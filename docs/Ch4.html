<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.555">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>STAT 255 Notes - 4&nbsp; Inference from Models</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./Ch5.html" rel="next">
<link href="./Ch3.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./Ch4.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Inference from Models</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">STAT 255 Notes</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ch1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Visualizing and Summarizing Data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ch2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Introduction to Statistical Models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ch3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Simulation-Based Inference</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ch4.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Inference from Models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ch5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Building and Assessing Models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ch6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Logistic Regression</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ch7.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Predictive Modeling</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#the-normal-error-regression-model" id="toc-the-normal-error-regression-model" class="nav-link active" data-scroll-target="#the-normal-error-regression-model"><span class="header-section-number">4.1</span> The Normal Error Regression Model</a>
  <ul class="collapse">
  <li><a href="#example-ice-cream-dispenser" id="toc-example-ice-cream-dispenser" class="nav-link" data-scroll-target="#example-ice-cream-dispenser"><span class="header-section-number">4.1.1</span> Example: Ice Cream dispenser</a></li>
  <li><a href="#normal-distribution" id="toc-normal-distribution" class="nav-link" data-scroll-target="#normal-distribution"><span class="header-section-number">4.1.2</span> Normal Distribution</a></li>
  <li><a href="#modeling-ice-cream-dispenser" id="toc-modeling-ice-cream-dispenser" class="nav-link" data-scroll-target="#modeling-ice-cream-dispenser"><span class="header-section-number">4.1.3</span> Modeling Ice Cream Dispenser</a></li>
  <li><a href="#normal-error-regression-model" id="toc-normal-error-regression-model" class="nav-link" data-scroll-target="#normal-error-regression-model"><span class="header-section-number">4.1.4</span> Normal Error Regression Model</a></li>
  <li><a href="#examples-of-normal-error-regression-model" id="toc-examples-of-normal-error-regression-model" class="nav-link" data-scroll-target="#examples-of-normal-error-regression-model"><span class="header-section-number">4.1.5</span> Examples of Normal Error Regression Model</a></li>
  <li><a href="#implications-of-normal-error-regression-model" id="toc-implications-of-normal-error-regression-model" class="nav-link" data-scroll-target="#implications-of-normal-error-regression-model"><span class="header-section-number">4.1.6</span> Implications of Normal Error Regression Model</a></li>
  </ul></li>
  <li><a href="#standard-error-and-confidence-intervals" id="toc-standard-error-and-confidence-intervals" class="nav-link" data-scroll-target="#standard-error-and-confidence-intervals"><span class="header-section-number">4.2</span> Standard Error and Confidence Intervals</a>
  <ul class="collapse">
  <li><a href="#common-standard-error-formulas" id="toc-common-standard-error-formulas" class="nav-link" data-scroll-target="#common-standard-error-formulas"><span class="header-section-number">4.2.1</span> Common Standard Error Formulas</a></li>
  <li><a href="#example-difference-in-means" id="toc-example-difference-in-means" class="nav-link" data-scroll-target="#example-difference-in-means"><span class="header-section-number">4.2.2</span> Example: Difference in Means</a></li>
  <li><a href="#example-regression-slope-and-intercept" id="toc-example-regression-slope-and-intercept" class="nav-link" data-scroll-target="#example-regression-slope-and-intercept"><span class="header-section-number">4.2.3</span> Example: Regression Slope and Intercept</a></li>
  <li><a href="#example-single-mean" id="toc-example-single-mean" class="nav-link" data-scroll-target="#example-single-mean"><span class="header-section-number">4.2.4</span> Example: Single Mean</a></li>
  <li><a href="#ci-method-comparison" id="toc-ci-method-comparison" class="nav-link" data-scroll-target="#ci-method-comparison"><span class="header-section-number">4.2.5</span> CI Method Comparison</a></li>
  </ul></li>
  <li><a href="#t-tests" id="toc-t-tests" class="nav-link" data-scroll-target="#t-tests"><span class="header-section-number">4.3</span> t-tests</a>
  <ul class="collapse">
  <li><a href="#t-distribution" id="toc-t-distribution" class="nav-link" data-scroll-target="#t-distribution"><span class="header-section-number">4.3.1</span> t-Distribution</a></li>
  <li><a href="#t-tests-1" id="toc-t-tests-1" class="nav-link" data-scroll-target="#t-tests-1"><span class="header-section-number">4.3.2</span> t-tests</a></li>
  <li><a href="#t-test-examples" id="toc-t-test-examples" class="nav-link" data-scroll-target="#t-test-examples"><span class="header-section-number">4.3.3</span> t-test Examples</a></li>
  <li><a href="#limitations-of-model-based-inference" id="toc-limitations-of-model-based-inference" class="nav-link" data-scroll-target="#limitations-of-model-based-inference"><span class="header-section-number">4.3.4</span> Limitations of Model-Based Inference</a></li>
  </ul></li>
  <li><a href="#f-tests" id="toc-f-tests" class="nav-link" data-scroll-target="#f-tests"><span class="header-section-number">4.4</span> F-tests</a>
  <ul class="collapse">
  <li><a href="#f-distribution" id="toc-f-distribution" class="nav-link" data-scroll-target="#f-distribution"><span class="header-section-number">4.4.1</span> F-Distribution</a></li>
  <li><a href="#house-condition-example" id="toc-house-condition-example" class="nav-link" data-scroll-target="#house-condition-example"><span class="header-section-number">4.4.2</span> House Condition Example</a></li>
  <li><a href="#interaction-example" id="toc-interaction-example" class="nav-link" data-scroll-target="#interaction-example"><span class="header-section-number">4.4.3</span> Interaction Example</a></li>
  </ul></li>
  <li><a href="#lm-summary-in-r" id="toc-lm-summary-in-r" class="nav-link" data-scroll-target="#lm-summary-in-r"><span class="header-section-number">4.5</span> <code>lm</code> Summary in R</a>
  <ul class="collapse">
  <li><a href="#lm-summary-output" id="toc-lm-summary-output" class="nav-link" data-scroll-target="#lm-summary-output"><span class="header-section-number">4.5.1</span> <code>lm</code> <code>summary</code> Output</a></li>
  <li><a href="#difference-in-means-example" id="toc-difference-in-means-example" class="nav-link" data-scroll-target="#difference-in-means-example"><span class="header-section-number">4.5.2</span> Difference in Means Example</a></li>
  <li><a href="#simple-linear-regression-example" id="toc-simple-linear-regression-example" class="nav-link" data-scroll-target="#simple-linear-regression-example"><span class="header-section-number">4.5.3</span> Simple Linear Regression Example</a></li>
  <li><a href="#multiple-regression-example" id="toc-multiple-regression-example" class="nav-link" data-scroll-target="#multiple-regression-example"><span class="header-section-number">4.5.4</span> Multiple Regression Example</a></li>
  <li><a href="#mr-with-interaction-example" id="toc-mr-with-interaction-example" class="nav-link" data-scroll-target="#mr-with-interaction-example"><span class="header-section-number">4.5.5</span> MR with Interaction Example</a></li>
  </ul></li>
  <li><a href="#intervals-for-expected-response" id="toc-intervals-for-expected-response" class="nav-link" data-scroll-target="#intervals-for-expected-response"><span class="header-section-number">4.6</span> Intervals for Expected Response</a>
  <ul class="collapse">
  <li><a href="#parameter-values-and-expected-responses" id="toc-parameter-values-and-expected-responses" class="nav-link" data-scroll-target="#parameter-values-and-expected-responses"><span class="header-section-number">4.6.1</span> Parameter Values and Expected Responses</a></li>
  <li><a href="#estimation-and-prediction" id="toc-estimation-and-prediction" class="nav-link" data-scroll-target="#estimation-and-prediction"><span class="header-section-number">4.6.2</span> Estimation and Prediction</a></li>
  <li><a href="#intervals-in-r" id="toc-intervals-in-r" class="nav-link" data-scroll-target="#intervals-in-r"><span class="header-section-number">4.6.3</span> Intervals in R</a></li>
  <li><a href="#slr-calculations-optional" id="toc-slr-calculations-optional" class="nav-link" data-scroll-target="#slr-calculations-optional"><span class="header-section-number">4.6.4</span> SLR Calculations (Optional)</a></li>
  <li><a href="#car-price-and-acceleration-time" id="toc-car-price-and-acceleration-time" class="nav-link" data-scroll-target="#car-price-and-acceleration-time"><span class="header-section-number">4.6.5</span> Car Price and Acceleration Time</a></li>
  <li><a href="#florida-lakes-est.-and-pred." id="toc-florida-lakes-est.-and-pred." class="nav-link" data-scroll-target="#florida-lakes-est.-and-pred."><span class="header-section-number">4.6.6</span> Florida Lakes Est. and Pred.</a></li>
  </ul></li>
  <li><a href="#the-regression-effect" id="toc-the-regression-effect" class="nav-link" data-scroll-target="#the-regression-effect"><span class="header-section-number">4.7</span> The Regression Effect</a>
  <ul class="collapse">
  <li><a href="#the-regression-effect-1" id="toc-the-regression-effect-1" class="nav-link" data-scroll-target="#the-regression-effect-1"><span class="header-section-number">4.7.1</span> The Regression Effect</a></li>
  <li><a href="#the-regression-effect-2" id="toc-the-regression-effect-2" class="nav-link" data-scroll-target="#the-regression-effect-2"><span class="header-section-number">4.7.2</span> The Regression Effect</a></li>
  <li><a href="#the-regression-effect-3" id="toc-the-regression-effect-3" class="nav-link" data-scroll-target="#the-regression-effect-3"><span class="header-section-number">4.7.3</span> The Regression Effect</a></li>
  <li><a href="#simulating-regression-effect" id="toc-simulating-regression-effect" class="nav-link" data-scroll-target="#simulating-regression-effect"><span class="header-section-number">4.7.4</span> Simulating Regression Effect</a></li>
  <li><a href="#test-scores-simulation---highest-scores" id="toc-test-scores-simulation---highest-scores" class="nav-link" data-scroll-target="#test-scores-simulation---highest-scores"><span class="header-section-number">4.7.5</span> Test Scores Simulation - Highest Scores</a></li>
  <li><a href="#test-scores-simulation---lowest-scores" id="toc-test-scores-simulation---lowest-scores" class="nav-link" data-scroll-target="#test-scores-simulation---lowest-scores"><span class="header-section-number">4.7.6</span> Test Scores Simulation - Lowest Scores</a></li>
  <li><a href="#another-example" id="toc-another-example" class="nav-link" data-scroll-target="#another-example"><span class="header-section-number">4.7.7</span> Another Example</a></li>
  <li><a href="#other-examples-of-regression-effect" id="toc-other-examples-of-regression-effect" class="nav-link" data-scroll-target="#other-examples-of-regression-effect"><span class="header-section-number">4.7.8</span> Other Examples of Regression Effect</a></li>
  </ul></li>
  <li><a href="#responsible-statistical-inference" id="toc-responsible-statistical-inference" class="nav-link" data-scroll-target="#responsible-statistical-inference"><span class="header-section-number">4.8</span> Responsible Statistical Inference</a>
  <ul class="collapse">
  <li><a href="#breakfast-cereals-and-sex-of-babies" id="toc-breakfast-cereals-and-sex-of-babies" class="nav-link" data-scroll-target="#breakfast-cereals-and-sex-of-babies"><span class="header-section-number">4.8.1</span> Breakfast Cereals and Sex of Babies</a></li>
  <li><a href="#flights-from-new-york-to-chicago" id="toc-flights-from-new-york-to-chicago" class="nav-link" data-scroll-target="#flights-from-new-york-to-chicago"><span class="header-section-number">4.8.2</span> Flights from New York to Chicago</a></li>
  <li><a href="#smoking-and-birthweight-example" id="toc-smoking-and-birthweight-example" class="nav-link" data-scroll-target="#smoking-and-birthweight-example"><span class="header-section-number">4.8.3</span> Smoking and Birthweight Example</a></li>
  <li><a href="#cautions-and-advice" id="toc-cautions-and-advice" class="nav-link" data-scroll-target="#cautions-and-advice"><span class="header-section-number">4.8.4</span> Cautions and Advice</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Inference from Models</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p><strong>Learning Outcomes:</strong></p>
<ol start="24" type="1">
<li>State the assumptions of the normal error regression model in context.<br>
</li>
<li>Calculate confidence intervals and t-statistics using standard error formulas.<br>
</li>
<li>State the hypotheses associated with each p-value in the lm summary table and explain what we should conclude from each test.<br>
</li>
<li>Show how to calculate standard errors, t-statistics, residual standard error, Multiple R^2, and F-Statistic in the <code>lm</code> summary output in R.<br>
</li>
<li>Interpret confidence and prediction intervals for expected response, as well as intervals for parameter estimates, and identify the sources of variability affecting each.</li>
<li>Explain the regression effect in context.<br>
</li>
<li>Make responsible decisions from data, considering issues such as representation and randomization, multiple testing, and the difference between statistical significance and practical importance.</li>
</ol>
<section id="the-normal-error-regression-model" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="the-normal-error-regression-model"><span class="header-section-number">4.1</span> The Normal Error Regression Model</h2>
<p>You’ve probably noticed that most of the sampling distributions of statistics we’ve seen were symmetric and bell-shaped in nature. When working with statistics that have symmetric and bell-shaped distributions and know standard error formulas, it is possible to use well-known probability facts to obtain confidence intervals and perform hypothesis tests without actually performing simulation.</p>
<p>In this chapter, we’ll examine a set of assumptions that, if true, would ensure that statistics like means and differences in means, and regression coefficients follow symmetric and bell-shaped distributions. We’ll learn how to use facts from probability to calculate confidence intervals and p-values without actually performing simulation in these instances.</p>
<section id="example-ice-cream-dispenser" class="level3" data-number="4.1.1">
<h3 data-number="4.1.1" class="anchored" data-anchor-id="example-ice-cream-dispenser"><span class="header-section-number">4.1.1</span> Example: Ice Cream dispenser</h3>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ice_Cream.png" class="img-fluid figure-img" style="width:50.0%"></p>
</figure>
</div>
</div>
</div>
<p>Suppose an ice cream machine is manufactured to dispense 2 oz. of ice cream per second, on average. If 15 people used the ice cream machine, holding the dispenser for different amounts of time, and each person got exactly 2 oz. per second, the relationship between time holding the dispenser and amount dispensed would look like this:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch4_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>In reality, however, the actual amount dispensed each time it is used will vary due to unknown factors like:</p>
<ul>
<li>force applied to dispenser<br>
</li>
<li>temperature<br>
</li>
<li>build-up of ice cream<br>
</li>
<li>other unknown factors</li>
</ul>
<p>Thus, if 15 real people held the dispenser and recorded the amount of ice cream they got, the scatter plot we would see would look something like this:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch4_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We can think of the amount of ice cream a person receives as being a result of two separate components, often referred to as <strong>signal</strong> and <strong>noise</strong>.</p>
<p>Signal represents the average amount of ice cream a person is expected to receive based on the amount of time holding the dispenser. In this case, signal is given by the function <span class="math inline">\(\text{Expected Amount} = 2\times\text{Time}\)</span>. Everyone who holds the dispenser for <span class="math inline">\(t\)</span> seconds is expected to receive <span class="math inline">\(2t\)</span> ounces of ice cream.</p>
<p>Noise represents how much each person’s actual amount of ice cream deviates from their expected amount. For example, a person who holds the dispenser for 1.5 seconds and receives 3.58 oz. of ice cream will have received 0.58 ounces more than expected due to noise (i.e.&nbsp;factors beyond time holding the dispenser).</p>
<p>In a statistical model, we assume that the response value of a response variable we observe is the sum of the signal, or expected response, which is a function of the explanatory variables in the model, and noise, which results from deviations due to factors beyond those accounted for in the model.</p>
</section>
<section id="normal-distribution" class="level3" data-number="4.1.2">
<h3 data-number="4.1.2" class="anchored" data-anchor-id="normal-distribution"><span class="header-section-number">4.1.2</span> Normal Distribution</h3>
<p>It is common to model noise using a symmetric, bell-shaped distribution, known as a <strong>normal distribution</strong>.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch4_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<p>We can think of the error term as a random draw from somewhere in the area below the bell-curve. For example, in the above illustration, most of the area under the curve lies between <span class="math inline">\(-1\leq x\leq 1\)</span>. If this curve represented the noise term in the ice cream example, it would mean that most people’s actual amount of ice cream dispensed would be within <span class="math inline">\(\pm 1\)</span> ounce of their expected amount (or signal). Notice that the normal distribution is centered at 0, indicating that on average, a person would be expected to get an amount exactly equal to their signal, but that they might deviate above or below this amount by unexplained factors, which can be modeled by random chance.</p>
<p>A normal distribution is defined by two parameters:<br>
- <span class="math inline">\(\mu\)</span> representing the center of the distribution<br>
- <span class="math inline">\(\sigma\)</span> representing the standard deviation</p>
<p>This distribution is denoted <span class="math inline">\(\mathcal{N}(\mu, \sigma)\)</span>.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch4_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<p>When the standard deviation is small, such as for the blue curve, noise tends to be close to 0, meaning the observed values will be close to their expectation. On the other hand, the green curve, which has higher standard deviation, would often produce noise values as extreme as <span class="math inline">\(\pm 2\)</span> or more.</p>
<p>Note that the square of the standard deviation <span class="math inline">\(\sigma^2\)</span> is called the variance. Some books denote the normal distribution as <span class="math inline">\(\mathcal{N}(\mu, \sigma^2)\)</span>, instead of <span class="math inline">\(\mathcal{N}(\mu,\sigma)\)</span>. We will use the <span class="math inline">\(\mathcal{N}(\mu,\sigma)\)</span> here, which is consistent with R.</p>
</section>
<section id="modeling-ice-cream-dispenser" class="level3" data-number="4.1.3">
<h3 data-number="4.1.3" class="anchored" data-anchor-id="modeling-ice-cream-dispenser"><span class="header-section-number">4.1.3</span> Modeling Ice Cream Dispenser</h3>
<p>In this example, we’ll simulate the amount of ice cream dispensed for each person by adding a random number from a normal distribution with mean 0 and standard deviation 0.5 to the expected amount dispensed, which is given by <span class="math inline">\(2x\)</span>, where <span class="math inline">\(x\)</span> represents time pressing the dispenser. We’ll let <span class="math inline">\(\epsilon_i\)</span> represent the random noise term for the <span class="math inline">\(i\)</span>th person.</p>
<p>Thus, amount dispensed (<span class="math inline">\(Y_i\)</span>) for person <span class="math inline">\(i\)</span> is given by</p>
<p><span class="math display">\[
Y_i = 2x_i+\epsilon_i, \text{ where } \epsilon_i\sim\mathcal{N}(0, 0.5)
\]</span></p>
<p><strong>Illustration</strong></p>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="SLR_Model_Assumptions.png" class="img-fluid figure-img" style="width:50.0%"></p>
<figcaption>The amount dispensed follows a normal distribution with mean equal to twice the time holding the dispensor and standard deviation 0.5</figcaption>
</figure>
</div>
</div>
</div>
<p>We simulate the amount dispensed for a sample of 15 people below. The <code>rnorm</code>(n, <span class="math inline">\(\mu\)</span>, <span class="math inline">\(\sigma\)</span>) function generates <span class="math inline">\(n\)</span> random numbers from a normal distribution with mean <span class="math inline">\(\mu\)</span>, and standard deviation <span class="math inline">\(\sigma\)</span>. The code below simulates 15 random numbers and adds them to the expected amount dispensed for 15 people who hold the dispenser for the times shown.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">10082020</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"># set times </span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>time <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">1.2</span>, <span class="fl">1.5</span>, <span class="fl">1.8</span>, <span class="fl">2.1</span>, <span class="fl">2.1</span>, <span class="fl">2.3</span>, <span class="fl">2.5</span>, <span class="fl">2.6</span>, <span class="fl">2.8</span>, <span class="fl">2.9</span>, <span class="fl">2.9</span>, <span class="fl">3.1</span>, <span class="fl">3.2</span>, <span class="fl">3.6</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>expected <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span>time  <span class="co"># expected amount</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>noise <span class="ot">&lt;-</span><span class="fu">rnorm</span>(<span class="dv">15</span>, <span class="dv">0</span>, <span class="fl">0.5</span>) <span class="sc">%&gt;%</span> <span class="fu">round</span>(<span class="dv">2</span>)  <span class="co">#generate noise from normal distribution</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>amount <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span>time <span class="sc">+</span> noise  <span class="co"># calculate observed amounts</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>Icecream <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(time, signal, noise, amount) <span class="co"># set up data table</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>((Icecream)) <span class="co">#display table</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">time</th>
<th style="text-align: right;">signal</th>
<th style="text-align: right;">noise</th>
<th style="text-align: right;">amount</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">2.0</td>
<td style="text-align: right;">0.23</td>
<td style="text-align: right;">2.23</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.2</td>
<td style="text-align: right;">2.4</td>
<td style="text-align: right;">-0.49</td>
<td style="text-align: right;">1.91</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.5</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">0.58</td>
<td style="text-align: right;">3.58</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.8</td>
<td style="text-align: right;">3.6</td>
<td style="text-align: right;">-0.03</td>
<td style="text-align: right;">3.57</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2.1</td>
<td style="text-align: right;">4.2</td>
<td style="text-align: right;">0.17</td>
<td style="text-align: right;">4.37</td>
</tr>
<tr class="even">
<td style="text-align: right;">2.1</td>
<td style="text-align: right;">4.2</td>
<td style="text-align: right;">-0.93</td>
<td style="text-align: right;">3.27</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2.3</td>
<td style="text-align: right;">4.6</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">4.65</td>
</tr>
<tr class="even">
<td style="text-align: right;">2.5</td>
<td style="text-align: right;">5.0</td>
<td style="text-align: right;">-0.37</td>
<td style="text-align: right;">4.63</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2.6</td>
<td style="text-align: right;">5.2</td>
<td style="text-align: right;">-0.46</td>
<td style="text-align: right;">4.74</td>
</tr>
<tr class="even">
<td style="text-align: right;">2.8</td>
<td style="text-align: right;">5.6</td>
<td style="text-align: right;">0.17</td>
<td style="text-align: right;">5.77</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2.9</td>
<td style="text-align: right;">5.8</td>
<td style="text-align: right;">-0.59</td>
<td style="text-align: right;">5.21</td>
</tr>
<tr class="even">
<td style="text-align: right;">2.9</td>
<td style="text-align: right;">5.8</td>
<td style="text-align: right;">0.12</td>
<td style="text-align: right;">5.92</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3.1</td>
<td style="text-align: right;">6.2</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">6.20</td>
</tr>
<tr class="even">
<td style="text-align: right;">3.2</td>
<td style="text-align: right;">6.4</td>
<td style="text-align: right;">0.67</td>
<td style="text-align: right;">7.07</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3.6</td>
<td style="text-align: right;">7.2</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">7.25</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The scatterplot displays the amount dispensed, compared to the time pressing the dispenser. The red line indicates the line <span class="math inline">\(y=2x\)</span>. If there was no random noise, then each person’s amount dispensed would lie exactly on this line.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>Icecream1, <span class="fu">aes</span>(<span class="at">x=</span>time, <span class="at">y=</span>amount)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"Icecream Dispensed"</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"Time Pressing dispenser"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Amount Dispensed"</span>) <span class="sc">+</span> <span class="fu">geom_abline</span>(<span class="at">slope=</span><span class="dv">2</span>, <span class="at">intercept=</span><span class="dv">0</span>, <span class="at">color=</span><span class="st">"red"</span>) <span class="sc">+</span> </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">label=</span><span class="st">"y=2x"</span>, <span class="at">x=</span> <span class="fl">3.5</span>, <span class="at">y=</span><span class="fl">6.5</span>, <span class="at">size=</span><span class="dv">10</span>, <span class="at">color=</span><span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch4_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Estimating Regression Line</strong></p>
<p>In a real situation, we would not see the signal and noise columns in the table or the red line on the graph. We would only see the time and amount, and points on the scatter plot. From these, we would need to estimate the location of the red line by fitting a least squares regression line to the data, as we’ve done before.</p>
<p>The blue line represents the location of the least squares regression line fit to the time and amounts observed.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>Icecream1, <span class="fu">aes</span>(<span class="at">x=</span>time, <span class="at">y=</span>amount)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"Icecream Dispensed"</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"Time Pressing dispenser"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Amount Dispensed"</span>) <span class="sc">+</span> <span class="fu">stat_smooth</span>(<span class="at">method=</span><span class="st">"lm"</span>, <span class="at">se=</span><span class="cn">FALSE</span>) <span class="sc">+</span> <span class="fu">geom_abline</span>(<span class="at">slope=</span><span class="dv">2</span>, <span class="at">intercept=</span><span class="dv">0</span>, <span class="at">color=</span><span class="st">"red"</span>) <span class="sc">+</span> </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">label=</span><span class="st">"y=2x"</span>, <span class="at">x=</span> <span class="fl">3.5</span>, <span class="at">y=</span><span class="fl">6.5</span>, <span class="at">size=</span><span class="dv">10</span>, <span class="at">color=</span><span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch4_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The blue line is close, but not identical to the red line, representing the true (usually unknown) signal.</p>
<p>The slope and intercept of the blue line are given by:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>IC_Model <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>Icecream1, <span class="fu">lm</span>(amount<span class="sc">~</span>time))</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>IC_Model</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = lm(amount ~ time), data = Icecream1)

Coefficients:
(Intercept)         time  
    -0.1299       2.0312  </code></pre>
</div>
</div>
<p>Notice that these estimates are close, but not identical to the intercept and slope of the red line, which are 0 and 2, respectively.</p>
<p>The equation of the red line is given by:</p>
<p><span class="math inline">\(Y_i = \beta_0 + \beta_1X_{i} + \epsilon_i\)</span>, where <span class="math inline">\(\epsilon_i\sim\mathcal{N}(0,\sigma)\)</span>,</p>
<p>where <span class="math inline">\(Y_i\)</span> represents amount dispensed, and <span class="math inline">\(X_i\)</span> represents time. <span class="math inline">\(\beta_0, \beta_1,\)</span>, and <span class="math inline">\(\sigma\)</span> are the unknown model parameters associated with the ice cream machine’s process.</p>
<p>Using the values of <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span> obtained by fitting a model to our observed data as estimates of <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>, our estimated regression equation is</p>
<p>$$ Y_i = b_0 + b_1X_i + _i = -0.1299087 + 2.0312489X_i + _i</p>
<p>$$</p>
<p>where <span class="math inline">\(\epsilon_i\sim\mathcal{N}(0,\sigma)\)</span>.</p>
<p>An estimate for <span class="math inline">\(\sigma\)</span> is given by</p>
<p><span class="math inline">\(s =\sqrt{\frac{\text{SSR}}{n-(p+1)}} = \sqrt{\frac{\displaystyle\sum_{i=1}^n(y_i-\hat{y}_i)^2}{(n-(p+1))}}\)</span>.</p>
<p>We calculate <span class="math inline">\(s\)</span> , using R.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">sum</span>(IC_Model<span class="sc">$</span>residuals<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>(<span class="dv">15-2</span>))</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>s</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4527185</code></pre>
</div>
</div>
<p>In statistics it is common to use Greek letters like <span class="math inline">\(\beta_j\)</span> and <span class="math inline">\(\sigma\)</span>, to represent unknown model parameters, pertaining to a population or process (such as the ice cream dispenser), and English letters like <span class="math inline">\(b_j\)</span> and <span class="math inline">\(s\)</span> to represent statistics calculated from data.</p>
<p>The estimates of <span class="math inline">\(b_0 = -0.1299087\)</span>, <span class="math inline">\(b_1=2.0312489\)</span>, and <span class="math inline">\(s = 0.4527185\)</span> are reasonably close estimates to the values <span class="math inline">\(\beta_0=0, \beta_1=2\)</span>, and <span class="math inline">\(\sigma = 0.5\)</span>, that we used to generate the data.</p>
<p>In a real situation, we’ll have only statistics <span class="math inline">\(b_0\)</span>, <span class="math inline">\(b_1\)</span>, and <span class="math inline">\(s\)</span>, and we’ll need to use them to draw conclusions about parameters <span class="math inline">\(\beta_0=0, \beta_1=2\)</span>, and <span class="math inline">\(\sigma = 0.5\)</span>.</p>
</section>
<section id="normal-error-regression-model" class="level3" data-number="4.1.4">
<h3 data-number="4.1.4" class="anchored" data-anchor-id="normal-error-regression-model"><span class="header-section-number">4.1.4</span> Normal Error Regression Model</h3>
<p>In the ice cream example, the relationship between expected amount and time holding the dispenser was given by a linear equation involving a single numeric explanatory variable. We can generalize this to situations with multiple explanatory variables, which might be numeric or categorical.</p>
<p>Individual observations are then assumed to vary from their expectation in accordance with a normal distribution, representing random noise (or error).</p>
<p>The mathematical form of a normal error linear regression model is</p>
<p><span class="math inline">\(Y_i = \beta_0 + \beta_1X_{i1}+ \ldots + \beta_pX_{ip} + \epsilon_i\)</span>, with <span class="math inline">\(\epsilon_i\sim\mathcal{N}(0,\sigma)\)</span>.</p>
<p>Note that in place of <span class="math inline">\(X_{ip}\)</span>, we could have indicators for categories, or functions of <span class="math inline">\(X_{ip}\)</span>, such as <span class="math inline">\(X_{ip}^2\)</span>, <span class="math inline">\(\text{log}(X_{ip})\)</span>, or <span class="math inline">\(\text{sin}(X_{ip})\)</span>.</p>
<ul>
<li><p>The quantities <span class="math inline">\(\beta_0, \beta_1, \ldots, \beta_p\)</span> are parameters, pertaining to the true but unknown data generating mechanism.</p></li>
<li><p>The estimates <span class="math inline">\(b_0, b_1, \ldots, b_p\)</span>, are statistics, calculated from our observed data.<br>
</p></li>
<li><p>We use statistics <span class="math inline">\(b_0, b_1, \ldots, b_p\)</span> to obtain confidence intervals and hypothesis tests to make statements about parameters <span class="math inline">\(\beta_0, \beta_1, \ldots, \beta_p\)</span>.</p></li>
</ul>
<p><strong>Assumptions of Normal Error Regression Model</strong></p>
<p>When generating data for the ice cream machine, we assumed four things:</p>
<ol type="1">
<li><p><strong>Linearity</strong> - the expected amount of ice cream dispensed (i.e the signal) is a linear function of time the dispenser was pressed.</p></li>
<li><p><strong>Constant Variance</strong> - individual amounts dispensed varied from their expected amount with equal variability, regardless of the amount of time. That is, the amount of variability in individual amounts dispensed was the same for people who held the dispenser for 1 s. as for people who held it for 2 s. or 3 s., etc.</p></li>
<li><p><strong>Normality</strong> - individual amounts dispensed varied from their expected amount in accordance with a normal distribution.</p></li>
<li><p><strong>Independence</strong> - the amount of ice cream dispensed for one person was not affected by the amount dispensed for anyone else.</p></li>
</ol>
<p>More generally, the normal error regression model assumes:</p>
<ol type="1">
<li><p><strong>Linearity</strong> - the expected response is a linear function of the explanatory variable(s).</p></li>
<li><p><strong>Constant Variance</strong> - the variance between individual values of the response variable are the same for any values/categories of the explanatory variable(s)</p></li>
<li><p><strong>Normality</strong> - for any values/categories of the explanatory variable(s) individual response values vary from their expectation in accordance with a normal distribution.</p></li>
<li><p><strong>Independence</strong> - individual response values are not affected by one another</p></li>
</ol>
</section>
<section id="examples-of-normal-error-regression-model" class="level3" data-number="4.1.5">
<h3 data-number="4.1.5" class="anchored" data-anchor-id="examples-of-normal-error-regression-model"><span class="header-section-number">4.1.5</span> Examples of Normal Error Regression Model</h3>
<p>We can formulate all of the examples we’ve worked with so far in terms of the normal error regression model.</p>
<p>In the house price example, consider the following models:</p>
<p><strong>Model 1:</strong></p>
<p><span class="math inline">\(\text{Price}_i = \beta_0 + \beta_1\text{Sq.Ft.}_{i} + \epsilon_i\)</span>, where <span class="math inline">\(\epsilon_i\sim\mathcal{N}(0,\sigma)\)</span>.</p>
<p>If we use this model, we’re saying that we believe the expected price of a house is a linear function of its size, and that for any given size, the distribution of actual prices are normally distributed around their expected value of <span class="math inline">\(\beta_0 + \beta_1\text{Sq.Ft.}_{i}\)</span>. Furthermore, we’re saying that the amount of variability in hourse prices is the same for houses of any size.</p>
<p><strong>Model 2:</strong></p>
<p><span class="math inline">\(\text{Price}_i = \beta_0 + \beta_2\text{Waterfront}_{i}+ \epsilon_i\)</span>, where <span class="math inline">\(\epsilon_i\sim\mathcal{N}(0,\sigma)\)</span>.</p>
<p>If we use this model, we’re saying that we believe the expected price of a house depends only on whether or not it is on the waterfront, and that prices of both waterfront and non-waterfront houses follow normal distributions. Though these distributions may have different means (<span class="math inline">\(\beta_0\)</span> for non-waterfront houses, and <span class="math inline">\(\beta_1\)</span> for waterfront houses), the amount of variability in prices should be the same for waterfront as non-waterfront houses.</p>
<p><strong>Model 3:</strong></p>
<p><span class="math inline">\(\text{Price}_i = \beta_0 + \beta_1\text{Sq.Ft.}_{i}+ \beta_2\text{Waterfront}_{i}+ \beta_3\times\text{Sq.Ft.}_i\times\text{Waterfront}_{i} + \epsilon_i\)</span>, where <span class="math inline">\(\epsilon_i\sim\mathcal{N}(0,\sigma)\)</span>.</p>
<p>and</p>
<p><strong>Model 4:</strong></p>
<p><span class="math inline">\(\text{Price}_i = \beta_0 + \beta_1\text{Sq.Ft.}_{i}+ \beta_2\text{Waterfront}_{i}+ \beta_3\times\text{Sq.Ft.}_i\times\text{Waterfront}_{i} + \epsilon_i\)</span>, where <span class="math inline">\(\epsilon_i\sim\mathcal{N}(0,\sigma)\)</span>.</p>
<p>Both of Models 3 and 4 assume that actual prices of houses with the same size and waterfront status are normally distributed, and that the mean of the normal distribution is a linear function of its size. Model 3 allows for the intercept of the lines to differ between waterfront and non-waterfront houses, while Model 4 allows both the intercept and slope to differ. Both assume that the amount of variability among houses of the same size and waterfront status is the same.</p>
</section>
<section id="implications-of-normal-error-regression-model" class="level3" data-number="4.1.6">
<h3 data-number="4.1.6" class="anchored" data-anchor-id="implications-of-normal-error-regression-model"><span class="header-section-number">4.1.6</span> Implications of Normal Error Regression Model</h3>
<p>If we really believe that data come about as the normal error regression model describes, then probability theory tells us that regression coefficients <span class="math inline">\(b_j\)</span>’s, representing differences between categories for categorical variables and rates of change for quantitative variables, follow symmetric and bell-shaped distributions. We can use this fact to create confidence intervals and perform hypothesis tests, without needing to perform simulation. This is, in fact what R does in it’s model summary output.</p>
<p>These methods are only valid, however, if data can reasonably be thought of as having come from a process consistent with the assumptions of the normal error regression model process. If we don’t believe that our observed data can be reasonably thought of as having come from such a process, then the confidence intervals and p-values produced by R, and other places that rely on probability-based methods will not be reliable.</p>
<p>We close the section with a philosophical question:</p>
<p>Do data really come about from processes like the normal error regression model? That is, do you think it is reasonable to believe that data we see in the real world (perhaps the amount of ice cream dispensed by an ice cream machine) represent independent outcomes of a process in which expected outcomes are a linear function of explanatory variables, and deviate from their expectation according to a normal distribution with constant variance?</p>
<p>We won’t attempt to answer that question here, but it is worth thinking about. After all, it is an assumption on which many frequently employed methods of statistical inference depends.</p>
<div style="page-break-after: always;"></div>
</section>
</section>
<section id="standard-error-and-confidence-intervals" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="standard-error-and-confidence-intervals"><span class="header-section-number">4.2</span> Standard Error and Confidence Intervals</h2>
<section id="common-standard-error-formulas" class="level3" data-number="4.2.1">
<h3 data-number="4.2.1" class="anchored" data-anchor-id="common-standard-error-formulas"><span class="header-section-number">4.2.1</span> Common Standard Error Formulas</h3>
<p>In the normal error regression model, <span class="math inline">\(\sigma\)</span> is an unknown model parameter representing the standard deviation in response values among cases with the same values/categories of explanatory variable(s). We estimate <span class="math inline">\(\sigma\)</span> using the statistic</p>
<p><span class="math inline">\(s =\sqrt{\frac{\text{SSR}}{n-(p+1)}} = \sqrt{\frac{\displaystyle\sum_{i=1}^n(y_i-\hat{y}_i)^2}{(n-(p+1))}}\)</span>.</p>
<p><span class="math inline">\(s\)</span> is not the same as the standard errors of statistics we estimated using bootstrapping in Chapter 3. It is, however, related to these standard errors. In fact, standard errors for common statistics like sample means, differences in means, and regression coefficients can be approximated using formulas involving <span class="math inline">\(s\)</span>.</p>
<p>So far, we’ve used simulation (permutation tests and bootstrap intervals) to determine the amount of variability associated with a test statistic or estimate, in order to perform hypotheses tests and create confidence intervals. In special situations, there are mathematical formulas, based on probability theory, that can be used to approximate these standard errors without having to perform the simulations.</p>
<p><strong>Theory-Based Standard Error Formulas</strong></p>
<table class="caption-top table">
<colgroup>
<col style="width: 31%">
<col style="width: 68%">
</colgroup>
<thead>
<tr class="header">
<th>Statistic</th>
<th>Standard Error</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Single Mean</td>
<td><span class="math inline">\(SE(b_0)=\frac{s}{\sqrt{n}}\)</span></td>
</tr>
<tr class="even">
<td>Difference in Means</td>
<td><span class="math inline">\(SE(b_j)=s\sqrt{\frac{1}{n_1}+\frac{1}{n_2}}\)</span></td>
</tr>
<tr class="odd">
<td>Single Proportion</td>
<td><span class="math inline">\(SE(\hat{p}) = \sqrt{\frac{\hat{p}(1-\hat{p})}{n}}\)</span></td>
</tr>
<tr class="even">
<td>Difference in Proportions</td>
<td><span class="math inline">\(SE(\hat{p}) = \sqrt{\left(\frac{\hat{p_1}(1-\hat{p}_1)}{n_1}+\frac{\hat{p_2}(1-\hat{p_2})}{n_2}\right)}\)</span></td>
</tr>
<tr class="odd">
<td>Intercept in Simple Linear Regression</td>
<td><span class="math inline">\(SE(b_0)=s\sqrt{\frac{1}{n}+\frac{\bar{x}^2}{\sum(x_i-\bar{x})^2}}\)</span></td>
</tr>
<tr class="even">
<td>Slope in Simple Linear Regression</td>
<td><span class="math inline">\(SE(b_1)=\sqrt{\frac{s^2}{\sum(x_i-\bar{x})^2}}=\sqrt{\frac{1}{n-2}\frac{{\sum(\hat{y}_i-y_i)^2}}{\sum(x_i-\bar{x})^2}}\)</span></td>
</tr>
</tbody>
</table>
<ul>
<li><p><span class="math inline">\(s=\sqrt{\frac{\displaystyle\sum_{i=1}^n(y_i-\hat{y}_i)^2}{(n-(p+1))}} = \sqrt{\frac{\text{SSR}}{(n-(p+1))}}\)</span>, (p is number of regression coefficients not including <span class="math inline">\(b_0\)</span>). <span class="math inline">\(s\)</span> is an estimate of the variability in the response variable among cases where the explanatory variable(s) are the same. Note that in the one-sample case, this simplifies to the standard deviation formula we’ve seen previously.</p></li>
<li><p>In the 2nd formula, the standard error estimate <span class="math inline">\(s\sqrt{\frac{1}{n_1+n_2}}\)</span> is called a “pooled” estimate since it combines information from all groups. When there is reason to believe standard deviation differs between groups, we often use an “unpooled” standard error estimate of <span class="math inline">\(\sqrt{\frac{s_1^2}{n_1}+\frac{s_2^2}{n_2}}\)</span>, where <span class="math inline">\(s_1, s_2\)</span> represent the standard deviation for groups 1 and 2. This can be used in situations where the explanatory variable is categorical and we have doubts about the constant variance assumption.</p></li>
</ul>
<p>There is no theory-based formula for standard error associated with the median or standard deviation. For these, and many other statistics, we rely on simulation to estimate variability between samples.</p>
<p>There are formulas for standard errors associated with coefficients in multiple regression, but these require mathematics beyond what is assumed in this class. They involve linear algebra and matrix inversion, which you can read about <a href="https://web.stanford.edu/~mrosenfe/soc_meth_proj3/matrix_OLS_NYU_notes.pdf">here</a> if you are interested.</p>
<p>When the sampling distribution is symmetric and bell-shaped, approximate 95% confidence intervals can be calculated using the formula,</p>
<p><span class="math display">\[
\text{Statistic} \pm 2\times \text{Standard Error},
\]</span></p>
<p>where the standard error is estimated using a formula, rather than through bootstrapping.</p>
<p>We’ll go through some examples to illustrate how to calculate and interpret <span class="math inline">\(s\)</span> and <span class="math inline">\(SE(b_j)\)</span>.</p>
</section>
<section id="example-difference-in-means" class="level3" data-number="4.2.2">
<h3 data-number="4.2.2" class="anchored" data-anchor-id="example-difference-in-means"><span class="header-section-number">4.2.2</span> Example: Difference in Means</h3>
<p>We’ll use the normal error regression model to predict a lake’s mercury level, using location (N vs S) as the explanatory variable.</p>
<p>The regression model is:</p>
<p><span class="math display">\[
\text{Mercury} = \beta_0 +\beta_1 \times\text{Location}_{\text{South}} + \epsilon_i, \text{where } \epsilon_i\sim\mathcal{N}(0, \sigma)
\]</span></p>
<p>This model assumes:</p>
<ol type="1">
<li><p><strong>Linearity</strong> - there is no linearity assumption when the explanatory variable is categorical.</p></li>
<li><p><strong>Constant Variance</strong> - the variance between mercury levels of individual lakes is the same for Northern Florida, as for Southern Florida.</p></li>
<li><p><strong>Normality</strong> - mercury levels are normally distributed in Northern Florida and also in Southern Florida.</p></li>
<li><p><strong>Independence</strong> - mercury levels of individual lakes are not affected by those of other lakes.</p></li>
</ol>
<p>The <code>lm</code> summary command in R returns information pertaining to the model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>Lakes_M <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>FloridaLakes, Mercury <span class="sc">~</span> Location)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Lakes_M)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Mercury ~ Location, data = FloridaLakes)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.65650 -0.23455 -0.08455  0.24350  0.67545 

Coefficients:
            Estimate Std. Error t value       Pr(&gt;|t|)    
(Intercept)  0.42455    0.05519   7.692 0.000000000441 ***
LocationS    0.27195    0.08985   3.027        0.00387 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.3171 on 51 degrees of freedom
Multiple R-squared:  0.1523,    Adjusted R-squared:  0.1357 
F-statistic: 9.162 on 1 and 51 DF,  p-value: 0.003868</code></pre>
</div>
</div>
<p>The estimates column returns the estimates of <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span>. The estimated regression equation is</p>
<p><span class="math display">\[
\widehat{\text{Mercury}} = 0.42455 + 0.27185\times\text{Location}_{\text{South}}
\]</span></p>
<p><strong>Estimating</strong> <span class="math inline">\(\sigma\)</span></p>
<p>The <strong>Residual Standard Error</strong> in the output gives the value of <span class="math inline">\(s\)</span>, and estimate of <span class="math inline">\(\sigma\)</span>.</p>
<p><span class="math inline">\(s =\sqrt{\frac{\text{SSR}}{n-(p+1)}} = \sqrt{\frac{\displaystyle\sum_{i=1}^n(y_i-\hat{y}_i)^2}{(n-(p+1))}}\)</span>.</p>
<p>SSR is:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(Lakes_M<span class="sc">$</span>residuals<span class="sc">^</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5.126873</code></pre>
</div>
</div>
<p>Since LocationSouth is our only explanatory variable, <span class="math inline">\(p=1\)</span>, and since we have 53 lakes in the sample, <span class="math inline">\(n=53\)</span>.</p>
<p>Thus,</p>
<p><span class="math inline">\(s =\sqrt{\frac{5.126873}{53-(1+1)}} = 0.317\)</span>.</p>
<p>The standard deviation in mercury concentrations among lakes in the same part of the state is estimated to be 0.317 ppm.</p>
<p>THe second column in the coefficients table gives standard errors associated with <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span>. These tell us how much these statistics are expected to vary between samples of the given size.</p>
<p><strong>Estimating</strong> <span class="math inline">\(\text{SE}(b_0)\)</span> and <span class="math inline">\(\text{SE}(b_1)\)</span></p>
<p>We’ll use the theory-based formulas to calculate the standard errors for <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span>.</p>
<p>In this case, <span class="math inline">\(b_0\)</span> represents a single mean, the mean mercury level for lakes in Northern Florida. Since there are 33 such lakes, the calculation is:</p>
<p><span class="math inline">\(SE(b_0)=\frac{s}{\sqrt{n}} = \frac{0.317}{\sqrt{33}} \approx 0.055\)</span></p>
<p>The standard error of intercept <span class="math inline">\(b_0\)</span> is 0.055. This represents the variability in average mercury level in different samples of 33 lakes from Northern Florida.</p>
<p><span class="math inline">\(SE(b_1)=s\sqrt{\frac{1}{n_1}+\frac{1}{n_2}} = 0.317\sqrt{\frac{1}{20}+{1}{33}} = 0.0898\)</span></p>
<p>The standard error of slope <span class="math inline">\(b_1\)</span> is 0.0898. This represents the variability in average difference in mercury levels between samples of 33 lakes from Northern Florida and 20 lakes from Southern Florida.</p>
<p>These numbers match the values in the <code>Std. Error</code> column of the coefficients table of the <code>lm</code> summary output.</p>
<p>A 95% confidence interval for <span class="math inline">\(\beta_0\)</span> is given by</p>
<p><span class="math display">\[
\begin{aligned}
&amp; b_0 \pm 2\times\text{SE}(b_0) \\
&amp; = 0.42455 \pm 2\times{0.055} \\
&amp; = (0.314, 0.535)
\end{aligned}
\]</span></p>
<p>A 95% confidence interval for <span class="math inline">\(\beta_1\)</span> is given by</p>
<p><span class="math display">\[
\begin{aligned}
&amp; b_1 \pm 2\times\text{SE}(b_1) \\
&amp; = 0.272 \pm 2\times{0.0898} \\
&amp; = (0.09, 0.45)
\end{aligned}
\]</span></p>
<p>We are 95% confident that the average mercury level in Southern Lakes is between 0.09 ppm and 0.45 ppm higher than in Northern Florida.</p>
<p>These intervals can be obtained directly in R using the <code>confint</code> command.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(Lakes_M, <span class="at">level=</span><span class="fl">0.95</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                 2.5 %    97.5 %
(Intercept) 0.31374083 0.5353501
LocationS   0.09157768 0.4523314</code></pre>
</div>
</div>
<p><strong>Comparison to Bootstrap</strong></p>
<p>We previously calculated <span class="math inline">\(\text{SE}(b_1)\)</span> and a 95% confidence interval for <span class="math inline">\(\beta_1\)</span>, which are shown below.</p>
<p><strong>Bootstrap Standard Error</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>SE_b1 <span class="ot">&lt;-</span> <span class="fu">sd</span>(NS_Lakes_Bootstrap_Results<span class="sc">$</span>Bootstrap_b1)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>SE_b1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.09549244</code></pre>
</div>
</div>
<p><strong>Bootstrap 95% Confidence Interval:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>Sample_b1 <span class="ot">&lt;-</span> Lakes_M<span class="sc">$</span>coefficients[<span class="dv">2</span>]</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(Sample_b1 <span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span>SE_b1, Sample_b1 <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>SE_b1) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> LocationS  LocationS 
0.08096967 0.46293942 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>NS_Lakes_Bootstrap_Plot_b1 <span class="sc">+</span> </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x=</span>Sample_b1 <span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span>SE_b1,<span class="at">xend=</span>Sample_b1 <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>SE_b1, <span class="at">y=</span><span class="dv">50</span>, <span class="at">yend=</span><span class="dv">50</span>), </span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">color=</span><span class="st">"gold"</span>, <span class="at">size=</span><span class="dv">10</span>, <span class="at">alpha=</span><span class="fl">0.01</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch4_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The formula-based standard error and confidence interval and those produced by bootstrapping are both approximations, so they are not expected to be identical, but should be close.</p>
</section>
<section id="example-regression-slope-and-intercept" class="level3" data-number="4.2.3">
<h3 data-number="4.2.3" class="anchored" data-anchor-id="example-regression-slope-and-intercept"><span class="header-section-number">4.2.3</span> Example: Regression Slope and Intercept</h3>
<p>We’ll use the normal error regression model to predict a lake’s mercury level, using pH as the explanatory variable.</p>
<p>The regression model is:</p>
<p><span class="math display">\[
\text{Mercury} = \beta_0 +\beta_1 \times\text{pH} + \epsilon_i, \text{where } \epsilon_i\sim\mathcal{N}(0, \sigma)
\]</span></p>
<p>This model assumes:</p>
<ol type="1">
<li><p><strong>Linearity</strong> - the mercury level is a linear function of pH.</p></li>
<li><p><strong>Constant Variance</strong> - the variance between mercury levels of individual lakes is the same for each pH level.</p></li>
<li><p><strong>Normality</strong> - for each pH, mercury levels are normally distributed.</p></li>
<li><p><strong>Independence</strong> - mercury levels of individual lakes are not affected by those of other lakes.</p></li>
</ol>
<p>We might have doubts about some of these assumptions. For example, if we believe there might be more variability in mercury levels among lakes with higher pH levels than lower ones (a violation of the constant variance assumption), or that lakes closer together are likely to have similar mercury levels (a violation of the independence assumption) then the results of the model might not be reliable.</p>
<p>Later in this chapter, we’ll learn ways to check the appropriateness of these assumptions. For now, we’ll assume that the model is a reasonable enough approximation of reality and use it accordingly.</p>
<p>The <code>lm</code> summary command in R returns information pertaining to the model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>M_pH <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>FloridaLakes, Mercury <span class="sc">~</span> pH)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(M_pH)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Mercury ~ pH, data = FloridaLakes)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.48895 -0.19188 -0.05774  0.09456  0.71134 

Coefficients:
            Estimate Std. Error t value       Pr(&gt;|t|)    
(Intercept)  1.53092    0.20349   7.523 0.000000000814 ***
pH          -0.15230    0.03031  -5.024 0.000006572811 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.2816 on 51 degrees of freedom
Multiple R-squared:  0.3311,    Adjusted R-squared:  0.318 
F-statistic: 25.24 on 1 and 51 DF,  p-value: 0.000006573</code></pre>
</div>
</div>
<p>The estimated regression equation is</p>
<p><span class="math display">\[
\widehat{\text{Mercury}} = 1.53 - 0.15 \times\text{pH}
\]</span></p>
<p><strong>Estimating</strong> <span class="math inline">\(\sigma\)</span></p>
<p>As we saw in the ice cream example, an estimate for <span class="math inline">\(\sigma\)</span> is given by</p>
<p><span class="math inline">\(s =\sqrt{\frac{\text{SSR}}{n-(p+1)}} = \sqrt{\frac{\displaystyle\sum_{i=1}^n(y_i-\hat{y}_i)^2}{(n-(p+1))}}\)</span>.</p>
<p>We calculate <span class="math inline">\(s\)</span> , using R.</p>
<p>SSR is:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(M_pH<span class="sc">$</span>residuals<span class="sc">^</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4.045513</code></pre>
</div>
</div>
<p>Since pH is our only explanatory variable, <span class="math inline">\(p=1\)</span>, and since we have 53 lakes in the sample, <span class="math inline">\(n=53\)</span>.</p>
<p>Thus,</p>
<p><span class="math inline">\(s =\sqrt{\frac{4.045513}{53-(1+1)}} = 0.2816\)</span>.</p>
<p>The standard deviation in mercury concentrations among lakes with the same pH is estimated to be 0.2816 ppm.</p>
<p>The <strong>residual standard error</strong> in the summary output returns the value of <span class="math inline">\(s\)</span>.</p>
<p><strong>Estimating</strong> <span class="math inline">\(\text{SE}(b_0)\)</span> and <span class="math inline">\(\text{SE}(b_1)\)</span></p>
<p>Now, we’ll use the theory-based formulas to calculate standard error associated with the intercept and slope of the regression line relating mercury level and pH in Florida lakes.</p>
<p>We calculate <span class="math inline">\(\bar{x}\)</span>, the mean pH, and <span class="math inline">\(\sum(x_i-\bar{x})^2\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>xbar <span class="ot">&lt;-</span> <span class="fu">mean</span>(FloridaLakes<span class="sc">$</span>pH)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>xbar</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6.590566</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>Sxx <span class="ot">&lt;-</span> <span class="fu">sum</span>((FloridaLakes<span class="sc">$</span>pH  <span class="sc">-</span> xbar)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>Sxx</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 86.32528</code></pre>
</div>
</div>
<p><span class="math inline">\(SE(b_0)=s\sqrt{\frac{1}{n}+\frac{\bar{x}^2}{\sum(x_i-\bar{x})^2}} = 0.2816\sqrt{\frac{1}{53}+\frac{6.59^2}{86.325}}\approx 0.2034\)</span></p>
<p>The standard error of intercept <span class="math inline">\(b_0\)</span> is 0.2034. This represents the variability in estimated mercury level in lakes with pH of 0, between different samples of size 53. Since none of the lakes have pH levels of 0, this is not a meaningful statistic.</p>
<p><span class="math inline">\(SE(b_1)=\sqrt{\frac{s^2}{\sum(x_i-\bar{x})^2}}=\sqrt{\frac{0.2816^2}{86.325}} \approx 0.0303\)</span></p>
<p>The standard error of slope <span class="math inline">\(b_1\)</span> is 0.0303. This represents the variability in estimated rate of change in mercury level per one unit increase in pH, between different samples of size 53.</p>
<p>These numbers match the values in the <code>Std. Error</code> column of the coefficients table of the <code>lm</code> summary output.</p>
<p>A 95% confidence interval for <span class="math inline">\(\beta_1\)</span> is given by</p>
<p><span class="math display">\[
\begin{aligned}
&amp; b_1 \pm 2\times\text{SE}(b_1) \\
&amp; = -0.15 \pm 2\times{0.0303} \\
&amp; = (-0.09, -0.21)
\end{aligned}
\]</span></p>
<p>We are 95% confident that for each one unit increase in pH, mercury concentration is expected to decrease between 0.09 and 0.21 ppm, on average.</p>
<p>We can also use the <code>confint()</code> command to obtain these intervals.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(M_pH, <span class="at">level=</span><span class="fl">0.95</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                 2.5 %      97.5 %
(Intercept)  1.1223897  1.93944769
pH          -0.2131573 -0.09144445</code></pre>
</div>
</div>
<p><strong>Comparison to Bootstrap</strong></p>
<p>We previously calculated <span class="math inline">\(\text{SE}(b_1)\)</span> and a 95% confidence interval for <span class="math inline">\(\beta_1\)</span>, which are shown below.</p>
<p><strong>Bootstrap Standard Error for</strong> <span class="math inline">\(b_1\)</span>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>Sample_b1 <span class="ot">&lt;-</span> M_pH<span class="sc">$</span>coefficients[<span class="dv">2</span>]</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>SE_b1 <span class="ot">&lt;-</span> <span class="fu">sd</span>(Lakes_Bootstrap_Slope_Results<span class="sc">$</span>Bootstrap_b1)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>SE_b1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.02694529</code></pre>
</div>
</div>
<p><strong>Bootstrap 95% Confidence Interval for</strong> <span class="math inline">\(\beta_1\)</span>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(Sample_b1 <span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span>SE_b1, Sample_b1 <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>SE_b1) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         pH          pH 
-0.20619145 -0.09841028 </code></pre>
</div>
</div>
<p>The formula-based standard error and confidence interval and those produced by bootstrapping are both approximations, so they are not expected to be identical, but should be close.</p>
</section>
<section id="example-single-mean" class="level3" data-number="4.2.4">
<h3 data-number="4.2.4" class="anchored" data-anchor-id="example-single-mean"><span class="header-section-number">4.2.4</span> Example: Single Mean</h3>
<p>Finally, we’ll use a model to estimate the average mercury level among all lakes in Florida. For this, we use an “Intercept-only” model, with no explanatory variables.</p>
<p>The model equation is:</p>
<p>The regression model is:</p>
<p><span class="math display">\[
\text{Mercury} = \beta_0  + \epsilon_i, \text{where } \epsilon_i\sim\mathcal{N}(0, \sigma)
\]</span></p>
<p>This model assumes:</p>
<ol type="1">
<li><p><strong>Linearity</strong> - there is no linearity assumption since there are no explanatory variables.</p></li>
<li><p><strong>Constant Variance</strong> - there is no linearity assumption since there are no explanatory variables.</p></li>
<li><p><strong>Normality</strong> - mercury levels among all lakes in Florida are normally distributed.</p></li>
<li><p><strong>Independence</strong> - mercury levels of individual lakes are not affected by those of other lakes.</p></li>
</ol>
<p>The <code>lm</code> summary command in R returns information pertaining to the model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>Lakes_M0 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>FloridaLakes, Mercury <span class="sc">~</span> <span class="dv">1</span>)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Lakes_M0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Mercury ~ 1, data = FloridaLakes)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.48717 -0.25717 -0.04717  0.24283  0.80283 

Coefficients:
            Estimate Std. Error t value            Pr(&gt;|t|)    
(Intercept)  0.52717    0.04684   11.25 0.00000000000000151 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.341 on 52 degrees of freedom</code></pre>
</div>
</div>
<p>The model estimates that the average mercury level is 0.527, which matches the sample mean, as we know it should.</p>
<p><strong>Estimating</strong> <span class="math inline">\(\sigma\)</span></p>
<p>An estimate for <span class="math inline">\(\sigma\)</span> is given by</p>
<p><span class="math inline">\(s =\sqrt{\frac{\text{SSR}}{n-(p+1)}} = \sqrt{\frac{\displaystyle\sum_{i=1}^n(y_i-\hat{y}_i)^2}{(n-(p+1))}}\)</span>.</p>
<p>We calculate <span class="math inline">\(s\)</span> , using R.</p>
<p>SSR is:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(Lakes_M0<span class="sc">$</span>residuals<span class="sc">^</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6.047875</code></pre>
</div>
</div>
<p>Since there are no explanatory variables, <span class="math inline">\(p=0\)</span>, and since we have 53 lakes in the sample, <span class="math inline">\(n=53\)</span>.</p>
<p>When there are no explanatory variables, <span class="math inline">\(s\)</span> is simply an estimate of the standard deviation of individual observations of the response variable.</p>
<p>Thus,</p>
<p><span class="math inline">\(s =\sqrt{\frac{6.047875}{53-(0+1)}} = 0.341\)</span>.</p>
<p>The standard deviation in mercury concentrations among lakes in Florida is estimated to be 0.341 ppm.</p>
<p>This matches <strong>residual standard error</strong> in the summary output returns the value of <span class="math inline">\(s\)</span>.</p>
<p><strong>Estimating</strong> <span class="math inline">\(\text{SE}(b_0)\)</span></p>
<p>Now, we’ll use the theory-based formulas to calculate standard error associated with <span class="math inline">\(b_0\)</span>, the average mercury level among all lakes in Florida.</p>
<p><span class="math inline">\(SE(b_0)=\frac{s}{\sqrt{n}}=\frac{0.341}{\sqrt{53}}\approx0.04684\)</span></p>
<p>The standard error of mean <span class="math inline">\(b_0\)</span> is 0.0484. This represents the variability in mean mercury level among samples of 53 lakes.</p>
<p>Notice that the standard error of the mean is less than the standard deviation of individual observations, and that the standard error of the mean decreases as sample size increases, as we’ve seen previously.</p>
<p>A 95% confidence interval for <span class="math inline">\(\beta_0\)</span>, is:</p>
<p><span class="math display">\[
\begin{aligned}
&amp; b_0 \pm 2\times\text{SE}(b_0) \\
&amp; = 0.527 \pm 2\times{0.0484} \\
&amp; = (0.43, 0.62)
\end{aligned}
\]</span></p>
<p>We are 95% confident that the average mercury level among all lakes in Florida is between 0.43 and 0.62 ppm.</p>
<p>We can also obtain this interval using the <code>confint()</code> command.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(Lakes_M0, <span class="at">level=</span><span class="fl">0.95</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                2.5 %    97.5 %
(Intercept) 0.4331688 0.6211709</code></pre>
</div>
</div>
<p><strong>Comparison to Bootstrap</strong></p>
<p>Here are the bootstrap standard error and confidence interval we calculated previously.</p>
<p><strong>Bootstrap Standard Error</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>SE_mean <span class="ot">&lt;-</span> <span class="fu">sd</span>(Lakes_Bootstrap_Results_Mean<span class="sc">$</span>Bootstrap_Mean)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>SE_mean</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.04595372</code></pre>
</div>
</div>
<p><strong>Bootstrap 95% Confidence Interval:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(mean <span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span>SE_mean, mean <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>SE_mean) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4352624 0.6190773</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>Lakes_Bootstrap_Mean_Plot <span class="sc">+</span> </span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x=</span>mean <span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span>SE_mean,<span class="at">xend=</span>mean <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>SE_mean, <span class="at">y=</span><span class="dv">50</span>, <span class="at">yend=</span><span class="dv">50</span>), </span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">color=</span><span class="st">"gold"</span>, <span class="at">size=</span><span class="dv">10</span>, <span class="at">alpha=</span><span class="fl">0.01</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch4_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The standard error and interval are very close to those obtained using the approximation formulas.</p>
</section>
<section id="ci-method-comparison" class="level3" data-number="4.2.5">
<h3 data-number="4.2.5" class="anchored" data-anchor-id="ci-method-comparison"><span class="header-section-number">4.2.5</span> CI Method Comparison</h3>
<p>We’ve now seen 3 different ways to obtain confidence intervals based on statistics calculated from data.</p>
<p>The table below tells us what must be true of the sampling distribution for a statistic in order to use each technique.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 37%">
<col style="width: 12%">
<col style="width: 18%">
<col style="width: 31%">
</colgroup>
<thead>
<tr class="header">
<th>Technique</th>
<th>No Gaps</th>
<th>Bell-Shaped</th>
<th>Known Formula for SE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Bootstrap Percentile</td>
<td>x</td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>Bootstrap Standard Error</td>
<td>x</td>
<td>x</td>
<td></td>
</tr>
<tr class="odd">
<td>Theory-Based</td>
<td>x</td>
<td>x</td>
<td>x</td>
</tr>
</tbody>
</table>
<div style="page-break-after: always;"></div>
</section>
</section>
<section id="t-tests" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="t-tests"><span class="header-section-number">4.3</span> t-tests</h2>
<section id="t-distribution" class="level3" data-number="4.3.1">
<h3 data-number="4.3.1" class="anchored" data-anchor-id="t-distribution"><span class="header-section-number">4.3.1</span> t-Distribution</h3>
<p>A t-distribution is a symmetric, bell-shaped curve. The t-distribution depends on a parameter called <strong>degrees of freedom</strong>, which determines the thickness of the distribution’s tails.</p>
<p>When the sampling distribution for a statistic is symmetric and bell-shaped, it can be approximated by a t-distribution. As the sample size increases, so do the degrees of freedom in the t-distribution.</p>
<p>As the degrees of freedom grow large, we see that the t-distributions get closer together, converging to a bell-shaped curve. This distribution is called a <strong>standard normal distribution.</strong></p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch4_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="t-tests-1" class="level3" data-number="4.3.2">
<h3 data-number="4.3.2" class="anchored" data-anchor-id="t-tests-1"><span class="header-section-number">4.3.2</span> t-tests</h3>
<p>When the sampling distribution of a statistic is symmetric and bell-shaped, then the ratio</p>
<p><span class="math display">\[
t= \frac{{\text{Statistic}}}{\text{SE}(\text{Statistic})}  
\]</span></p>
<p>approximately follows a t-distribution.</p>
<p>The statistic <span class="math inline">\(t\)</span> is called a t-statistic.</p>
<p>We’ll use this t-statistic as the test statistic in our hypothesis test.</p>
<p>The degrees of freedom are given by <span class="math inline">\(n-(p+1)\)</span>, where <span class="math inline">\(p\)</span> represents the number of terms in the model, not including the intercept.</p>
<p>To find a p-value, we use a t-distribution to find the probability of obtaining a t-statistic as or more extreme than the one calculated from our data.</p>
<p>A hypothesis test based on the t-statistic and t-distribution is called a <strong>t-test</strong>.</p>
</section>
<section id="t-test-examples" class="level3" data-number="4.3.3">
<h3 data-number="4.3.3" class="anchored" data-anchor-id="t-test-examples"><span class="header-section-number">4.3.3</span> t-test Examples</h3>
<section id="example-1-n-vs-s-lakes" class="level4" data-number="4.3.3.1">
<h4 data-number="4.3.3.1" class="anchored" data-anchor-id="example-1-n-vs-s-lakes"><span class="header-section-number">4.3.3.1</span> Example 1: N vs S Lakes</h4>
<p>The equation of the model is:</p>
<p><span class="math display">\[
\widehat{\text{Mercury}} = b_0+b_1\times\text{South}
\]</span></p>
<p>We fit the model in R and display its summary output below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>Lakes_M <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>FloridaLakes, Mercury<span class="sc">~</span>Location)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Lakes_M)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Mercury ~ Location, data = FloridaLakes)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.65650 -0.23455 -0.08455  0.24350  0.67545 

Coefficients:
            Estimate Std. Error t value       Pr(&gt;|t|)    
(Intercept)  0.42455    0.05519   7.692 0.000000000441 ***
LocationS    0.27195    0.08985   3.027        0.00387 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.3171 on 51 degrees of freedom
Multiple R-squared:  0.1523,    Adjusted R-squared:  0.1357 
F-statistic: 9.162 on 1 and 51 DF,  p-value: 0.003868</code></pre>
</div>
</div>
<p>Looking at the coefficients table, we’ve already seen where the first two columns, <code>Estimate</code> and <code>Std. Error</code> come from. <strong>The last two columns, labeled <code>t value</code> and “Pr(&gt;|t|)” represent the t-statistic and p-value for the t-test associated with the that the regression parameter on that line is zero. (i.e.</strong> <span class="math inline">\(\beta_j=0\)</span>).</p>
<p><strong>t-test for line <code>LocationS</code></strong></p>
<p>To test whether there is evidence of a difference in mercury levels between Northern and Southern Florida, we’ll test the null hypothesis (<span class="math inline">\(\beta_1=0\)</span>). This corresponds to the <code>locationS</code> line of the R output.</p>
<p><strong>Null Hypothesis:</strong> There is no difference in average mercury levels between Northern and Southern Florida (<span class="math inline">\(\beta_1=0\)</span>).</p>
<p><strong>Alternative Hypothesis:</strong> There is a difference in average mercury levels in Northern and Southern Florida (<span class="math inline">\(\beta_1\neq 0\)</span>).</p>
<p>In the previous section, we calculated the standard error for <span class="math inline">\(b_1\)</span> to be 0.0898, respectively.</p>
<p><strong>Test Statistic</strong>: <span class="math inline">\(t=\frac{{b_j}}{\text{SE}(b_j)} = \frac{0.27195}{0.0898} = 3.027\)</span></p>
<p>To calculate the p-value, we plot the t-statistic of 3.027 that we observed in our data and observe where it lies on a t-distribution.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>ts<span class="ot">=</span><span class="fl">3.027</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_dist</span>(<span class="st">"t"</span>, <span class="at">df=</span><span class="dv">51</span>, <span class="at">geom =</span> <span class="st">"area"</span>, <span class="at">fill =</span> <span class="sc">~</span> (<span class="fu">abs</span>(x)<span class="sc">&lt;</span> <span class="fu">abs</span>(ts)), <span class="at">show.legend=</span><span class="cn">FALSE</span>) <span class="sc">+</span> <span class="fu">geom_vline</span>(<span class="at">xintercept=</span><span class="fu">c</span>(ts, <span class="sc">-</span>ts), <span class="at">color=</span><span class="st">"red"</span>)  <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"t"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch4_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>The <code>pt</code> function returns the probability of getting a t-statistic higher than 3.027. We multiply by 2 to also get the area in the left tail.</p>
<p><strong>p-value:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span><span class="sc">*</span><span class="fu">pt</span>(<span class="sc">-</span><span class="fu">abs</span>(ts), <span class="at">df=</span><span class="dv">51</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.003866374</code></pre>
</div>
</div>
<p>The low p-value gives us strong evidence of a difference in average mercury levels between lakes in Northern and Southern Florida.</p>
<p><strong>Comparison to Permutation Test</strong></p>
<p>Recall the permutation test we previously performed.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>NSLakes_SimulationResultsPlot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch4_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>p-value:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> Lakes_M<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="do">## record value of b1 from actual data</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">abs</span>(NSLakes_SimulationResults<span class="sc">$</span>b1Sim) <span class="sc">&gt;</span> <span class="fu">abs</span>(b1))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0039</code></pre>
</div>
</div>
<p>The p-value from the permutation test is similar to the one from the t-test. Both lead us to the same conclusion.</p>
<p><strong>Hypothesis Test for line (intercept)</strong></p>
<p>Notice that there is also a t-statistic and p-value on the line <code>(intercept)</code>. This is tesing the following hypotheses.</p>
<p><strong>Null Hypothesis:</strong> The average mercury level among all lakes in North Florida is 0 (<span class="math inline">\(\beta_0=0\)</span>).</p>
<p><strong>Alternative Hypothesis:</strong> The average mercury level among all lakes in Northern Florida is not 0 (<span class="math inline">\(\beta_0\neq 0\)</span>).</p>
<p>We could carry out this test by dividing the estimate by its standard error and finding the p-value using a t-distribution, just like we did for <span class="math inline">\(\beta_1\)</span>. However, we already know that the average mercury level among all lakes in North Florida is certainly not 0, so this is a silly test, and we shouldn’t conclude much from it.</p>
<p><strong>Not every p-value that R provides is actually meaningful or informative.</strong></p>
</section>
<section id="example-2-regression-slope" class="level4" data-number="4.3.3.2">
<h4 data-number="4.3.3.2" class="anchored" data-anchor-id="example-2-regression-slope"><span class="header-section-number">4.3.3.2</span> Example 2: Regression Slope</h4>
<p>We revisit the model predicting a lake’s mercury level, using pH as the explanatory variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>M_pH <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>FloridaLakes, Mercury<span class="sc">~</span>pH)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(M_pH)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Mercury ~ pH, data = FloridaLakes)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.48895 -0.19188 -0.05774  0.09456  0.71134 

Coefficients:
            Estimate Std. Error t value       Pr(&gt;|t|)    
(Intercept)  1.53092    0.20349   7.523 0.000000000814 ***
pH          -0.15230    0.03031  -5.024 0.000006572811 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.2816 on 51 degrees of freedom
Multiple R-squared:  0.3311,    Adjusted R-squared:  0.318 
F-statistic: 25.24 on 1 and 51 DF,  p-value: 0.000006573</code></pre>
</div>
</div>
<p>The estimated regression equation is</p>
<p><span class="math display">\[
\text{Mercury} = 1.53 - 0.15 \times\text{pH}, \text{where } \epsilon\_i\sim\mathcal{N}(0, \sigma)
\]</span></p>
<p>We can use <span class="math inline">\(b_1\)</span> to test whether there is evidence of a relationship between mercury concentration and pH level.</p>
<p><strong>Null Hypothesis:</strong> There is no relationship between mercury and pH level among all Florida lakes. (<span class="math inline">\(\beta_1=0\)</span>).</p>
<p><strong>Alternative Hypothesis:</strong> There is a relationship between mercury and pH level among all Florida lakes. (<span class="math inline">\(\beta_1 \neq 0\)</span>).</p>
<p>In the last section, we calculated <span class="math inline">\(SE(b_1)\)</span> to be 0.0303.</p>
<p><strong>Test Statistic</strong>: <span class="math inline">\(t=\frac{{b_j}}{\text{SE}(b_j)} = \frac{-0.15230}{0.03031} = -5.024\)</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>ts<span class="ot">=</span><span class="fl">5.024</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_dist</span>(<span class="st">"t"</span>, <span class="at">df=</span><span class="dv">51</span>, <span class="at">geom =</span> <span class="st">"area"</span>, <span class="at">fill =</span> <span class="sc">~</span> (<span class="fu">abs</span>(x)<span class="sc">&lt;</span> <span class="fu">abs</span>(ts)), <span class="at">show.legend=</span><span class="cn">FALSE</span>) <span class="sc">+</span> <span class="fu">geom_vline</span>(<span class="at">xintercept=</span><span class="fu">c</span>(ts, <span class="sc">-</span>ts), <span class="at">color=</span><span class="st">"red"</span>)  <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"t"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch4_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p><strong>p-value:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span><span class="sc">*</span><span class="fu">pt</span>(<span class="sc">-</span><span class="fu">abs</span>(ts), <span class="at">df=</span><span class="dv">51</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.000006578117</code></pre>
</div>
</div>
<p>The p-value is extremely small, providing strong evidence of a relationship between pH level and mercury concentration.</p>
<p><strong>Hypothesis Test for Intercept Line</strong></p>
<p><strong>Null Hypothesis:</strong> The average mercury level among all Florida lakes with pH = 0 is 0. (<span class="math inline">\(\beta_0=0\)</span>).</p>
<p><strong>Alternative Hypothesis:</strong> The average mercury level among all Florida lakes with pH = 0 not 0. (<span class="math inline">\(\beta_0 \neq 0\)</span>).</p>
<p>Since there are no lakes with pH level 0, this is not a meaningful test.</p>
</section>
</section>
<section id="limitations-of-model-based-inference" class="level3" data-number="4.3.4">
<h3 data-number="4.3.4" class="anchored" data-anchor-id="limitations-of-model-based-inference"><span class="header-section-number">4.3.4</span> Limitations of Model-Based Inference</h3>
<p>We’ve seen that in situations where the sampling distribution for a regression coefficient <span class="math inline">\(b_j\)</span> is symmetric and bell-shaped, we can create confidence intervals and perform hypothesis tests using the t-distribution without performing permutation for hypothesis tests, or bootstrapping for confidence intervals.</p>
<p>There are, however, limitations to this approach, which underscore the importance of the simulation-based approaches seen in Chapters 3 and 4.</p>
<p>These include:</p>
<ol type="1">
<li><p>There are lots of statistics, like medians and standard deviations, that do not have known standard error formulas, and do not follow symmetric bell-shaped distributions. In more advanced and complicated models, it is common to encounter statistics of interest with unknown sampling distributions. In these cases, we can estimate p-values and build confidence intervals via simulation, even if we cannot identify the distribution by name.</p></li>
<li><p>Even for statistics with known standard error formulas, the t-test is only appropriate when the sampling distribution for <span class="math inline">\(b_j\)</span> is symmetric and bell-shaped. While there is probability theory that shows this will happen when the sample size is “large enough,” there is no set sample size that guarantees this. Datasets with heavier skewness in the response variable will require larger sample sizes than datasets with less skewness in the response.</p></li>
<li><p>The simulation-based approaches provide valuable insight to the logic behind hypothesis tests. When we permute values of an explanatory variable in a hypothesis test it is clear that we are simulating a situation where the null hypothesis is true. Likewise, when we simulate taking many samples in bootstrapping, it is clear that we are assessing the variability in a statistic across samples. Simply jumping to the t-based approximations of these distributions makes it easy to lose our sense of what they actually represent, and thus increases the likelihood of interpreting them incorrectly.</p></li>
</ol>
<p>In fact prominent statistician R.A. Fisher wrote of simulation-based methods in 1936:</p>
<p><em>“Actually, the statistician does not carry out this very simple and very tedious process, but his conclusions have no justification beyond the fact that they agree with those which could have been arrived at by this elementary method.”</em></p>
<p>Fisher’s comment emphasizes the fact that probability-based tests, like the t-test are simply approximations to what we would obtain via simulation-based approaches, which were not possible in his day, but are now.</p>
<p>Proponents of simulation-based inference include Tim Hesterberg, Senior Statistician at Instacart, and former Senior Statistician at Google, which heavily used simulation-based tests associated with computer experiments associated with their search settings. Hesterberg wrote a <a href="https://browse.arxiv.org/pdf/1411.5279.pdf">2015 paper</a>, arguing for the use and teaching of simulation-based techniques.</p>
<p>We will move forward by using probability-based inference where appropriate, while understanding that we are merely approximating what we would obtain via simulation. Meanwhile, we’ll continue to employ simulation-based approaches where probability-based techniques are inappropriate or unavailable.</p>
<div style="page-break-after: always;"></div>
</section>
</section>
<section id="f-tests" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="f-tests"><span class="header-section-number">4.4</span> F-tests</h2>
<p>Just as we’ve seen that the ratio of a regression statistic to its standard error follows a t-distribution when can be thought of as having come from a process that can be approximated with the normal error regression model, F-statistics also follow a known probability distribution under this assumption.</p>
<section id="f-distribution" class="level3" data-number="4.4.1">
<h3 data-number="4.4.1" class="anchored" data-anchor-id="f-distribution"><span class="header-section-number">4.4.1</span> F-Distribution</h3>
<p>An <strong>F distribution</strong> is a right-skewed distribution. It is defined by two parameters, <span class="math inline">\(\nu_1, \nu_2\)</span>, called numerator and denominator degrees of freedom.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch4_files/figure-html/unnamed-chunk-45-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<p>Under certain conditions (which we’ll examine in the next chapter), the F-statistic</p>
<p><span class="math display">\[
F=\frac{\frac{\text{Unexplained Variability in Reduced Model}-\text{Unexplained Variability in Full Model}}{p-q}}{\frac{\text{Unexplained Variability in Full Model}}{n-(p+1)}}
\]</span></p>
<p>follows an F-distribution.</p>
<p>The numerator and denominator degrees of freedom are given by <span class="math inline">\(p-q\)</span> and <span class="math inline">\(n-(p+1)\)</span>, respectively. These are the same values we divided by when computing the F-statistic.</p>
</section>
<section id="house-condition-example" class="level3" data-number="4.4.2">
<h3 data-number="4.4.2" class="anchored" data-anchor-id="house-condition-example"><span class="header-section-number">4.4.2</span> House Condition Example</h3>
<p>Recall the F-statistic for comparing prices of houses in either very good, good, or average condition, and the p-value associated with the simulation-based F-test we performed previously.</p>
<p><strong>Null Hypothesis:</strong> There is no difference in average prices between houses of the three different conditions, among all houses in King County, WA.</p>
<p><strong>Alternative Hypothesis:</strong> There is a difference in average prices between houses of the three different conditions, among all houses in King County, WA.</p>
<p>Reduced Model: <span class="math inline">\(\text{Price}= \beta_0 + \epsilon_i , \text{ where } \epsilon_i\sim\mathcal{N}(0, \sigma)\)</span></p>
<p>Full Model: <span class="math inline">\(\text{Price}= \beta_0+ \beta_1 \times\text{good condition}+ \beta_2\times\text{very good condition} + \epsilon_i , \text{ where } \epsilon_i\sim\mathcal{N}(0, \sigma)\)</span></p>
<p><span class="math display">\[
\begin{aligned}
F &amp;= \frac{\frac{\text{SSR}_{\text{Reduced}}-\text{SSR}_{\text{Full}}}{p-q}}{\frac{\text{SSR}_{\text{Full}}}{n-(p+1)}} \\
&amp;=\frac{\frac{69,045,634-68,195,387}{2-0}}{\frac{68,195,387}{100-(2+1)}} \\
\end{aligned}
\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>((SST <span class="sc">-</span> SSR_cond)<span class="sc">/</span>(<span class="dv">2-0</span>))<span class="sc">/</span>(SSR_cond<span class="sc">/</span>(<span class="dv">100</span><span class="sc">-</span>(<span class="dv">2</span><span class="sc">+</span><span class="dv">1</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6046888</code></pre>
</div>
</div>
<p>The results of the simulation-based hypothesis test are shown below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>House_Cond_SimulationResults_Plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch4_files/figure-html/unnamed-chunk-47-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p><strong>simulation-based p-value:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(FSim <span class="sc">&gt;</span> Fstat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5548</code></pre>
</div>
</div>
<p>Now, we calculate the p-value using the probability-based F-distribution.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>ts<span class="ot">=</span><span class="fl">0.605</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_dist</span>(<span class="st">"f"</span>, <span class="at">df1=</span><span class="dv">2</span>, <span class="at">df2=</span><span class="dv">97</span>, <span class="at">geom =</span> <span class="st">"area"</span>, <span class="at">fill =</span> <span class="sc">~</span> (<span class="fu">abs</span>(x)<span class="sc">&lt;</span> <span class="fu">abs</span>(ts)), <span class="at">show.legend=</span><span class="cn">FALSE</span>) <span class="sc">+</span> <span class="fu">geom_vline</span>(<span class="at">xintercept=</span><span class="fu">c</span>(ts), <span class="at">color=</span><span class="st">"red"</span>)  <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"F"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch4_files/figure-html/unnamed-chunk-49-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p><strong>p-value:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">-</span><span class="fu">pf</span>(ts, <span class="at">df1=</span><span class="dv">2</span>, <span class="at">df2=</span><span class="dv">97</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5481219</code></pre>
</div>
</div>
<p>The p-value we obtained is very similar to the one we obtained using the simulation-based test.</p>
<p>We can obtain this p-value directly using the <code>anova</code> command.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>M_cond <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>Houses, price <span class="sc">~</span> condition)</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>M0 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>Houses, price <span class="sc">~</span> <span class="dv">1</span>)</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(M0, M_cond)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Model 1: price ~ 1
Model 2: price ~ condition
  Res.Df      RSS Df Sum of Sq      F Pr(&gt;F)
1     99 69045634                           
2     97 68195387  2    850247 0.6047 0.5483</code></pre>
</div>
</div>
<p>Since the p-value is large, we do not have enough evidence to say that average price differs between conditions of the houses.</p>
</section>
<section id="interaction-example" class="level3" data-number="4.4.3">
<h3 data-number="4.4.3" class="anchored" data-anchor-id="interaction-example"><span class="header-section-number">4.4.3</span> Interaction Example</h3>
<p>We can also use an F-test to compare a model predicting house prices with an interaction term to one without one.</p>
<p>Reduced Model: <span class="math inline">\(\text{Price}= \beta_0+ \beta_1 \times\text{sqft\_living} + \beta_2\times\text{Waterfront} + \epsilon_i , \text{ where } \epsilon_i\sim\mathcal{N}(0, \sigma)\)</span></p>
<p>Full Model: <span class="math inline">\(\text{Price}= \beta_0+ \beta_1 \times\text{sqft\_living}+ \beta_2\times\text{Waterfront} + \beta_3\times\text{sqft\_living}\times\text{Waterfront} + \epsilon_i , \text{ where } \epsilon_i\sim\mathcal{N}(0, \sigma)\)</span></p>
<p><span class="math display">\[
\begin{aligned}
F &amp;= \frac{\frac{\text{SSR}_{\text{Reduced}}-\text{SSR}_{\text{Full}}}{p-q}}{\frac{\text{SSR}_{\text{Full}}}{n-(p+1)}} \\
&amp;=\frac{\frac{16,521,296-10,139,974}{3-2}}{\frac{10,139,974}{100-(3+1)}} \\
\end{aligned}
\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>((SSR_wf_sqft<span class="sc">-</span>SSR_int)<span class="sc">/</span>(<span class="dv">3-2</span>))<span class="sc">/</span>((SSR_int)<span class="sc">/</span>(<span class="dv">100</span><span class="sc">-</span>(<span class="dv">3</span><span class="sc">+</span><span class="dv">1</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 60.41505</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>ts<span class="ot">=</span><span class="fl">60.41505</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_dist</span>(<span class="st">"f"</span>, <span class="at">df1=</span><span class="dv">1</span>, <span class="at">df2=</span><span class="dv">96</span>, <span class="at">geom =</span> <span class="st">"area"</span>, <span class="at">fill =</span> <span class="sc">~</span> (<span class="fu">abs</span>(x)<span class="sc">&gt;!</span> <span class="fu">abs</span>(ts)), <span class="at">show.legend=</span><span class="cn">FALSE</span>) <span class="sc">+</span> <span class="fu">geom_vline</span>(<span class="at">xintercept=</span><span class="fu">c</span>(ts), <span class="at">color=</span><span class="st">"red"</span>)  <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"F"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch4_files/figure-html/unnamed-chunk-53-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p><strong>p-value:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">-</span><span class="fu">pf</span>(ts, <span class="at">df1=</span><span class="dv">1</span>, <span class="at">df2=</span><span class="dv">96</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.000000000008572476</code></pre>
</div>
</div>
<p>The probability-based F-test is used in the <code>anova</code> command.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>M_wf_SqFt <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>Houses, price<span class="sc">~</span>sqft_living <span class="sc">+</span> waterfront)</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>M_House_Int <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>Houses, price<span class="sc">~</span>sqft_living <span class="sc">*</span> waterfront)</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(M_wf_SqFt, M_House_Int)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Model 1: price ~ sqft_living + waterfront
Model 2: price ~ sqft_living * waterfront
  Res.Df      RSS Df Sum of Sq      F            Pr(&gt;F)    
1     97 16521296                                          
2     96 10139974  1   6381323 60.415 0.000000000008572 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Since the p-value is small, we have enough evidence to say that there is evidence of an interaction between size and whether or not the house is on the waterfront.</p>
<p>Notice that this p-value is identical to the one we obtained in the previous section, using the t-test for interaction associated with the <code>lm</code> command.</p>
</section>
</section>
<section id="lm-summary-in-r" class="level2" data-number="4.5">
<h2 data-number="4.5" class="anchored" data-anchor-id="lm-summary-in-r"><span class="header-section-number">4.5</span> <code>lm</code> Summary in R</h2>
<p>We’ve now seen how to obtain all of the quantities shown in the <code>lm</code> summary output in R. This section does not provide any new information, but brings together all of the information from the previous sections and chapters to show, in one place, how the <code>lm</code> summary output is obtained.</p>
<section id="lm-summary-output" class="level3" data-number="4.5.1">
<h3 data-number="4.5.1" class="anchored" data-anchor-id="lm-summary-output"><span class="header-section-number">4.5.1</span> <code>lm</code> <code>summary</code> Output</h3>
<p>The <code>summary</code> command for a linear model in R displays a table including 4 columns.</p>
<p><strong>Linear Model <code>summary()</code> Output in R</strong></p>
<ul>
<li><p><strong>Estimate</strong> gives the least-squares estimates <span class="math inline">\(b_0, b_1, \ldots, b_p\)</span></p></li>
<li><p><strong>Standard Error</strong> gives estimates of the standard deviation in the sampling distribution for estimate. It tells us how the estimate is expected to vary between different samples of the given size. These are computed using the formulas in Section 4.2.</p></li>
<li><p><strong>t value</strong> is the estimate divided by its standard error.</p></li>
<li><p><strong>Pr(&gt;|t|)</strong> is a p-value for the hypothesis test associated with the null hypothesis <span class="math inline">\(\beta_j = 0\)</span>, where <span class="math inline">\(\beta_j\)</span> is the regression coefficient pertaining to the given line. Note that <span class="math inline">\(\beta_j\)</span> is the unknown population parameter estimated by <span class="math inline">\(b_j\)</span>.</p></li>
<li><p>The <strong>Residual Standard Error</strong> is <span class="math inline">\(s =\sqrt{\frac{\text{SSR}}{n-(p+1)}} = \sqrt{\frac{\displaystyle\sum_{i=1}^n(y_i-\hat{y}_i)^2}{(n-(p+1))}}\)</span>. This is an estimate of <span class="math inline">\(\sigma\)</span>, which represents the standard deviation in the distribution of the response variable for given value(s) or category(ies) of explanatory variable(s). It tells us how much variability is expected in the response variable between different individuals with the same values/categories of the explanatory variables.</p></li>
<li><p>The <strong>degrees of freedom</strong> are <span class="math inline">\(n-(p+1)\)</span>.</p></li>
<li><p>The <strong>Multiple R-Squared</strong> value is the <span class="math inline">\(R^2\)</span> value seen in Chapter 2. <span class="math inline">\(R^2 = \frac{\text{SST} -\text{SSR}}{\text{SST}} = \frac{\displaystyle\sum_{i=1}^n(y_i-\hat{y}_i)^2}{\displaystyle\sum_{i=1}^n(y_i-\bar{y}_i)^2}\)</span></p></li>
<li><p>We know that <span class="math inline">\(R^2\)</span> can never decrease when additional variables are added to a model. The <strong>Adjusted-R^2</strong> value is an alternate version of <span class="math inline">\(R^2\)</span> that is designed to penalize adding variables that do little to explain variation in the response.</p></li>
<li><p>The F-statistic on the bottom line of the R-output corresponds to an F-test of the given model against a reduced model that include no explanatory variables. The p-value on this line is associated with the test of the null hypothesis that there is no relationship between the response variable and any of the explanatory variables. Since SSR for this reduced model is equal to SST, the F-statistic calculation simplifies to:</p></li>
</ul>
<p><span class="math display">\[ F=\frac{\frac{SST - SSR}{p}}{\frac{SSR}{n-(p+1)}} \]</span></p>
<p>The degrees of freedom associated with the F-statistic are given by <span class="math inline">\(p\)</span> and <span class="math inline">\((n-(p+1))\)</span>.</p>
<p><strong>Example:</strong> Northern vs Southern Florida Lakes</p>
<p>Recall our linear model for mercury levels of lakes in Northern Florida, compared to Southern Florida.</p>
<p>The equation of the model is:</p>
<p><span class="math display">\[\text{Mercury} = \beta\_0+\beta_1\times\text{South} + \epsilon_i, \text{where } \epsilon_i\sim\mathcal{N}(0, \sigma)\]</span></p>
<p>We fit the model in R and display its summary output below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>Lakes_M <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>FloridaLakes, Mercury<span class="sc">~</span>Location)</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Lakes_M)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Mercury ~ Location, data = FloridaLakes)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.65650 -0.23455 -0.08455  0.24350  0.67545 

Coefficients:
            Estimate Std. Error t value       Pr(&gt;|t|)    
(Intercept)  0.42455    0.05519   7.692 0.000000000441 ***
LocationS    0.27195    0.08985   3.027        0.00387 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.3171 on 51 degrees of freedom
Multiple R-squared:  0.1523,    Adjusted R-squared:  0.1357 
F-statistic: 9.162 on 1 and 51 DF,  p-value: 0.003868</code></pre>
</div>
</div>
<p>The estimated regression equation is</p>
<p><span class="math display">\[ \text{Mercury} = 0.42455+0.27195\times\text{South}, \text{where } \epsilon_i\sim\mathcal{N}(0, \sigma) \]</span></p>
<ul>
<li>SSR is:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(Lakes_M<span class="sc">$</span>residuals<span class="sc">^</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5.126873</code></pre>
</div>
</div>
<ul>
<li>SST is:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>((FloridaLakes<span class="sc">$</span>Mercury <span class="sc">-</span> <span class="fu">mean</span>(FloridaLakes<span class="sc">$</span>Mercury))<span class="sc">^</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6.047875</code></pre>
</div>
</div>
<ul>
<li>The residual standard error <span class="math inline">\(s\)</span> is our estimate of the standard deviation among lakes in the same location (either Northern or Southern Florida).</li>
</ul>
<p><span class="math display">\[ s =\sqrt{\frac{\text{SSR}}{n-(p+1)}} = \sqrt{\frac{\text{SSR}}{n-(p+1)}} = \sqrt{\frac{5.126873}{53-(1+1)}}=0.3171 \]</span></p>
<p>The degrees of freedom associated with this estimate is <span class="math inline">\(53-(1+1) = 51\)</span>.</p>
<ul>
<li>The Multiple R-Squared is:</li>
</ul>
<p><span class="math display">\[ R^2 = \frac{6.047875 - 5.126873}{6.047875} = 0.1523 \]</span></p>
<ul>
<li>The F-statistic is</li>
</ul>
<p><span class="math display">\[ F=\frac{\frac{SST - SSR}{p}}{\frac{SSR}{n-(p+1)}} = \frac{\frac{6.047875 - 5.126873}{1}}{\frac{5.126873}{53-(1+1)}} = 9.162 \]</span></p>
<p>This F-statistic is associated with 1 and 51 degrees of freedom.</p>
<p>Using formulas in Section 4.2, we obtain the standard error estimates for <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span>, given in the second column of the table.</p>
<p><span class="math display">\[SE(b_0) = SE(\bar{x}\_N)=s\frac{1}{\sqrt{n_{\text{North}}}} = \frac{0.3171}{\sqrt{33}} =0.0552 \]</span></p>
<p><span class="math inline">\(SE(b_0)\)</span> represents the variability in average mercury levels between different samples of 33 Northern Florida lakes.</p>
<p><span class="math display">\[
SE(b_1) = SE(\bar{x}*{South}-*\bar{x}{North})=s\sqrt{\frac{1}{n_{North}}+\frac{1}{n_{South}}} = 0.3171\sqrt{\frac{1}{20} + \frac{1}{33}} =0.0898
\]</span></p>
<p><span class="math inline">\(SE(b_1)\)</span> represents the variability in average difference in mercury levels between northern and southern lakes between different samples of 33 Northern Florida lakes and 20 Southern Florida lakes.</p>
<p>The last column, labeled “Pr(&gt;|t|)” is, in fact a p-value associated with associated with the null hypothesis that the regression parameter on that line is zero. (i.e.&nbsp;<span class="math inline">\(\beta_j=0\)</span>).</p>
<p><strong>Hypothesis Test for line (intercept)</strong></p>
<p><strong>Null Hypothesis:</strong> The average mercury level among all lakes in North Florida is 0 (<span class="math inline">\(\beta_0=0\)</span>).</p>
<p><strong>Alternative Hypothesis:</strong> The average mercury level among all lakes in Northern Florida is not 0 (<span class="math inline">\(\beta_0\neq 0\)</span>).</p>
<p>We already know the average mercury level among all lakes in North Florida is not 0, so this is a silly test.</p>
<p><strong>Hypothesis Test for line LocationS</strong></p>
<p><strong>Null Hypothesis:</strong> There is no difference in average mercury levels between Northern and Southern Florida (<span class="math inline">\(\beta_1=0\)</span>).</p>
<p><strong>Alternative Hypothesis:</strong> There is a difference in average mercury levels in Northern and Southern Florida (<span class="math inline">\(\beta_1\neq 0\)</span>).</p>
</section>
<section id="difference-in-means-example" class="level3" data-number="4.5.2">
<h3 data-number="4.5.2" class="anchored" data-anchor-id="difference-in-means-example"><span class="header-section-number">4.5.2</span> Difference in Means Example</h3>
<p>Recall the hypothesis test we performed to investigate whether there is a difference in average mercury level between lakes in Northern Florida and Southern Florida.</p>
<p><strong>Null Hypothesis:</strong> There is no difference in average mercury levels between Northern and Southern Florida (<span class="math inline">\(\beta_1=0\)</span>).</p>
<p><strong>Alternative Hypothesis:</strong> There is a difference in average mercury levels in Northern and Southern Florida (<span class="math inline">\(\beta_1\neq 0\)</span>).</p>
<p><strong>Test Statistic</strong>: <span class="math inline">\(t=\frac{{b_j}}{\text{SE}(b_j)} = \frac{0.27195}{0.08985} = 3.027\)</span></p>
<p><strong>Key Question:</strong> What is the probability of getting a t-statistic as extreme as 3.027 if <span class="math inline">\(\beta_1=0\)</span> (i.e.&nbsp;there is no difference in mercury levels between northern and southern lakes).</p>
<p>We plot the t-statistic of 3.027 that we observed in our data and observe where it lies on a t-distribution.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>ts<span class="ot">=</span><span class="fl">3.027</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_dist</span>(<span class="st">"t"</span>, <span class="at">df=</span><span class="dv">51</span>, <span class="at">geom =</span> <span class="st">"area"</span>, <span class="at">fill =</span> <span class="sc">~</span> (<span class="fu">abs</span>(x)<span class="sc">&lt;</span> <span class="fu">abs</span>(ts)), <span class="at">show.legend=</span><span class="cn">FALSE</span>) <span class="sc">+</span> <span class="fu">geom_vline</span>(<span class="at">xintercept=</span><span class="fu">c</span>(ts, <span class="sc">-</span>ts), <span class="at">color=</span><span class="st">"red"</span>)  <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"t"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch4_files/figure-html/unnamed-chunk-59-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span><span class="sc">*</span><span class="fu">pt</span>(<span class="sc">-</span><span class="fu">abs</span>(ts), <span class="at">df=</span><span class="dv">51</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.003866374</code></pre>
</div>
</div>
<p>The low p-value gives us strong evidence of a difference in average mercury levels between lakes in Northern and Southern Florida.</p>
<p>This is the p-value reported in R’s <code>lm</code> <code>summary()</code> output.</p>
<p>A t-statistic more extreme than <span class="math inline">\(\pm 2\)</span> will roughly correspond to a p-value less than 0.05.</p>
<p><strong>Permutation Test</strong></p>
<p>Let’s compare these results to those given by the permutation test.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>NSLakes_SimulationResultsPlot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch4_files/figure-html/unnamed-chunk-61-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>p-value:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> Lakes_M<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="do">## record value of b1 from actual data</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">abs</span>(NSLakes_SimulationResults<span class="sc">$</span>b1Sim) <span class="sc">&gt;</span> <span class="fu">abs</span>(b1))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0039</code></pre>
</div>
</div>
</section>
<section id="simple-linear-regression-example" class="level3" data-number="4.5.3">
<h3 data-number="4.5.3" class="anchored" data-anchor-id="simple-linear-regression-example"><span class="header-section-number">4.5.3</span> Simple Linear Regression Example</h3>
<p>We examine the model summary output for the model predicting a lake’s mercury level, using pH as the explanatory variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>M_pH <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>FloridaLakes, Mercury<span class="sc">~</span>pH)</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(M_pH)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Mercury ~ pH, data = FloridaLakes)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.48895 -0.19188 -0.05774  0.09456  0.71134 

Coefficients:
            Estimate Std. Error t value       Pr(&gt;|t|)    
(Intercept)  1.53092    0.20349   7.523 0.000000000814 ***
pH          -0.15230    0.03031  -5.024 0.000006572811 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.2816 on 51 degrees of freedom
Multiple R-squared:  0.3311,    Adjusted R-squared:  0.318 
F-statistic: 25.24 on 1 and 51 DF,  p-value: 0.000006573</code></pre>
</div>
</div>
<p>The estimated regression equation is</p>
<p><span class="math display">\[ \text{Mercury} = 1.53 - 0.15 \times\text{pH}, \text{where } \epsilon_i\sim\mathcal{N}(0, \sigma) \]</span></p>
<ul>
<li>SSR is:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(M_pH<span class="sc">$</span>residuals<span class="sc">^</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4.045513</code></pre>
</div>
</div>
<ul>
<li>SST is:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>((FloridaLakes<span class="sc">$</span>Mercury <span class="sc">-</span> <span class="fu">mean</span>(FloridaLakes<span class="sc">$</span>Mercury))<span class="sc">^</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6.047875</code></pre>
</div>
</div>
<ul>
<li>The residual standard error <span class="math inline">\(s\)</span> is our estimate of <span class="math inline">\(\sigma\)</span>, the standard deviation among lakes with the same pH.</li>
</ul>
<p><span class="math display">\[ s =\sqrt{\frac{\text{SSR}}{n-(p+1)}} = \sqrt{\frac{\text{SSR}}{n-(p+1)}} = \sqrt{\frac{4.045513}{53-(1+1)}}=0.2816 \]</span></p>
<p>The degrees of freedom associated with this estimate is <span class="math inline">\(53-(1+1) = 51\)</span>.</p>
<ul>
<li>The Multiple R-Squared is:</li>
</ul>
<p><span class="math display">\[ R^2 = \frac{6.047875 - 4.045513}{6.047875} = 0.3311 \]</span></p>
<ul>
<li>The F-statistic is</li>
</ul>
<p><span class="math display">\[ F=\frac{\frac{SST - SSR}{p}}{\frac{SSR}{n-(p+1)}} = \frac{\frac{6.047875 - 4.045513}{1}}{\frac{4.045513}{53-(1+1)}} = 25.24 \]</span></p>
<p>This F-statistic is associated with 1 and 51 degrees of freedom.</p>
<p>Using formulas in Section 4.2, we obtain the standard error estimates for <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span>, given in the second column of the table.</p>
<p>To do this, we need to calculate <span class="math inline">\(\bar{x}\)</span> and <span class="math inline">\(\sum(x_i-\bar{x})^2\)</span>, where <span class="math inline">\(x\)</span> represents the explanatory variable, <span class="math inline">\(pH\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(FloridaLakes<span class="sc">$</span>pH)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6.590566</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>((FloridaLakes<span class="sc">$</span>pH<span class="sc">-</span><span class="fu">mean</span>(FloridaLakes<span class="sc">$</span>pH))<span class="sc">^</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 86.32528</code></pre>
</div>
</div>
<p><span class="math display">\[ SE(b_0)=s\sqrt{\frac{1}{n}+\frac{\bar{x}^2}{\sum(x_i-\bar{x})^2}} = 0.2816\sqrt{\frac{1}{53} + \frac{6.59^2}{86.32528} } = 0.2034 \]</span></p>
<p><span class="math inline">\(SE(b_0)\)</span> represents the variability in mercury levels among lakes with pH of 0 between different samples of size 53. Since we don’t have any lakes with pH of 0, this is not a meaningful calculation.</p>
<p><span class="math display">\[ SE(b_1)=\sqrt{\frac{s^2}{\sum(x_i-\bar{x})^2}}=\sqrt{\frac{0.2816^2}{86.32528}} = 0.0303 \]</span></p>
<p><span class="math inline">\(SE(b_1)\)</span> represents the variability in rate of change in mercury level for each additional one unit increase in pH, between different samples of size 53.</p>
<p><strong>Hypothesis Test for Intercept Line</strong></p>
<p><strong>Null Hypothesis:</strong> The average mercury level among all Florida lakes with pH = 0 is 0. (<span class="math inline">\(\beta_0=0\)</span>).</p>
<p><strong>Alternative Hypothesis:</strong> The average mercury level among all Florida lakes with pH = 0 not 0. (<span class="math inline">\(\beta_0 \neq 0\)</span>).</p>
<p>Since there are no lakes with pH level 0, this is not a meaningful test.</p>
<p><strong>Hypothesis Test for pH Line</strong></p>
<p><strong>Null Hypothesis:</strong> There is no relationship between mercury and pH level among all Florida lakes. (<span class="math inline">\(\beta_1=0\)</span>).</p>
<p><strong>Alternative Hypothesis:</strong> There is a relationship between mercury and pH level among all Florida lakes. (<span class="math inline">\(\beta_1 \neq 0\)</span>).</p>
<p><strong>Test Statistic</strong>: <span class="math inline">\(t=\frac{{b_j}}{\text{SE}(b_j)} = \frac{-0.15230}{0.03031} = -5.024\)</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>ts<span class="ot">=</span><span class="fl">5.024</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_dist</span>(<span class="st">"t"</span>, <span class="at">df=</span><span class="dv">51</span>, <span class="at">geom =</span> <span class="st">"area"</span>, <span class="at">fill =</span> <span class="sc">~</span> (<span class="fu">abs</span>(x)<span class="sc">&lt;</span> <span class="fu">abs</span>(ts)), <span class="at">show.legend=</span><span class="cn">FALSE</span>) <span class="sc">+</span> <span class="fu">geom_vline</span>(<span class="at">xintercept=</span><span class="fu">c</span>(ts, <span class="sc">-</span>ts), <span class="at">color=</span><span class="st">"red"</span>)  <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"t"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch4_files/figure-html/unnamed-chunk-68-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span><span class="sc">*</span><span class="fu">pt</span>(<span class="sc">-</span><span class="fu">abs</span>(ts), <span class="at">df=</span><span class="dv">51</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.000006578117</code></pre>
</div>
</div>
<p>The p-value is extremely small, just as the simulation-based p-value we saw in Chapter 3.</p>
</section>
<section id="multiple-regression-example" class="level3" data-number="4.5.4">
<h3 data-number="4.5.4" class="anchored" data-anchor-id="multiple-regression-example"><span class="header-section-number">4.5.4</span> Multiple Regression Example</h3>
<p>We perform hypothesis tests on a model predicting house price using square feet and waterfront status as explanatory variables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>M_wf_sqft <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>Houses, price<span class="sc">~</span>sqft_living<span class="sc">+</span>waterfront)</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(M_wf_sqft)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = price ~ sqft_living + waterfront, data = Houses)

Residuals:
     Min       1Q   Median       3Q      Max 
-1363.79  -251.55    59.28   177.58  1599.72 

Coefficients:
               Estimate Std. Error t value             Pr(&gt;|t|)    
(Intercept)   -407.6549    86.2868  -4.724        0.00000779668 ***
sqft_living      0.4457     0.0353  12.626 &lt; 0.0000000000000002 ***
waterfrontYes  814.3613   124.8546   6.522        0.00000000313 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 412.7 on 97 degrees of freedom
Multiple R-squared:  0.7607,    Adjusted R-squared:  0.7558 
F-statistic: 154.2 on 2 and 97 DF,  p-value: &lt; 0.00000000000000022</code></pre>
</div>
</div>
<p>We won’t go through the standard error calculations here, though the details are given in the link provided in Section 4.2.</p>
<p><strong>Intercept Line:</strong></p>
<p><strong>Null Hypothesis</strong> The average price among all non-waterfront houses with 0 square feet is 0 dollars. (<span class="math inline">\(\beta_0=0\)</span>)</p>
<p>This is not a sensible hypothesis to test.</p>
<p><strong>sqft_living Line:</strong></p>
<p><strong>Null Hypothesis</strong> There is no relationship between price and square feet in a house, after accounting for waterfront status. (<span class="math inline">\(\beta_1=0\)</span>)</p>
<p>The large t-statistic (12.626) and small p-value provide strong evidence against this null hypothesis.</p>
<p>We know that a small p-value alone does not provide evidence of a relationship that is practically meaningful, but since our model estimates an expected 45 thousand dollar increase for each additional 100 square feet, this seems like a meaningful relationship.</p>
<p><strong>waterfrontYes Line:</strong></p>
<p><strong>Null Hypothesis</strong> On average, there is no difference between average price of waterfront and non-waterfront houses, assuming they are the same size. (<span class="math inline">\(\beta_2=0\)</span>)</p>
<p>The large t-statistic (6.522) and small p-value provide strong evidence against this null hypothesis. Waterfront houses are estimated to cost 814 thousand dollars more, on average, than non-waterfront houses of the same size.</p>
</section>
<section id="mr-with-interaction-example" class="level3" data-number="4.5.5">
<h3 data-number="4.5.5" class="anchored" data-anchor-id="mr-with-interaction-example"><span class="header-section-number">4.5.5</span> MR with Interaction Example</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>M_House_Int <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>Houses, price <span class="sc">~</span> sqft_living <span class="sc">*</span> waterfront)</span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(M_House_Int)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = price ~ sqft_living * waterfront, data = Houses)

Residuals:
     Min       1Q   Median       3Q      Max 
-1559.34  -114.93   -30.24   131.09  1266.58 

Coefficients:
                            Estimate Std. Error t value         Pr(&gt;|t|)    
(Intercept)                 67.39594   91.39267   0.737           0.4627    
sqft_living                  0.21837    0.04035   5.412 0.00000045752269 ***
waterfrontYes             -364.59498  180.75875  -2.017           0.0465 *  
sqft_living:waterfrontYes    0.43267    0.05566   7.773 0.00000000000857 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 325 on 96 degrees of freedom
Multiple R-squared:  0.8531,    Adjusted R-squared:  0.8486 
F-statistic: 185.9 on 3 and 96 DF,  p-value: &lt; 0.00000000000000022</code></pre>
</div>
</div>
<p><strong>Intercept Line:</strong></p>
<p><strong>Null Hypothesis</strong> The average price among all non-waterfront houses with 0 square feet is 0 dollars. (<span class="math inline">\(\beta_0=0\)</span>)</p>
<p>This is not a sensible hypothesis to test.</p>
<p><strong>sqft_living Line:</strong></p>
<p><strong>Null Hypothesis</strong> There is no relationship between price and square feet among non-waterfront houses. (<span class="math inline">\(\beta_1=0\)</span>)</p>
<p>The large t-statistic (5.412) and small p-value provide strong evidence against this null hypothesis.</p>
<p><strong>waterfrontYes Line:</strong></p>
<p><strong>Null Hypothesis</strong> On average, there is no difference between average price of waterfront and non-waterfront houses with 0 square feet. (<span class="math inline">\(\beta_2=0\)</span>)</p>
<p>This is not a sensible hypothesis to test.</p>
<p><strong>sqft_living:waterfrontYes</strong></p>
<p><strong>Null Hypothesis</strong>: There is no interaction between square feet and waterfront. (<span class="math inline">\(\beta_3=0\)</span>) (That is, the effect of size on price is the same for waterfront and non-waterfront houses).</p>
<p>The large t-statistic (7.773) and small p-value provide strong evidence against this null hypothesis. It appears there really is evidence of an interaction between price and waterfront status, as we previously suspected, based on graphical representation and background knowledge.</p>
<p>Note that if the interaction term had yielded a large p-value, indicating a lack of evidence of an interaction, we might have wanted to drop the interaction term from the model, in order to make the interpretations of the other estimates and hypothesis tests simpler.</p>
<div style="page-break-after: always;"></div>
</section>
</section>
<section id="intervals-for-expected-response" class="level2" data-number="4.6">
<h2 data-number="4.6" class="anchored" data-anchor-id="intervals-for-expected-response"><span class="header-section-number">4.6</span> Intervals for Expected Response</h2>
<section id="parameter-values-and-expected-responses" class="level3" data-number="4.6.1">
<h3 data-number="4.6.1" class="anchored" data-anchor-id="parameter-values-and-expected-responses"><span class="header-section-number">4.6.1</span> Parameter Values and Expected Responses</h3>
<p>Recall that in Chapter 4, we saw two different types of confidence intervals. One type was for regression parameters, <span class="math inline">\(\beta_0, \beta_1, \ldots, \beta_p\)</span>, using estimate <span class="math inline">\(b_0, b_1, \ldots, b_p\)</span>. The other type was for expected responses, which involved estimating linear functions of these parameters, for example <span class="math inline">\(\beta_0 + 7\beta_1\)</span>.</p>
<p>Under the assumptions of a normal error regression model, we an approximate 95% confidence interval for regression parameter <span class="math inline">\(\beta_j\)</span> is given by</p>
<p><span class="math display">\[ b_j + \pm t^*\text{SE}(b_j), \]</span></p>
<p>where <span class="math inline">\(t^*\approx 2\)</span>.</p>
<p>We’ve seen that in R, confidence intervals for regression parameters can be obtained through the <code>confint()</code> command.</p>
<p>A 95% confidence interval for an expected response <span class="math inline">\(E(Y_i|X_{i1}=x_{i1}, \ldots X_{ip}=x_{ip}) = \beta_0 + \beta_1x_{i1} + \ldots + \beta_px_{ip}\)</span> is estimated by</p>
<p><span class="math display">\[ b_0 + b_1x_{i1} + \ldots + b_px_{ip} \pm t^*\text{SE}(b_0 + b_1x_{i1} + \ldots + b_px_{ip}), \]</span></p>
<p>In this section, we’ll look more into confidence intervals for expected responses and also another kind of interval involving expected responses, called a prediction interval.</p>
<p>Well sometimes write <span class="math inline">\(E(Y_i|X_{i1}=x_{i1}, \ldots X_{ip}=x_{ip})\)</span> as <span class="math inline">\(E(Y|X)\)</span>.</p>
</section>
<section id="estimation-and-prediction" class="level3" data-number="4.6.2">
<h3 data-number="4.6.2" class="anchored" data-anchor-id="estimation-and-prediction"><span class="header-section-number">4.6.2</span> Estimation and Prediction</h3>
<p>Recall the ice cream dispenser that is known to dispense ice cream at a rate of 2 oz. per second on average, with individual amounts varying according to a normal distribution with mean 0 and standard deviation 0.5</p>
<p>Consider the following two questions:</p>
<ol type="1">
<li><p>On average, how much ice cream will be dispensed for people who press the dispenser for 1.5 seconds?</p></li>
<li><p>If a single person presses the dispenser for 1.5 seconds, how much ice cream will be dispensed?</p></li>
</ol>
<p>The first question is one of estimation. The second pertains to prediction.</p>
<p>When estimating expected responses and making predictions on new observations, there are two sources of variability we must consider.</p>
<ol type="1">
<li>We are using data to estimate <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>, which introduces sampling variability.<br>
</li>
<li>Even if we did know <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>, there is variability in individual observations, which follows a <span class="math inline">\(\mathcal{N}(0, \sigma)\)</span> distribution.</li>
</ol>
<p>In an estimation problem, we only need to think about (1). When predicting the value of a single new observation, we need to think about both (1) and (2).</p>
<p>Thus, intervals for predictions of individual observations carry more uncertainty and are wider than confidence intervals for <span class="math inline">\(E(Y|X)\)</span>.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="SLR_Model_Assumptions.png" class="img-fluid figure-img" style="width:50.0%"></p>
</figure>
</div>
</div>
</div>
<section id="example-ice-cream-machine" class="level4" data-number="4.6.2.1">
<h4 data-number="4.6.2.1" class="anchored" data-anchor-id="example-ice-cream-machine"><span class="header-section-number">4.6.2.1</span> Example: Ice Cream Machine</h4>
<p>In the estimation setting, we are trying to determine the location of the regression line for the entire population. Uncertainty comes from the fact that we only have data from a sample.</p>
<p>In the ice cream example, we can see that the blue line, fit to our data, is a good approximation of the “true” regression line that pertains to the mechanism from which the data were generated. It does, however, vary from the red line slightly due to sampling variability.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>Icecream1, <span class="fu">aes</span>(<span class="at">x=</span>time, <span class="at">y=</span>amount)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"Icecream Dispensed"</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"Time Pressing dispenser"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Amount Dispensed"</span>) <span class="sc">+</span> <span class="fu">geom_abline</span>(<span class="at">slope=</span><span class="dv">2</span>, <span class="at">intercept=</span><span class="dv">0</span>, <span class="at">color=</span><span class="st">"red"</span>) <span class="sc">+</span> <span class="fu">stat_smooth</span>(<span class="at">method=</span><span class="st">"lm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch4_files/figure-html/unnamed-chunk-73-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(IC_Model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = lm(amount ~ time), data = Icecream1)

Residuals:
    Min      1Q  Median      3Q     Max 
-0.8645 -0.3553  0.0685  0.2252  0.6963 

Coefficients:
            Estimate Std. Error t value     Pr(&gt;|t|)    
(Intercept)  -0.1299     0.3968  -0.327        0.749    
time          2.0312     0.1598  12.714 0.0000000104 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.4527 on 13 degrees of freedom
Multiple R-squared:  0.9256,    Adjusted R-squared:  0.9198 
F-statistic: 161.6 on 1 and 13 DF,  p-value: 0.00000001042</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>b0 <span class="ot">&lt;-</span> IC_Model<span class="sc">$</span>coefficients[<span class="dv">1</span>]</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> IC_Model<span class="sc">$</span>coefficients[<span class="dv">2</span>]</span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">sigma</span>(IC_Model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The first question:</p>
<p>“On average, how much ice cream will be dispensed for people who press the dispenser for 1.5 seconds?”</p>
<p>is a question of estimation. It is of the form, for a given <span class="math inline">\(X\)</span>, on average what do we expect to be true of <span class="math inline">\(Y\)</span>.</p>
<p>In the ice cream question, we can answer this exactly, since we know <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>.</p>
<p>In a real situation, we don’t know these and have to estimate them from the data, which introduces uncertainty.</p>
<p>Confidence interval for <span class="math inline">\(E(Y | (X=x))\)</span>:</p>
<p><span class="math display">\[
\begin{aligned}
&amp; b_0+b_1x^* \pm t^*SE(\hat{Y}|X=x^*) \\
&amp; b_0+b_1x^* \pm t^*\sqrt{\widehat{Var}(\hat{Y}|X=x^*)}
\end{aligned}
\]</span></p>
<p>The second question is a question of prediction. Even if we knew the true values of <span class="math inline">\(beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>, we would not be able to given the exact amount dispensed for an individual user, since this varies between users.</p>
<p>Prediction interval for <span class="math inline">\(E(Y | (X=x))\)</span>:</p>
<p><span class="math display">\[
\begin{aligned}
&amp; b_0+b_1x^* \pm t^*\sqrt{\widehat{Var}(\hat{Y}|X=x^*) + s^2}
\end{aligned}
\]</span></p>
<p>The extra <span class="math inline">\(s^2\)</span> in the calculation of prediction variance comes from the uncertainty associated with individual observations.</p>
</section>
</section>
<section id="intervals-in-r" class="level3" data-number="4.6.3">
<h3 data-number="4.6.3" class="anchored" data-anchor-id="intervals-in-r"><span class="header-section-number">4.6.3</span> Intervals in R</h3>
<p>In R, we can obtain confidence intervals for an expected response and prediction intervals for an individual response using the <code>predict</code> command, with either <code>interval="confidence"</code> or <code>interval="prediction"</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(IC_Model, <span class="at">newdata=</span><span class="fu">data.frame</span>(<span class="at">time=</span><span class="fl">1.5</span>), <span class="at">interval =</span> <span class="st">"confidence"</span>, <span class="at">level=</span><span class="fl">0.95</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       fit      lwr      upr
1 2.916965 2.523728 3.310201</code></pre>
</div>
</div>
<p>We are 95% confident that the mean amount of ice cream dispensed when the dispenser is held for 1.5 seconds is between 2.52 and 3.31 oz.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(IC_Model, <span class="at">newdata=</span><span class="fu">data.frame</span>(<span class="at">time=</span><span class="fl">1.5</span>), <span class="at">interval =</span> <span class="st">"prediction"</span>, <span class="at">level=</span><span class="fl">0.95</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       fit      lwr      upr
1 2.916965 1.862832 3.971097</code></pre>
</div>
</div>
<p>We are 95% confident that in individual who holds the dispenser for 1.5 seconds will get between 1.86 and 3.97 oz of ice cream.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch4_files/figure-html/unnamed-chunk-78-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>The prediction interval (in red) is wider than the confidence interval (in blue), since it must account for variability between individuals, in addition to sampling variability.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="C_P_Band.png" class="img-fluid figure-img" style="width:75.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="slr-calculations-optional" class="level3" data-number="4.6.4">
<h3 data-number="4.6.4" class="anchored" data-anchor-id="slr-calculations-optional"><span class="header-section-number">4.6.4</span> SLR Calculations (Optional)</h3>
<p>In simple linear regression,</p>
<p><span class="math display">\[
\begin{aligned}
SE(\hat{Y}|X=x^*) = \sqrt{\frac{1}{n}+ \frac{(x^*-\bar{x})^2}{\displaystyle\sum_{i=1}^n(x_i-\bar{x})^2}}
\end{aligned}
\]</span></p>
<p>Thus a confidence interval for <span class="math inline">\(E(Y | (X=x))\)</span> is:</p>
<p><span class="math display">\[
\begin{aligned}
&amp; b_0+b_1x^* \pm t^*SE(\hat{Y}|X=x^*) \\
&amp; = b_0+b_1x^* \pm t^*s\sqrt{\frac{1}{n}+ \frac{(x^*-\bar{x})^2}{\displaystyle\sum_{i=1}^n(x_i-\bar{x})^2}}  \
\end{aligned}
\]</span></p>
<p>A prediction interval for <span class="math inline">\(E(Y | (X=x))\)</span> is:</p>
<p><span class="math display">\[
\beta_0 + \beta_1x^* \pm t^* s\sqrt{\left(\frac{1}{n}+ \frac{(x^*-\bar{x})^2}{\displaystyle\sum_{i=1}^n(x_i-\bar{x})^2}\right) + 1}
\]</span></p>
<p><strong>Calculations in Ice cream example</strong></p>
<p>For <span class="math inline">\(x=1.5\)</span>, a confidence interval is:</p>
<p><span class="math display">\[
\begin{aligned}
&amp; b_0+b_1x^* \pm t^*SE(\hat{Y}|X=x^*) \\
&amp; = b_0+b_1x^* \pm 2s\sqrt{\frac{1}{n}+ \frac{(x^*-\bar{x})^2}{\displaystyle\sum_{i=1}^n(x_i-\bar{x})^2}}  \\
&amp; = -0.1299087 + 2.0312489 \pm 20.4527185 \sqrt{\frac{1}{15}+ \frac{(1.5-2.3733)^2}{8.02933}}
\end{aligned}
\]</span></p>
<p>A prediction interval is:</p>
<p><span class="math display">\[
\begin{aligned}
&amp; b_0+b_1x^* \pm t^*SE(\hat{Y}|X=x^*) \\
&amp; = b_0+b_1x^* \pm 2s\sqrt{\frac{1}{n}+ \frac{(x^*-\bar{x})^2}{\displaystyle\sum_{i=1}^n(x_i-\bar{x})^2}}  \\
&amp; = -0.1299087 + 2.0312489 \pm 20.4527185 \sqrt{\left(\frac{1}{15}+ \frac{(1.5-2.3733)^2}{8.02933}\right)+1}
\end{aligned}
\]</span></p>
</section>
<section id="car-price-and-acceleration-time" class="level3" data-number="4.6.5">
<h3 data-number="4.6.5" class="anchored" data-anchor-id="car-price-and-acceleration-time"><span class="header-section-number">4.6.5</span> Car Price and Acceleration Time</h3>
<p>We consider data from the Kelly Blue Book, pertaining to new cars, released in 2015. We’ll investigate the relationship between price, length, and time it takes to accelerate from 0 to 60 mph.</p>
<p><code>Price</code> represents the price of a standard (non-luxury) model of a car. <code>Acc060</code> represents time it takes to accelerate from 0 to 60 mph.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>CarsA060 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>Cars2015, <span class="fu">aes</span>(<span class="at">x=</span>Acc060, <span class="at">y=</span>Price)) <span class="sc">+</span> <span class="fu">geom_point</span>() </span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>CarsA060 <span class="sc">+</span> <span class="fu">stat_smooth</span>(<span class="at">method=</span><span class="st">"lm"</span>, <span class="at">se=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch4_files/figure-html/unnamed-chunk-81-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><span class="math inline">\(Price = \beta_0 + \beta_1\times\text{Acc. Time} , \text{where } \epsilon_i\sim\mathcal{N}(0, \sigma)\)</span></p>
<p>The model assumes expected price is a linear function of acceleration time.</p>
<p>Parameter Interpretations:</p>
<p><span class="math inline">\(\beta_0\)</span> represents intercept of regression line, i.e.&nbsp;expected price of a car that can accelerate from 0 to 60 mph in no time. This is not a meaningful interpretation in context.</p>
<p><span class="math inline">\(\beta_1\)</span> represents slope of regression line, i.e.&nbsp;expected change in price for each additional second it takes to accelerate from 0 to 60 mph.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>Cars_M_A060 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>Cars2015, Price<span class="sc">~</span>Acc060)</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Cars_M_A060)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Price ~ Acc060, data = Cars2015)

Residuals:
    Min      1Q  Median      3Q     Max 
-29.512  -6.544  -1.265   4.759  27.195 

Coefficients:
            Estimate Std. Error t value            Pr(&gt;|t|)    
(Intercept)  89.9036     5.0523   17.79 &lt;0.0000000000000002 ***
Acc060       -7.1933     0.6234  -11.54 &lt;0.0000000000000002 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 10.71 on 108 degrees of freedom
Multiple R-squared:  0.5521,    Adjusted R-squared:  0.548 
F-statistic: 133.1 on 1 and 108 DF,  p-value: &lt; 0.00000000000000022</code></pre>
</div>
</div>
<p>** Model Interpretations**</p>
<p><span class="math inline">\(\widehat{Price} = b_0 + b_1\times\text{Acc. Time}\)</span></p>
<p><span class="math inline">\(\widehat{Price} = 89.90 - 7.193\times\text{Acc. Time}\)</span></p>
<ul>
<li><p>Intercept <span class="math inline">\(b_0\)</span> might be interpreted as the price of a car that can accelerate from 0 to 60 in no time, but this is not a meaningful interpretation since there are no such cars.</p></li>
<li><p><span class="math inline">\(b_1=-7.1933\)</span> tells us that on average, the price of a car is expected to decrease by 7.19 thousand dollars for each additional second it takes to accelerate from 0 to 60 mph.</p></li>
<li><p><span class="math inline">\(R^2 = 0.5521\)</span> tells us that 55% of the variation in price is explained by the linear model using acceleration time as the explanatory variable.</p></li>
</ul>
<ol type="1">
<li><p>What is a reasonable range for the average price of all new 2015 cars that can accelerate from 0 to 60 mph in 7 seconds?</p></li>
<li><p>If a car I am looking to buy can accelerate from 0 to 60 mph in 7 seconds, what price range should I expect?</p></li>
</ol>
<p>What is a reasonable range for the average price of all new 2015 cars that can accelerate from 0 to 60 mph in 7 seconds?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(Cars_M_A060, <span class="at">newdata=</span><span class="fu">data.frame</span>(<span class="at">Acc060=</span><span class="dv">7</span>), <span class="at">interval=</span><span class="st">"confidence"</span>, <span class="at">level=</span><span class="fl">0.95</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      fit      lwr      upr
1 39.5502 37.21856 41.88184</code></pre>
</div>
</div>
<p>We are 95% confident that the average price of new 2015 cars that accelerate from 0 to 60 mph in 7 seconds is between 37.2 and 41.9 thousand dollars.</p>
<p>Note: this is a confidence interval for <span class="math inline">\(\beta_0 -7\beta_1\)</span>.</p>
<p>If a car I am looking to buy can accelerate from 0 to 60 mph in 7 seconds, what price range should I expect?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(Cars_M_A060, <span class="at">newdata=</span><span class="fu">data.frame</span>(<span class="at">Acc060=</span><span class="dv">7</span>), <span class="at">interval=</span><span class="st">"prediction"</span>, <span class="at">level=</span><span class="fl">0.95</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      fit      lwr      upr
1 39.5502 18.19826 60.90215</code></pre>
</div>
</div>
<p>We are 95% confident that a single new 2015 car that accelerates from 0 to 60 mph in 7 seconds will cost between 18.2 and 60.9 thousand dollars.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch4_files/figure-html/unnamed-chunk-85-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="florida-lakes-est.-and-pred." class="level3" data-number="4.6.6">
<h3 data-number="4.6.6" class="anchored" data-anchor-id="florida-lakes-est.-and-pred."><span class="header-section-number">4.6.6</span> Florida Lakes Est. and Pred.</h3>
<ol type="1">
<li><p>Calculate an interval that we are 95% confident contains the mean mercury concentration for all lakes in Northern Florida. Do the same for Southern Florida.</p></li>
<li><p>Calculate an interval that we are 95% confident contains the mean mercury concentration for an individual lake in Northern Florida. Do the same for a lake in Southern Florida.</p></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(Lakes_M, <span class="at">newdata=</span><span class="fu">data.frame</span>(<span class="at">Location=</span><span class="fu">c</span>(<span class="st">"N"</span>, <span class="st">"S"</span>)), <span class="at">interval=</span><span class="st">"confidence"</span>, <span class="at">level=</span><span class="fl">0.95</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        fit       lwr       upr
1 0.4245455 0.3137408 0.5353501
2 0.6965000 0.5541689 0.8388311</code></pre>
</div>
</div>
<p>We are 95% confident that the mean mercury level in North Florida is between 0.31 and 0.54 ppm.<br>
We are 95% confident that the mean mercury level in South Florida is between 0.55 and 0.84 ppm.<br>
Note: these are confidence intervals for <span class="math inline">\(\beta_0\)</span>, and <span class="math inline">\(\beta_0 + \beta_1\)</span>, respectively.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(Lakes_M, <span class="at">newdata=</span><span class="fu">data.frame</span>(<span class="at">Location=</span><span class="fu">c</span>(<span class="st">"N"</span>, <span class="st">"S"</span>)), <span class="at">interval=</span><span class="st">"prediction"</span>, <span class="at">level=</span><span class="fl">0.95</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        fit         lwr      upr
1 0.4245455 -0.22155101 1.070642
2 0.6965000  0.04425685 1.348743</code></pre>
</div>
</div>
<p>We are 95% confident that an individual lake in North Florida will have mercury level between 0 and 1.07 ppm.</p>
<p>We are 95% confident that the mean mercury level in South Florida is between 0.04 and 1.35 ppm.</p>
<p>Note that the normality assumption, which allows for negative mercury levels leads to a somewhat nonsensical result.</p>
<div style="page-break-after: always;"></div>
</section>
</section>
<section id="the-regression-effect" class="level2" data-number="4.7">
<h2 data-number="4.7" class="anchored" data-anchor-id="the-regression-effect"><span class="header-section-number">4.7</span> The Regression Effect</h2>
<section id="the-regression-effect-1" class="level3" data-number="4.7.1">
<h3 data-number="4.7.1" class="anchored" data-anchor-id="the-regression-effect-1"><span class="header-section-number">4.7.1</span> The Regression Effect</h3>
<p>You might be wondering how regression gets its name. It comes from a well known phenomenon, known as “regression to the mean”, or the “regression effect”. While the word “regression” is often construed with a negative context (i.e.&nbsp;getting worse), it could also refer to movement in the positive direction.</p>
<p>Exam 1 vs Exam 2 scores for intro stat students at another college</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch4_files/figure-html/unnamed-chunk-88-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>What is the relationship between scores on the two exams?</p>
</section>
<section id="the-regression-effect-2" class="level3" data-number="4.7.2">
<h3 data-number="4.7.2" class="anchored" data-anchor-id="the-regression-effect-2"><span class="header-section-number">4.7.2</span> The Regression Effect</h3>
<p>Exam 1 vs Exam 2 scores for intro stat students at another college</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch4_files/figure-html/unnamed-chunk-89-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>How many of the 6 students who scored below 70 on Exam 1 improved their scores on Exam 2?</p>
<p>How many of the 7 students who scored above 90 improved on Exam 2?</p>
</section>
<section id="the-regression-effect-3" class="level3" data-number="4.7.3">
<h3 data-number="4.7.3" class="anchored" data-anchor-id="the-regression-effect-3"><span class="header-section-number">4.7.3</span> The Regression Effect</h3>
<p>A low score on an exam is often the result of both poor preparation and bad luck.</p>
<p>A high score often results from both good preparation and good luck.</p>
<p>While changes in study habits and preparation likely explain some improvement in low scores, we would also expect the lowest performers to improve simply because of better luck.</p>
<p>Likewise, some of the highest performers may simply not be as lucky on exam 2, so a small dropoff should not be interpreted as weaker understanding of the exam material.</p>
</section>
<section id="simulating-regression-effect" class="level3 smaller" data-number="4.7.4">
<h3 class="smaller anchored" data-number="4.7.4" data-anchor-id="simulating-regression-effect"><span class="header-section-number">4.7.4</span> Simulating Regression Effect</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">110322018</span>)</span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>Understanding <span class="ot">&lt;-</span><span class="fu">rnorm</span>(<span class="dv">25</span>, <span class="dv">80</span>, <span class="dv">10</span>)</span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>Score1 <span class="ot">&lt;-</span> Understanding <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">25</span>, <span class="dv">0</span>, <span class="dv">5</span>)</span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a>Score2 <span class="ot">&lt;-</span> Understanding <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">25</span>, <span class="dv">0</span>, <span class="dv">5</span>)</span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true" tabindex="-1"></a>Understanding <span class="ot">&lt;-</span> <span class="fu">round</span>(Understanding,<span class="dv">0</span>)</span>
<span id="cb122-6"><a href="#cb122-6" aria-hidden="true" tabindex="-1"></a>TestSim <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(Understanding, Score1, Score2)</span>
<span id="cb122-7"><a href="#cb122-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>TestSim, <span class="fu">aes</span>(<span class="at">y=</span>Score2, <span class="at">x=</span>Score1))<span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">stat_smooth</span>(<span class="at">method=</span><span class="st">"lm"</span>) <span class="sc">+</span></span>
<span id="cb122-8"><a href="#cb122-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope=</span><span class="dv">1</span>) <span class="sc">+</span> <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span>Understanding), <span class="at">vjust =</span> <span class="dv">0</span>, <span class="at">nudge_y =</span> <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch4_files/figure-html/unnamed-chunk-90-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>This phenomon is called the <strong>regression effect</strong>.</p>
</section>
<section id="test-scores-simulation---highest-scores" class="level3" data-number="4.7.5">
<h3 data-number="4.7.5" class="anchored" data-anchor-id="test-scores-simulation---highest-scores"><span class="header-section-number">4.7.5</span> Test Scores Simulation - Highest Scores</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(TestSim<span class="sc">%&gt;%</span><span class="fu">arrange</span>(<span class="fu">desc</span>(Score1))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">Understanding</th>
<th style="text-align: right;">Score1</th>
<th style="text-align: right;">Score2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">97</td>
<td style="text-align: right;">98.86412</td>
<td style="text-align: right;">93.60285</td>
</tr>
<tr class="even">
<td style="text-align: right;">89</td>
<td style="text-align: right;">98.57157</td>
<td style="text-align: right;">88.25851</td>
</tr>
<tr class="odd">
<td style="text-align: right;">94</td>
<td style="text-align: right;">97.23330</td>
<td style="text-align: right;">92.65175</td>
</tr>
<tr class="even">
<td style="text-align: right;">91</td>
<td style="text-align: right;">93.92857</td>
<td style="text-align: right;">98.23312</td>
</tr>
<tr class="odd">
<td style="text-align: right;">85</td>
<td style="text-align: right;">93.66503</td>
<td style="text-align: right;">88.70963</td>
</tr>
<tr class="even">
<td style="text-align: right;">93</td>
<td style="text-align: right;">92.06243</td>
<td style="text-align: right;">88.67015</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>These students’ success on test 1 is due to a strong understanding and good luck. We would expect the understanding to carry over to test 2 (provided the student continues to study in a similar way), but not necessarily the luck.</p>
</section>
<section id="test-scores-simulation---lowest-scores" class="level3" data-number="4.7.6">
<h3 data-number="4.7.6" class="anchored" data-anchor-id="test-scores-simulation---lowest-scores"><span class="header-section-number">4.7.6</span> Test Scores Simulation - Lowest Scores</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(TestSim<span class="sc">%&gt;%</span><span class="fu">arrange</span>(Score1)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">Understanding</th>
<th style="text-align: right;">Score1</th>
<th style="text-align: right;">Score2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">58</td>
<td style="text-align: right;">54.44354</td>
<td style="text-align: right;">50.30597</td>
</tr>
<tr class="even">
<td style="text-align: right;">69</td>
<td style="text-align: right;">59.86641</td>
<td style="text-align: right;">77.04696</td>
</tr>
<tr class="odd">
<td style="text-align: right;">61</td>
<td style="text-align: right;">61.35228</td>
<td style="text-align: right;">65.54305</td>
</tr>
<tr class="even">
<td style="text-align: right;">66</td>
<td style="text-align: right;">65.22433</td>
<td style="text-align: right;">73.45304</td>
</tr>
<tr class="odd">
<td style="text-align: right;">75</td>
<td style="text-align: right;">65.87041</td>
<td style="text-align: right;">80.79416</td>
</tr>
<tr class="even">
<td style="text-align: right;">72</td>
<td style="text-align: right;">69.53082</td>
<td style="text-align: right;">74.96092</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>These students’ lack of success on test 1 is due to a low understanding and poor luck. We would expect the understanding to carry over to test 2 (unless the student improves their preparation), but not necessarily the luck.</p>
</section>
<section id="another-example" class="level3" data-number="4.7.7">
<h3 data-number="4.7.7" class="anchored" data-anchor-id="another-example"><span class="header-section-number">4.7.7</span> Another Example</h3>
<p>Wins by NFL teams in 2021 and 2022</p>
<div class="cell" data-each="false">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch4_files/figure-html/unnamed-chunk-93-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="other-examples-of-regression-effect" class="level3 smaller" data-number="4.7.8">
<h3 class="smaller anchored" data-number="4.7.8" data-anchor-id="other-examples-of-regression-effect"><span class="header-section-number">4.7.8</span> Other Examples of Regression Effect</h3>
<p>A 1973 article by Kahneman, D. and Tversky, A., “On the Psychology of Prediction,” Pysch. Rev.&nbsp;80:237-251 describes an instance of the regression effect in the training of air force pilots.</p>
<p>Trainees were praised after performing well and criticized after performing badly. The flight instructors observed that “high praise for good execution of complex maneuvers typically results in a decrement of performance on the next try.”</p>
<p>Kahneman and Tversky write that :</p>
<p><em>“We normally reinforce others when their behavior is good and punish them when their behavior is bad. By regression alone, therefore, they [the trainees] are most likely to improve after being punished and most likely to deteriorate after being rewarded. Consequently, we are exposed to a lifetime schedule in which we are most often rewarded for punishing others, and punished for rewarding.”</em></p>
<div style="page-break-after: always;"></div>
</section>
</section>
<section id="responsible-statistical-inference" class="level2" data-number="4.8">
<h2 data-number="4.8" class="anchored" data-anchor-id="responsible-statistical-inference"><span class="header-section-number">4.8</span> Responsible Statistical Inference</h2>
<p>While statistics offer insight that have lead to great advances in science, medicine, business and economics and many other areas, they have also been misused, (either intentionally or unintentionally) in ways that have resulted in harm. In an effort to better educate the public, the American Statistical Association released a report in 2016, highlighting common misuses of p-values, and the notion of statistical significance. Kenneth Rothman, Professor of Epidemiology at Boston University School of Public Health wrote:</p>
<ul>
<li>“(S)cientists have embraced and even avidly pursued meaningless differences solely because they are statistically significant, and have ignored important effects because they failed to pass the screen of statistical significance…It is a safe bet that people have suffered or died because scientists (and editors, regulators, journalists and others) have used significance tests to interpret results, and have consequently failed to identify the most beneficial courses of action.” -ASA statement on p-values, 2016</li>
</ul>
<p>In this section, we’ll look at some real scenarios where it might be tempting to make an improper conclusion based on data. Think carefully about each scenario and identify possible misinterpretations that might arise. Then think about what conclusions or actions would be appropriate in each scenario.</p>
<p>Keep in mind the following guidelines for responsible statistical inference.</p>
<p><strong>What a p-value tells us</strong></p>
<p>Performing responsible statistical inference requires understanding what p-values do and do not tell us, and how they should and should not be interpreted.</p>
<ul>
<li><p>A low p-value tells us that the data we observed are inconsistent with our null hypothesis or some assumption we make in our model.</p></li>
<li><p>A large p-value tells us that the data we observed could have plausibly been obtained under our supposed model and null hypothesis.</p></li>
<li><p>A p-value never provides evidence supporting the null hypothesis, it only tells us the strength of evidence against it.</p></li>
<li><p>A p-value is impacted by</p>
<ul>
<li>the size of the difference between group, or change per unit increase (effect size)<br>
</li>
<li>the amount of variability in the data<br>
</li>
<li>the sample size</li>
</ul></li>
<li><p>Sometimes, a p-value tells us more about sample size, than relationship we’re actually interested in.</p></li>
<li><p>A p-value does not tell us the “size” of a difference or effect, or whether it is practically meaningful.</p></li>
<li><p>We should only generalize results from a hypothesis test performed on a sample to a larger population or process if the sample is representative of the population or process (such as when the sample is randomly selected).</p></li>
<li><p>A correlation between two variables does not necessarily imply a causal relationship.</p></li>
</ul>
<section id="breakfast-cereals-and-sex-of-babies" class="level3" data-number="4.8.1">
<h3 data-number="4.8.1" class="anchored" data-anchor-id="breakfast-cereals-and-sex-of-babies"><span class="header-section-number">4.8.1</span> Breakfast Cereals and Sex of Babies</h3>
<p>The title of a <a href="https://www.newscientist.com/article/dn13754-breakfast-cereals-boost-chances-of-conceiving-boys/">2008 article by New Scientist</a> makes a surprising claim: “Breakfast cereals boost chances of conceiving boys.” Although the article lacks details on the underlying study, researchers, in fact, tracked the eating habits of women who were attempting to become pregnant. They tracked 133 different food items, and tested whether there was a difference in the proportion of baby boys conceived between women who ate the food, compared to those who didn’t. Of the 133 foods tested, only breakfast cereal showed a significant difference.</p>
<p><strong>Question:</strong> Why is the researcher’s conclusion that eating breakfast cereal increases the chances of conceiving a boy inappropriate? Hint: think about how this situation is similar to the one in the <a href="https://xkcd.com/882/">xkcd comic</a>?</p>
<p>A statistical procedure called the <strong>Bonferroni Correction</strong> suggests that when more than one test is performed simultaneously, we should multiply observed p-values by the number of tests performed. Why might this help prevent errors? Do you see any downsides of doing this?</p>
</section>
<section id="flights-from-new-york-to-chicago" class="level3" data-number="4.8.2">
<h3 data-number="4.8.2" class="anchored" data-anchor-id="flights-from-new-york-to-chicago"><span class="header-section-number">4.8.2</span> Flights from New York to Chicago</h3>
<p>A traveler lives in New York and wants to fly to Chicago. They consider flying out of two New York airports:</p>
<ul>
<li>Newark (EWR)<br>
</li>
<li>LaGuardia (LGA)</li>
</ul>
<p>We have data on the times of flights from both airports to Chicago’s O’Hare airport from 2013 (more than 14,000 flights).</p>
<p>Assuming these flights represent a random sample of all flights from these airports to Chicago, consider how the traveler might use this information to decide which airport to fly out of.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nycflights13)</span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(flights)</span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a>flights<span class="sc">$</span>origin <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(flights<span class="sc">$</span>origin)</span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a>flights<span class="sc">$</span>dest <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(flights<span class="sc">$</span>dest)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We’ll create a dataset containing only flights from Newark and Laguardia to O’Hare, and only the variables we’re interested in.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>Flights_NY_CHI <span class="ot">&lt;-</span> flights <span class="sc">%&gt;%</span> </span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(origin <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"EWR"</span>, <span class="st">"LGA"</span>) <span class="sc">&amp;</span> dest <span class="sc">==</span><span class="st">"ORD"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(origin, dest, air_time)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The plot and table compare the duration of flights from New York to Chicago from each airport.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>Flights_NY_CHI, <span class="fu">aes</span>(<span class="at">x=</span>air_time, <span class="at">fill=</span>origin, <span class="at">color=</span>origin)) <span class="sc">+</span> <span class="fu">geom_density</span>(<span class="at">alpha=</span><span class="fl">0.2</span>) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"Flight Time"</span>)</span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>Flights_NY_CHI, <span class="fu">aes</span>(<span class="at">x=</span>air_time, <span class="at">y=</span>origin)) <span class="sc">+</span> <span class="fu">geom_boxplot</span>() <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"Flight Time"</span>)</span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(p1, p2, <span class="at">ncol=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch4_files/figure-html/unnamed-chunk-96-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a>T <span class="ot">&lt;-</span> Flights_NY_CHI <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(origin) <span class="sc">%&gt;%</span> </span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Mean_Airtime =</span> <span class="fu">mean</span>(air_time, <span class="at">na.rm=</span><span class="cn">TRUE</span>), </span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">SD =</span> <span class="fu">sd</span>(air_time, <span class="at">na.rm=</span><span class="cn">TRUE</span>), <span class="at">n=</span><span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(air_time)))</span>
<span id="cb128-5"><a href="#cb128-5" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">origin</th>
<th style="text-align: right;">Mean_Airtime</th>
<th style="text-align: right;">SD</th>
<th style="text-align: right;">n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">EWR</td>
<td style="text-align: right;">113.2603</td>
<td style="text-align: right;">9.987122</td>
<td style="text-align: right;">5828</td>
</tr>
<tr class="even">
<td style="text-align: left;">LGA</td>
<td style="text-align: right;">115.7998</td>
<td style="text-align: right;">9.865270</td>
<td style="text-align: right;">8507</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>We fit a model to test whether there is evidence of a difference in average flight time.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a>M_Flights <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>Flights_NY_CHI, air_time<span class="sc">~</span>origin)</span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(M_Flights)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = air_time ~ origin, data = Flights_NY_CHI)

Residuals:
   Min     1Q Median     3Q    Max 
-26.26  -7.26  -1.26   5.20  84.74 

Coefficients:
            Estimate Std. Error t value            Pr(&gt;|t|)    
(Intercept) 113.2603     0.1299  872.06 &lt;0.0000000000000002 ***
originLGA     2.5395     0.1686   15.06 &lt;0.0000000000000002 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 9.915 on 14333 degrees of freedom
  (622 observations deleted due to missingness)
Multiple R-squared:  0.01558,   Adjusted R-squared:  0.01551 
F-statistic: 226.9 on 1 and 14333 DF,  p-value: &lt; 0.00000000000000022</code></pre>
</div>
</div>
<p>Confidence Interval for Flights:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(M_Flights)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                2.5 %     97.5 %
(Intercept) 113.00572 113.514871
originLGA     2.20905   2.869984</code></pre>
</div>
</div>
<ul>
<li><p>Flights from LGA are estimated to take 2.5 minutes longer than flights from EWR on average.</p></li>
<li><p>The very low p-value provides strong evidence of a difference in mean flight time.</p></li>
<li><p>We are 95% confident that flights from LGA to ORD take between 2.2 and 2.9 minutes longer, on average, than flights from EWR to ORD.</p></li>
</ul>
<p><strong>Question:</strong> If you were planning a trip from New York to Chicago, how much of a factor would this information play in your decision? Why do you think the p-value is so small in this scenario?</p>
</section>
<section id="smoking-and-birthweight-example" class="level3" data-number="4.8.3">
<h3 data-number="4.8.3" class="anchored" data-anchor-id="smoking-and-birthweight-example"><span class="header-section-number">4.8.3</span> Smoking and Birthweight Example</h3>
<p>We consider data on the relationship between a pregnant mother’s smoking and the birth weight of the baby. Data come from a sample of 80 babies born in North Carolina in 2004. Thirty of the mothers were smokers, and fifty were nonsmokers.</p>
<p>The plot and table show the distribution of birth weights among babies whose mothers smoked, compared to those who didn’t.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>NCBirths, <span class="fu">aes</span>(<span class="at">x=</span>weight, <span class="at">fill=</span>habit, <span class="at">color=</span>habit)) <span class="sc">+</span> <span class="fu">geom_density</span>(<span class="at">alpha=</span><span class="fl">0.2</span>) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"Birthweight and Smoking"</span>)</span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>NCBirths, <span class="fu">aes</span>(<span class="at">x=</span>weight, <span class="at">y=</span>habit)) <span class="sc">+</span> <span class="fu">geom_boxplot</span>() <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"Birthweight and Smoking"</span>)</span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(p1, p2, <span class="at">ncol=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch4_files/figure-html/unnamed-chunk-101-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>T <span class="ot">&lt;-</span> NCBirths <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(habit) <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">Mean_Weight =</span> <span class="fu">mean</span>(weight), <span class="at">SD =</span> <span class="fu">sd</span>(weight), <span class="at">n=</span><span class="fu">n</span>())</span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">habit</th>
<th style="text-align: right;">Mean_Weight</th>
<th style="text-align: right;">SD</th>
<th style="text-align: right;">n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">nonsmoker</td>
<td style="text-align: right;">7.039200</td>
<td style="text-align: right;">1.709388</td>
<td style="text-align: right;">50</td>
</tr>
<tr class="even">
<td style="text-align: left;">smoker</td>
<td style="text-align: right;">6.616333</td>
<td style="text-align: right;">1.106418</td>
<td style="text-align: right;">30</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>We fit a model and test for differences in average birth weight.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a>M_Birthwt <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>NCBirths, weight<span class="sc">~</span>habit)</span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(M_Birthwt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = weight ~ habit, data = NCBirths)

Residuals:
    Min      1Q  Median      3Q     Max 
-6.0392 -0.6763  0.2372  0.8280  2.4437 

Coefficients:
            Estimate Std. Error t value            Pr(&gt;|t|)    
(Intercept)   7.0392     0.2140   32.89 &lt;0.0000000000000002 ***
habitsmoker  -0.4229     0.3495   -1.21                0.23    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.514 on 78 degrees of freedom
Multiple R-squared:  0.01842,   Adjusted R-squared:  0.005834 
F-statistic: 1.464 on 1 and 78 DF,  p-value: 0.23</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(M_Birthwt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                2.5 %    97.5 %
(Intercept)  6.613070 7.4653303
habitsmoker -1.118735 0.2730012</code></pre>
</div>
</div>
<ul>
<li><p>The average birth weight of babies whose mothers are smokers is estimated to be about 0.42 lbs less than the average birthweight for babies whose mothers are nonsmokers.</p></li>
<li><p>The large p-value of 0.23, tells us that there is not enough evidence to say that a mother’s smoking is associated with lower birth weights. It is plausible that this difference could have occurred by chance.</p></li>
<li><p>We are 95% confident that the average birtweight of babies whose mothers are smokers is between 1.12 lbs less and 0.27 lbs more than the average birthweight for babies whose mothers are nonsmokers.</p></li>
</ul>
<p><strong>Question:</strong> Many studies have shown that a mother’s smoking puts a baby at risk of low birthweight. Do our results contradict this research? Should we conclude that smoking has no impact on birthweights?</p>
<section id="larger-study" class="level4" data-number="4.8.3.1">
<h4 data-number="4.8.3.1" class="anchored" data-anchor-id="larger-study"><span class="header-section-number">4.8.3.1</span> Larger Study</h4>
<p>In fact, this sample of 80 babies is part of a larger dataset, consisting of 1,000 babies born in NC in 2004. When we consider the full dataset, notice that the difference between the groups is similar, but the p-value is much smaller, providing stronger evidence of a relationship between a mother’s smoking and lower birthweight.</p>
<p>We’ll now fit a model to the larger dataset.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a>M_Birthwt_Full <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>ncbirths, weight<span class="sc">~</span>habit)</span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(M_Birthwt_Full)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = weight ~ habit, data = ncbirths)

Residuals:
    Min      1Q  Median      3Q     Max 
-6.1443 -0.7043  0.1657  0.9157  4.6057 

Coefficients:
            Estimate Std. Error t value            Pr(&gt;|t|)    
(Intercept)  7.14427    0.05086 140.472 &lt;0.0000000000000002 ***
habitsmoker -0.31554    0.14321  -2.203              0.0278 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.503 on 997 degrees of freedom
  (1 observation deleted due to missingness)
Multiple R-squared:  0.004846,  Adjusted R-squared:  0.003848 
F-statistic: 4.855 on 1 and 997 DF,  p-value: 0.02779</code></pre>
</div>
</div>
<p>Confidence interval based on larger dataset:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(M_Birthwt_Full)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                 2.5 %      97.5 %
(Intercept)  7.0444697  7.24407557
habitsmoker -0.5965648 -0.03452013</code></pre>
</div>
</div>
<p>Notice that the estimated difference in birth weights is actually smaller in the full dataset than in the subset (though 0.3 lbs is still a pretty big difference for babies), and yet now the p-value is much smaller. Why do you think this happened? What should we learn from this?</p>
</section>
</section>
<section id="cautions-and-advice" class="level3" data-number="4.8.4">
<h3 data-number="4.8.4" class="anchored" data-anchor-id="cautions-and-advice"><span class="header-section-number">4.8.4</span> Cautions and Advice</h3>
<p><strong>p-values are only (a small) part of a statistical analysis.</strong></p>
<ul>
<li>For small samples, real differences might not be statistically significant.<br>
-Don’t accept null hypothesis. Gather more information.<br>
</li>
<li>For large, even very small differences will be statistically significant.<br>
-Look at confidence interval. Is difference practically important?<br>
</li>
<li>When many hypotheses are tested at once (such as many food items) some will produce a significant result just by change.<br>
-Use a multiple testing correction, such as Bonferroni<br>
</li>
<li>Interpret p-values on a “sliding scale”
<ul>
<li>0.049 is practically the same as 0.051</li>
</ul></li>
<li>Is sample representative of larger population?<br>
</li>
<li>Were treatments randomly assigned (for experiments)?<br>
</li>
<li>Are there other variables to consider?</li>
</ul>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./Ch3.html" class="pagination-link" aria-label="Simulation-Based Inference">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Simulation-Based Inference</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./Ch5.html" class="pagination-link" aria-label="Building and Assessing Models">
        <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Building and Assessing Models</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>