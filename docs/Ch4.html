<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>4&nbsp; Inference from Models – STAT 255 Notes</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./Ch5.html" rel="next">
<link href="./Ch3.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-626149efe8f5d16e1d391ba177679bf0.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./Ch4.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Inference from Models</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">STAT 255 Notes</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ch1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Visualizing and Summarizing Data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ch2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Introduction to Statistical Models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ch3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Simulation-Based Inference</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ch4.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Inference from Models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ch5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Building and Assessing Models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ch6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Logistic Regression</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#learning-outcomes" id="toc-learning-outcomes" class="nav-link active" data-scroll-target="#learning-outcomes">Learning Outcomes</a></li>
  <li><a href="#ordinary-linear-regression-model" id="toc-ordinary-linear-regression-model" class="nav-link" data-scroll-target="#ordinary-linear-regression-model"><span class="header-section-number">4.1</span> Ordinary Linear Regression Model</a>
  <ul class="collapse">
  <li><a href="#signal-and-noise" id="toc-signal-and-noise" class="nav-link" data-scroll-target="#signal-and-noise"><span class="header-section-number">4.1.1</span> Signal and Noise</a></li>
  <li><a href="#normal-distribution" id="toc-normal-distribution" class="nav-link" data-scroll-target="#normal-distribution"><span class="header-section-number">4.1.2</span> Normal Distribution</a></li>
  <li><a href="#estimating-signal" id="toc-estimating-signal" class="nav-link" data-scroll-target="#estimating-signal"><span class="header-section-number">4.1.3</span> Estimating Signal</a></li>
  <li><a href="#estimating-noise" id="toc-estimating-noise" class="nav-link" data-scroll-target="#estimating-noise"><span class="header-section-number">4.1.4</span> Estimating Noise</a></li>
  <li><a href="#ordinary-linear-regression-model-1" id="toc-ordinary-linear-regression-model-1" class="nav-link" data-scroll-target="#ordinary-linear-regression-model-1"><span class="header-section-number">4.1.5</span> Ordinary Linear Regression Model</a></li>
  <li><a href="#model-assumptions" id="toc-model-assumptions" class="nav-link" data-scroll-target="#model-assumptions"><span class="header-section-number">4.1.6</span> Model Assumptions</a></li>
  <li><a href="#statistical-abstraction" id="toc-statistical-abstraction" class="nav-link" data-scroll-target="#statistical-abstraction"><span class="header-section-number">4.1.7</span> Statistical Abstraction</a></li>
  </ul></li>
  <li><a href="#theory-based-inference" id="toc-theory-based-inference" class="nav-link" data-scroll-target="#theory-based-inference"><span class="header-section-number">4.2</span> Theory-Based Inference</a>
  <ul class="collapse">
  <li><a href="#common-standard-error-formulas" id="toc-common-standard-error-formulas" class="nav-link" data-scroll-target="#common-standard-error-formulas"><span class="header-section-number">4.2.1</span> Common Standard Error Formulas</a></li>
  <li><a href="#confidence-intervals" id="toc-confidence-intervals" class="nav-link" data-scroll-target="#confidence-intervals"><span class="header-section-number">4.2.2</span> Confidence Intervals</a></li>
  <li><a href="#t-tests" id="toc-t-tests" class="nav-link" data-scroll-target="#t-tests"><span class="header-section-number">4.2.3</span> t-tests</a></li>
  <li><a href="#f-tests" id="toc-f-tests" class="nav-link" data-scroll-target="#f-tests"><span class="header-section-number">4.2.4</span> F-tests</a></li>
  <li><a href="#limitations-of-theory-based-inference" id="toc-limitations-of-theory-based-inference" class="nav-link" data-scroll-target="#limitations-of-theory-based-inference"><span class="header-section-number">4.2.5</span> Limitations of Theory-Based Inference</a></li>
  </ul></li>
  <li><a href="#model-based-inference" id="toc-model-based-inference" class="nav-link" data-scroll-target="#model-based-inference"><span class="header-section-number">4.3</span> Model-Based Inference</a>
  <ul class="collapse">
  <li><a href="#difference-in-means" id="toc-difference-in-means" class="nav-link" data-scroll-target="#difference-in-means"><span class="header-section-number">4.3.1</span> Difference in Means</a></li>
  <li><a href="#regression-slope-and-intercept" id="toc-regression-slope-and-intercept" class="nav-link" data-scroll-target="#regression-slope-and-intercept"><span class="header-section-number">4.3.2</span> Regression Slope and Intercept</a></li>
  <li><a href="#single-mean" id="toc-single-mean" class="nav-link" data-scroll-target="#single-mean"><span class="header-section-number">4.3.3</span> Single Mean</a></li>
  <li><a href="#comparing-three-groups" id="toc-comparing-three-groups" class="nav-link" data-scroll-target="#comparing-three-groups"><span class="header-section-number">4.3.4</span> Comparing Three Groups</a></li>
  </ul></li>
  <li><a href="#confidence-and-prediction-intervals" id="toc-confidence-and-prediction-intervals" class="nav-link" data-scroll-target="#confidence-and-prediction-intervals"><span class="header-section-number">4.4</span> Confidence and Prediction Intervals</a>
  <ul class="collapse">
  <li><a href="#intervals-for-expected-response" id="toc-intervals-for-expected-response" class="nav-link" data-scroll-target="#intervals-for-expected-response"><span class="header-section-number">4.4.1</span> Intervals for Expected Response</a></li>
  <li><a href="#estimation-and-prediction" id="toc-estimation-and-prediction" class="nav-link" data-scroll-target="#estimation-and-prediction"><span class="header-section-number">4.4.2</span> Estimation and Prediction</a></li>
  <li><a href="#calculating-confidence-intervals" id="toc-calculating-confidence-intervals" class="nav-link" data-scroll-target="#calculating-confidence-intervals"><span class="header-section-number">4.4.3</span> Calculating Confidence Intervals</a></li>
  <li><a href="#calculating-prediction-interval" id="toc-calculating-prediction-interval" class="nav-link" data-scroll-target="#calculating-prediction-interval"><span class="header-section-number">4.4.4</span> Calculating Prediction Interval</a></li>
  <li><a href="#mercury-and-ph-in-florida-lakes" id="toc-mercury-and-ph-in-florida-lakes" class="nav-link" data-scroll-target="#mercury-and-ph-in-florida-lakes"><span class="header-section-number">4.4.5</span> Mercury and pH in Florida Lakes</a></li>
  <li><a href="#mercury-in-northern-and-southern-lakes" id="toc-mercury-in-northern-and-southern-lakes" class="nav-link" data-scroll-target="#mercury-in-northern-and-southern-lakes"><span class="header-section-number">4.4.6</span> Mercury in Northern and Southern Lakes</a></li>
  </ul></li>
  <li><a href="#the-regression-effect" id="toc-the-regression-effect" class="nav-link" data-scroll-target="#the-regression-effect"><span class="header-section-number">4.5</span> The Regression Effect</a>
  <ul class="collapse">
  <li><a href="#the-regression-effect-1" id="toc-the-regression-effect-1" class="nav-link" data-scroll-target="#the-regression-effect-1"><span class="header-section-number">4.5.1</span> The Regression Effect</a></li>
  <li><a href="#simulating-test-scores" id="toc-simulating-test-scores" class="nav-link" data-scroll-target="#simulating-test-scores"><span class="header-section-number">4.5.2</span> Simulating Test Scores</a></li>
  <li><a href="#nfl-wins" id="toc-nfl-wins" class="nav-link" data-scroll-target="#nfl-wins"><span class="header-section-number">4.5.3</span> NFL Wins</a></li>
  <li><a href="#pilot-training" id="toc-pilot-training" class="nav-link" data-scroll-target="#pilot-training"><span class="header-section-number">4.5.4</span> Pilot Training</a></li>
  </ul></li>
  <li><a href="#responsible-statistical-inference" id="toc-responsible-statistical-inference" class="nav-link" data-scroll-target="#responsible-statistical-inference"><span class="header-section-number">4.6</span> Responsible Statistical Inference</a>
  <ul class="collapse">
  <li><a href="#multiple-testing-error-1" id="toc-multiple-testing-error-1" class="nav-link" data-scroll-target="#multiple-testing-error-1"><span class="header-section-number">4.6.1</span> Multiple Testing Error</a></li>
  <li><a href="#flights-from-new-york-to-chicago" id="toc-flights-from-new-york-to-chicago" class="nav-link" data-scroll-target="#flights-from-new-york-to-chicago"><span class="header-section-number">4.6.2</span> Flights from New York to Chicago</a></li>
  <li><a href="#smoking-and-birthweight-example" id="toc-smoking-and-birthweight-example" class="nav-link" data-scroll-target="#smoking-and-birthweight-example"><span class="header-section-number">4.6.3</span> Smoking and Birthweight Example</a></li>
  <li><a href="#cautions-and-advice" id="toc-cautions-and-advice" class="nav-link" data-scroll-target="#cautions-and-advice"><span class="header-section-number">4.6.4</span> Cautions and Advice</a></li>
  </ul></li>
  <li><a href="#practice-questions" id="toc-practice-questions" class="nav-link" data-scroll-target="#practice-questions"><span class="header-section-number">4.7</span> Practice Questions</a>
  <ul class="collapse">
  <li><a href="#section" id="toc-section" class="nav-link" data-scroll-target="#section">1)</a></li>
  <li><a href="#section-1" id="toc-section-1" class="nav-link" data-scroll-target="#section-1">2)</a></li>
  <li><a href="#section-2" id="toc-section-2" class="nav-link" data-scroll-target="#section-2">3)</a></li>
  <li><a href="#section-3" id="toc-section-3" class="nav-link" data-scroll-target="#section-3">4)</a></li>
  <li><a href="#section-4" id="toc-section-4" class="nav-link" data-scroll-target="#section-4">5)</a></li>
  <li><a href="#section-5" id="toc-section-5" class="nav-link" data-scroll-target="#section-5">6)</a></li>
  <li><a href="#section-6" id="toc-section-6" class="nav-link" data-scroll-target="#section-6">7)</a></li>
  <li><a href="#section-7" id="toc-section-7" class="nav-link" data-scroll-target="#section-7">8)</a></li>
  <li><a href="#section-8" id="toc-section-8" class="nav-link" data-scroll-target="#section-8">9)</a></li>
  <li><a href="#section-9" id="toc-section-9" class="nav-link" data-scroll-target="#section-9">10)</a></li>
  <li><a href="#section-10" id="toc-section-10" class="nav-link" data-scroll-target="#section-10">11)</a></li>
  <li><a href="#section-11" id="toc-section-11" class="nav-link" data-scroll-target="#section-11">12)</a></li>
  <li><a href="#section-12" id="toc-section-12" class="nav-link" data-scroll-target="#section-12">13)</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Inference from Models</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="learning-outcomes" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="learning-outcomes">Learning Outcomes</h3>
<p><strong>Conceptual Learning Outcomes</strong><br>
16. State the assumptions of the ordinary regression model in context.&nbsp;<br>
17. State the hypotheses associated with each p-value in the <code>lm</code> summary table and explain what we should conclude from each test.&nbsp;<br>
18. Interpret quantities in the R <code>lm summary output</code> including standard errors, residual standard error, <span class="math inline">\(R^2\)</span>, and the F-statistic.<br>
19. Use standard error formulas to calculate quantities in R model summary output (including estimates, standard errors, t-statistics, <span class="math inline">\(R^2\)</span>, and F-statistics), as well as output for associated tests and confidence intervals.<br>
20. Distinguish between confidence intervals for model parameters, confidence for expected response, and prediction intervals, and identify the sources of variability contributing to each.<br>
21. Explain the regression effect in context.&nbsp;<br>
22. Identify situations where multiple testing error is a concern and explain how to correct for such errors.<br>
23. Identify situations where a statistically discernible result might not be practically important, or when a large p-value might still be meaningful.</p>
<p><strong>Computational Learning Outcomes</strong><br>
H. Perform hypothesis tests and calculate confidence and prediction intervals based on models using R.</p>
</section>
<section id="ordinary-linear-regression-model" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="ordinary-linear-regression-model"><span class="header-section-number">4.1</span> Ordinary Linear Regression Model</h2>
<p>You’ve probably noticed that most of the sampling distributions for statistics we’ve seen were symmetric and bell-shaped in nature. When working with statistics that have symmetric and bell-shaped distributions it is often possible to use well-known probability facts to obtain confidence intervals and perform hypothesis tests without actually performing simulation.</p>
<p>In this chapter, we’ll examine a set of assumptions that, if true, would ensure that statistics like means and differences in means, and regression coefficients follow symmetric and bell-shaped distributions. We’ll learn how to use facts from probability to calculate confidence intervals and p-values without actually performing simulation in these instances.</p>
<section id="signal-and-noise" class="level3" data-number="4.1.1">
<h3 data-number="4.1.1" class="anchored" data-anchor-id="signal-and-noise"><span class="header-section-number">4.1.1</span> Signal and Noise</h3>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ice_Cream.png" class="img-fluid figure-img" style="width:50.0%"></p>
</figure>
</div>
</div>
</div>
<p>Suppose an ice cream machine is manufactured to dispense 2 oz. of ice cream per second, on average. If 15 people used the ice cream machine, holding the dispenser for different amounts of time, and each person got exactly 2 oz. per second, the relationship between time holding the dispenser and amount dispensed would look like this:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch4_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>In reality, however, the actual amount dispensed each time it is used will vary due to unknown factors like:</p>
<ul>
<li>force applied to dispenser<br>
</li>
<li>temperature<br>
</li>
<li>build-up of ice cream<br>
</li>
<li>other unknown factors</li>
</ul>
<p>Thus, if 15 real people held the dispenser and recorded the amount of ice cream they got, the scatter plot we would see would look something like this:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch4_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>We can think of the amount of ice cream a person receives as being a result of two separate components, often referred to as <strong>signal</strong> and <strong>noise</strong>. In the graphic the red line represents the signal, and the amount by which each point deviates from the line is the noise.</p>
<p>Signal represents the average amount of ice cream a person is expected to receive based on the amount of time holding the dispenser. In this case, signal is given by the function <span class="math inline">\(\text{Expected Amount} = 2\times\text{Time}\)</span>. Everyone who holds the dispenser for <span class="math inline">\(t\)</span> seconds is expected to receive <span class="math inline">\(2t\)</span> ounces of ice cream.</p>
<p>Noise represents how much each person’s actual amount of ice cream deviates from their expected amount. For example, a person who holds the dispenser for 1.5 seconds and receives 3.58 oz. of ice cream will have received 0.58 ounces more than expected due to noise (i.e.&nbsp;factors other than the amount of time holding the dispenser).</p>
<p>In a statistical model, we assume that in the data we observe, the value of the response variable is the sum of the signal and noise. The signal is a function of the explanatory variables in the model and noise is a deviation from the signal due to factors beyond those accounted for in the model.</p>
</section>
<section id="normal-distribution" class="level3" data-number="4.1.2">
<h3 data-number="4.1.2" class="anchored" data-anchor-id="normal-distribution"><span class="header-section-number">4.1.2</span> Normal Distribution</h3>
<p>In the ice cream example it might be reasonable to expect that most people will get close to the amount of ice cream they should expect to get, based on the amount of time they hold down the dispenser, while a few people might get a lot more or less. When modeling noise, it is common to model noise using a symmetric, bell-shaped distribution, known as a <strong>normal distribution</strong>.</p>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Ch4_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="768"></p>
<figcaption>Distribution of noise in ice cream dispenser</figcaption>
</figure>
</div>
</div>
</div>
<p>We can think of the noise associated with each person’s amount of ice cream as if it came from randomly picking a point somewhere under the bell curve. Since most of the area under the curve is close to the middle, most people’s deviation or noise, will be small, so they expect to get approximately the amount of ice cream they would expect, based on the amount of time they held down the dispenser. There is, however, some area in the tails of the bell curve, indicating that occasionally, a person will get much more or much less ice cream than expected.</p>
<p><strong>Spread in a Normal Distribution</strong></p>
<p>A normal distribution is denoted <span class="math inline">\(\mathcal{N}(\mu, \sigma)\)</span>.</p>
<ul>
<li><span class="math inline">\(\mu\)</span> represents the mean, or center, of the distribution. When modeling noise, we typically assume <span class="math inline">\(\mu=0\)</span>.<br>
</li>
<li><span class="math inline">\(\sigma\)</span> represents the standard deviation in the normal distribution. More noise corresponds to higher values of <span class="math inline">\(\sigma\)</span>.</li>
</ul>
<p>In the ice cream example, <span class="math inline">\(\sigma\)</span> can be thought of as the standard deviation in amount of ice cream dispensed among people who hold the dispenser for the same amount of time.</p>
<p>The normal distribution seen previously is shown again below (Dist. A), along with two others. The graph shows how the amount of noise can vary between normal distributions. If our ice cream was very consistent and had little noise, it would behave more like Distribution B, with noise most often being close to 0. If there is a lot of variability between ice cream dispensed, even for people holding the dispenser for the same amount of time, it would behave more like Distribution C with more area in the tails resulting in a higher probability of unusually high or low ice cream amounts.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch4_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>Here, we’ll assume that the noise associated with our ice cream machine can be characterized by a normal distribution with mean <span class="math inline">\(\mu=0\)</span> and standard deviation <span class="math inline">\(\sigma=1\)</span>.</p>
<p>Note that the square of the standard deviation <span class="math inline">\(\sigma^2\)</span> is called the variance. Some books denote the normal distribution as <span class="math inline">\(\mathcal{N}(\mu, \sigma^2)\)</span>, instead of <span class="math inline">\(\mathcal{N}(\mu,\sigma)\)</span>. We will use the <span class="math inline">\(\mathcal{N}(\mu,\sigma)\)</span> here, which is consistent with R.</p>
<p><strong>Simulating the Ice Cream Dispenser</strong></p>
<p>The amount of ice cream a person gets is thus determined by both the amount of time they hold the dispenser and by noise, representing factors other than time. The illustration below shows the amount of ice cream people might get as a function of time holding the dispenser. The grey dots represent ice cream amounts for individual people. Notice that people who hold the dispenser for 2 seconds get 4 oz. of ice cream, on average, but some come out higher or lower due to noise.</p>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="SLR_Model_Assumptions.png" class="img-fluid figure-img" style="width:75.0%"></p>
<figcaption>The amount dispensed follows a normal distribution with mean equal to twice the time holding the dispenser and standard deviation 1</figcaption>
</figure>
</div>
</div>
</div>
<p>We’ll simulate the amount of ice cream dispensed for 15 people. We’ll assume the noise associated with each person’s ice cream amount is normally distributed, as in the above illustration. So, we’ll simulate the amount of ice cream they get by adding a random number from the normal distribution shown to each person’s expected amount.</p>
<p>The <code>rnorm</code> command below generates random numbers from a normal distribution. Here we tell it to generate 15 numbers from a normal distribution with with mean of 0, and standard deviation of 1, which is consistent with the illustrations we’ve seen.</p>
<p>The table shows the time each person pressed the dispenser, the signal (the amount they would be expected to receive based on time holding the dispenser), the noise, and the amount they actually receive.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">10082020</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"># set times </span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>time <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="fl">2.2</span>, <span class="fl">2.5</span>, <span class="fl">2.8</span>, <span class="fl">3.1</span>, <span class="fl">3.1</span>, <span class="fl">3.3</span>, <span class="fl">3.5</span>, <span class="fl">3.6</span>, <span class="fl">3.8</span>, <span class="fl">3.9</span>, <span class="fl">3.9</span>, <span class="fl">4.1</span>, <span class="fl">4.2</span>, <span class="fl">4.6</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>expected <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span>time  <span class="co"># expected amount</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>noise <span class="ot">&lt;-</span><span class="fu">rnorm</span>(<span class="dv">15</span>, <span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">round</span>(<span class="dv">2</span>)  <span class="co">#generate noise from normal distribution</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>amount <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span>time <span class="sc">+</span> noise  <span class="co"># calculate observed amounts</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>Icecream <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(time, signal, noise, amount) <span class="co"># set up data table</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>((Icecream)) <span class="co">#display table</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">time</th>
<th style="text-align: right;">signal</th>
<th style="text-align: right;">noise</th>
<th style="text-align: right;">amount</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2.0</td>
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">0.46</td>
<td style="text-align: right;">4.46</td>
</tr>
<tr class="even">
<td style="text-align: right;">2.2</td>
<td style="text-align: right;">4.4</td>
<td style="text-align: right;">-0.98</td>
<td style="text-align: right;">3.42</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2.5</td>
<td style="text-align: right;">5.0</td>
<td style="text-align: right;">1.16</td>
<td style="text-align: right;">6.16</td>
</tr>
<tr class="even">
<td style="text-align: right;">2.8</td>
<td style="text-align: right;">5.6</td>
<td style="text-align: right;">-0.06</td>
<td style="text-align: right;">5.54</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3.1</td>
<td style="text-align: right;">6.2</td>
<td style="text-align: right;">0.34</td>
<td style="text-align: right;">6.54</td>
</tr>
<tr class="even">
<td style="text-align: right;">3.1</td>
<td style="text-align: right;">6.2</td>
<td style="text-align: right;">-1.86</td>
<td style="text-align: right;">4.34</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3.3</td>
<td style="text-align: right;">6.6</td>
<td style="text-align: right;">0.10</td>
<td style="text-align: right;">6.70</td>
</tr>
<tr class="even">
<td style="text-align: right;">3.5</td>
<td style="text-align: right;">7.0</td>
<td style="text-align: right;">-0.73</td>
<td style="text-align: right;">6.27</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3.6</td>
<td style="text-align: right;">7.2</td>
<td style="text-align: right;">-0.93</td>
<td style="text-align: right;">6.27</td>
</tr>
<tr class="even">
<td style="text-align: right;">3.8</td>
<td style="text-align: right;">7.6</td>
<td style="text-align: right;">0.34</td>
<td style="text-align: right;">7.94</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3.9</td>
<td style="text-align: right;">7.8</td>
<td style="text-align: right;">-1.19</td>
<td style="text-align: right;">6.61</td>
</tr>
<tr class="even">
<td style="text-align: right;">3.9</td>
<td style="text-align: right;">7.8</td>
<td style="text-align: right;">0.23</td>
<td style="text-align: right;">8.03</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4.1</td>
<td style="text-align: right;">8.2</td>
<td style="text-align: right;">-0.01</td>
<td style="text-align: right;">8.19</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.2</td>
<td style="text-align: right;">8.4</td>
<td style="text-align: right;">1.33</td>
<td style="text-align: right;">9.73</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4.6</td>
<td style="text-align: right;">9.2</td>
<td style="text-align: right;">0.10</td>
<td style="text-align: right;">9.30</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The scatterplot displays the amount dispensed compared to the time pressing the dispenser. The red line indicates the line <span class="math inline">\(y=2x\)</span>. If there was no random noise, then each person’s amount dispensed would lie exactly on this line.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>Icecream1, <span class="fu">aes</span>(<span class="at">x=</span>time, <span class="at">y=</span>amount)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"Icecream Dispensed"</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"Time Pressing dispenser"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Amount Dispensed"</span>) <span class="sc">+</span> <span class="fu">geom_abline</span>(<span class="at">slope=</span><span class="dv">2</span>, <span class="at">intercept=</span><span class="dv">0</span>, <span class="at">color=</span><span class="st">"red"</span>) <span class="sc">+</span> <span class="fu">xlim</span>(<span class="fu">c</span>(<span class="fl">1.5</span>,<span class="dv">5</span>)) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="fl">2.5</span>,<span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">label=</span><span class="st">"y=2x"</span>, <span class="at">x=</span> <span class="fl">3.5</span>, <span class="at">y=</span><span class="fl">6.5</span>, <span class="at">size=</span><span class="dv">10</span>, <span class="at">color=</span><span class="st">"red"</span>)  <span class="sc">+</span> <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch4_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>Mathematically, we write the amount of ice cream the <span class="math inline">\(i-\)</span>th person gets as the sum of a linear function of time holding the dispenser (the signal), and a normal random variable <span class="math inline">\(\epsilon_i\)</span> (the noise).</p>
<p><span class="math display">\[
\text{Amount}_i = \beta_0 + \beta_1\times\text{Time}_i+\epsilon_i, \text{ where } \epsilon_i\sim\mathcal{N}(0, \sigma)
\]</span></p>
<p>In this instance, we know that a person who does not press the dispenser at all will, of course, get no ice cream, and a person who holds the dispenser for two seconds is supposed to get 2 ounces of ice cream for each second they hold the dispenser. Thus, we know so <span class="math inline">\(\beta_0=0\)</span> and <span class="math inline">\(\beta_1=2\)</span>. We also know that <span class="math inline">\(\sigma\)</span>, the standard deviation in amounts between people holding the dispenser for the same amount of time, is <span class="math inline">\(\sigma=1\)</span>. Thus, the true equation of the regression line is:</p>
<p><span class="math display">\[
\text{Amount}_i = 0 + 2\times\text{Time}_i+\epsilon_i, \text{ where } \epsilon_i\sim\mathcal{N}(0, 1)
\]</span></p>
</section>
<section id="estimating-signal" class="level3" data-number="4.1.3">
<h3 data-number="4.1.3" class="anchored" data-anchor-id="estimating-signal"><span class="header-section-number">4.1.3</span> Estimating Signal</h3>
<p>In a real situation, we would not see the signal and noise columns in the table or the red line on the graph. We would only know the time and amount, and points on the scatter plot. From these, we would need to estimate the location of the red line by fitting a least squares regression line to the data, as we’ve done before.</p>
<p>We can estimate the slope and intercept of the red line, <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> by fitting a regression line to the observed data. The blue line represents the regression line fit to the data from the 15 people in our simulation. Notice that it is close, but not identical to the red line.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>Icecream1, <span class="fu">aes</span>(<span class="at">x=</span>time, <span class="at">y=</span>amount)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"Icecream Dispensed"</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"Time Pressing dispenser"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Amount Dispensed"</span>) <span class="sc">+</span> <span class="fu">stat_smooth</span>(<span class="at">method=</span><span class="st">"lm"</span>, <span class="at">se=</span><span class="cn">FALSE</span>) <span class="sc">+</span> <span class="fu">geom_abline</span>(<span class="at">slope=</span><span class="dv">2</span>, <span class="at">intercept=</span><span class="dv">0</span>, <span class="at">color=</span><span class="st">"red"</span>)  <span class="sc">+</span> <span class="fu">xlim</span>(<span class="fu">c</span>(<span class="fl">1.5</span>,<span class="dv">5</span>)) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="fl">2.5</span>,<span class="dv">10</span>)) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch4_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>We fit the model to the simulated data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>IC_Model <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>Icecream1, <span class="fu">lm</span>(amount<span class="sc">~</span>time))</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>IC_Model</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = lm(amount ~ time), data = Icecream1)

Coefficients:
(Intercept)         time  
    -0.3223       2.0625  </code></pre>
</div>
</div>
<p>The intercept and slope are <span class="math inline">\(b_0=\)</span> -0.32 and 2.06.</p>
<p>The estimated regression equation is</p>
<p><span class="math display">\[
\begin{aligned}
\text{Amount}_i &amp; = b_0 + b_1\text{Time}_i + \epsilon_i \\
&amp; = -0.32 + 2.06\text{Time}_i + \epsilon_i
\end{aligned}
\]</span></p>
<p>The estimates <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span> are close, but not identical to the the true values of <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>, which in this case, we know are <span class="math inline">\(\beta_0=0\)</span> and <span class="math inline">\(\beta_1=2\)</span>. Typically, the values of <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span> calculated from a sample will deviate from the true values <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> due to noise in the observed data.</p>
<p>It is common for people to be confused about the difference between <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> and <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span>. To reemphasize the distinction, the Greek letters <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> are parameters about the true mechanism or process, which we typically don’t know. The English letters <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span> are statistics calculated from the sample of data we have. These will vary from sample to sample. As we did in Chapter 3, we’ll use <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span> to estimate and draw inferences about <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>.</p>
</section>
<section id="estimating-noise" class="level3" data-number="4.1.4">
<h3 data-number="4.1.4" class="anchored" data-anchor-id="estimating-noise"><span class="header-section-number">4.1.4</span> Estimating Noise</h3>
<p>An estimate for <span class="math inline">\(\sigma\)</span>, the amount of variability in amount of ice cream dispensed between people who hold the dispenser for the same amount of time (i.e.&nbsp;the amount of noise) can be estimated as a function of SSR, sample size (n), and number of parameters terms in the model (p), excluding the intercept.</p>
<p><span class="math inline">\(s =\sqrt{\frac{\text{SSR}}{n-(p+1)}} = \sqrt{\frac{\displaystyle\sum_{i=1}^n(y_i-\hat{y}_i)^2}{(n-(p+1))}}\)</span>.</p>
<p>This quantity <span class="math inline">\(s\)</span> is called the <strong>residual standard error.</strong></p>
<p>Keeping with the convention of using Greek letters to represent population parameters <span class="math inline">\(\sigma\)</span> and English letters to represent estimates calculated from samples, we use <span class="math inline">\(s\)</span> to represent the estimate of <span class="math inline">\(\sigma\)</span> that we calculate from our sample.</p>
<p>In this case, <span class="math inline">\(n=15\)</span>, and <span class="math inline">\(p=1\)</span> so we can calculate <span class="math inline">\(s\)</span> as below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">sum</span>(IC_Model<span class="sc">$</span>residuals<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>(<span class="dv">15</span><span class="sc">-</span>(<span class="dv">1</span><span class="sc">+</span><span class="dv">1</span>)))</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>s</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.905437</code></pre>
</div>
</div>
<p>We notice that <span class="math inline">\(s\)</span> is a reasonable estimate of <span class="math inline">\(\sigma\)</span>, which we know to be 1. In most situations, we won’t know the true value of <span class="math inline">\(\sigma\)</span> and will use <span class="math inline">\(s\)</span> as an estimate.</p>
</section>
<section id="ordinary-linear-regression-model-1" class="level3" data-number="4.1.5">
<h3 data-number="4.1.5" class="anchored" data-anchor-id="ordinary-linear-regression-model-1"><span class="header-section-number">4.1.5</span> Ordinary Linear Regression Model</h3>
<p>In the ice cream example, the relationship between expected amount and time holding the dispenser was given by a linear equation involving a single numeric explanatory variable. We can generalize this to situations with multiple explanatory variables, which might be numeric or categorical.</p>
<p>Individual observations are then assumed to vary from their expectation in accordance with a normal distribution, representing random noise (or error).</p>
<p>The mathematical form of a linear regression model is</p>
<p><span class="math inline">\(Y_i = \beta_0 + \beta_1X_{i1}+ \ldots + \beta_pX_{ip} + \epsilon_i\)</span>, with <span class="math inline">\(\epsilon_i\sim\mathcal{N}(0,\sigma)\)</span>.</p>
<p>Note that in place of <span class="math inline">\(X_{ip}\)</span>, we could have indicators for categories, or functions of <span class="math inline">\(X_{ip}\)</span>, such as <span class="math inline">\(X_{ip}^2\)</span>, <span class="math inline">\(\text{log}(X_{ip})\)</span>, or <span class="math inline">\(\text{sin}(X_{ip})\)</span>.</p>
<ul>
<li><p>The quantities <span class="math inline">\(\beta_0, \beta_1, \ldots, \beta_p\)</span> are parameters, pertaining to the true but unknown data generating mechanism.</p></li>
<li><p>The estimates <span class="math inline">\(b_0, b_1, \ldots, b_p\)</span>, are statistics, calculated from our observed data.<br>
</p></li>
<li><p>We use statistics <span class="math inline">\(b_0, b_1, \ldots, b_p\)</span> to obtain confidence intervals and hypothesis tests to make statements about parameters <span class="math inline">\(\beta_0, \beta_1, \ldots, \beta_p\)</span>.</p></li>
</ul>
</section>
<section id="model-assumptions" class="level3" data-number="4.1.6">
<h3 data-number="4.1.6" class="anchored" data-anchor-id="model-assumptions"><span class="header-section-number">4.1.6</span> Model Assumptions</h3>
<p>The linear regression model depends on four assumptions, which we made when simulating the behavior of the ice cream dispenser.</p>
<ol type="1">
<li><p><strong>Linearity</strong> - The expected value of the response variable <span class="math inline">\(Y\)</span> is a linear function of the explanatory variable(s).<br>
<strong>Ex.</strong> the expected amount of ice cream dispensed (i.e the signal) is a linear function of time the dispenser was pressed.</p></li>
<li><p><strong>Constant Variance</strong> - the variance between individual values of the response variable is the same for any values/categories of the explanatory variable(s)<br>
<strong>Ex.</strong> individual amounts dispensed varied from their expected amount with equal variability, regardless of the amount of time. That is, the amount of variability in individual amounts dispensed was the same for people who held the dispenser for 1 s. as for people who held it for 2 s. or 3 s., etc.</p></li>
<li><p><strong>Normality</strong> - for any values/categories of the explanatory variable(s) individual response values vary from their expectation in accordance with a normal distribution.<br>
<strong>Ex.</strong> individual amounts dispensed varied from their expected amount in accordance with a normal distribution.</p></li>
<li><p><strong>Independence</strong> - individual response values are not affected by one another<br>
<strong>Ex.</strong> the amount of ice cream dispensed for one person was not affected by the amount dispensed for anyone else.</p></li>
</ol>
</section>
<section id="statistical-abstraction" class="level3" data-number="4.1.7">
<h3 data-number="4.1.7" class="anchored" data-anchor-id="statistical-abstraction"><span class="header-section-number">4.1.7</span> Statistical Abstraction</h3>
<p>If we really believe that data come about as the ordinary regression model describes, then probability theory tells us that regression coefficients <span class="math inline">\(b_j\)</span>’s, representing differences between categories for categorical variables and rates of change for quantitative variables, follow symmetric and bell-shaped distributions. We can use this fact to create confidence intervals and perform hypothesis tests, without needing to perform simulation. This is, in fact what R does in it’s model summary output.</p>
<p>These methods are only valid, however, if data can reasonably be thought of as having come from a process consistent with the assumptions of the ordinary regression model process. If we don’t believe that our observed data can be reasonably thought of as having come from such a process, then the confidence intervals and p-values produced by R, and other places that rely on probability-based methods will not be reliable.</p>
<p>The process of formulating a real world situation as a statistical model is known as <strong>statistical abstraction.</strong></p>
<p>We close the section with a philosophical question:</p>
<p>Do data really come about from processes like the ordinary regression model? That is, do you think it is reasonable to believe that data we see in the real world (perhaps the amount of ice cream dispensed by an ice cream machine) represent independent outcomes of a process in which expected outcomes are a linear function of explanatory variables, and deviate from their expectation according to a normal distribution with constant variance?</p>
<p>We won’t attempt to answer that question here, but it is worth thinking about. After all, it is an assumption on which many frequently employed methods of statistical inference depends.</p>
<div style="page-break-after: always;"></div>
</section>
</section>
<section id="theory-based-inference" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="theory-based-inference"><span class="header-section-number">4.2</span> Theory-Based Inference</h2>
<p>You probably noticed that most of the bootstrap and sampling distributions we saw in Chapter 3 were symmetric and bell-shaped in nature. When the assumptions of the ordinary regression model are reasonably satisfied, the distribution of common model estimates, including means, differences in means, and regression slopes will approximately follow symmetric, bell-shaped distributions. In such situations, we can use statistical theory to calculate confidence intervals and perform hypothesis tests, without needing to actually perform the simulations that we did in Chapter 3.</p>
<p>In this Section, we’ll look at the formulas and probability distributions we can use when the ordinary linear regression model is appropriate, and see how they lead to results very similar to those we’ve obtain previously via bootstrapping and permutation tests.</p>
<section id="common-standard-error-formulas" class="level3" data-number="4.2.1">
<h3 data-number="4.2.1" class="anchored" data-anchor-id="common-standard-error-formulas"><span class="header-section-number">4.2.1</span> Common Standard Error Formulas</h3>
<p>In Chapter 3, we used bootstrapping to estimate the standard error associated with statistics <span class="math inline">\(b_0\)</span>, <span class="math inline">\(b_1\)</span>, …<span class="math inline">\(b_p\)</span> in a regression model. Depending on the model, <span class="math inline">\(b_j\)</span> might represent an overall mean, means for different categories, or regression slopes.</p>
<p>It is important to realize that the standard error of a statistic <span class="math inline">\(\text{SE}(b_j)\)</span> is not the same thing as the residual standard error <span class="math inline">\(s\)</span> that was used to estimate <span class="math inline">\(\sigma\)</span> in the previous section. The standard errors <span class="math inline">\(\text{SE}(b_j)\)</span>, seen in Chapter 3, are estimates of much the statistic <span class="math inline">\(b_j\)</span> could vary between different samples of the same size as ours. On the other hand, the residual standard error <span class="math inline">\(s\)</span> is an estimate of the standard deviation in values of the response variable among individual observations with the same value(s) or category(ies) of all explanatory variables.</p>
<p>These quantities are, however, related. It might not be surprising to find out that when there is more variability between individual observations, there is also more variability in statistics between samples. Thus, <span class="math inline">\(\text{SE}(b_j)\)</span> is a function of <span class="math inline">\(s\)</span>.</p>
<p>Recall</p>
<p><span class="math inline">\(s =\sqrt{\frac{\text{SSR}}{n-(p+1)}} = \sqrt{\frac{\displaystyle\sum_{i=1}^n(y_i-\hat{y}_i)^2}{(n-(p+1))}}\)</span>.</p>
<p>We can use <span class="math inline">\(s\)</span> to calculate standard errors <span class="math inline">\(\text{SE}(b_j)\)</span> when <span class="math inline">\(b_j\)</span> represents a statistic like a mean, difference in means, or slope.</p>
<p><strong>Theory-Based Standard Error Formulas</strong></p>
<table class="caption-top table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th>Statistic</th>
<th>Standard Error</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Single Mean</td>
<td><span class="math inline">\(SE(b_0)=\frac{s}{\sqrt{n_{Group}}}\)</span></td>
</tr>
<tr class="even">
<td>Difference in Means</td>
<td><span class="math inline">\(SE(b_j)=s\sqrt{\frac{1}{n_{Groupj}}+\frac{1}{n_{Comp.Group}}}\)</span></td>
</tr>
<tr class="odd">
<td>Intercept in Simple Linear Regression</td>
<td><span class="math inline">\(SE(b_0)=s\sqrt{\frac{1}{n}+\frac{\bar{x}^2}{\sum(x_i-\bar{x})^2}}\)</span></td>
</tr>
<tr class="even">
<td>Slope in Simple Linear Regression</td>
<td><span class="math inline">\(SE(b_1)=\sqrt{\frac{s^2}{\sum(x_i-\bar{x})^2}}=\sqrt{\frac{1}{n-2}\frac{{\sum(\hat{y}_i-y_i)^2}}{\sum(x_i-\bar{x})^2}}\)</span></td>
</tr>
</tbody>
</table>
<p>Notes:</p>
<ol type="1">
<li><p><span class="math inline">\(n\)</span> represents the total sample size. In Formula 1, <span class="math inline">\(n_{Group}\)</span> represents the sample size for the group corresponding to the coefficient <span class="math inline">\(b_0\)</span>. If there are no explanatory variables in the model, it will be <span class="math inline">\(n\)</span>, otherwise, it will be the size of the baseline group. <span class="math inline">\(n_{\text{Groupj}}\)</span> represents the sample size for the group represented by <span class="math inline">\(b_j\)</span>, and <span class="math inline">\(n_{Comp.Group}\)</span> represents the sample size for the group it’s being compared to (i.e.&nbsp;the baseline group).</p></li>
<li><p>For the difference in means formula, the standard error estimate <span class="math inline">\(s\sqrt{\frac{1}{n_1+n_0}}\)</span> is called a “pooled” estimate since it combines information from all groups to estimate <span class="math inline">\(s\)</span>. This is beneficial, as long as the constant variance assumption in the ordinary regression model is appropriate. When there is reason to believe standard deviation differs between groups, we can use an “unpooled” standard error estimate of <span class="math inline">\(\sqrt{\frac{s_\text{Groupj}^2}{n_\text{Groupj}}+\frac{s_{\text{CompGroup}}^2}{n_{CompGroup}}}\)</span>, where <span class="math inline">\(s_1, s_0\)</span> represent the standard deviation for the two groups being compared. This can be used in situations where the explanatory variable is categorical and we have doubts about the constant variance assumption. By default, R assumes constant variance and uses a pooled estimate in its model summary output and related tests/intervals.</p></li>
</ol>
<p>There is no theory-based formula for standard error associated with the median or standard deviation. For these, and many other statistics, we rely on simulation to estimate variability between samples.</p>
<p>There are formulas for standard errors associated with coefficients in multiple regression, but these require mathematics beyond what is assumed in this class. They involve linear algebra and matrix inversion, which you can read about <a href="https://web.stanford.edu/~mrosenfe/soc_meth_proj3/matrix_OLS_NYU_notes.pdf">here</a> if you are interested.</p>
</section>
<section id="confidence-intervals" class="level3" data-number="4.2.2">
<h3 data-number="4.2.2" class="anchored" data-anchor-id="confidence-intervals"><span class="header-section-number">4.2.2</span> Confidence Intervals</h3>
<p>When the sampling distribution is symmetric and bell-shaped, approximate 95% confidence intervals can be calculated using the formula,</p>
<p><span class="math display">\[
\text{Statistic} \pm 2\times \text{Standard Error},
\]</span></p>
<p>where the standard error is estimated using a formula, rather than through bootstrapping.</p>
<p>In the next section, we’ll go through some examples to illustrate how to calculate and interpret <span class="math inline">\(s\)</span> and <span class="math inline">\(SE(b_j)\)</span>.</p>
<p>We’ve now seen 3 different ways to obtain confidence intervals based on statistics calculated from data.</p>
<p>The table below tells us what must be true of the sampling distribution for a statistic in order to use each technique.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Technique</th>
<th>No Gaps</th>
<th>Bell-Shaped</th>
<th>Known SE Formula</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Bootstrap Percentile</td>
<td>x</td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>Bootstrap Standard Error</td>
<td>x</td>
<td>x</td>
<td></td>
</tr>
<tr class="odd">
<td>Theory-Based</td>
<td>x</td>
<td>x</td>
<td>x</td>
</tr>
</tbody>
</table>
</section>
<section id="t-tests" class="level3" data-number="4.2.3">
<h3 data-number="4.2.3" class="anchored" data-anchor-id="t-tests"><span class="header-section-number">4.2.3</span> t-tests</h3>
<p>A <strong>t-distribution</strong> is a symmetric, bell-shaped curve. Its shape is similar to that of the normal distribution, only it has more area in the tales, and is less concentrated around the center. When the sampling distribution for a statistic is symmetric and bell-shaped, it can be approximated by a t-distribution.</p>
<p>The t-distribution depends on a parameter called <strong>degrees of freedom</strong>, which determines the thickness of the distribution’s tails. The degrees of freedom is related to the sample size. As the sample size (and thus degrees of freedom) increase, the t-distributions gets closer and closer to a normal distribution with mean 0 and standard deviation 1, which is known as a <strong>standard normal distribution.</strong></p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch4_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>When the sampling distribution of a statistic is symmetric and bell-shaped, then the ratio</p>
<p><span class="math display">\[
t= \frac{{\text{Statistic}}}{\text{SE}(\text{Statistic})}  =\frac{b_j}{\text{SE}(b_j)}
\]</span></p>
<p>approximately follows a t-distribution. The statistic <span class="math inline">\(t\)</span> is called a <strong>standardized statistic</strong>.</p>
<p>We can use a t-distribution to perform a hypothesis test with a null hypothesis that there is no difference between groups, or no relationship between variables. The null hypothesis is <span class="math inline">\(\beta_j=0\)</span>.</p>
<p>The standardized statistic tells us how many standard errors higher or lower our statistic <span class="math inline">\(b_j\)</span> is than we would expect it to be if our null hypothesis were true.</p>
<p>The larger the t-statistic is, the less consistent it is with the null hypothesis. t-statistics more extreme than <span class="math inline">\(\pm 2\)</span> typically provide evidence against the null hypothesis.</p>
<p>To find a p-value, we use a t-distribution to find the probability of obtaining a t-statistic as or more extreme than the one calculated from our data.</p>
<p>For example, for a t-distribution with 20 degrees of freedom the probability of obtaining a t-statistic as or more extreme than 1.5 is about 0.14, while the probability of obtaining a t-statistic as or more extreme than 2.8 is only 0.01.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch4_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="f-tests" class="level3" data-number="4.2.4">
<h3 data-number="4.2.4" class="anchored" data-anchor-id="f-tests"><span class="header-section-number">4.2.4</span> F-tests</h3>
<p>Just as the ratio of a regression statistic to its standard error follows a t-distribution, F-statistics also follow a known probability distribution when the assumptions of the ordinary linear regression model are apropriate.</p>
<p>An <strong>F distribution</strong> is a right-skewed distribution. It is defined by two parameters, <span class="math inline">\(\nu_1, \nu_2\)</span>, called numerator and denominator degrees of freedom.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch4_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<p>When the assumptions of the ordinary linear regression model are reasonably satisfied, the F-statistic</p>
<p><span class="math display">\[
F = \frac{\frac{\text{SSR}_{\text{Reduced}}-\text{SSR}_{\text{Full}}}{p-q}}{\frac{\text{SSR}_{\text{Full}}}{n-(p+1)}}
\]</span></p>
<p>approximately follows an F-distribution with <span class="math inline">\(p-q\)</span> and <span class="math inline">\(n-(p+1)\)</span> degrees of freedom.</p>
<p>Like with a t-statistic, we can calculate an F-statistic by looking at how extreme our F-statistic is in its F-distribution.</p>
<p>For an F-distribution with 2 and 20 degrees of freedom, the probability of getting an F-statistic more extreme than 1.8 is about 0.19, while the probability of getting and F-statistic as extreme or more than 4.6 is about 0.02.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch4_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="limitations-of-theory-based-inference" class="level3" data-number="4.2.5">
<h3 data-number="4.2.5" class="anchored" data-anchor-id="limitations-of-theory-based-inference"><span class="header-section-number">4.2.5</span> Limitations of Theory-Based Inference</h3>
<p>We’ve seen that in situations where the sampling distribution for a regression coefficient <span class="math inline">\(b_j\)</span> is symmetric and bell-shaped, we can create confidence intervals and perform hypothesis tests using theory-based standard error formulas, as well as t- and F-distributions. This means we won’t need to perform permutation-based hypothesis tests, or bootstrapping for confidence intervals as we did in Chapter 3.</p>
<p>There are, however, limitations to this approach, which underscore the importance of the simulation-based approaches seen in Chapter 3.</p>
<p>These include:</p>
<ol type="1">
<li><p>There are lots of statistics, like medians and standard deviations, that do not have known standard error formulas, and do not follow symmetric bell-shaped distributions. In more advanced and complicated models, it is common to encounter statistics of interest with unknown sampling distributions. In these cases, we can estimate p-values and build confidence intervals via simulation, even if we cannot identify the distribution by name.</p></li>
<li><p>Even for statistics with known standard error formulas, the t-test is only appropriate when the sampling distribution for <span class="math inline">\(b_j\)</span> is symmetric and bell-shaped. If the assumptions of the ordinary regression model are reasonably satisfied, then we can be assured that this will be the case. Sometimes, however, those assumptions will not be satisfied. There is probability theory which tells us that even when model assumptions do not hold, t-tests and and theory-based confidence intervals for regression coefficients will still be reasonable when the sample size is “large enough,” but there is no consistent definition of what “large enough.” The necessary sample size depends on the context and the degree to which assumptions are violated. Simulation-based approaches offer a more flexible method for performing inference in these situations, and also offer a way to check the results we get using theory-based methods. Furthermore, F-tests become invalid when model assumptions are violated regardless of the sample size.</p></li>
<li><p>The simulation-based approaches provide valuable insight to the logic behind hypothesis tests. When we permute values of an explanatory variable in a hypothesis test it is clear that we are simulating a situation where the null hypothesis is true. Likewise, when we simulate taking many samples in bootstrapping, it is clear that we are assessing the variability in a statistic across samples. Simply jumping to the t-based approximations of these distributions makes it easy to lose our sense of what they actually represent, and thus increases the likelihood of interpreting them incorrectly.</p></li>
</ol>
<p>In fact, prominent statistician R.A. Fisher wrote of simulation-based methods in 1936:</p>
<p><em>“Actually, the statistician does not carry out this very simple and very tedious process, but his conclusions have no justification beyond the fact that they agree with those which could have been arrived at by this elementary method.”</em></p>
<p>Fisher’s comment emphasizes the fact that probability-based tests, like the t-test are simply approximations to what we would obtain via simulation-based approaches, which were not possible in his day, but are now.</p>
<p>Proponents of simulation-based inference include Tim Hesterberg, Senior Statistician at Instacart, and former Senior Statistician at Google, which heavily used simulation-based tests associated with computer experiments associated with their search settings. Hesterberg wrote a <a href="https://browse.arxiv.org/pdf/1411.5279.pdf">2015 paper</a>, arguing for the use and teaching of simulation-based techniques.</p>
<p>We will move forward by using probability-based inference where appropriate, while understanding that we are merely approximating what we would obtain via simulation. Meanwhile, we’ll continue to employ simulation-based approaches where probability-based techniques are inappropriate or unavailable.</p>
</section>
</section>
<section id="model-based-inference" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="model-based-inference"><span class="header-section-number">4.3</span> Model-Based Inference</h2>
<p>In this section, we’ll apply the theories and formulas from the previous section to the models won the Florida lakes data that we saw in Chapter 3. We’ll illustrate how to calculate all of the important peices of information provided in the model summary output produced by R.</p>
<section id="difference-in-means" class="level3" data-number="4.3.1">
<h3 data-number="4.3.1" class="anchored" data-anchor-id="difference-in-means"><span class="header-section-number">4.3.1</span> Difference in Means</h3>
<p>We’ll begin by using the ordinary regression model to predict a lake’s mercury level, using location (N vs S) as the explanatory variable.</p>
<p>The regression model is:</p>
<p><span class="math display">\[
\text{Mercury} = \beta_0 +\beta_1 \times\text{Location}_{\text{South}} + \epsilon_i, \text{where } \epsilon_i\sim\mathcal{N}(0, \sigma)
\]</span></p>
<p>This model assumes:</p>
<ol type="1">
<li><p><strong>Linearity</strong> - there is no linearity assumption when the explanatory variable is categorical.</p></li>
<li><p><strong>Constant Variance</strong> - the variance between mercury levels of individual lakes is the same for Northern Florida, as for Southern Florida.</p></li>
<li><p><strong>Normality</strong> - mercury levels are normally distributed in Northern Florida and also in Southern Florida.</p></li>
<li><p><strong>Independence</strong> - mercury levels of individual lakes are not affected by those of other lakes.</p></li>
</ol>
<p>A table summarizing the means and standard deviations among lakes in Northern and Southern Florida is shown below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(LakesTable)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Location</th>
<th style="text-align: right;">MeanHg</th>
<th style="text-align: right;">StDevHg</th>
<th style="text-align: right;">N</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">N</td>
<td style="text-align: right;">0.4245455</td>
<td style="text-align: right;">0.2696652</td>
<td style="text-align: right;">33</td>
</tr>
<tr class="even">
<td style="text-align: left;">S</td>
<td style="text-align: right;">0.6965000</td>
<td style="text-align: right;">0.3838760</td>
<td style="text-align: right;">20</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Note that the standard deviation in mercury levels is higher in Southern Florida than in Northern Florida, but the difference is not that big. As a rough guide we should be concerned about the constant variance assumption when the standard deviation in one group is more than twice as big as in another. Since that is not the case here, it seems reasonable to use the pooled standard deviation estimate as R does in its <code>lm</code> summary output, discussed next.</p>
<p><strong><code>lm</code> Summary Output</strong></p>
<p>The <code>lm</code> summary command in R returns estimates, standard errors, test statistics, and p-values pertaining to the model. These are calculated using the formulas in Section 4.2.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>M_Lakes_merc_loc <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>FloridaLakes, Mercury <span class="sc">~</span> Location)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(M_Lakes_merc_loc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Mercury ~ Location, data = FloridaLakes)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.65650 -0.23455 -0.08455  0.24350  0.67545 

Coefficients:
            Estimate Std. Error t value       Pr(&gt;|t|)    
(Intercept)  0.42455    0.05519   7.692 0.000000000441 ***
LocationS    0.27195    0.08985   3.027        0.00387 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.3171 on 51 degrees of freedom
Multiple R-squared:  0.1523,    Adjusted R-squared:  0.1357 
F-statistic: 9.162 on 1 and 51 DF,  p-value: 0.003868</code></pre>
</div>
</div>
<ul>
<li><p><strong>Estimate</strong> gives the least-squares estimates <span class="math inline">\(b_0, b_1, \ldots, b_p\)</span></p></li>
<li><p><strong>Standard Error</strong> gives estimates of the standard deviation in the sampling distribution for estimate. It tells us how the estimate is expected to vary between different samples of the given size. These are computed using the formulas in Section 4.2.1.</p></li>
<li><p><strong>t value</strong> is the estimate divided by its standard error.</p></li>
<li><p><strong>Pr(&gt;|t|)</strong> is a p-value for the hypothesis test associated with the null hypothesis <span class="math inline">\(\beta_j = 0\)</span>, where <span class="math inline">\(\beta_j\)</span> is the regression coefficient pertaining to the given line. Note that <span class="math inline">\(\beta_j\)</span> is the unknown population parameter estimated by <span class="math inline">\(b_j\)</span>.</p></li>
<li><p>The <strong>Residual Standard Error</strong> is <span class="math inline">\(s =\sqrt{\frac{\text{SSR}}{n-(p+1)}} = \sqrt{\frac{\displaystyle\sum_{i=1}^n(y_i-\hat{y}_i)^2}{(n-(p+1))}}\)</span>. This is an estimate of <span class="math inline">\(\sigma\)</span>, which represents the standard deviation in the distribution of the response variable for given value(s) or category(ies) of explanatory variable(s). It tells us how much variability is expected in the response variable between different individuals with the same values/categories of the explanatory variables.</p></li>
<li><p>The <strong>degrees of freedom</strong> are <span class="math inline">\(n-(p+1)\)</span>.</p></li>
<li><p>The <strong>Multiple R-Squared</strong> value is the <span class="math inline">\(R^2\)</span> value seen in Chapter 2. <span class="math inline">\(R^2 = \frac{\text{SST} -\text{SSR}}{\text{SST}} = \frac{\displaystyle\sum_{i=1}^n(y_i-\hat{y}_i)^2}{\displaystyle\sum_{i=1}^n(y_i-\bar{y}_i)^2}\)</span></p></li>
<li><p>We know that <span class="math inline">\(R^2\)</span> can never decrease when additional variables are added to a model. The <strong>Adjusted-R^2</strong> value is an alternate version of <span class="math inline">\(R^2\)</span> that is designed to penalize adding variables that do little to explain variation in the response.</p></li>
<li><p>The <strong>F-statistic</strong> on the bottom line of the R-output corresponds to an F-test of the given model against a reduced model that include no explanatory variables. The p-value on this line is associated with the test of the null hypothesis that there is no relationship between the response variable and any of the explanatory variables. Since SSR for this reduced model is equal to SST, the F-statistic calculation simplifies to:</p></li>
</ul>
<p><span class="math display">\[ F=\frac{\frac{SST - SSR}{p}}{\frac{SSR}{n-(p+1)}} \]</span></p>
<p>The degrees of freedom associated with the F-statistic are given by <span class="math inline">\(p\)</span> and <span class="math inline">\((n-(p+1))\)</span>.</p>
<ul>
<li>The <strong>p-value associated with the F-statistic</strong> tells us the probability of obtaining an F-statistic as extreme or more extreme than we did if there is really no relationship between the response variable and any explanatory variables in our model.</li>
</ul>
<p><strong>Calculations in Summary Output</strong></p>
<p>Let’s go through how all of these quantities are calculated and discuss what they tell us.</p>
<p>In order to do the calculations, we’ll need to know the values of SSR and SST. These are</p>
<p>SSR:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(M_Lakes_merc_loc<span class="sc">$</span>residuals<span class="sc">^</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5.126873</code></pre>
</div>
</div>
<p>SST:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>MeanMerc <span class="ot">&lt;-</span> <span class="fu">mean</span>(FloridaLakes<span class="sc">$</span>Mercury) </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>((FloridaLakes<span class="sc">$</span>Mercury <span class="sc">-</span> MeanMerc)<span class="sc">^</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6.047875</code></pre>
</div>
</div>
<p>We’ll start with the calculations in the bottom part, underneath the coefficients table, namely residual standard error, Multiple R-squared, and the F-statistic.</p>
<section id="residual-standard-error" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="residual-standard-error">Residual Standard Error</h4>
<p><span class="math display">\[
\begin{aligned}
s &amp; =\sqrt{\frac{\text{SSR}}{n-(p+1)}} \\
&amp; = \sqrt{\frac{\displaystyle\sum_{i=1}^n(y_i-\hat{y}_i)^2}{(n-(p+1))}} \\
&amp; =\sqrt{\frac{5.126873}{53-(1+1)}} \\
&amp; = 0.317
\end{aligned}
\]</span></p>
<p>The standard deviation in mercury concentrations among lakes in the same part of the state is estimated to be 0.317 ppm.</p>
</section>
<section id="multiple-r-squared" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="multiple-r-squared">Multiple R-Squared</h4>
<p><span class="math display">\[ R^2 = \frac{6.047875 - 5.126873}{6.047875} = 0.1523 \]</span></p>
</section>
<section id="f-statistic" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="f-statistic">F-Statistic</h4>
<p><span class="math display">\[ F=\frac{\frac{SST - SSR}{p}}{\frac{SSR}{n-(p+1)}} = \frac{\frac{6.047875 - 5.126873}{1}}{\frac{5.126873}{53-(1+1)}} = 9.162 \]</span></p>
<p>This F-statistic is associated with 1 and 51 degrees of freedom.</p>
</section>
<section id="p-value-for-f-statistic" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="p-value-for-f-statistic">p-value for F-Statistic</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_dist</span>(<span class="st">"f"</span>, <span class="at">df1=</span><span class="dv">1</span>, <span class="at">df2=</span><span class="dv">51</span>, <span class="at">geom =</span> <span class="st">"area"</span>, <span class="at">fill =</span> <span class="sc">~</span> (x <span class="sc">&lt;</span> <span class="fl">9.162</span>), <span class="at">show.legend=</span><span class="cn">FALSE</span>) <span class="sc">+</span> <span class="fu">geom_vline</span>(<span class="at">xintercept=</span><span class="fl">9.162</span>, <span class="at">color=</span><span class="st">"red"</span>)  <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"F"</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">xlim</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">10</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch4_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We can use the <code>pf()</code> command to calculate the p-value. Note that <code>pf()</code> this command returns the probability of obtaining an F-statistic less extreme than we did, so we subtract it from 1 to get the probability of obtaining an F-statistic more extreme than we did.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> <span class="fu">pf</span>(<span class="fl">9.162</span>, <span class="at">df1=</span><span class="dv">1</span>, <span class="at">df2=</span><span class="dv">51</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.003867677</code></pre>
</div>
</div>
<p>The large F-statistic and small p-value provide strong evidence against the null hypothesis that there is no relationship between a lake’s location and mercury level. We have strong evidence that there is a relationship between location and mercury level, or in other words, that mean mercury level differs between lakes in Northern and Southern Florida.</p>
<p>We’ll now move into the calculations in the coefficients table.</p>
</section>
<section id="estimates" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="estimates">Estimates</h4>
<p>The estimates column returns the estimates of <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span>. The estimated regression equation is</p>
<p><span class="math display">\[
\widehat{\text{Mercury}} = 0.4245455 + 0.2719545\times\text{Location}_{\text{South}}
\]</span></p>
</section>
<section id="standard-errors" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="standard-errors">Standard Errors</h4>
<p>The second column in the coefficients table gives standard errors associated with <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span>. These tell us how much these statistics are expected to vary between samples of the given size.</p>
<p><strong>Estimating</strong> <span class="math inline">\(\text{SE}(b_0)\)</span> and <span class="math inline">\(\text{SE}(b_1)\)</span></p>
<p>We’ll use the theory-based formulas to calculate the standard errors for <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span>.</p>
<p>In this case, <span class="math inline">\(b_0\)</span> represents a single mean, the mean mercury level for lakes in Northern Florida. Since there are 33 such lakes, the calculation is:</p>
<p><span class="math inline">\(SE(b_0)=\frac{s}{\sqrt{n_\text{North}}} = \frac{0.317}{\sqrt{33}} \approx 0.055\)</span></p>
<p>The standard error of intercept <span class="math inline">\(b_0\)</span> is 0.055. This represents the variability in average mercury level in different samples of 33 lakes from Northern Florida.</p>
<p><span class="math inline">\(SE(b_1)=s\sqrt{\frac{1}{n_{\text{South}}}+\frac{1}{n_{\text{North}}}} = 0.317\sqrt{\frac{1}{20}+\frac{1}{33}} = 0.0898\)</span></p>
<p>The standard error of slope <span class="math inline">\(b_1\)</span> is 0.0898. This represents the variability in average difference in mercury levels between samples of 33 lakes from Northern Florida and 20 lakes from Southern Florida.</p>
<p>These numbers match the values in the <code>Std. Error</code> column of the coefficients table of the <code>lm</code> summary output.</p>
</section>
<section id="confidence-intervals-1" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="confidence-intervals-1">Confidence Intervals</h4>
<p>We can use these standard errors to calculate 95% confidence intervals for <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>.</p>
<p>A 95% confidence interval for <span class="math inline">\(\beta_0\)</span> is given by</p>
<p><span class="math display">\[
\begin{aligned}
&amp; b_0 \pm 2\times\text{SE}(b_0) \\
&amp; = 0.42455 \pm 2\times{0.055} \\
&amp; = (0.314, 0.535)
\end{aligned}
\]</span></p>
<p>We are 95% confident that the mean mercury level among all lakes in Northern Florida is between 0.314 and 0.535 ppm.</p>
<p>A 95% confidence interval for <span class="math inline">\(\beta_1\)</span> is given by</p>
<p><span class="math display">\[
\begin{aligned}
&amp; b_1 \pm 2\times\text{SE}(b_1) \\
&amp; = 0.272 \pm 2\times{0.0898} \\
&amp; = (0.09, 0.45)
\end{aligned}
\]</span></p>
<p>We are 95% confident that the average mercury level in Southern Lakes is between 0.09 ppm and 0.45 ppm higher than in Northern Florida.</p>
<p>These intervals can be obtained directly in R using the <code>confint</code> command.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(M_Lakes_merc_loc, <span class="at">level=</span><span class="fl">0.95</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                 2.5 %    97.5 %
(Intercept) 0.31374083 0.5353501
LocationS   0.09157768 0.4523314</code></pre>
</div>
</div>
</section>
<section id="hypotheses" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="hypotheses">Hypotheses</h4>
<p>Before interpreting t-values and p-values in the coefficients table, we should state the hypotheses associated with them.</p>
<p><strong>Hypothesis Test for line (intercept)</strong></p>
<p><strong>Null Hypothesis:</strong> The average mercury level among all lakes in North Florida is 0 (<span class="math inline">\(\beta_0=0\)</span>).</p>
<p><strong>Alternative Hypothesis:</strong> The average mercury level among all lakes in Northern Florida is not 0 (<span class="math inline">\(\beta_0\neq 0\)</span>).</p>
<p>We already know the average mercury level among all lakes in North Florida is not 0, so this is a silly test. Not every test reported in the R output is a meaningful one, so we should not attempt to draw conclusions from this p-value.</p>
<p><strong>Hypothesis Test for line LocationS</strong></p>
<p><strong>Null Hypothesis:</strong> There is no difference in average mercury levels between Northern and Southern Florida (<span class="math inline">\(\beta_1=0\)</span>).</p>
<p><strong>Alternative Hypothesis:</strong> There is a difference in average mercury levels in Northern and Southern Florida (<span class="math inline">\(\beta_1\neq 0\)</span>).</p>
</section>
<section id="t-value" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="t-value">t-value</h4>
<p>We calculate standardized t-statistics associated with <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span>.</p>
<p><strong>t-statistic for</strong> <span class="math inline">\(b_0\)</span>:</p>
<p><span class="math inline">\(t=\frac{{b_0}}{\text{SE}(b_0)} = \frac{0.42455}{0.05519} = 7.692\)</span></p>
<p>In our sample, the average mercury level among lakes in Northern Florida is 7.7 standard errors higher than we would expect it to be if the average mercury level among all lakes in Northern Florida is 0. Since we know that the mean mercury level among all lakes in Northern Florida is not 0, this is not a meaningful interpretation.</p>
<p><strong>t-statistic for</strong> <span class="math inline">\(b_1\)</span>:</p>
<p><span class="math inline">\(t=\frac{{b_1}}{\text{SE}(b_1)} = \frac{0.27195}{0.08985} = 3.027\)</span></p>
<p>In our sample, the average mercury level among lakes in Southern Florida is 3 standard errors higher than we would expect it to be if the there was really no difference in average mercury levels between lakes in Northern and Southern Florida. Equivalently, we could say that the mean mercury level among lakes in Southern Florida is 3 standard errors higher than in Northern Florida.</p>
</section>
<section id="prt" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="prt">Pr(&gt;|t|)</h4>
<p><strong>p-value for line (Intercept)</strong></p>
<p>We already know the average mercury level among all lakes in North Florida is not 0, so this is a silly test. Not every test reported in the R output is a meaningful one, so we should not attempt to draw conclusions from this p-value.</p>
<p><strong>p-value for line LocationS</strong></p>
<p>We plot the t-statistic of 3.027 that we observed in our data and observe where it lies on a t-distribution.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>ts<span class="ot">=</span><span class="fl">3.027</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_dist</span>(<span class="st">"t"</span>, <span class="at">df=</span><span class="dv">51</span>, <span class="at">geom =</span> <span class="st">"area"</span>, <span class="at">fill =</span> <span class="sc">~</span> (<span class="fu">abs</span>(x)<span class="sc">&lt;</span> <span class="fu">abs</span>(ts)), <span class="at">show.legend=</span><span class="cn">FALSE</span>) <span class="sc">+</span> <span class="fu">geom_vline</span>(<span class="at">xintercept=</span><span class="fu">c</span>(ts, <span class="sc">-</span>ts), <span class="at">color=</span><span class="st">"red"</span>)  <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"t"</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch4_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<p>We use the <code>pt</code> command to calculate the probability of getting a t-statistic as extreme or more extreme than the 3.027 we saw in our data. We multiply by 2 to get the area on both the left and right extremes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span><span class="sc">*</span><span class="fu">pt</span>(<span class="fl">3.027</span>, <span class="at">df=</span><span class="dv">51</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.003866374</code></pre>
</div>
</div>
<p>The low p-value gives us strong evidence of a difference in average mercury levels between lakes in Northern and Southern Florida.</p>
<p>Note that the p-value from the t-test is the same as for the F-statistic. This will happen when there is only one variable in the model.</p>
</section>
<section id="comparison-to-simulation" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="comparison-to-simulation">Comparison to Simulation</h4>
<p>Let’s compare the confidence intervals and p-values we got to the ones we obtained in Chapter 3 using bootstrapping and a permutation test.</p>
<p><strong>Formula-Based 95% Confidence Interval for</strong> <span class="math inline">\(b_1\)</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(M_Lakes_merc_loc,  <span class="at">parm =</span> <span class="fu">c</span>(<span class="st">"LocationS"</span>), <span class="at">level=</span><span class="fl">0.95</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               2.5 %    97.5 %
LocationS 0.09157768 0.4523314</code></pre>
</div>
</div>
<p><strong>Bootstrap 95% Confidence Interval for</strong> <span class="math inline">\(b_1\)</span>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(M_Lakes_merc_loc_Bootstrap, <span class="at">parm =</span> <span class="fu">c</span>(<span class="st">"LocationS"</span>),</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">level =</span> <span class="fl">0.95</span>, <span class="at">method =</span> <span class="st">"se"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       name      lower     upper level method  estimate margin.of.error
1 LocationS 0.08256301 0.4586334  0.95 stderr 0.2719545       0.1880352</code></pre>
</div>
</div>
<p><strong>p-value from t-distribution</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>ts<span class="ot">=</span><span class="fl">3.027</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_dist</span>(<span class="st">"t"</span>, <span class="at">df=</span><span class="dv">51</span>, <span class="at">geom =</span> <span class="st">"area"</span>, <span class="at">fill =</span> <span class="sc">~</span> (<span class="fu">abs</span>(x)<span class="sc">&lt;</span> <span class="fu">abs</span>(ts)), <span class="at">show.legend=</span><span class="cn">FALSE</span>) <span class="sc">+</span> <span class="fu">geom_vline</span>(<span class="at">xintercept=</span><span class="fu">c</span>(ts, <span class="sc">-</span>ts), <span class="at">color=</span><span class="st">"red"</span>)  <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"t"</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch4_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span><span class="sc">*</span><span class="fu">pt</span>(<span class="fl">3.027</span>, <span class="at">df=</span><span class="dv">51</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.003866374</code></pre>
</div>
</div>
<p><strong>Permutation - based p-value</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>Estimate <span class="ot">&lt;-</span> <span class="fl">0.272</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>Extreme <span class="ot">&lt;-</span> <span class="fu">abs</span>(Lakes_merc_loc_perm_test<span class="sc">$</span>LocationS) <span class="sc">&gt;</span> <span class="fl">0.272</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>Lakes_merc_loc_perm_test_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>Lakes_merc_loc_perm_test, <span class="fu">aes</span>(<span class="at">x=</span>LocationS)) <span class="sc">+</span> </span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Extreme), <span class="at">color=</span><span class="st">"white"</span>) <span class="sc">+</span> </span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"FALSE"</span> <span class="ot">=</span> <span class="st">"blue"</span>, <span class="st">"TRUE"</span> <span class="ot">=</span> <span class="st">"red"</span>)) <span class="sc">+</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept=</span><span class="fu">c</span>(Estimate, <span class="sc">-</span><span class="dv">1</span><span class="sc">*</span>Estimate), <span class="at">color=</span><span class="st">"red"</span>) <span class="sc">+</span> </span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Lakes: Simulated Value of b1"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Frequency"</span>) <span class="sc">+</span> </span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Distribution of b1 under assumption of no relationship"</span>) <span class="sc">+</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>Lakes_merc_loc_perm_test_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch4_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">prop</span>(<span class="sc">~</span> (<span class="fu">abs</span>(LocationS) <span class="sc">&gt;</span> <span class="fl">0.272</span>), <span class="at">data =</span> Lakes_merc_loc_perm_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>prop_TRUE 
    0.003 </code></pre>
</div>
</div>
<p>The formula-based confidence interval and p-value are very close to those produced by simulation. Both approximations, so they are not expected to be identical, but should be close. They lead us to the same conclusion, namely that there is a difference in mean mercury level between lakes in Northern and Southern Florida and that the difference is somewhere between about 0.10 and 0.45 ppm.</p>
</section>
</section>
<section id="regression-slope-and-intercept" class="level3" data-number="4.3.2">
<h3 data-number="4.3.2" class="anchored" data-anchor-id="regression-slope-and-intercept"><span class="header-section-number">4.3.2</span> Regression Slope and Intercept</h3>
<p>We’ll use the ordinary regression model to predict a lake’s mercury level, using pH as the explanatory variable. In this case, the explanatory variable is quantitative, so <span class="math inline">\(\beta_1\)</span> represents a slope.</p>
<p>The regression model is:</p>
<p><span class="math display">\[
\text{Mercury} = \beta_0 +\beta_1 \times\text{pH} + \epsilon_i, \text{where } \epsilon_i\sim\mathcal{N}(0, \sigma)
\]</span></p>
<p>This model assumes:</p>
<ol type="1">
<li><p><strong>Linearity</strong> - the mercury level is a linear function of pH.</p></li>
<li><p><strong>Constant Variance</strong> - the variance between mercury levels of individual lakes is the same for each pH level.</p></li>
<li><p><strong>Normality</strong> - for each pH, mercury levels are normally distributed.</p></li>
<li><p><strong>Independence</strong> - mercury levels of individual lakes are not affected by those of other lakes.</p></li>
</ol>
<p>We might have doubts about some of these assumptions. For example, if we believe there might be more variability in mercury levels among lakes with higher pH levels than lower ones (a violation of the constant variance assumption), or that lakes closer together are likely to have similar mercury levels (a violation of the independence assumption) then the results of the model might not be reliable.</p>
<p>In Chapter 5, we’ll learn ways to check the appropriateness of these assumptions. For now, we’ll assume that the model is a reasonable enough approximation of reality and use it accordingly.</p>
<p>The <code>lm</code> summary command in R returns information pertaining to the model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>M_Lakes_merc_pH <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>FloridaLakes, Mercury <span class="sc">~</span> pH)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(M_Lakes_merc_pH)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Mercury ~ pH, data = FloridaLakes)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.48895 -0.19188 -0.05774  0.09456  0.71134 

Coefficients:
            Estimate Std. Error t value       Pr(&gt;|t|)    
(Intercept)  1.53092    0.20349   7.523 0.000000000814 ***
pH          -0.15230    0.03031  -5.024 0.000006572811 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.2816 on 51 degrees of freedom
Multiple R-squared:  0.3311,    Adjusted R-squared:  0.318 
F-statistic: 25.24 on 1 and 51 DF,  p-value: 0.000006573</code></pre>
</div>
</div>
<p>Let’s go through the calculations in the coefficients table and the rows below it. We first need to calculate SST and SSR as well as <span class="math inline">\(\bar{x}\)</span> and <span class="math inline">\(\sum(x_i-\bar{x})^2\)</span>, where <span class="math inline">\(x\)</span> represents the explanatory variable, <span class="math inline">\(pH\)</span>.</p>
<p>SST:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>Mean_merc <span class="ot">&lt;-</span> <span class="fu">mean</span>(FloridaLakes<span class="sc">$</span>Mercury)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>((FloridaLakes<span class="sc">$</span>Mercury<span class="sc">-</span>Mean_merc)<span class="sc">^</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6.047875</code></pre>
</div>
</div>
<p>SSR:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(M_Lakes_merc_pH<span class="sc">$</span>residuals<span class="sc">^</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4.045513</code></pre>
</div>
</div>
<p><span class="math inline">\(\bar{x}\)</span>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(FloridaLakes<span class="sc">$</span>pH)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6.590566</code></pre>
</div>
</div>
<p><span class="math inline">\(\sum(x_i-\bar{x})^2\)</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>Mean_pH <span class="ot">&lt;-</span> <span class="fu">mean</span>(FloridaLakes<span class="sc">$</span>pH)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>((FloridaLakes<span class="sc">$</span>pH<span class="sc">-</span>Mean_pH)<span class="sc">^</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 86.32528</code></pre>
</div>
</div>
<section id="residual-standard-error-1" class="level4 unlabeled" data-number="4.3.2.1">
<h4 class="unlabeled anchored" data-number="4.3.2.1" data-anchor-id="residual-standard-error-1"><span class="header-section-number">4.3.2.1</span> Residual Standard Error</h4>
<p><span class="math display">\[ s =\sqrt{\frac{\text{SSR}}{n-(p+1)}} = \sqrt{\frac{\text{SSR}}{n-(p+1)}} = \sqrt{\frac{4.045513}{53-(1+1)}}=0.2816 \]</span></p>
<p>The degrees of freedom associated with this estimate is <span class="math inline">\(53-(1+1) = 51\)</span>.</p>
</section>
<section id="multiple-r-squared-1" class="level4 unlabeled" data-number="4.3.2.2">
<h4 class="unlabeled anchored" data-number="4.3.2.2" data-anchor-id="multiple-r-squared-1"><span class="header-section-number">4.3.2.2</span> Multiple R-Squared</h4>
<p><span class="math display">\[ R^2 = \frac{6.047875 - 4.045513}{6.047875} = 0.3311 \]</span></p>
</section>
<section id="f-statistic-1" class="level4 unlabeled" data-number="4.3.2.3">
<h4 class="unlabeled anchored" data-number="4.3.2.3" data-anchor-id="f-statistic-1"><span class="header-section-number">4.3.2.3</span> F-Statistic</h4>
<p>The F-statistic is</p>
<p><span class="math display">\[ F=\frac{\frac{SST - SSR}{p}}{\frac{SSR}{n-(p+1)}} = \frac{\frac{6.047875 - 4.045513}{1}}{\frac{4.045513}{53-(1+1)}} = 25.24 \]</span></p>
<p>This F-statistic is associated with 1 and 51 degrees of freedom.</p>
</section>
<section id="p-value-associated-with-f-statistic" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="p-value-associated-with-f-statistic">p-value associated with F-statistic</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_dist</span>(<span class="st">"f"</span>, <span class="at">df1=</span><span class="dv">1</span>, <span class="at">df2=</span><span class="dv">51</span>, <span class="at">geom =</span> <span class="st">"area"</span>, <span class="at">fill =</span> <span class="sc">~</span> (x <span class="sc">&lt;</span> <span class="fl">9.162</span>), <span class="at">show.legend=</span><span class="cn">FALSE</span>) <span class="sc">+</span> <span class="fu">geom_vline</span>(<span class="at">xintercept=</span><span class="fl">25.24</span>, <span class="at">color=</span><span class="st">"red"</span>)  <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"F"</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">xlim</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">30</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch4_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> <span class="fu">pf</span>(<span class="fl">25.24</span>, <span class="at">df1=</span><span class="dv">1</span>, <span class="at">df2=</span><span class="dv">51</span>) <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
</div>
</section>
<section id="estimates-1" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="estimates-1">Estimates</h4>
<p>The estimates <span class="math inline">\(b_0 = 1.53\)</span> and <span class="math inline">\(b_1=-0.15\)</span> are calculated by fitting the regression line that minimizes the sum of the squared residuals.</p>
</section>
<section id="standard-errors-1" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="standard-errors-1">Standard Errors</h4>
<p><span class="math display">\[ SE(b_0)=s\sqrt{\frac{1}{n}+\frac{\bar{x}^2}{\sum(x_i-\bar{x})^2}} = 0.2816\sqrt{\frac{1}{53} + \frac{6.59^2}{86.32528} } = 0.2034 \]</span></p>
<p><span class="math inline">\(SE(b_0)\)</span> represents the variability in mercury levels among lakes with pH of 0 between different samples of size 53. Since we don’t have any lakes with pH of 0, this is not a meaningful calculation.</p>
<p><span class="math display">\[ SE(b_1)=\sqrt{\frac{s^2}{\sum(x_i-\bar{x})^2}}=\sqrt{\frac{0.2816^2}{86.32528}} = 0.0303 \]</span></p>
<p><span class="math inline">\(SE(b_1)\)</span> represents the variability in rate of change in mercury level for each additional one unit increase in pH, between different samples of size 53.</p>
</section>
<section id="confidence-interval" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="confidence-interval">Confidence Interval</h4>
<p>A 95% confidence interval for <span class="math inline">\(\beta_0\)</span> is given by</p>
<p><span class="math display">\[
\begin{aligned}
&amp; b_0 \pm 2\times\text{SE}(b_0) \\
&amp; = 1.53 \pm 2\times{0.203} \\
&amp; = (1.12, 1.94)
\end{aligned}
\]</span> This, in theory, would be telling us that we are 95% confident that the mean mercury level among all lakes in Florida with pH 0 would be between 1.12 and 1.94 ppm. Since there are no such lakes, this is not a sensible interpretation.</p>
<p>A 95% confidence interval for <span class="math inline">\(\beta_1\)</span> is given by</p>
<p><span class="math display">\[
\begin{aligned}
&amp; b_1 \pm 2\times\text{SE}(b_1) \\
&amp; = -0.15 \pm 2\times{0.03} \\
&amp; = (-0.21, -0.09)
\end{aligned}
\]</span></p>
<p>We are 95% confident that for each 1-unit increase in pH, mercury level is expected to decrease between 0.09 and 0.21 ppm.</p>
<p>These intervals can be obtained directly in R using the <code>confint</code> command.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(M_Lakes_merc_pH, <span class="at">level=</span><span class="fl">0.95</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                 2.5 %      97.5 %
(Intercept)  1.1223897  1.93944769
pH          -0.2131573 -0.09144445</code></pre>
</div>
</div>
</section>
<section id="hypotheses-1" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="hypotheses-1">Hypotheses</h4>
<p><strong>Hypothesis Test for Intercept Line</strong></p>
<p><strong>Null Hypothesis:</strong> The average mercury level among all Florida lakes with pH = 0 is 0. (<span class="math inline">\(\beta_0=0\)</span>).</p>
<p><strong>Alternative Hypothesis:</strong> The average mercury level among all Florida lakes with pH = 0 not 0. (<span class="math inline">\(\beta_0 \neq 0\)</span>).</p>
<p>Since there are no lakes with pH level 0, this is not a meaningful test.</p>
<p><strong>Hypothesis Test for pH Line</strong></p>
<p><strong>Null Hypothesis:</strong> There is no relationship between mercury and pH level among all Florida lakes. (<span class="math inline">\(\beta_1=0\)</span>).</p>
<p><strong>Alternative Hypothesis:</strong> There is a relationship between mercury and pH level among all Florida lakes. (<span class="math inline">\(\beta_1 \neq 0\)</span>).</p>
</section>
<section id="t-value-1" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="t-value-1">t-value</h4>
<p><strong>t-statistic for b_0</strong></p>
<p><span class="math inline">\(t=\frac{{b_j}}{\text{SE}(b_j)} = \frac{1.53}{2.03} = 7.72\)</span></p>
<p>In our sample, the mean mercury level in lakes with pH 0 is estimated to be 7 standard errors lower than we would expect if the mean mercury level in lakes with pH 0 was 0. This is not a meaningful interpretation since no lakes have pH 0.</p>
<p><strong>t-statistic for b_1</strong></p>
<p><span class="math inline">\(t=\frac{{b_j}}{\text{SE}(b_j)} = \frac{-0.15230}{0.03031} = -5.024\)</span></p>
<p>In our sample, the estimated change in mercury for each on unit change in pH is 5 standard errors less than we would expect it to be if there were no relationship between mercury and pH.</p>
</section>
<section id="prt-1" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="prt-1">Pr(&gt;|t|)</h4>
<p><strong>p-value for line intercept</strong></p>
<p>Since the null hypothesis on the intercept line is not a sensible one, we should not draw conclusions based on this p-value.</p>
<p><strong>p-value for line pH</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>ts<span class="ot">=</span><span class="fl">5.024</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_dist</span>(<span class="st">"t"</span>, <span class="at">df=</span><span class="dv">51</span>, <span class="at">geom =</span> <span class="st">"area"</span>, <span class="at">fill =</span> <span class="sc">~</span> (<span class="fu">abs</span>(x)<span class="sc">&lt;</span> <span class="fu">abs</span>(ts)), <span class="at">show.legend=</span><span class="cn">FALSE</span>) <span class="sc">+</span> <span class="fu">geom_vline</span>(<span class="at">xintercept=</span><span class="fu">c</span>(ts, <span class="sc">-</span>ts), <span class="at">color=</span><span class="st">"red"</span>)  <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"t"</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch4_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span><span class="sc">*</span><span class="fu">pt</span>(<span class="sc">-</span><span class="fu">abs</span>(ts), <span class="at">df=</span><span class="dv">51</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.000006578117</code></pre>
</div>
</div>
<p>The p-value is extremely small, providing strong evidence of a relationship between a lake’s pH and mercury content.</p>
</section>
<section id="comparison-to-simulation-1" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="comparison-to-simulation-1">Comparison to Simulation</h4>
<p>We compare this standard error estimate and confidence interval to the ones we would obtain via bootstrapping.</p>
<p><strong>Formula-Based 95% Confidence Interval for</strong> <span class="math inline">\(\beta_1\)</span>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(M_Lakes_merc_pH, <span class="at">parm=</span><span class="fu">c</span>(<span class="st">"pH"</span>), <span class="at">level=</span><span class="fl">0.95</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        2.5 %      97.5 %
pH -0.2131573 -0.09144445</code></pre>
</div>
</div>
<p><strong>Bootstrap 95% Confidence Interval for</strong> <span class="math inline">\(\beta_1\)</span>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>M_Lakes_merc_pH_Bootstrap <span class="ot">&lt;-</span> <span class="fu">do</span>(<span class="dv">10000</span>) <span class="sc">*</span> <span class="fu">lm</span>(Mercury <span class="sc">~</span>  pH, <span class="at">data =</span> <span class="fu">resample</span>(FloridaLakes))</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(M_Lakes_merc_pH_Bootstrap, <span class="at">parm =</span> <span class="fu">c</span>(<span class="st">"pH"</span>),</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">level =</span> <span class="fl">0.95</span>, <span class="at">method =</span> <span class="st">"se"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  name      lower      upper level method   estimate margin.of.error
1   pH -0.2049221 -0.1000458  0.95 stderr -0.1523009      0.05243817</code></pre>
</div>
</div>
<p><strong>p-value from t-distribution</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>ts<span class="ot">=</span><span class="fl">5.024</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_dist</span>(<span class="st">"t"</span>, <span class="at">df=</span><span class="dv">51</span>, <span class="at">geom =</span> <span class="st">"area"</span>, <span class="at">fill =</span> <span class="sc">~</span> (<span class="fu">abs</span>(x)<span class="sc">&lt;</span> <span class="fu">abs</span>(ts)), <span class="at">show.legend=</span><span class="cn">FALSE</span>) <span class="sc">+</span> <span class="fu">geom_vline</span>(<span class="at">xintercept=</span><span class="fu">c</span>(ts, <span class="sc">-</span>ts), <span class="at">color=</span><span class="st">"red"</span>)  <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"t"</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch4_files/figure-html/unnamed-chunk-48-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span><span class="sc">*</span><span class="fu">pt</span>(<span class="sc">-</span><span class="fu">abs</span>(ts), <span class="at">df=</span><span class="dv">51</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.000006578117</code></pre>
</div>
</div>
<p><strong>Permutation - based p-value</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>Lakes_merc_pH_perm_test_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch4_files/figure-html/unnamed-chunk-50-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">prop</span>(<span class="sc">~</span> (<span class="fu">abs</span>(pH) <span class="sc">&gt;</span> <span class="fl">0.15</span>), <span class="at">data =</span> Lakes_merc_pH_perm_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>prop_TRUE 
        0 </code></pre>
</div>
</div>
<p>The interval and p-value produced by the theory based methods are again very similar those we obtained via simulation and lead us to the same conclusions.</p>
</section>
</section>
<section id="single-mean" class="level3" data-number="4.3.3">
<h3 data-number="4.3.3" class="anchored" data-anchor-id="single-mean"><span class="header-section-number">4.3.3</span> Single Mean</h3>
<p>Now, we’ll look at a simple model in which we seek to estimate the mean mercury level among all lakes in Florida, based on the 53 lakes in our sample.</p>
<p>The regression model is:</p>
<p><span class="math display">\[
\text{Mercury} = \beta_0  + \epsilon_i, \text{where } \epsilon_i\sim\mathcal{N}(0, \sigma)
\]</span></p>
<p>This model assumes:</p>
<ol type="1">
<li><p><strong>Linearity</strong> - there is no linearity assumption since there are no explanatory variables.</p></li>
<li><p><strong>Constant Variance</strong> - there is no linearity assumption since there are no explanatory variables.</p></li>
<li><p><strong>Normality</strong> - mercury levels among all lakes in Florida are normally distributed.</p></li>
<li><p><strong>Independence</strong> - mercury levels of individual lakes are not affected by those of other lakes.</p></li>
</ol>
<p>The <code>lm</code> summary command in R returns information pertaining to the model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>M_Lakes_merc_0 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>FloridaLakes, Mercury <span class="sc">~</span> <span class="dv">1</span>)</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(M_Lakes_merc_0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Mercury ~ 1, data = FloridaLakes)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.48717 -0.25717 -0.04717  0.24283  0.80283 

Coefficients:
            Estimate Std. Error t value            Pr(&gt;|t|)    
(Intercept)  0.52717    0.04684   11.25 0.00000000000000151 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.341 on 52 degrees of freedom</code></pre>
</div>
</div>
<p>The model estimates that the average mercury level is 0.527, which matches the sample mean, as we know it should.</p>
<p>We’ll again go through the calculations in the model summary output.</p>
<p>We first calculate SST, which is equal to SSR for a model with no explanatory variables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>Mean_merc <span class="ot">&lt;-</span> <span class="fu">mean</span>(FloridaLakes<span class="sc">$</span>Mercury)</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>((FloridaLakes<span class="sc">$</span>Mercury<span class="sc">-</span>Mean_merc)<span class="sc">^</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6.047875</code></pre>
</div>
</div>
<section id="residual-standard-error-2" class="level4 unlabeled" data-number="4.3.3.1">
<h4 class="unlabeled anchored" data-number="4.3.3.1" data-anchor-id="residual-standard-error-2"><span class="header-section-number">4.3.3.1</span> Residual Standard Error</h4>
<p>Since there are no explanatory variables in this model, p=0.</p>
<p><span class="math display">\[ s =\sqrt{\frac{\text{SSR}}{n-(p+1)}}  = \sqrt{\frac{6.047875}{53-(1+0)}}=0.341\]</span></p>
<p>The degrees of freedom associated with this estimate is <span class="math inline">\(53-(1+0) = 51\)</span>.</p>
</section>
<section id="multiple-r-squared-2" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="multiple-r-squared-2">Multiple R-Squared</h4>
<p>Since there are no explanatory variables in the model, SSR=SST, so <span class="math inline">\(R^2=0\)</span>. Notice that <span class="math inline">\(R^2\)</span> is not given in the model summary.</p>
</section>
<section id="f-statistic-2" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="f-statistic-2">F-Statistic</h4>
<p>Since there are no explanatory variables in the model, SSR=SST, so <span class="math inline">\(F=0\)</span>. Notice that F is not given in the model summary.</p>
</section>
<section id="estimates-2" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="estimates-2">Estimates</h4>
<p><span class="math inline">\(b_0 = \bar{y} = 0.527\)</span></p>
<p>The mean mercury level among all lakes in Florida is 0.527 ppm.</p>
</section>
<section id="standard-errors-2" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="standard-errors-2">Standard Errors</h4>
<p><span class="math inline">\(\text{SE}(b_0) = \frac{s}{\sqrt{n}} =\frac{0.341}{\sqrt{53}} = 0.4684\)</span></p>
</section>
<section id="confidence-intervals-2" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="confidence-intervals-2">Confidence Intervals</h4>
<p>A 95% confidence interval for <span class="math inline">\(\beta_0\)</span> is</p>
<p><span class="math display">\[
\begin{aligned}
&amp; b_0 \pm 2\times\text{SE}(b_0) \\
&amp; = 0.527 \pm 2\times{0.0468} \\
&amp; = (0.43, 0.62)
\end{aligned}
\]</span> We are 95% confident that the mean mercury level among all lakes in Florida is between 0.43 and 0.62 parts per million.</p>
</section>
<section id="hypotheses-2" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="hypotheses-2">Hypotheses</h4>
<p>The null hypothesis on the line (Intercept) is that the average mercury level among all lakes in Florida is 0. We know this isn’t true, so there is no reason to perform the hypothesis test.</p>
</section>
<section id="t-value-2" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="t-value-2">t-value</h4>
<p><span class="math inline">\(t=\frac{b_0}{\text{SE}(b_0)} = \frac{0.527}{0.0468} = 11.25\)</span></p>
<p>The mean mercury level among the lakes in the sample is 11 standard errors higher than we would expect it to be if the mean mercury level among all lakes in the state were actually 0, but since we know that’s not the case, this is not a meaningful interpretation.</p>
</section>
<section id="prt-2" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="prt-2">Pr(&gt;|t|)</h4>
<p><strong>p-value for line (Intercept)</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span><span class="sc">*</span><span class="fu">pt</span>(<span class="sc">-</span><span class="fu">abs</span>(<span class="fl">11.25</span>), <span class="at">df=</span><span class="dv">52</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.000000000000001523657</code></pre>
</div>
</div>
<p>The p-value is extremely small, but it is not meaningful since the null hypothesis being tested in nonsensical.</p>
</section>
<section id="comparison-to-simulation-2" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="comparison-to-simulation-2">Comparison to Simulation</h4>
<p><strong>Formula-based confidence interval for mean mercury level</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(M_Lakes_merc_0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                2.5 %    97.5 %
(Intercept) 0.4331688 0.6211709</code></pre>
</div>
</div>
<p><strong>Bootstrap confidence interval for mean mercury level</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(Lakes_Bootstrap_Mean, <span class="at">level =</span> <span class="fl">0.95</span>, <span class="at">parm=</span> <span class="fu">c</span>(<span class="st">"Intercept"</span>), <span class="at">method =</span> <span class="st">"stderr"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       name     lower    upper level method  estimate margin.of.error
1 Intercept 0.4375052 0.617128  0.95 stderr 0.5271698      0.08981142</code></pre>
</div>
</div>
</section>
</section>
<section id="comparing-three-groups" class="level3" data-number="4.3.4">
<h3 data-number="4.3.4" class="anchored" data-anchor-id="comparing-three-groups"><span class="header-section-number">4.3.4</span> Comparing Three Groups</h3>
<p>Now, we’ll look at a model comparing mercury levels between deep, medium, and shallow lakes.</p>
<p>The table shows the mean and standard deviation in mercury and number of lakes at each depth level.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(Lakes_merc_cond_Tab)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Depth</th>
<th style="text-align: right;">Mean_Hg</th>
<th style="text-align: right;">SD_Hg</th>
<th style="text-align: right;">N</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Deep</td>
<td style="text-align: right;">0.604</td>
<td style="text-align: right;">0.307</td>
<td style="text-align: right;">15</td>
</tr>
<tr class="even">
<td style="text-align: left;">Medium</td>
<td style="text-align: right;">0.591</td>
<td style="text-align: right;">0.429</td>
<td style="text-align: right;">16</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Shallow</td>
<td style="text-align: right;">0.428</td>
<td style="text-align: right;">0.276</td>
<td style="text-align: right;">22</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Note that the standard deviations within each group are pretty similar. This suggests that the constant variance model assumption appears reasonable, so the R <code>lm</code> summary output, which uses a pooled standard deviation estimate should be reliable.</p>
<p>The model equation is:</p>
<p><span class="math display">\[
\widehat{\text{Mercury}} = b_0 + b_1\times\text{DepthMedium} + b_2\times\text{DepthShallow}
\]</span></p>
<p>The model summary output is shown below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>M_Lakes_merc_depth <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>FloridaLakes, Mercury<span class="sc">~</span>Depth)</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(M_Lakes_merc_depth)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Mercury ~ Depth, data = FloridaLakes)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.55125 -0.24818 -0.08818  0.23875  0.72600 

Coefficients:
             Estimate Std. Error t value     Pr(&gt;|t|)    
(Intercept)   0.60400    0.08701   6.942 0.0000000074 ***
DepthMedium  -0.01275    0.12111  -0.105        0.917    
DepthShallow -0.17582    0.11284  -1.558        0.126    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.337 on 50 degrees of freedom
Multiple R-squared:  0.06115,   Adjusted R-squared:  0.02359 
F-statistic: 1.628 on 2 and 50 DF,  p-value: 0.2065</code></pre>
</div>
</div>
<p>SSR is</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(M_Lakes_merc_depth<span class="sc">$</span>residuals<span class="sc">^</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5.678062</code></pre>
</div>
</div>
<p>SST is</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>Mean_merc <span class="ot">&lt;-</span> <span class="fu">mean</span>(FloridaLakes<span class="sc">$</span>Mercury)</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>((FloridaLakes<span class="sc">$</span>Mercury <span class="sc">-</span> Mean_merc)<span class="sc">^</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6.047875</code></pre>
</div>
</div>
<section id="residual-standard-error-3" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="residual-standard-error-3">Residual Standard Error</h4>
<p>Since there are 2 explanatory variables in this model (DepthMedium and DepthShallow), p=2.</p>
<p><span class="math display">\[ s =\sqrt{\frac{\text{SSR}}{n-(p+1)}}  = \sqrt{\frac{5.678062}{53-(1+2)}}=0.337\]</span></p>
</section>
<section id="multiple-r-squared-3" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="multiple-r-squared-3">Multiple R-Squared</h4>
<p><span class="math inline">\(R^2 = \frac{6.047875 - 5.678062}{6.047875} =0.06115\)</span></p>
<p>6% of the total variation in mercury level is explained by depth.</p>
</section>
<section id="f-statistic-3" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="f-statistic-3">F-Statistic</h4>
<p><span class="math display">\[ F=\frac{\frac{SST - SSR}{p}}{\frac{SSR}{n-(p+1)}} = \frac{\frac{6.047875 - 5.678062}{2}}{\frac{5.678062}{53-(1+2)}} = 1.628 \]</span></p>
</section>
<section id="p-value-for-f-statistic-1" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="p-value-for-f-statistic-1">p-value for F-Statistic</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_dist</span>(<span class="st">"f"</span>, <span class="at">df1=</span><span class="dv">2</span>, <span class="at">df2=</span><span class="dv">50</span>, <span class="at">geom =</span> <span class="st">"area"</span>, <span class="at">fill =</span> <span class="sc">~</span> (x <span class="sc">&lt;</span> <span class="fl">1.628</span>), <span class="at">show.legend=</span><span class="cn">FALSE</span>) <span class="sc">+</span> <span class="fu">geom_vline</span>(<span class="at">xintercept=</span><span class="fl">1.628</span>, <span class="at">color=</span><span class="st">"red"</span>)  <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"F"</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">xlim</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">5</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch4_files/figure-html/unnamed-chunk-61-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> <span class="fu">pf</span>(<span class="fl">1.628</span>, <span class="at">df1=</span><span class="dv">2</span>, <span class="at">df2=</span><span class="dv">50</span>) <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2066</code></pre>
</div>
</div>
<p>The large p-value tells us we do not have enough evidence to conclude that a model accounting for depth better explains variability in mercury level than one that does not, implying we don’t have enough evidence to conclude that average mercury level differs between shallow, medium, and deep lakes.</p>
</section>
<section id="estimates-3" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="estimates-3">Estimates</h4>
<p><span class="math inline">\(b_0 = 0.604\)</span> - the average mercury content in deep lakes in Florida is 0.604 ppm.</p>
<p><span class="math inline">\(b_1 = 0.013\)</span> - the average mercury content in medium lakes in Florida is 0.013 ppm less than in deep lakes.</p>
<p><span class="math inline">\(b_2 = 0.18\)</span> - the average mercury content in shallow lakes in Florida is 0.18 ppm less than in deep lakes.</p>
</section>
<section id="standard-errors-3" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="standard-errors-3">Standard Errors</h4>
<p><span class="math inline">\(SE(b_0)=\frac{s}{\sqrt{n_\text{Deep}}} = \frac{0.604}{\sqrt{15}} \approx 0.087\)</span></p>
<p><span class="math inline">\(SE(b_1)=s\sqrt{\frac{1}{\text{Deep}}+\frac{1}{\text{Medium}}} = 0.317\sqrt{\frac{1}{15}+\frac{1}{16}} = 0.1211\)</span></p>
<p><span class="math inline">\(SE(b_2)=s\sqrt{\frac{1}{\text{Deep}}+\frac{1}{\text{Shallow}}} = 0.317\sqrt{\frac{1}{15}+\frac{1}{22}} = 0.1128\)</span></p>
</section>
<section id="confidence-intervals-3" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="confidence-intervals-3">Confidence Intervals</h4>
<p>We can use these standard errors to calculate 95% confidence intervals for <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>.</p>
<p>A 95% confidence interval for <span class="math inline">\(\beta_0\)</span> is given by</p>
<p><span class="math display">\[
\begin{aligned}
&amp; b_0 \pm 2\times\text{SE}(b_0) \\
&amp; = -0.01275 \pm 2\times{0.087} \\
&amp; = (0.43, 0.78)
\end{aligned}
\]</span></p>
<p>We are 95% confident that the mean mercury level among all deep lakes in Florida is between 0.43 and 0.78 ppm.</p>
<p>A 95% confidence interval for <span class="math inline">\(\beta_1\)</span> is given by</p>
<p><span class="math display">\[
\begin{aligned}
&amp; b_1 \pm 2\times\text{SE}(b_1) \\
&amp; = -0.01275 \pm 2\times{0.1211} \\
&amp; = (-0.26, 0.23)
\end{aligned}
\]</span></p>
<p>We are 95% confident that the average mercury level in lakes of medium depth is between 0.26 ppm lower and 0.23 ppm higher than in deep lakes.</p>
<p>A 95% confidence interval for <span class="math inline">\(\beta_2\)</span> is given by</p>
<p><span class="math display">\[
\begin{aligned}
&amp; b_1 \pm 2\times\text{SE}(b_1) \\
&amp; = -0.17582 \pm 2\times{0.1128} \\
&amp; = (0.09, 0.45)
\end{aligned}
\]</span></p>
<p>We are 95% confident that the average mercury level in shallow lakes is between 0.40 ppm lower and 0.05 ppm higher than in deep lakes.</p>
<p>We confirm these intervals using the <code>confint</code> command.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(M_Lakes_merc_depth, <span class="at">level=</span><span class="fl">0.95</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                  2.5 %     97.5 %
(Intercept)   0.4292352 0.77876484
DepthMedium  -0.2560124 0.23051236
DepthShallow -0.4024618 0.05082548</code></pre>
</div>
</div>
</section>
<section id="hypotheses-3" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="hypotheses-3">Hypotheses</h4>
<p><strong>Hypothesis Test for line (intercept)</strong></p>
<p><strong>Null Hypothesis:</strong> The average mercury level among all deep lakes in Florida is 0 (<span class="math inline">\(\beta_0=0\)</span>).</p>
<p><strong>Alternative Hypothesis:</strong> The average mercury level among all deep lakes in Florida is not 0 (<span class="math inline">\(\beta_0\neq 0\)</span>).</p>
<p>We know the average mercury level is not 0, so there is no reason to do this hypothesis test.</p>
<p><strong>Hypothesis Test for line DepthMedium</strong></p>
<p><strong>Null Hypothesis:</strong> There is no difference in average mercury levels between deep and medium lakes in Florida (<span class="math inline">\(\beta_1=0\)</span>).</p>
<p><strong>Alternative Hypothesis:</strong> There is a difference in average mercury levels between deep and medium lakes in Florida (<span class="math inline">\(\beta_1\neq 0\)</span>).</p>
<p><strong>Hypothesis Test for line DepthShallow</strong></p>
<p><strong>Null Hypothesis:</strong> There is no difference in average mercury levels between shallow and deep lakes in Florida (<span class="math inline">\(\beta_2=0\)</span>).</p>
<p><strong>Alternative Hypothesis:</strong> There is a difference in average mercury levels between shallow and deep lakes in Florida (<span class="math inline">\(\beta_2\neq 0\)</span>).</p>
</section>
<section id="t-value-3" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="t-value-3">t-value</h4>
<p><strong>t-statistic for</strong> <span class="math inline">\(b_0\)</span>:</p>
<p><span class="math inline">\(t=\frac{{b_0}}{\text{SE}(b_0)} = \frac{0.60400}{0.08701} = 6.942\)</span></p>
<p>In our sample, the average mercury level among deep lakes in Florida is 6.9 standard errors higher than we would expect it to be if the average mercury level among all deep lakes in Florida is 0. Since we know that the mean mercury level among all deep lakes in Florida is not 0, this is not a meaningful interpretation.</p>
<p><strong>t-statistic for</strong> <span class="math inline">\(b_1\)</span>:</p>
<p><span class="math inline">\(t=\frac{{b_1}}{\text{SE}(b_1)} = \frac{-0.01275}{0.12111} = -0.105\)</span></p>
<p>In our sample, the average mercury level among all medium lakes in Florida is 0.1 standard errors lower than we would expect it to be if the there was really no difference in average mercury levels between deep and medium lakes in Florida. Equivalently, we could say that the mean mercury level among lakes in medium depth lakes is 0.1 standard errors lower than in deep lakes.</p>
<p><strong>t-statistic for</strong> <span class="math inline">\(b_2\)</span>:</p>
<p><span class="math inline">\(t=\frac{{b_2}}{\text{SE}(b_2)} = \frac{-0.17582}{0.11284} = -1.558\)</span></p>
<p>In our sample, the average mercury level among all shallow lakes in Florida is 1.56 standard errors lower than we would expect it to be if the there was really no difference in average mercury levels between deep and shallow lakes in Florida. Equivalently, we could say that the mean mercury level among lakes in shallow depth lakes is 1.56 standard errors lower than in deep lakes.</p>
</section>
<section id="prt-3" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="prt-3">Pr(&gt;|t|)</h4>
<p><strong>p-value for line (Intercept)</strong></p>
<p>We already know the average mercury level among all deep lakes in Florida is not 0, so this is a silly test and we won’t elaborate on it.</p>
<p><strong>p-value for line DepthMedium</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>ts<span class="ot">=</span><span class="sc">-</span><span class="fl">0.105</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_dist</span>(<span class="st">"t"</span>, <span class="at">df=</span><span class="dv">50</span>, <span class="at">geom =</span> <span class="st">"area"</span>, <span class="at">fill =</span> <span class="sc">~</span> (<span class="fu">abs</span>(x)<span class="sc">&lt;</span> <span class="fu">abs</span>(ts)), <span class="at">show.legend=</span><span class="cn">FALSE</span>) <span class="sc">+</span> <span class="fu">geom_vline</span>(<span class="at">xintercept=</span><span class="fu">c</span>(ts, <span class="sc">-</span>ts), <span class="at">color=</span><span class="st">"red"</span>)  <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"t"</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch4_files/figure-html/unnamed-chunk-64-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span><span class="sc">*</span><span class="fu">pt</span>(<span class="fl">0.105</span>, <span class="at">df=</span><span class="dv">50</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9167959</code></pre>
</div>
</div>
<p>The p-value is very large, indicating we have no evidence of differences between in average mercury level between deep and medium lakes.</p>
<p><strong>p-value for line DepthShallow</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>ts<span class="ot">=</span><span class="fl">1.558</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_dist</span>(<span class="st">"t"</span>, <span class="at">df=</span><span class="dv">50</span>, <span class="at">geom =</span> <span class="st">"area"</span>, <span class="at">fill =</span> <span class="sc">~</span> (<span class="fu">abs</span>(x)<span class="sc">&lt;</span> <span class="fu">abs</span>(ts)), <span class="at">show.legend=</span><span class="cn">FALSE</span>) <span class="sc">+</span> <span class="fu">geom_vline</span>(<span class="at">xintercept=</span><span class="fu">c</span>(ts, <span class="sc">-</span>ts), <span class="at">color=</span><span class="st">"red"</span>)  <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"t"</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch4_files/figure-html/unnamed-chunk-66-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span><span class="sc">*</span><span class="fu">pt</span>(<span class="fl">1.558</span>, <span class="at">df=</span><span class="dv">50</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.125541</code></pre>
</div>
</div>
<p>The p-value is too big to conclude that there is evidence of differences in mean mercury level between deep and shallow lakes.</p>
<p>We did observe an average difference of about 0.18 ppm, which could potentially be meaningful, but given the size in our sample and amount of variability in the data, we cannot rule out the possibility that this difference was just a result of which lakes got randomly selected for the study.</p>
</section>
<section id="pairwise-comparisons" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="pairwise-comparisons">Pairwise Comparisons</h4>
<p>The model summary output allows us to compare mercury levels in medium and deep lakes to shallow ones, but it does not directly compare shallow and medium lakes. The <code>pairs</code> function in the <code>emmeans</code> command performs t-tests for all pairs of a categorical variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emmeans)</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>M_Lakes_merc_depth <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>FloridaLakes, Mercury<span class="sc">~</span>Depth)</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>GroupMeans <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(M_Lakes_merc_depth, <span class="sc">~</span> Depth)</span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(GroupMeans, <span class="at">adjust =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> contrast         estimate    SE df t.ratio p.value
 Deep - Medium      0.0127 0.121 50   0.105  0.9166
 Deep - Shallow     0.1758 0.113 50   1.558  0.1255
 Medium - Shallow   0.1631 0.111 50   1.473  0.1471</code></pre>
</div>
</div>
<p>We see that the t-ratios and p-values for the first two lines match those in the <code>lm</code> output, and we also get a comparison for medium and shallow lakes.</p>
</section>
<section id="multiple-testing-error" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="multiple-testing-error">Multiple Testing Error</h4>
<p>In the previous table, we compared three groups simultaneously. Running multiple hypothesis tests at the same time increases the risk of a false positive - that is, detecting a difference when there actually isn’t one.</p>
<p>If we only ran one test and rejected the null hypothesis if the p-value is less than 0.05, then we would only have a 0.05 chance of rejecting the null hypothesis when it is actually true. If we run three tests though, and reject the null hypothesis for any test with a p-value less than 0.05, we will have a <span class="math inline">\(1 - 0.95^3 = 0.14\)</span> probability of rejecting a null hypothesis that is actually true. This problem gets worse the more tests we run, making it a big problem in areas like genomics, where hundreds of thousands of tests (or more) are run simultaneously.</p>
<p>One popular strategy for avoiding false positives when performing multiple tests is to simply multiple each p-value by the number of tests being run. This approach is called the <strong>Bonferroni Correction</strong>. In this case, since we are running three tests, instead of rejecting a null hypothesis when the p-value for the individual test is less than 0.05, we would need it to be less than <span class="math inline">\(0.05/3 = 0.0167\)</span>. This ensures that the probability of wrongly rejecting the null hypothesis in <em>any</em> of our tests remains 0.05. The downside to the <strong>Bonferroni Correction</strong> is that it is a conservative method and can prevent us from detecting differences that are actually there. Other, more advanced methods, have been suggested in specific situations to try to improve on Bonferroni’s approach and controlling multiple testing error remains an active area of research in statistics and biostatistics.</p>
<p>In R, we can implement the Bonferroni correction using <code>adjust="Bonferroni</code> in the <code>pairs</code> command.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emmeans)</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>M_Lakes_merc_depth <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>FloridaLakes, Mercury<span class="sc">~</span>Depth)</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>GroupMeans <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(M_Lakes_merc_depth, <span class="sc">~</span> Depth)</span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(GroupMeans, <span class="at">adjust =</span> <span class="st">"Bonferroni"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> contrast         estimate    SE df t.ratio p.value
 Deep - Medium      0.0127 0.121 50   0.105  1.0000
 Deep - Shallow     0.1758 0.113 50   1.558  0.3765
 Medium - Shallow   0.1631 0.111 50   1.473  0.4412

P value adjustment: bonferroni method for 3 tests </code></pre>
</div>
</div>
<p>Notice that the p-values are tripled. In this case, we did not have evidence of differences between shallow, medium, and deep lakes even without using the Bonferroni correction, but the evidence grows even weaker after we apply the correction.<br>
This finding is consistent with the F-test we performed on the entire model, which did not suggest evidence of differences in mercury levels between the three different depths of lakes.</p>
<!--

### Interaction Example (Move to chapter 5)

We can also use an F-test to compare a model predicting house prices with an interaction term to one without one.

Reduced Model: $\text{Price}= \beta_0+ \beta_1 \times\text{sqft\_living} + \beta_2\times\text{Waterfront} + \epsilon_i , \text{ where } \epsilon_i\sim\mathcal{N}(0, \sigma)$

Full Model: $\text{Price}= \beta_0+ \beta_1 \times\text{sqft\_living}+ \beta_2\times\text{Waterfront} + \beta_3\times\text{sqft\_living}\times\text{Waterfront} + \epsilon_i , \text{ where } \epsilon_i\sim\mathcal{N}(0, \sigma)$

$$
\begin{aligned}
F &= \frac{\frac{\text{SSR}_{\text{Reduced}}-\text{SSR}_{\text{Full}}}{p-q}}{\frac{\text{SSR}_{\text{Full}}}{n-(p+1)}} \\
&=\frac{\frac{16,521,296-10,139,974}{3-2}}{\frac{10,139,974}{100-(3+1)}} \\
\end{aligned}
$$

::: {.cell}

```{.r .cell-code}
#((SSR_wf_sqft-SSR_int)/(3-2))/((SSR_int)/(100-(3+1)))
```
:::

::: {.cell}

```{.r .cell-code}
ts=60.41505
gf_dist("f", df1=1, df2=96, geom = "area", fill = ~ (abs(x)>! abs(ts)), show.legend=FALSE) + geom_vline(xintercept=c(ts), color="red")  + xlab("F")
```

::: {.cell-output-display}
![](Ch4_files/figure-html/unnamed-chunk-71-1.png){width=768}
:::
:::

**p-value:**

::: {.cell}

```{.r .cell-code}
1-pf(ts, df1=1, df2=96)
```

::: {.cell-output .cell-output-stdout}

```
[1] 0.000000000008572476
```


:::
:::

The probability-based F-test is used in the `anova` command.

::: {.cell}

```{.r .cell-code}
M_wf_SqFt <- lm(data=Houses, price~sqft_living + waterfront)
M_House_Int <- lm(data=Houses, price~sqft_living * waterfront)
anova(M_wf_SqFt, M_House_Int)
```

::: {.cell-output .cell-output-stdout}

```
Analysis of Variance Table

Model 1: price ~ sqft_living + waterfront
Model 2: price ~ sqft_living * waterfront
  Res.Df      RSS Df Sum of Sq      F        Pr(>F)    
1    197 23720774                                      
2    196 20429024  1   3291749 31.582 0.00000006502 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
```


:::
:::

Since the p-value is small, we have enough evidence to say that there is evidence of an interaction between size and whether or not the house is on the waterfront.

Notice that this p-value is identical to the one we obtained in the previous section, using the t-test for interaction associated with the `lm` command.

-->
<div style="page-break-after: always;"></div>
</section>
</section>
</section>
<section id="confidence-and-prediction-intervals" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="confidence-and-prediction-intervals"><span class="header-section-number">4.4</span> Confidence and Prediction Intervals</h2>
<section id="intervals-for-expected-response" class="level3" data-number="4.4.1">
<h3 data-number="4.4.1" class="anchored" data-anchor-id="intervals-for-expected-response"><span class="header-section-number">4.4.1</span> Intervals for Expected Response</h3>
<p>In Chapter 3, we saw two different types of confidence intervals. One type was for regression parameters, <span class="math inline">\(\beta_0, \beta_1, \ldots, \beta_p\)</span>. For example, how much is a lake’s mercury level expected to change when its pH goes up by 1? The other type was for expected responses, which involved estimating linear functions of these parameters, for example <span class="math inline">\(\beta_0 + 7\beta_1\)</span>. For example, what is the expected mercury level among lakes with pH of 7?</p>
<p>We’ve seen how to calculate the first type of intervals using standard error formulas and the t-distribution. In this section, we’ll talk about the second kind of interval.</p>
</section>
<section id="estimation-and-prediction" class="level3" data-number="4.4.2">
<h3 data-number="4.4.2" class="anchored" data-anchor-id="estimation-and-prediction"><span class="header-section-number">4.4.2</span> Estimation and Prediction</h3>
<p>Think about the ice cream machine in Section 4.1. Suppose we did not know that the machine is manufactured to dispense 2 oz of ice cream per second, and had only the data on the 15 people, shown below.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch4_files/figure-html/unnamed-chunk-74-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Suppose we are asked the following two questions:</p>
<ol type="1">
<li>Give a range for the average amount of ice cream dispensed among people who hold the dispenser for 3 seconds.<br>
</li>
<li>Give a range for the amount of ice cream an individual person should expect to get if they hold the dispenser for 3 seconds.</li>
</ol>
<p>To answer the first question, we only need to estimate the location of the red line in the diagram below. Since we would only have sample data, the regression line estimated from our sample would not exactly match the “true” regression line relating time and amount dispensed, due to sampling variability. So we would need to include a margin of error accounting for uncertainty in the location of our estimated regression line.</p>
<p>When answering the second question, we would need to account for variability between individual people, in addition to sampling variability. Even if we knew the exact location of the red line, we would need to account for the fact that some people would get more ice cream than expected, and others less, even if they hold the dispenser for the same amount of time. Thus, we will need to create a wider interval that is able to capture 95% of all individuals.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="SLR_Pred_Int.png" class="img-fluid figure-img" style="width:75.0%"></p>
</figure>
</div>
</div>
</div>
<p>An interval for the expected response among all individuals with given value(s) of explanatory variable(s) is called a <strong>confidence interval</strong>.</p>
<p>An interval for an individual observation with given value(s) of explanatory variable(s) is called a <strong>prediction interval</strong>.</p>
<p>A confidence interval only needs to account for uncertainty associated with sampling variability. A prediction interval needs to account for uncertainty associated with sampling variability and variability between individuals, hence it needs to be wider than a confidence interval.</p>
</section>
<section id="calculating-confidence-intervals" class="level3" data-number="4.4.3">
<h3 data-number="4.4.3" class="anchored" data-anchor-id="calculating-confidence-intervals"><span class="header-section-number">4.4.3</span> Calculating Confidence Intervals</h3>
<p>An estimate for the expected among of ice cream when a person holds the dispenser for three seconds is <span class="math inline">\(b_0 + 3b_1\)</span>. In our model, we estimated <span class="math inline">\(b_0\)</span> = -0.32 and <span class="math inline">\(b_1\)</span> = 2.06, so the estimated amount of ice cream is <span class="math display">\[-0.32+ 3\times2.06 = 5.87\]</span> oz.</p>
<p>In order to calculate a 95% confidence interval using the standard error formula in Section 4.2, we’ll need the following quantities:</p>
<p>SSR:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>((IC_Model)<span class="sc">$</span>residuals<span class="sc">^</span><span class="dv">2</span>) <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 10.66</code></pre>
</div>
</div>
<p><span class="math inline">\(\bar{x}\)</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(Icecream<span class="sc">$</span>time) <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.37</code></pre>
</div>
</div>
<p><span class="math inline">\(\displaystyle\sum(x_i-\bar{x})^2\)</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>((Icecream1<span class="sc">$</span>time <span class="sc">-</span> <span class="fu">mean</span>(Icecream1<span class="sc">$</span>time))<span class="sc">^</span><span class="dv">2</span>) <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 8.03</code></pre>
</div>
</div>
<p>We begin by calculating the residual standard error <span class="math inline">\(s\)</span>.</p>
<p><span class="math display">\[
s=\sqrt\frac{{SSR}}{n-(p+1)} = \sqrt{\frac{10.66}{15-(1+1)}} = 0.91
\]</span></p>
<p>A 95% confidence interval for the average amount of ice cream dispensed only needs to account for the amount of uncertainty associated with using <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span>, which are calculated from our sample to estimate the true, typically unknown, regression coefficients <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>.</p>
<p>95% confidence interval for the average amount of ice cream dispensed when the dispenser is held for three seconds is</p>
<p><span class="math display">\[
\begin{aligned}
&amp; b_0 + 3 b_1 \pm 2 \times \text{SE}(b_0 + 3b_1) \\
&amp; = b_0 + 3 b_1 \pm 2s\sqrt{\frac{1}{n}+ \frac{(x^*-\bar{x})^2}{\displaystyle\sum_{i=1}^n(x_i-\bar{x})^2}}  \\
&amp; = -0.32 + 2.06 \pm 20.91 \sqrt{\frac{1}{15}+ \frac{(3-3.37)^2}{8.03}} \\
&amp; = (5.3322,  6.3878)
\end{aligned}
\]</span></p>
<p>This interval can be calculated using the <code>predict</code> command in R, entering the desired time in the <code>newdata</code> argument, and specifying <code>interval=confidence</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(IC_Model, <span class="at">newdata=</span><span class="fu">data.frame</span>(<span class="at">time=</span><span class="dv">3</span>), <span class="at">interval =</span> <span class="st">"confidence"</span>, <span class="at">level=</span><span class="fl">0.95</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       fit      lwr      upr
1 5.865178 5.298168 6.432188</code></pre>
</div>
</div>
<p>We are 95% confident that the average amount of ice cream dispensed when the dispenser is held for 3 seconds is between 5.3 and 6.4 oz.</p>
<p>Note there are small differences in the calculation, due to rounding and technicalities. R actually uses a number slightly different than 2 in its calculation, but the results are similar and these are all approximations anyway.</p>
<p>The plot shows 95% the estimated regression line from our sample (in blue), along with “true” regression line in read (which we wouldn’t know in a real situation). The shaded gray area represents a 95% confidence interval for the average amount of ice cream dispensed for a given amount of time the dispenser is held.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch4_files/figure-html/unnamed-chunk-81-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="calculating-prediction-interval" class="level3" data-number="4.4.4">
<h3 data-number="4.4.4" class="anchored" data-anchor-id="calculating-prediction-interval"><span class="header-section-number">4.4.4</span> Calculating Prediction Interval</h3>
<p>When calculating an interval for the amount of ice cream an individual person receives, we need to account for variability between individual people in addition to variability associated with using <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span> to estimate <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>.</p>
<p>The residual standard error <span class="math inline">\(s\)</span> represents variability in ice cream amount between individuals who hold the dispenser for the same amount of time. So essentially, we need to add an extra <span class="math inline">\(s\)</span> into our calculation to account for variability between individuals.</p>
<p>A good first idea might be to add <span class="math inline">\(s\)</span> to <span class="math inline">\(\text{SE}(b_0 + 3b_1)\)</span> when calculating the margin of error needed for the prediction interval. It turns out that probability theory tells us that adding standard deviations isn’t a good idea. But instead, we can add the variances, which are the squares of the standard deviations. So, we’ll add <span class="math inline">\((\text{SE}(b_0 + 3b_1))^2+s^2\)</span>, when calculating the margin of error for the prediction interval, and then take the square root to get back to the scale of oz., rather than oz.<span class="math inline">\(^2\)</span>.</p>
<p>Thus, a 95% prediction interval for the amount of ice cream an individual person should expect to receive when holding the dispenser for 3 seconds is</p>
<p><span class="math display">\[
\begin{aligned}
&amp; b_0+3b_1 \pm 2\sqrt{(\text{SE}(b_0 + 3b_1))^2 + s^2} \\
&amp; b_0 + 3b_1 \pm 2 \sqrt{s^2\left(\frac{1}{n}+ \frac{(x^*-\bar{x})^2}{\displaystyle\sum_{i=1}^n(x_i-\bar{x})^2}\right) + s^2} \\
&amp;  \\
&amp; b_0 + 3b_1 \pm 2 s\sqrt{\left(\frac{1}{n}+ \frac{(x^*-\bar{x})^2}{\displaystyle\sum_{i=1}^n(x_i-\bar{x})^2}\right) + 1} \\
&amp;  = -0.32 + 2.06 \pm 20.91 \sqrt{\frac{1}{15}+ \frac{(3-3.37)^2}{8.03}+1} \\
&amp; = (5.314,  7.68)
\end{aligned}
\]</span></p>
<p>While the calculation itself might look intimidating, the key intuition here is to note the extra <span class="math inline">\(s^2\)</span> being added under the square root, which accounts for the variability in amount dispensed between people who hold the dispenser for the same amount of time.</p>
<p>To perform the calculation in R, we simply change <code>interval="confidence"</code> to <code>interval="prediction"</code> in the <code>predict</code> command.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(IC_Model, <span class="at">newdata=</span><span class="fu">data.frame</span>(<span class="at">time=</span><span class="dv">3</span>), <span class="at">interval =</span> <span class="st">"prediction"</span>, <span class="at">level=</span><span class="fl">0.95</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       fit      lwr      upr
1 5.865178 3.828578 7.901778</code></pre>
</div>
</div>
<p>We are 95% confident that in individual who holds the dispenser for 3 seconds will get between 3.83 and 7.9 oz of ice cream.</p>
<p>We add the red line, displaying prediction intervals for the amount of ice cream an individual person is expected to receive for a given amount of time holding the dispenser. Notice that the prediction intervals are considerably wider than the confidence intervals for the average amount, due to variability between individuals.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch4_files/figure-html/unnamed-chunk-83-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="mercury-and-ph-in-florida-lakes" class="level3" data-number="4.4.5">
<h3 data-number="4.4.5" class="anchored" data-anchor-id="mercury-and-ph-in-florida-lakes"><span class="header-section-number">4.4.5</span> Mercury and pH in Florida Lakes</h3>
<p>We’ll calculate a confidence interval for the average mercury content among all Florida lakes with pH of 7 and for the mercury content of an individual lake with pH of 7.</p>
<p>These could be done using the same formulas as above, but we’ll calculate them using the <code>predict</code> command in R.</p>
<p>First, we fit the model in R.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>Lakes_M_merc_pH <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>FloridaLakes, Mercury<span class="sc">~</span>pH)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Confidence Interval</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(Lakes_M_merc_pH, <span class="at">newdata=</span><span class="fu">data.frame</span>(<span class="at">pH=</span><span class="dv">7</span>), <span class="at">interval=</span><span class="st">"confidence"</span>, <span class="at">level=</span><span class="fl">0.95</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        fit       lwr       upr
1 0.4648127 0.3832466 0.5463788</code></pre>
</div>
</div>
<p>We are 95% confident that the average mercury level among all Florida lakes with pH of 7 is between 0.38 and 0.55 ppm.</p>
<p><strong>Prediction Interval</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(Lakes_M_merc_pH, <span class="at">newdata=</span><span class="fu">data.frame</span>(<span class="at">pH=</span><span class="dv">7</span>), <span class="at">interval=</span><span class="st">"prediction"</span>, <span class="at">level=</span><span class="fl">0.95</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        fit        lwr      upr
1 0.4648127 -0.1064657 1.036091</code></pre>
</div>
</div>
<p>We are 95% confident that the mercury level for an individual lake in Florida with pH of 7 is between -0.11 and 1.04 ppm.</p>
<p>This interval is very wide, and a bit nonsensical, since mercury content can’t be negative, but we can say that we are confident such a lake will have mercury content below 1.04 ppm.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>temp_var <span class="ot">&lt;-</span> <span class="fu">predict</span>(M_Lakes_merc_pH, <span class="at">interval=</span><span class="st">"prediction"</span>)</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>new_df <span class="ot">&lt;-</span> <span class="fu">cbind</span>(FloridaLakes, temp_var)</span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>new_df, <span class="fu">aes</span>(<span class="at">x=</span>pH, <span class="at">y=</span>Mercury)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"pH"</span>,</span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">y=</span><span class="st">"Amount"</span>) <span class="sc">+</span> <span class="fu">stat_smooth</span>(<span class="at">method=</span>lm, <span class="at">se=</span><span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span>lwr), <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span>upr), <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch4_files/figure-html/unnamed-chunk-87-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="mercury-in-northern-and-southern-lakes" class="level3" data-number="4.4.6">
<h3 data-number="4.4.6" class="anchored" data-anchor-id="mercury-in-northern-and-southern-lakes"><span class="header-section-number">4.4.6</span> Mercury in Northern and Southern Lakes</h3>
<p>We can also calculate confidence and prediction intervals when the explanatory variable is categorical. Here we’ll calcuate confidence intervals for the mean mercury content among all lakes in Northern and Southern Florida, as well as prediction intervals for individual lakes in these regions.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>M_Lakes_merc_loc <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>FloridaLakes, Mercury <span class="sc">~</span> Location)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Confidence Intervals</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(M_Lakes_merc_loc, <span class="at">newdata=</span><span class="fu">data.frame</span>(<span class="at">Location=</span><span class="fu">c</span>(<span class="st">"N"</span>, <span class="st">"S"</span>)), <span class="at">interval=</span><span class="st">"confidence"</span>, <span class="at">level=</span><span class="fl">0.95</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        fit       lwr       upr
1 0.4245455 0.3137408 0.5353501
2 0.6965000 0.5541689 0.8388311</code></pre>
</div>
</div>
<p>We are 95% confident that the mean mercury level in North Florida is between 0.31 and 0.54 ppm.<br>
</p>
<p>We are 95% confident that the mean mercury level in South Florida is between 0.55 and 0.84 ppm.<br>
</p>
<p>These are confidence intervals for <span class="math inline">\(\beta_0\)</span>, and <span class="math inline">\(\beta_0 + \beta_1\)</span>, respectively.</p>
<p><strong>Prediction Intervals</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(M_Lakes_merc_loc, <span class="at">newdata=</span><span class="fu">data.frame</span>(<span class="at">Location=</span><span class="fu">c</span>(<span class="st">"N"</span>, <span class="st">"S"</span>)), <span class="at">interval=</span><span class="st">"prediction"</span>, <span class="at">level=</span><span class="fl">0.95</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        fit         lwr      upr
1 0.4245455 -0.22155101 1.070642
2 0.6965000  0.04425685 1.348743</code></pre>
</div>
</div>
<p>We are 95% confident that an individual lake in North Florida will have mercury level between 0 and 1.07 ppm.</p>
<p>We are 95% confident that an individual lake in South Florida will have mercury level between 0.04 and 1.35 ppm.</p>
<p>Confidence intervals for the mean are shown in blue, and prediction intervals for individual lakes in red, for each part of the state.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>temp_var <span class="ot">&lt;-</span> <span class="fu">predict</span>(M_Lakes_merc_loc, <span class="at">interval=</span><span class="st">"prediction"</span>)</span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>new_df <span class="ot">&lt;-</span> <span class="fu">cbind</span>(FloridaLakes, temp_var)</span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>new_df, <span class="fu">aes</span>(<span class="at">x=</span>Location, <span class="at">y=</span>Mercury)) <span class="sc">+</span> <span class="fu">geom_jitter</span>(<span class="at">width=</span><span class="fl">0.2</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Location"</span>,</span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">y=</span><span class="st">"Amount"</span>) <span class="sc">+</span> <span class="fu">stat_smooth</span>(<span class="at">method=</span>lm, <span class="at">se=</span><span class="cn">TRUE</span>)  <span class="sc">+</span></span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="st">"N"</span>, <span class="at">ymin=</span><span class="dv">0</span>, <span class="at">ymax=</span><span class="fl">1.07</span>), <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="st">"S"</span>, <span class="at">ymin=</span><span class="fl">0.04</span>, <span class="at">ymax=</span><span class="fl">1.35</span>), <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb114-7"><a href="#cb114-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="st">"N"</span>, <span class="at">ymin=</span><span class="fl">0.31</span>, <span class="at">ymax=</span><span class="fl">0.54</span>), <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb114-8"><a href="#cb114-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="st">"S"</span>, <span class="at">ymin=</span><span class="fl">0.55</span>, <span class="at">ymax=</span><span class="fl">0.84</span>), <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span> <span class="fu">geom_jitter</span>(<span class="at">width=</span><span class="fl">0.2</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Location"</span>,</span>
<span id="cb114-9"><a href="#cb114-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">y=</span><span class="st">"Amount"</span>) <span class="sc">+</span> <span class="fu">stat_smooth</span>(<span class="at">method=</span>lm, <span class="at">se=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch4_files/figure-html/unnamed-chunk-91-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<div style="page-break-after: always;"></div>
</section>
</section>
<section id="the-regression-effect" class="level2" data-number="4.5">
<h2 data-number="4.5" class="anchored" data-anchor-id="the-regression-effect"><span class="header-section-number">4.5</span> The Regression Effect</h2>
<section id="the-regression-effect-1" class="level3" data-number="4.5.1">
<h3 data-number="4.5.1" class="anchored" data-anchor-id="the-regression-effect-1"><span class="header-section-number">4.5.1</span> The Regression Effect</h3>
<p>You might be wondering how regression gets its name. It comes from a well known phenomenon, known as “regression to the mean”, or the “regression effect”. While the word “regression” is often construed with a negative context (i.e.&nbsp;getting worse), it could also refer to movement in the positive direction.</p>
<p>The scatterplot below shows student scores on two exams given in an introductory statistics class at another college. The data are part of the <code>Lock5Data</code> package.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch4_files/figure-html/unnamed-chunk-92-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<p>The blue line represents the least squares regression line. The black line represents the line <span class="math inline">\(y=x\)</span>. A student who scored exactly the same on both exams would lie on the black line.</p>
<p>We do see a positive relationship between the exam scores, as we would expect. On average students who scored higher on the first exam also did on the second one. If we look deeper, however, we notice some interesting results.</p>
<ul>
<li><p>There were 6 students who scored below a 70 on the first exam. Of these, 5 improved their score on the second exam (as indicated by the fact that they lie above the black line).</p></li>
<li><p>There were 7 students who scored a 90 or above on the first exam. Of these, only 2 improved on the second exam.</p></li>
</ul>
<p>At first glance, a professor might think that the students who struggled on the first exam had begun studying harder, strengthened their understanding of the material, and thus improved on the second exam. Meanwhile, the professor might conclude that the students who had done well on the first exam had gotten lazy and not prepared or learned the material as well for the second exam. While these explanations may be true, there is another explanation we should consider here.</p>
<p>We can think of a student’s score on an exam as being a combination of their skill (or understanding) and luck. A certain with a strong understanding of the material will certainly be better positioned to score higher than a student with a weak understanding. Still, there are other factors that will affect an exam score, such as how the person is feeling on the day of the exam, or which questions are on the exam.</p>
<p>A student who scores very high on the first exam likely knew the material well, and also experienced some good luck. Perhaps they got a good night’s sleep before the exam and the questions that were on the test were over the topics they knew best. If the student keeps studying and preparing just as well for the second exam, we would expect their skill level and understanding of the material to be just as good, but they may still see a slip in their score if their luck doesn’t hold up as well. Perhaps they aren’t feeling as well during the exam, or the professor happens to choose an exam question on their least favorite topic. Conversely, a student who scores very low on the first exam likely had a low understanding of the material and also experienced some bad luck. Unless they take action to improve their work in the class, it is unlikely that their level of understanding will be any better on the second exam, but their score may still improve if they get even average luck.</p>
</section>
<section id="simulating-test-scores" class="level3" data-number="4.5.2">
<h3 data-number="4.5.2" class="anchored" data-anchor-id="simulating-test-scores"><span class="header-section-number">4.5.2</span> Simulating Test Scores</h3>
<p>We’ll conduct a simulation of the test scores under the assumption that a student’s score is a combination of skill and luck. We’ll assume there are 25 students in a class, and that the students’ levels of understanding are normally distributed with an average understanding equivalent to a score of 80 on the exam. We’ll assume that the standard deviation in understanding level between students is 10. We’ll also assume that each student’s score on the exam will deviate from their actual level of understanding in accordance with a normal distribution with standard deviation 5. (This means that most students will score within <span class="math inline">\(\pm10\)</span>) points of their true level of understanding. <strong>We’ll assume that all of the students have the same level of understanding for both exams (none get any stronger or weaker), but that their luck might differ between the exams.</strong></p>
<p>The figure below shows each student’s simulated scores. The number on the diagram represents their actual level of understanding. For example, the top center student understood the material well enough to merit an 83 on both exams, but actually scored a 79 on the first exam and a 95 on the second exam, due to somewhat poor luck on the first, and very good luck on the second.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">110322018</span>)</span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>Understanding <span class="ot">&lt;-</span><span class="fu">rnorm</span>(<span class="dv">25</span>, <span class="dv">80</span>, <span class="dv">10</span>)</span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a>Score1 <span class="ot">&lt;-</span> Understanding <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">25</span>, <span class="dv">0</span>, <span class="dv">5</span>)</span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a>Score2 <span class="ot">&lt;-</span> Understanding <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">25</span>, <span class="dv">0</span>, <span class="dv">5</span>)</span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a>Understanding <span class="ot">&lt;-</span> <span class="fu">round</span>(Understanding,<span class="dv">0</span>)</span>
<span id="cb115-6"><a href="#cb115-6" aria-hidden="true" tabindex="-1"></a>TestSim <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(Understanding, Score1, Score2)</span>
<span id="cb115-7"><a href="#cb115-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>TestSim, <span class="fu">aes</span>(<span class="at">y=</span>Score2, <span class="at">x=</span>Score1))<span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">stat_smooth</span>(<span class="at">method=</span><span class="st">"lm"</span>, <span class="at">se=</span><span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb115-8"><a href="#cb115-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope=</span><span class="dv">1</span>) <span class="sc">+</span> <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span>Understanding), <span class="at">vjust =</span> <span class="dv">0</span>, <span class="at">nudge_y =</span> <span class="fl">0.5</span>)  <span class="sc">+</span> <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch4_files/figure-html/unnamed-chunk-93-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<p>Notice that the behavior of the simulated scores mirrors those of the real ones we saw. Students who scored very low on the first exam tended to improve, and students who scored very high tended to drop off, <strong>even though this simulation was conducted under the assumption that their true level of understanding stayed the same!</strong></p>
<p>The regression effect says that people who achieve very high performance in one event are likely to see a decrease in their next one, not because they got any worse, but because the excellent performance was probably a combination of both skill and good luck. Even if the skill persists, they are unlikely to experience the same good luck again, and thus are more likely to deteriorate or “regress” to their true ability level. Conversely, those who achieved very poor performance likely experience both poor skill and bad luck, and even if they don’t get any better, their performance is bound to improve based on better luck alone. Thus, a person who achieves very high or low performance is likely to “regress” toward their true ability level in the next attempt. This is known as the <strong>regression effect</strong>, or <strong>regression to the mean.</strong></p>
</section>
<section id="nfl-wins" class="level3" data-number="4.5.3">
<h3 data-number="4.5.3" class="anchored" data-anchor-id="nfl-wins"><span class="header-section-number">4.5.3</span> NFL Wins</h3>
<p>The graphic plots the number of games won by each team in the National Football League in 2021 and 2022.</p>
<div class="cell" data-each="false">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch4_files/figure-html/unnamed-chunk-94-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<p>We see that among the teams that won 5 or fewer games in 2021 4 of the 5 improved the following year. Meanwhile, among the 7 teams that won 10 or more, only 2 improved, while one stayed the same.</p>
<p>While it may be the case that the weak teams got better and the good teams got worse, it is also possible that the teams that won fewer games in 2021 experienced some bad luck. Perhaps they had a lot of injuries, played difficult opponents, or had questionable calls that went against them. In that case, they may have won more games in 2022 simply because their luck wasn’t so bad. Likewise, the teams that did the best in 2021 may have been fortunate to stay healthy, play an easier schedule, or have calls go their way. They might see a decrease in wins the next year if their good luck reverts to being only average, even if they didn’t actually get any worse as a team. This is another example of the regression effect.</p>
</section>
<section id="pilot-training" class="level3" data-number="4.5.4">
<h3 data-number="4.5.4" class="anchored" data-anchor-id="pilot-training"><span class="header-section-number">4.5.4</span> Pilot Training</h3>
<p>A 1973 article by Kahneman, D. and Tversky, A., “On the Psychology of Prediction,” Pysch. Rev.&nbsp;80:237-251 describes an instance of the regression effect in the training of air force pilots.</p>
<p>Trainees were praised after performing well and criticized after performing badly. The flight instructors observed that “high praise for good execution of complex maneuvers typically results in a decrements of performance on the next try.”</p>
<p>Kahneman and Tversky write that :</p>
<p><em>“We normally reinforce others when their behavior is good and punish them when their behavior is bad. By regression alone, therefore, they [the trainees] are most likely to improve after being punished and most likely to deteriorate after being rewarded. Consequently, we are exposed to a lifetime schedule in which we are most often rewarded for punishing others, and punished for rewarding.”</em></p>
</section>
</section>
<section id="responsible-statistical-inference" class="level2" data-number="4.6">
<h2 data-number="4.6" class="anchored" data-anchor-id="responsible-statistical-inference"><span class="header-section-number">4.6</span> Responsible Statistical Inference</h2>
<p>While statistics offer insight that have lead to great advances in science, medicine, business and economics and many other areas, they have also been misused, (either intentionally or unintentionally) in ways that have resulted in harm. In an effort to better educate the public, the American Statistical Association released a report in 2016, highlighting common misuses of p-values, and the notion of statistical significance. Kenneth Rothman, Professor of Epidemiology at Boston University School of Public Health wrote:</p>
<ul>
<li>“(S)cientists have embraced and even avidly pursued meaningless differences solely because they are statistically significant, and have ignored important effects because they failed to pass the screen of statistical significance…It is a safe bet that people have suffered or died because scientists (and editors, regulators, journalists and others) have used significance tests to interpret results, and have consequently failed to identify the most beneficial courses of action.” -ASA statement on p-values, 2016</li>
</ul>
<p>In this section, we’ll look at some real scenarios where it might be tempting to make an improper conclusion based on data. Think carefully about each scenario and identify possible misinterpretations that might arise. Then think about what conclusions or actions would be appropriate in each scenario.</p>
<p>Keep in mind the following guidelines for responsible statistical inference.</p>
<p><strong>What a p-value tells us</strong></p>
<p>Performing responsible statistical inference requires understanding what p-values do and do not tell us, and how they should and should not be interpreted.</p>
<ul>
<li><p>A low p-value tells us that the data we observed are inconsistent with our null hypothesis or some assumption we make in our model.</p></li>
<li><p>A large p-value tells us that the data we observed could have plausibly been obtained under our supposed model and null hypothesis.</p></li>
<li><p>A p-value never provides evidence supporting the null hypothesis, it only tells us the strength of evidence against it.</p></li>
<li><p>A p-value is impacted by</p>
<ul>
<li>the size of the difference between group, or change per unit increase (effect size)<br>
</li>
<li>the amount of variability in the data<br>
</li>
<li>the sample size</li>
</ul></li>
<li><p>Sometimes, a p-value tells us more about sample size, than relationship we’re actually interested in.</p></li>
<li><p>A p-value does not tell us the “size” of a difference or effect, or whether it is practically meaningful.</p></li>
<li><p>We should only generalize results from a hypothesis test performed on a sample to a larger population or process if the sample is representative of the population or process (such as when the sample is randomly selected).</p></li>
<li><p>A correlation between two variables does not necessarily imply a causal relationship.</p></li>
</ul>
<section id="multiple-testing-error-1" class="level3" data-number="4.6.1">
<h3 data-number="4.6.1" class="anchored" data-anchor-id="multiple-testing-error-1"><span class="header-section-number">4.6.1</span> Multiple Testing Error</h3>
<p>In Section 4.3.4, we talked about the risk of detecting false positives when performing multiple hypothesis tests at the same time. We noted that this could be controlled using methods like the Bonferroni correction.</p>
<p>An obvious example of multiple testing error occurred in a <a href="https://www.newscientist.com/article/dn13754-breakfast-cereals-boost-chances-of-conceiving-boys/">2008 article by New Scientist</a> whose title made the surprising claim: “Breakfast cereals boost chances of conceiving boys.” Although the article lacks details on the underlying study, researchers, in fact, tracked the eating habits of women who were attempting to become pregnant. They tracked 133 different food items, and tested whether there was a difference in the proportion of baby boys conceived between women who ate the food, compared to those who didn’t. Of the 133 foods tested, only breakfast cereal showed a significant difference.</p>
<p>If none of the food items had any effect on the likelihood of a baby being born male, we should expect to obtain p-values less than 0.05 for <span class="math inline">\(0.05 \times 133 = 6.6\)</span> food items, just by chance. The probability of getting at least one p-value less than 0.05 is <span class="math inline">\(1-0.95^{133} = 99.9\%\)</span>. The link between sex at birth and the mother’s consumption of breakfast cereal was almost certainly one of these false positives, resulting from performing 133 tests simultaneously. This <a href="https://xkcd.com/882/">xkcd comic</a>? illustrates the faulty reasoning at play here.</p>
<p>It is important to use the Bonferroni correction, or some other kind of correction to control for false positives when performing multiple tests simultaneously.</p>
</section>
<section id="flights-from-new-york-to-chicago" class="level3" data-number="4.6.2">
<h3 data-number="4.6.2" class="anchored" data-anchor-id="flights-from-new-york-to-chicago"><span class="header-section-number">4.6.2</span> Flights from New York to Chicago</h3>
<p>A traveler lives in New York and wants to fly to Chicago. They consider flying out of two New York airports:</p>
<ul>
<li>Newark (EWR)<br>
</li>
<li>LaGuardia (LGA)</li>
</ul>
<p>We have data on the times of flights from both airports to Chicago’s O’Hare airport from 2013 (more than 14,000 flights).</p>
<p>Assuming these flights represent a random sample of all flights from these airports to Chicago, consider how the traveler might use this information to decide which airport to fly out of.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nycflights13)</span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(flights)</span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>flights<span class="sc">$</span>origin <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(flights<span class="sc">$</span>origin)</span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a>flights<span class="sc">$</span>dest <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(flights<span class="sc">$</span>dest)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We’ll create a dataset containing only flights from Newark and Laguardia to O’Hare, and only the variables we’re interested in.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>Flights_NY_CHI <span class="ot">&lt;-</span> flights <span class="sc">%&gt;%</span> </span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(origin <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"EWR"</span>, <span class="st">"LGA"</span>) <span class="sc">&amp;</span> dest <span class="sc">==</span><span class="st">"ORD"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(origin, dest, air_time)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The plot and table compare the duration of flights from New York to Chicago from each airport.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>Flights_NY_CHI, <span class="fu">aes</span>(<span class="at">x=</span>air_time, <span class="at">fill=</span>origin, <span class="at">color=</span>origin)) <span class="sc">+</span> <span class="fu">geom_density</span>(<span class="at">alpha=</span><span class="fl">0.2</span>) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"Flight Time"</span>)  <span class="sc">+</span> <span class="fu">theme_bw</span>()</span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>Flights_NY_CHI, <span class="fu">aes</span>(<span class="at">x=</span>air_time, <span class="at">y=</span>origin)) <span class="sc">+</span> <span class="fu">geom_boxplot</span>() <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"Flight Time"</span>)  <span class="sc">+</span> <span class="fu">theme_bw</span>()</span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(p1, p2, <span class="at">ncol=</span><span class="dv">2</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch4_files/figure-html/unnamed-chunk-97-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>T <span class="ot">&lt;-</span> Flights_NY_CHI <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(origin) <span class="sc">%&gt;%</span> </span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Mean_Airtime =</span> <span class="fu">mean</span>(air_time, <span class="at">na.rm=</span><span class="cn">TRUE</span>), </span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">SD =</span> <span class="fu">sd</span>(air_time, <span class="at">na.rm=</span><span class="cn">TRUE</span>), <span class="at">n=</span><span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(air_time)))</span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">origin</th>
<th style="text-align: right;">Mean_Airtime</th>
<th style="text-align: right;">SD</th>
<th style="text-align: right;">n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">EWR</td>
<td style="text-align: right;">113.2603</td>
<td style="text-align: right;">9.987122</td>
<td style="text-align: right;">5828</td>
</tr>
<tr class="even">
<td style="text-align: left;">LGA</td>
<td style="text-align: right;">115.7998</td>
<td style="text-align: right;">9.865270</td>
<td style="text-align: right;">8507</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>We fit a model to test whether there is evidence of a difference in average flight time.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>M_Flights <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>Flights_NY_CHI, air_time<span class="sc">~</span>origin)</span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(M_Flights)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = air_time ~ origin, data = Flights_NY_CHI)

Residuals:
   Min     1Q Median     3Q    Max 
-26.26  -7.26  -1.26   5.20  84.74 

Coefficients:
            Estimate Std. Error t value            Pr(&gt;|t|)    
(Intercept) 113.2603     0.1299  872.06 &lt;0.0000000000000002 ***
originLGA     2.5395     0.1686   15.06 &lt;0.0000000000000002 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 9.915 on 14333 degrees of freedom
  (622 observations deleted due to missingness)
Multiple R-squared:  0.01558,   Adjusted R-squared:  0.01551 
F-statistic: 226.9 on 1 and 14333 DF,  p-value: &lt; 0.00000000000000022</code></pre>
</div>
</div>
<p>Confidence Interval for Flights:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(M_Flights)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                2.5 %     97.5 %
(Intercept) 113.00572 113.514871
originLGA     2.20905   2.869984</code></pre>
</div>
</div>
<ul>
<li><p>Flights from LGA are estimated to take 2.5 minutes longer than flights from EWR on average.</p></li>
<li><p>The very low p-value provides strong evidence of a difference in mean flight time.</p></li>
<li><p>We are 95% confident that flights from LGA to ORD take between 2.2 and 2.9 minutes longer, on average, than flights from EWR to ORD.</p></li>
</ul>
<p>We obtained a small p-value, and thus a statistically discernible difference in mean flight time to Chicago between the two airports. And yet, the difference is very small (between 2-3 minutes). Most travelers would not make their decision on this basis, and would likely prioritize other factors, such as price and convenience. In this case, the small p-value is due to the fact that we have a very large sample size, rather than a meaningful difference in outcomes.</p>
</section>
<section id="smoking-and-birthweight-example" class="level3" data-number="4.6.3">
<h3 data-number="4.6.3" class="anchored" data-anchor-id="smoking-and-birthweight-example"><span class="header-section-number">4.6.3</span> Smoking and Birthweight Example</h3>
<p>We consider data on the relationship between a pregnant mother’s smoking and the birth weight of the baby. Data come from a sample of 80 babies born in North Carolina in 2004. Thirty of the mothers were smokers, and fifty were nonsmokers.</p>
<p>The plot and table show the distribution of birth weights among babies whose mothers smoked, compared to those who didn’t.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>NCBirths, <span class="fu">aes</span>(<span class="at">x=</span>weight, <span class="at">fill=</span>habit, <span class="at">color=</span>habit)) <span class="sc">+</span> <span class="fu">geom_density</span>(<span class="at">alpha=</span><span class="fl">0.2</span>) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"Birthweight and Smoking"</span>)  <span class="sc">+</span> <span class="fu">theme_bw</span>()</span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>NCBirths, <span class="fu">aes</span>(<span class="at">x=</span>weight, <span class="at">y=</span>habit)) <span class="sc">+</span> <span class="fu">geom_boxplot</span>() <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"Birthweight and Smoking"</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(p1, p2, <span class="at">ncol=</span><span class="dv">2</span>)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch4_files/figure-html/unnamed-chunk-102-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>T <span class="ot">&lt;-</span> NCBirths <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(habit) <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">Mean_Weight =</span> <span class="fu">mean</span>(weight), <span class="at">SD =</span> <span class="fu">sd</span>(weight), <span class="at">n=</span><span class="fu">n</span>())</span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">habit</th>
<th style="text-align: right;">Mean_Weight</th>
<th style="text-align: right;">SD</th>
<th style="text-align: right;">n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">nonsmoker</td>
<td style="text-align: right;">7.039200</td>
<td style="text-align: right;">1.709388</td>
<td style="text-align: right;">50</td>
</tr>
<tr class="even">
<td style="text-align: left;">smoker</td>
<td style="text-align: right;">6.616333</td>
<td style="text-align: right;">1.106418</td>
<td style="text-align: right;">30</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>We fit a model and test for differences in average birth weight.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>M_Birthwt <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>NCBirths, weight<span class="sc">~</span>habit)</span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(M_Birthwt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = weight ~ habit, data = NCBirths)

Residuals:
    Min      1Q  Median      3Q     Max 
-6.0392 -0.6763  0.2372  0.8280  2.4437 

Coefficients:
            Estimate Std. Error t value            Pr(&gt;|t|)    
(Intercept)   7.0392     0.2140   32.89 &lt;0.0000000000000002 ***
habitsmoker  -0.4229     0.3495   -1.21                0.23    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.514 on 78 degrees of freedom
Multiple R-squared:  0.01842,   Adjusted R-squared:  0.005834 
F-statistic: 1.464 on 1 and 78 DF,  p-value: 0.23</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(M_Birthwt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                2.5 %    97.5 %
(Intercept)  6.613070 7.4653303
habitsmoker -1.118735 0.2730012</code></pre>
</div>
</div>
<ul>
<li><p>The average birth weight of babies whose mothers are smokers is estimated to be about 0.42 lbs less than the average birthweight for babies whose mothers are nonsmokers.</p></li>
<li><p>The large p-value of 0.23, tells us that there is not enough evidence to say that a mother’s smoking is associated with lower birth weights. It is plausible that this difference could have occurred by chance.</p></li>
<li><p>We are 95% confident that the average birtweight of babies whose mothers are smokers is between 1.12 lbs less and 0.27 lbs more than the average birthweight for babies whose mothers are nonsmokers.</p></li>
</ul>
<p>Many studies have shown that a mother’s smoking puts a baby at risk of low birthweight. Do our results contradict this research? Should we conclude that smoking has no impact on birthweights?</p>
<section id="larger-study" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="larger-study">Larger Study</h4>
<p>In fact, this sample of 80 babies is part of a larger dataset, consisting of 1,000 babies born in NC in 2004. When we consider the full dataset, notice that the difference between the groups is similar, but the p-value is much smaller, providing stronger evidence of a relationship between a mother’s smoking and lower birthweight.</p>
<p>We’ll now fit a model to the larger dataset.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a>M_Birthwt_Full <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>ncbirths, weight<span class="sc">~</span>habit)</span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(M_Birthwt_Full)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = weight ~ habit, data = ncbirths)

Residuals:
    Min      1Q  Median      3Q     Max 
-6.1443 -0.7043  0.1657  0.9157  4.6057 

Coefficients:
            Estimate Std. Error t value            Pr(&gt;|t|)    
(Intercept)  7.14427    0.05086 140.472 &lt;0.0000000000000002 ***
habitsmoker -0.31554    0.14321  -2.203              0.0278 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.503 on 997 degrees of freedom
  (1 observation deleted due to missingness)
Multiple R-squared:  0.004846,  Adjusted R-squared:  0.003848 
F-statistic: 4.855 on 1 and 997 DF,  p-value: 0.02779</code></pre>
</div>
</div>
<p>Confidence interval based on larger dataset:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(M_Birthwt_Full)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                 2.5 %      97.5 %
(Intercept)  7.0444697  7.24407557
habitsmoker -0.5965648 -0.03452013</code></pre>
</div>
</div>
<p>Notice that the estimated difference in birth weights is actually smaller in the full dataset than in the subset (though 0.3 lbs is still a pretty big difference for babies), and yet now the p-value is much smaller. Why do you think this happened? What should we learn from this?</p>
<p>We saw that a difference that was not statistically discernible for the sample of 80 babies became discernible when we had a larger sample. The large p-value from the initial study was due to a small sample size, rather than the lack of an effect of smoking. It wasn’t that smoking didn’t have an effect on birth weight, only that the sample was too small to detect it conclusively, given the amount of variability in the data. Had the researchers stopped and “accepted” the null hypothesis, concluding that smoking during pregnancy had no effect on the baby’s health, they would have been making a disasterous mistake!</p>
</section>
</section>
<section id="cautions-and-advice" class="level3" data-number="4.6.4">
<h3 data-number="4.6.4" class="anchored" data-anchor-id="cautions-and-advice"><span class="header-section-number">4.6.4</span> Cautions and Advice</h3>
<p><strong>p-values are only (a small) part of a statistical analysis.</strong></p>
<ul>
<li>For small samples, real differences might not be statistically significant.<br>
-Don’t accept null hypothesis. Gather more information.<br>
</li>
<li>For large, even very small differences will be statistically significant.<br>
-Look at confidence interval. Is difference practically important?<br>
</li>
<li>When many hypotheses are tested at once (such as many food items) some will produce a significant result just by change.<br>
-Use a multiple testing correction, such as Bonferroni<br>
</li>
<li>Interpret p-values on a “sliding scale”
<ul>
<li>0.049 is practically the same as 0.051</li>
</ul></li>
<li>Is sample representative of larger population?<br>
</li>
<li>Were treatments randomly assigned (for experiments)?<br>
</li>
<li>Are there other variables to consider?</li>
</ul>
</section>
</section>
<section id="practice-questions" class="level2" data-number="4.7">
<h2 data-number="4.7" class="anchored" data-anchor-id="practice-questions"><span class="header-section-number">4.7</span> Practice Questions</h2>
<section id="section" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="section">1)</h3>
<p>For each of the three plots, state whether it would be appropriate to use the ordinary linear regression model of the form</p>
<p><span class="math display">\[
y = \beta_0 + \beta_1x + \epsilon_i, \text{ where } \epsilon_i\sim{\text{N}}(0,\sigma)
\]</span></p>
<p>Explain why or why not. (Hint: Think about whether the assumptions of the ordinary regression model in Section 4.1.6 appear to be satisfied. )</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch4_files/figure-html/unnamed-chunk-109-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="section-1" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="section-1">2)</h3>
<p>We use the ordinary linear regression model</p>
<p><span class="math display">\[
y = \beta_0 + \beta_1x + \epsilon_i, \text{ where } \epsilon_i\sim{\text{N}}(0,\sigma).
\]</span></p>
<p>Shown below are histograms showing the distribution of the explanatory variable <span class="math inline">\(x\)</span>, the response variable, <span class="math inline">\(y\)</span>, and a scatterplot displaying the relationship between <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">10082020</span>)</span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a><span class="co"># set times </span></span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">60</span></span>
<span id="cb134-4"><a href="#cb134-4" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rexp</span>(n, <span class="at">rate=</span><span class="dv">1</span>)</span>
<span id="cb134-5"><a href="#cb134-5" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> x <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="fl">0.75</span>)</span>
<span id="cb134-6"><a href="#cb134-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb134-7"><a href="#cb134-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb134-8"><a href="#cb134-8" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x, y) <span class="co"># set up data table</span></span>
<span id="cb134-9"><a href="#cb134-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-10"><a href="#cb134-10" aria-hidden="true" tabindex="-1"></a>P1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>df, <span class="fu">aes</span>(<span class="at">x=</span>x)) <span class="sc">+</span> <span class="fu">geom_histogram</span>()  <span class="sc">+</span> </span>
<span id="cb134-11"><a href="#cb134-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">5</span>))  <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"A) Histogram of x"</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"x"</span>)  <span class="sc">+</span> </span>
<span id="cb134-12"><a href="#cb134-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb134-13"><a href="#cb134-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-14"><a href="#cb134-14" aria-hidden="true" tabindex="-1"></a>P2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>df, <span class="fu">aes</span>(<span class="at">x=</span>y)) <span class="sc">+</span> <span class="fu">geom_histogram</span>()  <span class="sc">+</span> </span>
<span id="cb134-15"><a href="#cb134-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">5</span>))  <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"B) Histogram of y"</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"y"</span>)  <span class="sc">+</span> </span>
<span id="cb134-16"><a href="#cb134-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb134-17"><a href="#cb134-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-18"><a href="#cb134-18" aria-hidden="true" tabindex="-1"></a>P3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>df, <span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y)) <span class="sc">+</span> <span class="fu">geom_point</span>()  <span class="sc">+</span> </span>
<span id="cb134-19"><a href="#cb134-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">5</span>)) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">5</span>)) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"C) Scatterplot of y and x"</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"x"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"y"</span>) <span class="sc">+</span> </span>
<span id="cb134-20"><a href="#cb134-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">stat_smooth</span>(<span class="at">method=</span><span class="st">"lm"</span>, <span class="at">se=</span><span class="cn">FALSE</span>)</span>
<span id="cb134-21"><a href="#cb134-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-22"><a href="#cb134-22" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(P1, P2, P3, <span class="at">ncol=</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch4_files/figure-html/unnamed-chunk-110-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
<p>Based on these graphs, should we be concerned about the normality assumption in the ordinary linear regression model? Why or why not?</p>
</section>
<section id="section-2" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="section-2">3)</h3>
<p>Consider the data shown in each of the four plots, and the ordinary linear regression model</p>
<p><span class="math display">\[
y = \beta_0 + \beta_1x + \epsilon_i, \text{ where } \epsilon_i\sim{\text{N}}(0,\sigma).
\]</span></p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch4_files/figure-html/unnamed-chunk-111-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<section id="a-order-the-plots-from-the-one-with-the-smallest-value-of-beta_1-to-the-largest." class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="a-order-the-plots-from-the-one-with-the-smallest-value-of-beta_1-to-the-largest.">a) Order the plots from the one with the smallest value of <span class="math inline">\(\beta_1\)</span> to the largest.</h4>
</section>
<section id="b-order-the-plots-from-the-one-with-the-smallest-value-of-sigma-to-the-largest." class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="b-order-the-plots-from-the-one-with-the-smallest-value-of-sigma-to-the-largest.">b) Order the plots from the one with the smallest value of <span class="math inline">\(\sigma\)</span> to the largest.</h4>
</section>
<section id="c-order-the-plots-from-the-one-with-the-smallest-value-of-r2-to-the-largest." class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="c-order-the-plots-from-the-one-with-the-smallest-value-of-r2-to-the-largest.">c) Order the plots from the one with the smallest value of <span class="math inline">\(R^2\)</span> to the largest.</h4>
</section>
</section>
<section id="section-3" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="section-3">4)</h3>
<p>Consider the data shown in each of the four plots, and the ordinary linear regression model</p>
<p><span class="math display">\[
y = \beta_0 + \beta_1\text{GroupB}+ \epsilon_i, \text{ where } \epsilon_i\sim{\text{N}}(0,\sigma).
\]</span></p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch4_files/figure-html/unnamed-chunk-112-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<section id="a-order-the-plots-from-the-one-with-the-smallest-value-of-beta_1-to-the-largest.-1" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="a-order-the-plots-from-the-one-with-the-smallest-value-of-beta_1-to-the-largest.-1">a) Order the plots from the one with the smallest value of <span class="math inline">\(\beta_1\)</span> to the largest.</h4>
</section>
<section id="b-order-the-plots-from-the-one-with-the-smallest-value-of-sigma-to-the-largest.-1" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="b-order-the-plots-from-the-one-with-the-smallest-value-of-sigma-to-the-largest.-1">b) Order the plots from the one with the smallest value of <span class="math inline">\(\sigma\)</span> to the largest.</h4>
</section>
<section id="c-order-the-plots-from-the-one-with-the-smallest-f-statistic-to-the-largest." class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="c-order-the-plots-from-the-one-with-the-smallest-f-statistic-to-the-largest.">c) Order the plots from the one with the smallest F-statistic to the largest.</h4>
</section>
<section id="for-questions-5-and-6recall-that-in-chapter-3-practice-problems-we-worked-with-a-dataset-pertaining-to-a-sample-of-200-high-school-seniors.-data-were-collected-from-student-responses-to-the-high-school-and-beyond-survey.well-continue-to-work-with-those-data-this-time-using-theory-based-on-the-ordinary-regression-model-to-perform-inference." class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="for-questions-5-and-6recall-that-in-chapter-3-practice-problems-we-worked-with-a-dataset-pertaining-to-a-sample-of-200-high-school-seniors.-data-were-collected-from-student-responses-to-the-high-school-and-beyond-survey.well-continue-to-work-with-those-data-this-time-using-theory-based-on-the-ordinary-regression-model-to-perform-inference."><strong>For Questions 5 and 6,recall that in Chapter 3 practice problems, we worked with a dataset pertaining to a sample of 200 high school seniors. Data were collected from student responses to the High School and Beyond Survey.We’ll continue to work with those data, this time using theory based on the ordinary regression model to perform inference.</strong></h4>
</section>
</section>
<section id="section-4" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="section-4">5)</h3>
<p>Consider a regression model of the form</p>
<p><span class="math display">\[
\text{Science Score} = \beta_0 + \beta_1\times\text{SchoolTypePrivate} + \epsilon_i, \text{ where } \epsilon_i\sim\mathcal{N}(0, \sigma)
\]</span></p>
<section id="a" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="a">a)</h4>
<p>State the four assumptions of the ordinary regression model and explain what they mean in this context.</p>
</section>
<section id="b" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="b">b)</h4>
<p>The model output is shown below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a>M_Seniors_science_schtype <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>HSSeniors, science<span class="sc">~</span>schtyp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img src="Ch4_1.png" id="id" class="class" style="width:110.0%;height:110.0%" alt="M1 Output"> The table shows the mean and standard deviation in science scores for public and private schools, as well as SSR and SST for the model.</p>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">schtyp</th>
<th style="text-align: right;">Mean_Science</th>
<th style="text-align: right;">SD_Science</th>
<th style="text-align: right;">N</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">public</td>
<td style="text-align: right;">51.57</td>
<td style="text-align: right;">10.19</td>
<td style="text-align: right;">168</td>
</tr>
<tr class="even">
<td style="text-align: left;">private</td>
<td style="text-align: right;">53.31</td>
<td style="text-align: right;">8.19</td>
<td style="text-align: right;">32</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>SSR:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(M_Seniors_science_schtype<span class="sc">$</span>residuals<span class="sc">^</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 19426.02</code></pre>
</div>
</div>
<p>SST:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>((HSSeniors<span class="sc">$</span>science<span class="sc">-</span><span class="fu">mean</span>(HSSeniors<span class="sc">$</span>science))<span class="sc">^</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 19507.5</code></pre>
</div>
</div>
<p><strong>Calculate the values that go in blanks (A)-(L) in the model output. Show your calculations. You may use the values in the tables and R output below.</strong></p>
</section>
<section id="c" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="c">c)</h4>
<p>Calculate 95% confidence intervals for <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>.</p>
</section>
<section id="d" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="d">d)</h4>
<p>Give an estimate of <span class="math inline">\(\sigma\)</span>. Explain what this number represents in context. It might be helpful to phrase the statement in the form “this quantity represents the variability in ________ between __________.”</p>
</section>
<section id="e" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="e">e)</h4>
<p>Explain what the standard errors of <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span> represent in context. It might be helpful to phrase these statements in the form “this quantity represents the variability in ________ between __________.”</p>
</section>
<section id="f" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="f">f)</h4>
<p>Write the null hypothesis associated with the p-value on the line <code>intercept</code>. What (if anything) should we conclude from this p-value?</p>
<section id="g" class="level5 unnumbered">
<h5 class="unnumbered anchored" data-anchor-id="g">g)</h5>
<p>Write the null hypothesis associated with the p-value on the line <code>schtypprivate</code>. What (if anything) should we conclude from this p-value?</p>
</section>
<section id="h" class="level5 unnumbered">
<h5 class="unnumbered anchored" data-anchor-id="h">h)</h5>
<p>Write sentences interpreting each of the following intervals in context. If the command produces two intervals, interpret both of them.</p>
<ol type="i">
<li></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(M_Seniors_science_schtype)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                  2.5 %   97.5 %
(Intercept)   50.064421 53.07844
schtypprivate -2.026447  5.50859</code></pre>
</div>
</div>
<ol start="2" type="i">
<li></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(M_Seniors_science_schtype, <span class="at">newdata=</span><span class="fu">data.frame</span>(<span class="at">schtyp=</span><span class="st">"private"</span>), <span class="at">interval=</span><span class="st">"confidence"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      fit      lwr      upr
1 53.3125 49.85951 56.76549</code></pre>
</div>
</div>
<ol start="3" type="i">
<li></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(M_Seniors_science_schtype, <span class="at">newdata=</span><span class="fu">data.frame</span>(<span class="at">schtyp=</span><span class="st">"private"</span>), <span class="at">interval=</span><span class="st">"prediction"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      fit      lwr      upr
1 53.3125 33.47659 73.14841</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="section-5" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="section-5">6)</h3>
<p>Now consider a model of the form:</p>
<p><span class="math display">\[
\text{Science Score} = \beta_0 + \beta_1\times\text{WritingScore} + \epsilon_i, \text{ where } \epsilon_i\sim\mathcal{N}(0, \sigma)
\]</span></p>
<section id="a-1" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="a-1">a)</h4>
<p>State the four assumptions of the ordinary regression model and explain what they mean in this context.</p>
</section>
<section id="b-1" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="b-1">b)</h4>
<p>The model output is shown below, along with some quantities that can be used to calculate the model estimates.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a>M_Seniors_science_write <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>HSSeniors, <span class="fu">lm</span>(<span class="at">data=</span>HSSeniors, science<span class="sc">~</span>write))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Ch4_2.png" class="class figure-img" style="width:110.0%;height:110.0%"></p>
<figcaption>M2 Output</figcaption>
</figure>
</div>
<p>SSR:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(M_Seniors_science_write<span class="sc">$</span>residuals<span class="sc">^</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 13159.69</code></pre>
</div>
</div>
<p>SST:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>((HSSeniors<span class="sc">$</span>science<span class="sc">-</span><span class="fu">mean</span>(HSSeniors<span class="sc">$</span>science))<span class="sc">^</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 19507.5</code></pre>
</div>
</div>
<p><span class="math inline">\(\bar{x}\)</span>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(HSSeniors<span class="sc">$</span>write)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 52.775</code></pre>
</div>
</div>
<p><span class="math inline">\(\bar{y}\)</span>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(HSSeniors<span class="sc">$</span>science)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 51.85</code></pre>
</div>
</div>
<p><span class="math inline">\(\displaystyle\sum_{i=1}^n(x_i-\bar{x})^2\)</span>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>((HSSeniors<span class="sc">$</span>write<span class="sc">-</span><span class="fu">mean</span>(HSSeniors<span class="sc">$</span>write))<span class="sc">^</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 17878.87</code></pre>
</div>
</div>
<p><strong>Calculate the values that go in blanks (A)-(J) in the model output. Show your calculations. You may use the values in the tables and R output below.</strong></p>
</section>
<section id="c-1" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="c-1">c)</h4>
<p>Calculate 95% confidence intervals for <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>.</p>
</section>
<section id="d-1" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="d-1">d)</h4>
<p>Give an estimate of <span class="math inline">\(\sigma\)</span>. Explain what this number represents in context. It might be helpful to phrase the statement in the form “this quantity represents the variability in ________ between __________.”</p>
</section>
<section id="e-1" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="e-1">e)</h4>
<p>Explain what the standard errors of <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span> represent in context. It might be helpful to phrase these statements in the form “this quantity represents the variability in ________ between __________.”</p>
</section>
<section id="f-1" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="f-1">f)</h4>
<p>Write the null hypothesis associated with the p-value on the line <code>intercept</code>. What (if anything) should we conclude from this p-value?</p>
</section>
<section id="g-1" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="g-1">g)</h4>
<p>Write the null hypothesis associated with the p-value on the line <code>wrire</code>. What (if anything) should we conclude from this p-value?</p>
<section id="h-1" class="level5 unnumbered">
<h5 class="unnumbered anchored" data-anchor-id="h-1">h)</h5>
<p>Write sentences interpreting each of the following intervals in context. If the command produces two intervals, interpret both of them.</p>
<ol type="i">
<li></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(M_Seniors_science_write)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                 2.5 %     97.5 %
(Intercept) 13.9572262 26.8500841
write        0.4756219  0.7160918</code></pre>
</div>
</div>
<ol start="2" type="i">
<li></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(M_Seniors_science_write, <span class="at">newdata=</span><span class="fu">data.frame</span>(<span class="at">write=</span><span class="dv">60</span>), <span class="at">interval=</span><span class="st">"confidence"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       fit      lwr      upr
1 56.15507 54.72435 57.58579</code></pre>
</div>
</div>
<ol start="3" type="i">
<li></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(M_Seniors_science_write, <span class="at">newdata=</span><span class="fu">data.frame</span>(<span class="at">write=</span><span class="dv">60</span>), <span class="at">interval=</span><span class="st">"prediction"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       fit      lwr      upr
1 56.15507 40.01468 72.29545</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="section-6" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="section-6">7)</h3>
<ol type="a">
<li><p>Using the public/private schools data, suppose we randomly select a single public school student and find that they have a science score of 55. Should we conclude that this person is exceptionally strong at science, relative to other students? Why or why not?</p></li>
<li><p>Suppose we take a random sample of 168 public school students and find that the average science score in the group was 55. Should we conclude that this group was exceptionally strong at science, relative to other groups of students? Why or why not?</p></li>
</ol>
</section>
<section id="section-7" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="section-7">8)</h3>
<p>The residual standard error <span class="math inline">\(s\)</span> is different for the model in Question 1 than in Question 2. Suppose a person says “these are both meant to be the standard deviation in science test scores, so how can they be different?” How should you respond?</p>
</section>
<section id="section-8" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="section-8">9)</h3>
<p>Suppose the sample had consisted of 400 total students (instead of 200), of which 336 were from public schools and 64 from private schools (so the proportion from each school type is the same as in Question 1). Suppose the variability in the 400 students was similar to the variability in the original 200. For the quantities (A) - (L) in the Question 1 R Output, state whether each would be expected to increase, decrease, or stay about the same.</p>
</section>
<section id="section-9" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="section-9">10)</h3>
<p>The following data and description come from the <code>alr4</code> R package.</p>
<p>“Karl Pearson organized the collection of data on over 1100 families in England in the period 1893 to 1898. This particular data set gives the Heights in inches of mothers and their daughters, with up to two daughters per mother. All daughters are at least age 18, and all mothers are younger than 65.”</p>
<p>A scatterplot of the heights of the mothers and their daughters is shown below. The black line represents the line “y=x” and the blue line is the least squares regression line.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(alr4)</span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(Heights)</span>
<span id="cb163-3"><a href="#cb163-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>Heights, <span class="fu">aes</span>(<span class="at">x=</span>mheight, <span class="at">y=</span>dheight)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb163-4"><a href="#cb163-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method=</span><span class="st">"lm"</span>, <span class="at">se=</span><span class="cn">FALSE</span>) <span class="sc">+</span> </span>
<span id="cb163-5"><a href="#cb163-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope=</span><span class="dv">1</span>, <span class="at">intercept=</span><span class="dv">0</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb163-6"><a href="#cb163-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Mother Height"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Daughter Height"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch4_files/figure-html/unnamed-chunk-130-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="a-2" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="a-2">a)</h4>
<p>Describe the strength and direction of the relationship between heights of mothers and their children? Approximately what is the value of <span class="math inline">\(R^2\)</span>.</p>
</section>
<section id="b-2" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="b-2">b)</h4>
<p>Among mothers who are less than 60 inches tall, how do their daughters’ heights compare to the mothers’? What about for mothers who are more than 67 inches tall? Explain why this might be happening and give the statistical name for the behavior we see here.</p>
</section>
<section id="c-2" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="c-2">c)</h4>
<p>Suppose a mother is 60 inches tall. What is the predicted height of her daughter?</p>
</section>
<section id="d-2" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="d-2">d)</h4>
<p>Suppose a mother is 60 inches tall. Use the graph the approximate a 95% prediction interval for her daughter’s height.</p>
</section>
</section>
<section id="section-10" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="section-10">11)</h3>
<p>When a particular brain area becomes more active, it uses more oxygen. Functional Magnetic Resonance Imaging (fMRI) involves taking a scan of the brain to measure changes in blood flow to different regions. The fMRI machine can record the activity in a region of the brain, but it is subject to measurement error (noise).</p>
<p>In a <a href="http://prefrontal.org/files/posters/Bennett-Salmon-2009.pdf">2009 study by Bennett et. al</a>, an 18-inch, 3.8 lb. salmon was shown a series of photographs depicting human individuals in social situations with a specified emotional valence. Statistics measuring activity in voxels, tiny 3D regions of the brain, were calculated for both when the salmon was resting, and when it was viewing the photograph. t-tests were used on each voxel to test whether there was evidence of differences in brain activation when viewing the photograph, compared to at rest. Out of 8,064 voxels tested, 16 yielded p-values less than 0.001, thus showing evidence of differences in brain activity.</p>
<p>There was, however, a trick. The salmon was dead, and thus was experiencing no brain activity at all!</p>
<ol type="a">
<li><p>Even if we hadn’t known that the salmon was dead, why shouldn’t we conclude that the salmon’s brain was responding differently when viewing the photo, compared to when at rest, based on these results?</p></li>
<li><p>What could we do in this situation to reduce that risk of detecting a false positive when testing for change in a voxel of the brain?</p></li>
</ol>
</section>
<section id="section-11" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="section-11">12)</h3>
<p><a href="https://www.pnas.org/doi/full/10.1073/pnas.1506451112">A 2015 study by Rohrer, Egloff, and Schmukle</a> examined whether older siblings exhibited differences in intelligence and personality, compared to their younger siblings. The study used data from three large national panels from the United States (n = 5,240), Great Britain (n = 4,489), and Germany (n = 10,457).</p>
<p>The article states:</p>
<p><em>The question of whether a person’s position among siblings has a lasting impact on that person’s life course has fascinated both the scientific community and the general public for &gt;100 years. By combining large datasets from three national panels, we confirmed the effect that firstborns score higher on objectively measured intelligence and additionally found a similar effect on self-reported intellect. However, we found no birth-order effects on extraversion, emotional stability, agreeableness, conscientiousness, or imagination. This finding contradicts lay beliefs and prominent scientific theories alike and indicates that the development of personality is less determined by the role within the family of origin than previously thought.</em></p>
<ol type="a">
<li><p>The study tested six different outcomes (intelligence, extraversion, emotional stability, agreeableness, conscientiousness, and imagination). For each outcome, the null hypothesis is that there is no relationship between that outcome and the sibling’s birth order. Suppose that for each outcome there is a 0.05 probability of a hypothesis test resulting in a false positive (concluding an outcome is related to birth order when it really isn’t). If hypothesis tests are run on all six outcomes, what is the probability of getting at least one false positive? How can we ensure that the probability of getting one or more false positives when running six tests simultaneously is no higher than 0.05?</p></li>
<li><p>To test intellect, the authors used scores on Intelligence Quotient (IQ) tests. The mean score on IQ tests is 100, with a standard deviation of 15 between individual scores. The authors found that an older sibling scored, on average 1.5 points higher than the next younger sibling in the family. An ANOVA F-test with the null hypothesis that there is no relationship between birth order and intelligence resulted in an F-statistic of 11.80 and p-value of less than 0.001. Is the relationship between birth order and intelligence statistically discernible? Do you think it is practically meaningful? Explain your answer.</p></li>
</ol>
</section>
<section id="section-12" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="section-12">13)</h3>
<p>Duchenne muscular dystrophy (DMD). DMD is a severe and progressive genetic disease that leads to muscle weakness, worsening over time. It is more common in boys than in girls. In 2016, a drug called Eteplirsen (now known as Exondys 51) was developed for the purpose of treating DMD symptoms and improving quality of life. Because the disease is rare, it is difficult to collect a large sample of participants for a randomized clinical trial to test the effectiveness of the drug. In a sample of 12 boys, 6 were assigned to a treatment group and took Eteplirsen for 62 weeks. The other 6 were assigned to a control group and took a placebo for 24 weeks, followed by Eteplirsen for 38 weeks. The boys were randomly assigned to groups. Researchers recorded the distance each boy walked in 6 minutes at the beginning and end of the study. Two of the boys in the placebo group withdrew from the study due to health complications. The average distance walked by the remaining four boys in the placebo group decreased by 63.8 m. over the 62 weeks, compared to an average decrease of only 4.2 meters for boys in the treatment group. A hypothesis test with the null hypothesis that there is no difference in distance walked between the groups returned a p-value of 0.012.</p>
<ol type="a">
<li><p>Is the difference between the groups statistically discernible? Is it practically meaningful?</p></li>
<li><p>There was disagreement within the Federal Drug Administration about whether to to approve the Eteplirsen drug based on this study. Why might it be a good idea to approve the drug? What concerns might you have?</p></li>
<li><p>Suppose the same difference in walking distances had been observed, but the p-value had been 0.072 instead of 0.012? Would this change your thoughts on whether the drug should be approved? Why or why not?</p></li>
</ol>
<p>NOTE: In the end, the FDA approved the drug, while requiring its producer to conduct additional future tests and noting that approval could be withdrawn if those tests did not confirm a clinical benefit. Results and discussion of the study are available <a href="https://www.fiercebiotech.com/biotech/sarepta-therapeutics-announces-a-continued-benefit-on-walking-test-through-62-weeks-phase">here</a>, and <a href="https://pubmed.ncbi.nlm.nih.gov/26573217/.">here</a>.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./Ch3.html" class="pagination-link" aria-label="Simulation-Based Inference">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Simulation-Based Inference</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./Ch5.html" class="pagination-link" aria-label="Building and Assessing Models">
        <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Building and Assessing Models</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>