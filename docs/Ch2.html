<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>2&nbsp; Introduction to Statistical Models – STAT 255 Notes</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./Ch3.html" rel="next">
<link href="./Ch1.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-626149efe8f5d16e1d391ba177679bf0.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./Ch2.html"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Introduction to Statistical Models</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">STAT 255 Notes</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ch1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Visualizing and Summarizing Data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ch2.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Introduction to Statistical Models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ch3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Simulation-Based Inference</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ch4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Inference from Models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ch5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Building and Assessing Models</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#learning-outcomes" id="toc-learning-outcomes" class="nav-link active" data-scroll-target="#learning-outcomes">Learning Outcomes</a></li>
  <li><a href="#fitting-models-to-data" id="toc-fitting-models-to-data" class="nav-link" data-scroll-target="#fitting-models-to-data"><span class="header-section-number">2.1</span> Fitting Models to Data</a>
  <ul class="collapse">
  <li><a href="#terminology" id="toc-terminology" class="nav-link" data-scroll-target="#terminology"><span class="header-section-number">2.1.1</span> Terminology</a></li>
  <li><a href="#quantitative-explanatory-variable" id="toc-quantitative-explanatory-variable" class="nav-link" data-scroll-target="#quantitative-explanatory-variable"><span class="header-section-number">2.1.2</span> Quantitative Explanatory Variable</a></li>
  <li><a href="#categorical-explanatory-variable" id="toc-categorical-explanatory-variable" class="nav-link" data-scroll-target="#categorical-explanatory-variable"><span class="header-section-number">2.1.3</span> Categorical Explanatory Variable</a></li>
  <li><a href="#multiple-explanatory-variables" id="toc-multiple-explanatory-variables" class="nav-link" data-scroll-target="#multiple-explanatory-variables"><span class="header-section-number">2.1.4</span> Multiple Explanatory Variables</a></li>
  <li><a href="#no-explanatory-variable" id="toc-no-explanatory-variable" class="nav-link" data-scroll-target="#no-explanatory-variable"><span class="header-section-number">2.1.5</span> No Explanatory Variable</a></li>
  </ul></li>
  <li><a href="#variability-explained-by-a-model" id="toc-variability-explained-by-a-model" class="nav-link" data-scroll-target="#variability-explained-by-a-model"><span class="header-section-number">2.2</span> Variability Explained by a Model</a>
  <ul class="collapse">
  <li><a href="#total-variability" id="toc-total-variability" class="nav-link" data-scroll-target="#total-variability"><span class="header-section-number">2.2.1</span> Total Variability</a></li>
  <li><a href="#residuals" id="toc-residuals" class="nav-link" data-scroll-target="#residuals"><span class="header-section-number">2.2.2</span> Residuals</a></li>
  <li><a href="#variability-explained-by-sq.-ft.-model" id="toc-variability-explained-by-sq.-ft.-model" class="nav-link" data-scroll-target="#variability-explained-by-sq.-ft.-model"><span class="header-section-number">2.2.3</span> Variability Explained by Sq. Ft. Model</a></li>
  <li><a href="#linear-correlation-coefficient" id="toc-linear-correlation-coefficient" class="nav-link" data-scroll-target="#linear-correlation-coefficient"><span class="header-section-number">2.2.4</span> Linear Correlation Coefficient</a></li>
  <li><a href="#variability-explained-by-waterfront-model" id="toc-variability-explained-by-waterfront-model" class="nav-link" data-scroll-target="#variability-explained-by-waterfront-model"><span class="header-section-number">2.2.5</span> Variability Explained by Waterfront Model</a></li>
  <li><a href="#variability-explained-by-multiple-regression-model" id="toc-variability-explained-by-multiple-regression-model" class="nav-link" data-scroll-target="#variability-explained-by-multiple-regression-model"><span class="header-section-number">2.2.6</span> Variability Explained by Multiple Regression Model</a></li>
  <li><a href="#adding-age" id="toc-adding-age" class="nav-link" data-scroll-target="#adding-age"><span class="header-section-number">2.2.7</span> Adding Age</a></li>
  <li><a href="#summary-sst-ssr-ssm-r2" id="toc-summary-sst-ssr-ssm-r2" class="nav-link" data-scroll-target="#summary-sst-ssr-ssm-r2"><span class="header-section-number">2.2.8</span> Summary: SST, SSR, SSM, <span class="math inline">\(R^2\)</span></a></li>
  <li><a href="#model-comparison-summary" id="toc-model-comparison-summary" class="nav-link" data-scroll-target="#model-comparison-summary"><span class="header-section-number">2.2.9</span> Model Comparison Summary</a></li>
  </ul></li>
  <li><a href="#analysis-of-variance" id="toc-analysis-of-variance" class="nav-link" data-scroll-target="#analysis-of-variance"><span class="header-section-number">2.3</span> ANalysis Of VAriance</a>
  <ul class="collapse">
  <li><a href="#sub-models" id="toc-sub-models" class="nav-link" data-scroll-target="#sub-models"><span class="header-section-number">2.3.1</span> Sub-Models</a></li>
  <li><a href="#f-statistics" id="toc-f-statistics" class="nav-link" data-scroll-target="#f-statistics"><span class="header-section-number">2.3.2</span> F-Statistics</a></li>
  <li><a href="#f-statistic-for-comparing-groups" id="toc-f-statistic-for-comparing-groups" class="nav-link" data-scroll-target="#f-statistic-for-comparing-groups"><span class="header-section-number">2.3.3</span> F-Statistic for Comparing Groups</a></li>
  <li><a href="#relationship-between-f-statistic-and-r2" id="toc-relationship-between-f-statistic-and-r2" class="nav-link" data-scroll-target="#relationship-between-f-statistic-and-r2"><span class="header-section-number">2.3.4</span> Relationship Between F-statistic and <span class="math inline">\(R^2\)</span></a></li>
  <li><a href="#comparing-3-or-more-categories" id="toc-comparing-3-or-more-categories" class="nav-link" data-scroll-target="#comparing-3-or-more-categories"><span class="header-section-number">2.3.5</span> Comparing 3 or More Categories</a></li>
  <li><a href="#alternate-f-stat-formula" id="toc-alternate-f-stat-formula" class="nav-link" data-scroll-target="#alternate-f-stat-formula"><span class="header-section-number">2.3.6</span> Alternate F-Stat Formula</a></li>
  </ul></li>
  <li><a href="#least-squares-estimation-lse" id="toc-least-squares-estimation-lse" class="nav-link" data-scroll-target="#least-squares-estimation-lse"><span class="header-section-number">2.4</span> Least Squares Estimation (LSE)</a>
  <ul class="collapse">
  <li><a href="#estimating-regression-coefficients" id="toc-estimating-regression-coefficients" class="nav-link" data-scroll-target="#estimating-regression-coefficients"><span class="header-section-number">2.4.1</span> Estimating Regression Coefficients</a></li>
  <li><a href="#mathematics-of-lse-for-slr" id="toc-mathematics-of-lse-for-slr" class="nav-link" data-scroll-target="#mathematics-of-lse-for-slr"><span class="header-section-number">2.4.2</span> Mathematics of LSE for SLR</a></li>
  <li><a href="#lse-for-categorical-variable" id="toc-lse-for-categorical-variable" class="nav-link" data-scroll-target="#lse-for-categorical-variable"><span class="header-section-number">2.4.3</span> LSE for Categorical Variable</a></li>
  <li><a href="#lse-more-generally" id="toc-lse-more-generally" class="nav-link" data-scroll-target="#lse-more-generally"><span class="header-section-number">2.4.4</span> LSE More Generally</a></li>
  </ul></li>
  <li><a href="#practice-questions" id="toc-practice-questions" class="nav-link" data-scroll-target="#practice-questions"><span class="header-section-number">2.5</span> Practice Questions</a>
  <ul class="collapse">
  <li><a href="#section" id="toc-section" class="nav-link" data-scroll-target="#section">1)</a></li>
  <li><a href="#section-1" id="toc-section-1" class="nav-link" data-scroll-target="#section-1">2)</a></li>
  <li><a href="#section-2" id="toc-section-2" class="nav-link" data-scroll-target="#section-2">3)</a></li>
  <li><a href="#section-3" id="toc-section-3" class="nav-link" data-scroll-target="#section-3">4)</a></li>
  <li><a href="#section-4" id="toc-section-4" class="nav-link" data-scroll-target="#section-4">5)</a></li>
  <li><a href="#section-5" id="toc-section-5" class="nav-link" data-scroll-target="#section-5">6)</a></li>
  <li><a href="#section-6" id="toc-section-6" class="nav-link" data-scroll-target="#section-6">7)</a></li>
  <li><a href="#section-7" id="toc-section-7" class="nav-link" data-scroll-target="#section-7">8)</a></li>
  <li><a href="#section-8" id="toc-section-8" class="nav-link" data-scroll-target="#section-8">9)</a></li>
  <li><a href="#section-9" id="toc-section-9" class="nav-link" data-scroll-target="#section-9">10)</a></li>
  <li><a href="#section-10" id="toc-section-10" class="nav-link" data-scroll-target="#section-10">11)</a></li>
  <li><a href="#section-11" id="toc-section-11" class="nav-link" data-scroll-target="#section-11">12)</a></li>
  <li><a href="#section-12" id="toc-section-12" class="nav-link" data-scroll-target="#section-12">13)</a></li>
  <li><a href="#section-13" id="toc-section-13" class="nav-link" data-scroll-target="#section-13">14)</a></li>
  <li><a href="#section-14" id="toc-section-14" class="nav-link" data-scroll-target="#section-14">15)</a></li>
  <li><a href="#section-15" id="toc-section-15" class="nav-link" data-scroll-target="#section-15">16)</a></li>
  <li><a href="#section-16" id="toc-section-16" class="nav-link" data-scroll-target="#section-16">17)</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Introduction to Statistical Models</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="learning-outcomes" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="learning-outcomes">Learning Outcomes</h3>
<p><strong>Conceptual Learning Outcomes</strong><br>
4. Use regression models to calculate estimates and predictions.<br>
5. Interpret coefficient estimates in regression models in context.<br>
6. Calculate and interpret regression sums of squares SSR, SSM, and SST, and coefficient of determination,<span class="math inline">\(R^2\)</span>.<br>
7. Calculate and interpret F-statistics for comparing models.<br>
8. Draw conclusions about model estimates, <span class="math inline">\(R^2\)</span>, and F-statistics using graphical representations of data.<br>
9. Explain the least squares estimation process.</p>
<p><strong>Computational Learning Outcomes</strong><br>
E. Fit statistical models in R and interpret results.</p>
</section>
<section id="fitting-models-to-data" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="fitting-models-to-data"><span class="header-section-number">2.1</span> Fitting Models to Data</h2>
<section id="terminology" class="level3" data-number="2.1.1">
<h3 data-number="2.1.1" class="anchored" data-anchor-id="terminology"><span class="header-section-number">2.1.1</span> Terminology</h3>
<p>In this section, we’ll use statistical models to predict the prices of houses in King County, WA.</p>
<p>In a statistical model,</p>
<ul>
<li><p>The variable we are trying to predict (price) is called the <strong>response variable</strong> (denoted <span class="math inline">\(Y\)</span>).</p></li>
<li><p>Variable(s) we use to help us make the prediction is(are) called <strong>explanatory variables</strong> (denoted <span class="math inline">\(X\)</span>). These are also referred to as <strong>predictor variables</strong> or <strong>covariates</strong>.</p></li>
</ul>
<p>In this section, we’ll attempt to predict the price of a house, using information about its size (in square feet), and whether or not it is on the waterfront. The price is our response variable, while size and waterfront location are explanatory variables.</p>
<ul>
<li><p><strong>Categorical variables</strong> are variables that take on groups or categories, rather than numeric values, for example, whether or not the house is on the waterfront.</p></li>
<li><p><strong>Quantitative variables</strong> take on meaningful numeric values, for example the number of square feet in the house.</p></li>
</ul>
</section>
<section id="quantitative-explanatory-variable" class="level3" data-number="2.1.2">
<h3 data-number="2.1.2" class="anchored" data-anchor-id="quantitative-explanatory-variable"><span class="header-section-number">2.1.2</span> Quantitative Explanatory Variable</h3>
<p>We’ll first predict the price of the house, using the number of square feet of living space as our explanatory variable.</p>
<p>A model with a single quantitative explanatory variable is called a <strong>simple linear regression (SLR)</strong> model.</p>
<p>We’ll assume that price changes linearly with square feet, and fit a trend line to the data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>Houses, <span class="fu">aes</span>(<span class="at">x=</span>sqft_living, <span class="at">y=</span>price)) <span class="sc">+</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method=</span><span class="st">"lm"</span>, <span class="at">se=</span><span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Price and Living Space"</span>) <span class="sc">+</span> </span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Price"</span>) <span class="sc">+</span> </span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Living Space in sq. ft. "</span>) <span class="sc">+</span> </span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch2_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The model equation is</p>
<p><span class="math display">\[
\widehat{\text{Price}} = b_0 + b_1\times\text{Sq.Ft.}
\]</span></p>
<p>The symbol over the response variable (Price) is read as “hat”, and means “predicted price”.</p>
<p>We fit the model in R, using the <code>lm</code> (linear model) command. The output gives the estimates of <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>M_House_price_sqft <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>Houses, price<span class="sc">~</span>sqft_living)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>M_House_price_sqft</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = price ~ sqft_living, data = Houses)

Coefficients:
(Intercept)  sqft_living  
  -364.8497       0.4641  </code></pre>
</div>
</div>
<p>The estimates are <span class="math inline">\(b_0=\)</span> -364.85 and <span class="math inline">\(b_1=\)</span> 0.46.</p>
<p>The model equation is</p>
<p><span class="math display">\[
\widehat{\text{Price}} = -364.85  + 0.46\times\text{Sq.Ft.}
\]</span></p>
<p><strong>Interpretations</strong></p>
<p>The intercept <span class="math inline">\(b_0\)</span> represents the expected (or average) value of the response variable, when the explanatory variable is equal to 0. This is not always a meaningful interpretation in context.</p>
<p>The slope <span class="math inline">\(b_1\)</span> represents the expected (or average) change in the response variable for each one-unit increase in the explanatory variable.</p>
<ul>
<li><p>On average, a house with 0 square feet is expected to cost -365 thousand dollars. This is not a sensible interpretation, as there are no houses with 0 square feet.</p></li>
<li><p>For each additional square foot in living space, the price of the house is expected to increase by 0.46 thousand dollars (or $460).<br>
</p>
<ul>
<li>Since a 1 square ft. increase is very small, it makes more sense to give the interpretation in terms of a 100-square foot increase. For each additional 100 square feet in living space, the price of the house is expected to increase by 46 thousand dollars.</li>
</ul></li>
</ul>
<p><strong>Prediction</strong></p>
<p>We can predict the price of a house with a given number of square feet by plugging the square feet into the model equation.</p>
<p>The predicted price of a house with 2,000 square feet is</p>
<p><span class="math display">\[
\widehat{\text{Price}} = -364.85 + 0.46\times 2000 = 563.41{ \text{ thousand dollars}}
\]</span></p>
<p>We can calculate this directly in R using the <code>predict</code> command.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(M_House_price_sqft, <span class="at">newdata=</span><span class="fu">data.frame</span>(<span class="at">sqft_living=</span><span class="dv">2000</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       1 
563.4116 </code></pre>
</div>
</div>
<p>We should only try to make predictions on houses within the range of the observed data. Since the largest house in the dataset is 8,000 square feet we should not try to predict the price of house with 10,000 square feet.</p>
</section>
<section id="categorical-explanatory-variable" class="level3" data-number="2.1.3">
<h3 data-number="2.1.3" class="anchored" data-anchor-id="categorical-explanatory-variable"><span class="header-section-number">2.1.3</span> Categorical Explanatory Variable</h3>
<p>Next, we’ll predict the price of a house based on whether or not it is on the waterfront.</p>
<p>The boxplot shows the distribution of prices for waterfront and nonwaterfront houses. The red dots indicate the mean.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>Houses, <span class="fu">aes</span>(<span class="at">x=</span>waterfront, <span class="at">y=</span>price)) <span class="sc">+</span> <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"House Price by Waterfront Status"</span>) <span class="sc">+</span> </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Waterfront"</span>) <span class="sc">+</span> </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.y=</span><span class="st">"mean"</span>, <span class="at">geom=</span><span class="st">"point"</span>, <span class="at">shape=</span><span class="dv">20</span>, <span class="at">color=</span><span class="st">"red"</span>, <span class="at">fill=</span><span class="st">"red"</span>)  <span class="sc">+</span> </span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Price"</span>) <span class="sc">+</span> </span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span> </span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch2_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The table displays the price summary by waterfront status.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>Houses_Grouped_Summary <span class="ot">&lt;-</span> Houses <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(waterfront) <span class="sc">%&gt;%</span> </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>                                      <span class="fu">summarize</span>(<span class="at">Mean_Price =</span> <span class="fu">mean</span>(price, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">Median_Price =</span> <span class="fu">median</span>(price, <span class="at">na.rm=</span><span class="cn">TRUE</span>), </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">StDev_Price =</span> <span class="fu">sd</span>(price, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">Number_of_Houses =</span> <span class="fu">n</span>()) </span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(Houses_Grouped_Summary)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">waterfront</th>
<th style="text-align: right;">Mean_Price</th>
<th style="text-align: right;">Median_Price</th>
<th style="text-align: right;">StDev_Price</th>
<th style="text-align: right;">Number_of_Houses</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">No</td>
<td style="text-align: right;">552.6609</td>
<td style="text-align: right;">430</td>
<td style="text-align: right;">409.7904</td>
<td style="text-align: right;">175</td>
</tr>
<tr class="even">
<td style="text-align: left;">Yes</td>
<td style="text-align: right;">1812.9540</td>
<td style="text-align: right;">1700</td>
<td style="text-align: right;">1073.8480</td>
<td style="text-align: right;">25</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The model equation is</p>
<p><span class="math display">\[
\widehat{\text{Price}} = b_0 + b_1\times\text{Waterfront}
\]</span></p>
<p>The waterfront variable takes on value of 1 if the house is on the waterfront, and 0 otherwise.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>M_House_price_wf <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>Houses, price<span class="sc">~</span>waterfront)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>M_House_price_wf</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = price ~ waterfront, data = Houses)

Coefficients:
  (Intercept)  waterfrontYes  
        552.7         1260.3  </code></pre>
</div>
</div>
<p>The estimates are <span class="math inline">\(b_0=\)</span> 552.66 and <span class="math inline">\(b_1=\)</span> 1260.29.</p>
<p>The model equation is</p>
<p><span class="math display">\[
\widehat{\text{Price}} = 552.66 + 1260.29\times \text{Waterfront}
\]</span></p>
<p><strong>Interpretations</strong></p>
<p>The intercept <span class="math inline">\(b_0\)</span> represents the expected (or average) value of the response variable in the “baseline” category (in this case non-waterfront).</p>
<p>The coefficient <span class="math inline">\(b_1\)</span> represents the expected (or average) difference in response between the a category and the “baseline” category.</p>
<ul>
<li><p>On average, a house that is not on the waterfront is expected to cost <code>r</code>M_House_price_wf_b0` thousand dollars.</p></li>
<li><p>On average a house that is on the waterfront is expected to cost 1260.29 thousand (or 1.26029 million) dollars more than a house that is not on the waterfront.</p></li>
</ul>
<p><strong>Prediction</strong></p>
<p>We can predict the price of a house with a given number of square feet by plugging in either 1 or 0 for the waterfront variable.</p>
<p>The predicted price of a house on the waterfront is:</p>
<p><span class="math display">\[
\widehat{\text{Price}} = 552.66 + 552.66\times 1 = 1812.95{ \text{ thousand (or 553.92 million)}}
\]</span></p>
<p>The predicted price of a house not on the waterfront is:</p>
<p><span class="math display">\[
\widehat{\text{Price}} = 552.66 + 552.66\times 0 = 552.66{ \text{ thousand}}
\]</span></p>
<p>Calculations in R:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(M_House_price_wf, <span class="at">newdata=</span><span class="fu">data.frame</span>(<span class="at">waterfront=</span><span class="st">"Yes"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       1 
1812.954 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(M_House_price_wf, <span class="at">newdata=</span><span class="fu">data.frame</span>(<span class="at">waterfront=</span><span class="st">"No"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       1 
552.6609 </code></pre>
</div>
</div>
<p>Notice that the predicted prices for each category correspond to the average price for that category.</p>
</section>
<section id="multiple-explanatory-variables" class="level3" data-number="2.1.4">
<h3 data-number="2.1.4" class="anchored" data-anchor-id="multiple-explanatory-variables"><span class="header-section-number">2.1.4</span> Multiple Explanatory Variables</h3>
<p>We’ve used square feet and waterfront status as explanatory variables individually. We can also build a model that uses both of these variables at the same time.</p>
<p>A model with two or more explanatory variables is called a <strong>multiple regression model</strong>.</p>
<p>The model equation is</p>
<p><span class="math display">\[
\widehat{\text{Price}} = b_0 + b_1\times\text{Sq. Ft} + b_2\times\text{Waterfront}
\]</span></p>
<p>For a house not on the waterfront, the <span class="math inline">\(\text{Waterfront} = 0\)</span> so the model equation is:</p>
<p><span class="math display">\[
\widehat{\text{Price}} = b_0  + b_1\text{Sq. Ft}
\]</span></p>
<p>For a house on the waterfront, <span class="math inline">\(\text{Waterfront} = 1\)</span>, so the model equation is:</p>
<p><span class="math display">\[
\widehat{\text{Price}} = (b_0 + b_2) + b_1\times\text{Sq. Ft}
\]</span></p>
<p>Notice that the slope is the same, regardless of whether the house is on the waterfront (<span class="math inline">\(b_1\)</span>). The intercept, however, is different (<span class="math inline">\(b_0\)</span> for houses not on the waterfront, and <span class="math inline">\(b_0 + b_2\)</span> for houses on the waterfront). Thus, the model assumes that price increases at the same rate, with respect to square feet, regardless of whether or not it is on the waterfront, but allows the predicted price for a waterfront house to differ from a non-waterfront house of the same size.</p>
<p>The <code>geom_parallel_slopes(se=FALSE)</code> command adds regression lines with a common slope. This function is part of the <code>moderndive</code> R package.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>Plot_House_price_sqft_wf <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>Houses, <span class="fu">aes</span>(<span class="at">x=</span>sqft_living, <span class="at">y=</span>price, <span class="at">color=</span>waterfront)) <span class="sc">+</span> </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_parallel_slopes</span>(<span class="at">se=</span><span class="cn">FALSE</span>) </span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>Plot_House_price_sqft_wf</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch2_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>We fit the model in R.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>M_House_price_sqft_wf <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>Houses, price<span class="sc">~</span>sqft_living<span class="sc">+</span>waterfront)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>M_House_price_sqft_wf</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = price ~ sqft_living + waterfront, data = Houses)

Coefficients:
  (Intercept)    sqft_living  waterfrontYes  
    -269.5118         0.3819       760.2965  </code></pre>
</div>
</div>
<p>The model equation is</p>
<p><span class="math display">\[
\widehat{\text{Price}} = -269.51 + 0.38\times\text{Sq. Ft} + 760.3\times\text{Waterfront}
\]</span></p>
<p><strong>Interpretations</strong></p>
<p>The intercept <span class="math inline">\(b_0\)</span> represents the expected (or average) value of the response variable, when all quantitative explanatory variables are equal to 0, and all categorical variables are in the “baseline” category. This interpretation is not always sensible.</p>
<p>We interpret coefficients <span class="math inline">\(b_j\)</span> for categorical or quantitative variables, the same way we would in a regression model with only one variable, but we need to state that all other explanatory variables are being held constant.</p>
<ul>
<li><p>On average, a house that is not on the waterfront with 0 square feet is expected to cost -269.51 thousand dollars. This is not a sensible interpretation, since there are no houses with 0 square feet.<br>
</p></li>
<li><p>For each 1-square foot increase in size, the price of a house is expected to increase by 0.38 thousand (or 380) dollars, assuming waterfront status is the same. Equivalently, for each 100-square foot increase in size, the price of a house is expected to increase by 38 thousand dollars, assuming waterfront status is the same.</p></li>
<li><p>On average, a house on the waterfront is expected to cost 760.3 thousand dollars more than a house that is not on the waterfront, assuming square footage is the same.</p></li>
</ul>
<p><strong>Question for thought:</strong> Notice that the estimated difference in price between waterfront and non-waterfront houses, after accounting for size, is 760.3, which is less than the estimated difference when we did not account for size, which was 1260.29. Why is this? Hint: look at the scatterplot displaying house price, size, and waterfront status.</p>
<p><strong>Prediction</strong></p>
<p>The predicted price of a 2,000 square foot house on the waterfront is:</p>
<p><span class="math display">\[
\widehat{\text{Price}} = -269.51 + 0.38\times2000 + 760.3\times1 = 1254.66{ \text{ thousand (or 1.25 million)}}
\]</span></p>
<p>The predicted price of a 2,000 square foot house not on the waterfront is:</p>
<p><span class="math display">\[
\widehat{\text{Price}} = -269.51 + 0.38\times2000 = 494.37{ \text{ thousand}}
\]</span></p>
<p>Calculations in R:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(M_House_price_sqft_wf, <span class="at">newdata=</span><span class="fu">data.frame</span>(<span class="at">waterfront=</span><span class="st">"Yes"</span>, <span class="at">sqft_living=</span><span class="dv">2000</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       1 
1254.665 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(M_House_price_sqft_wf, <span class="at">newdata=</span><span class="fu">data.frame</span>(<span class="at">waterfront=</span><span class="st">"No"</span>, <span class="at">sqft_living=</span><span class="dv">2000</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       1 
494.3681 </code></pre>
</div>
</div>
</section>
<section id="no-explanatory-variable" class="level3" data-number="2.1.5">
<h3 data-number="2.1.5" class="anchored" data-anchor-id="no-explanatory-variable"><span class="header-section-number">2.1.5</span> No Explanatory Variable</h3>
<p>Finally, we’ll consider a model that makes use of no explanatory variables at all. Although this might seem silly, its relevance will be seen in the next section.</p>
<p>The histogram shows the distribution of prices, without any information about explanatory variables. The mean price is indicated in red.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>Houses, <span class="fu">aes</span>(<span class="at">x=</span>price)) <span class="sc">+</span> </span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">fill=</span><span class="st">"lightblue"</span>, <span class="at">color=</span><span class="st">"white"</span>) <span class="sc">+</span> </span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Distribution of House Prices"</span>) <span class="sc">+</span> </span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Price"</span>) <span class="sc">+</span> </span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Frequency"</span>) <span class="sc">+</span> </span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="fu">mean</span>(Houses<span class="sc">$</span>price), <span class="at">y=</span><span class="dv">0</span>), <span class="at">color=</span><span class="st">"red"</span>, <span class="at">shape=</span><span class="dv">24</span>, <span class="at">fill=</span><span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch2_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The mean, median, and standard deviation in prices is shown below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(Houses_Summary)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">Mean_Price</th>
<th style="text-align: right;">Median_Price</th>
<th style="text-align: right;">StDev_Price</th>
<th style="text-align: right;">Number_of_Houses</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">710.1975</td>
<td style="text-align: right;">457.8125</td>
<td style="text-align: right;">678.6034</td>
<td style="text-align: right;">200</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Suppose we know that a house sold in King County during this time, and want to predict the price, without knowing anything else about the house.</p>
<p>The best we can do is to use the mean price for our prediction. (We’ll define what we mean by “best” later in the chapter.)</p>
<p>The model equation is</p>
<p><span class="math display">\[
\widehat{\text{Price}} = b_0
\]</span></p>
<p>We fit a statistical model in R using the <code>lm</code> command.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>M_House_price_0 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>Houses, price <span class="sc">~</span> <span class="dv">1</span>) <span class="co"># when there are no explanatory variables, use ~1</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>M_House_price_0</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = price ~ 1, data = Houses)

Coefficients:
(Intercept)  
      710.2  </code></pre>
</div>
</div>
<p>The model equation is</p>
<p><span class="math display">\[
\widehat{\text{Price}} = 710.2
\]</span></p>
<p><strong>Interpretation</strong></p>
<p>The expected price of a house in King County is 710.2 thousand dollars.</p>
<p><strong>Predictions</strong></p>
<p>Without knowing anything about the house other than that it is in King County, WA we would expect it to cost 710.2 thousand dollars.</p>
<div style="page-break-after: always;"></div>
</section>
</section>
<section id="variability-explained-by-a-model" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="variability-explained-by-a-model"><span class="header-section-number">2.2</span> Variability Explained by a Model</h2>
<p>We’ve seen four different models for predicting house price. We want to be able to quantify how well the models are predicting prices, and determine which best explain variability in price.</p>
<p>Of course we won’t know the price of the house we are trying to predict, so we can’t be sure how close or far our prediction is. We do, however, know the prices of the original 200 houses in our dataset. We can assess the models by measuring how far the actual prices of the 200 houses differ from the predicted (mean) price, and by calculating the proportion of total variation in sale price explained by each model.</p>
<section id="total-variability" class="level3" data-number="2.2.1">
<h3 data-number="2.2.1" class="anchored" data-anchor-id="total-variability"><span class="header-section-number">2.2.1</span> Total Variability</h3>
<p>Let’s start with our most basic model, which uses no explanatory variables and predicts the price of each simply using the average of all houses in the dataset.</p>
<p>We measure the total variability in the response variable by calculating the square difference between each individual response value and the overall average. This quantity is called the total sum of squares (SST).</p>
<p><span class="math display">\[
\text{SST} = \displaystyle\sum_{i=1}^n (y_i - \bar{y})^2
\]</span></p>
<p>The plot below shows a horizontal line at the mean sale price (710.2 thousand). The points represent prices of individual houses, and the red lines represent the differences between the price of each house and the overall average.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch2_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
<p>We see that the majority of the houses are priced below the overall average, but some houses are much more expensive than average. A property of averages is that the positive and negative differences from the average will always cancel out and sum to zero.</p>
<p>The first three houses in the dataset are shown below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>First3Houses <span class="ot">&lt;-</span> Houses <span class="sc">%&gt;%</span> <span class="fu">select</span>(ID, price, waterfront, sqft_living) <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="dv">3</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(First3Houses)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">ID</th>
<th style="text-align: right;">price</th>
<th style="text-align: left;">waterfront</th>
<th style="text-align: right;">sqft_living</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">90</td>
<td style="text-align: right;">335.0</td>
<td style="text-align: left;">No</td>
<td style="text-align: right;">1030</td>
</tr>
<tr class="even">
<td style="text-align: right;">126</td>
<td style="text-align: right;">1450.0</td>
<td style="text-align: left;">No</td>
<td style="text-align: right;">2750</td>
</tr>
<tr class="odd">
<td style="text-align: right;">300</td>
<td style="text-align: right;">267.5</td>
<td style="text-align: left;">No</td>
<td style="text-align: right;">1590</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><span class="math display">\[
\begin{aligned}
\text{SST} &amp; = \displaystyle\sum_{i=1}^{100} (y_i - \bar{y})^2 \\
&amp; = (335- 710)^2 + (1450- 710)^2 + (1450- 710)^2 + \ldots
\end{aligned}
\]</span></p>
<p>We could calculate SST by hand for small datasets. For larger datasets, we’ll use R to perform the calculation.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>meanprice <span class="ot">&lt;-</span> <span class="fu">mean</span>(Houses<span class="sc">$</span>price)  <span class="co">#calculate mean price</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>SST <span class="ot">&lt;-</span> <span class="fu">sum</span>((Houses<span class="sc">$</span>price <span class="sc">-</span> meanprice)<span class="sc">^</span><span class="dv">2</span>)  <span class="do">## calculate SST</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>SST</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 91640004</code></pre>
</div>
</div>
<p>Or, equivalently,</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>SST_M_House_price <span class="ot">&lt;-</span> <span class="fu">sum</span>((M_House_price_0<span class="sc">$</span>resid)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>SST_M_House_price</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 91640004</code></pre>
</div>
</div>
<p>By itself, the size of SST does not have much meaning. We cannot say whether a SST value like the one we see here is large or small, since it depends on the size and scale of the variable being measured. An SST value that is very large in one context might be very small in another.</p>
<p>SST does, however, give us a baseline measure of the total variability in the response variable. We’ll assess the performance of a model with a given explanatory variable by measuring how much of this variability the model accounts for.</p>
</section>
<section id="residuals" class="level3" data-number="2.2.2">
<h3 data-number="2.2.2" class="anchored" data-anchor-id="residuals"><span class="header-section-number">2.2.2</span> Residuals</h3>
<p>Now let’s consider our model that uses the size of the house in square feet as the explanatory variable. The figure on the left shows difference between actual and predicted prices, using this linear model. We compare the size of the differences to those resulting from the basic model that does not use any explanatory variables, and predicts each price using the overall average (shown on the right).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>P_Resid_M_House_price_sqft <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>Houses, <span class="fu">aes</span>(<span class="at">x =</span> sqft_living, <span class="at">y =</span> price)) <span class="sc">+</span>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>                <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">xend =</span> sqft_living, <span class="at">yend =</span> M_House_price_sqft<span class="sc">$</span>fitted.values), <span class="at">color=</span><span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>                <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> M_House_price_sqft<span class="sc">$</span>fitted.values), <span class="at">shape =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>                <span class="fu">stat_smooth</span>(<span class="at">method=</span><span class="st">"lm"</span>, <span class="at">se=</span><span class="cn">FALSE</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">5000</span>)) <span class="sc">+</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>                <span class="fu">theme_bw</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch2_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
<p>Notice that the red lines are shorter in the figure on the left, indicating the predictions are closer to the actual values.</p>
<p>The difference between the actual and predicted values is called the <strong>residual</strong>. The residual for the <span class="math inline">\(ith\)</span> case is</p>
<p><span class="math display">\[
r_i = (y_i-\hat{y}_i)
\]</span></p>
<p>We’ll calculate the residuals for the first three houses in the dataset, shown below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(First3Houses)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">ID</th>
<th style="text-align: right;">price</th>
<th style="text-align: left;">waterfront</th>
<th style="text-align: right;">sqft_living</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">90</td>
<td style="text-align: right;">335.0</td>
<td style="text-align: left;">No</td>
<td style="text-align: right;">1030</td>
</tr>
<tr class="even">
<td style="text-align: right;">126</td>
<td style="text-align: right;">1450.0</td>
<td style="text-align: left;">No</td>
<td style="text-align: right;">2750</td>
</tr>
<tr class="odd">
<td style="text-align: right;">300</td>
<td style="text-align: right;">267.5</td>
<td style="text-align: left;">No</td>
<td style="text-align: right;">1590</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The model equation is</p>
<p><span class="math display">\[
\widehat{\text{Price}} = -364.85 + 0.46\times \text{Sq. Ft}
\]</span></p>
<p>The predicted prices for these three houses are:</p>
<p><span class="math display">\[
\widehat{\text{Price}_1} = -364.85 + 0.46\times 1030 = 113.2 \text{ thousand dollars}
\]</span></p>
<p><span class="math display">\[
\widehat{\text{Price}_2} = -364.85 + 0.46\times 2750 = 911.5 \text{ thousand dollars}
\]</span></p>
<p><span class="math display">\[
\widehat{\text{Price}_3} = -364.85 + 0.46\times 1590 = 373.1 \text{ thousand dollars}
\]</span></p>
<p>To calculate the residuals, we subtract the predicted price from the actual price.</p>
<p><span class="math display">\[r_1 = y_1-\hat{y}_1 = 335 - 113.2 = 222  \text{ thousand dollars}\]</span></p>
<p><span class="math display">\[r_2 = y_2-\hat{y}_2 = 1450 - 911.5 = 538 \text{ thousand dollars}\]</span></p>
<p><span class="math display">\[r_3 = y_3-\hat{y}_2 = 267.5 - 373.1 = -106 \text{ thousand dollars}\]</span></p>
<p>Positive residuals indicate that the house sold for more than the model predicted, while negative residuals mean the house sold for less than the model predicted.</p>
<p>The predicted values and residuals from a model can be calculated automatically in R. The predicted values and residuals for the first 3 houses are shown below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>Predicted <span class="ot">&lt;-</span> <span class="fu">predict</span>(M_House_price_sqft)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Predicted, <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       1        2        3 
113.2049 911.5096 373.1180 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>Residual <span class="ot">&lt;-</span> M_House_price_sqft<span class="sc">$</span>residuals</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Residual, <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        1         2         3 
 221.7951  538.4904 -105.6180 </code></pre>
</div>
</div>
</section>
<section id="variability-explained-by-sq.-ft.-model" class="level3" data-number="2.2.3">
<h3 data-number="2.2.3" class="anchored" data-anchor-id="variability-explained-by-sq.-ft.-model"><span class="header-section-number">2.2.3</span> Variability Explained by Sq. Ft. Model</h3>
<p>The <strong>sum of squared residuals (SSR)</strong> measures the amount of unexplained variability in the response variable after accounting for all explanatory variables in the model.</p>
<p><span class="math display">\[
\text{SSR} = \displaystyle\sum_{i=1}^{n}(y_i-\hat{y}_i)^2.  
\]</span></p>
<p>Note that SSR is similar to SST, except we subtract the model’s predicted values, rather than the overall average. In the special case of a model with no explanatory variables, the predicted values are equal to the overall average, so SSR is equal to SST.</p>
<p>We calculate SSR for the model using square feet as the explanatory variable.</p>
<p><span class="math display">\[
\begin{aligned}
\text{SSR} &amp; = \displaystyle\sum_{i=1}^{n}(y_i-\hat{y}_i)^2.  \\
&amp; = (335 - 113.2)^2 + (1450 - 911.5)^2 + (267.5 - 373.1)^2 + \ldots
\end{aligned}
\]</span></p>
<p>We can calculate the model’s SSR directly in R.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>SSR_M_House_price_sqft <span class="ot">&lt;-</span> <span class="fu">sum</span>(M_House_price_sqft<span class="sc">$</span>residuals<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>SSR_M_House_price_sqft</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 34576162</code></pre>
</div>
</div>
<p>SSR represents the amount of total variability in saleprice remaining after accounting for the house’s size in square feet.</p>
<p>The SSR=34576162.0524397 value is about one third of the SST value of 91640003.8131156. This means that about 2/3 of the total variability in sale price is explained by the model that accounts for sale price.</p>
<p>The difference (SST-SSR) represents the variability in the response variable that is explained by the model. This quantity is called the <strong>model sum of squares (SSM)</strong>.</p>
<p><span class="math display">\[ \text{SSM} = \text{SST} - \text{SSR} \]</span></p>
<p>It can be shown that <span class="math inline">\(\text{SSM}=\displaystyle\sum_{i=1}^n(\hat{y}_i-\bar{y})^2\)</span>.</p>
<p>The proportion of total variability in the response variable explained by the model is called the <strong>coefficient of determination</strong>, denoted <span class="math inline">\(R^2\)</span>. We calculate this by dividing SSM by SST.</p>
<p><span class="math display">\[
R^2=\frac{SSM}{SST}= \frac{SST-SSR}{SST}
\]</span></p>
<p><strong>Example:</strong> For the model with square feet as the explanatory variable,</p>
<p><span class="math display">\[
SSM = SST-SSR = 91640004 - 34576162 = 57063842 .
\]</span></p>
<p><span class="math display">\[
R^2 = \frac{34576162}{91640004}=0.62.
\]</span></p>
<p>Approximately 62.3% of the total variability in sale price is explained by the model using square feet as the explanatory variable.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch2_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We calculate <span class="math inline">\(R^2\)</span> directly in R.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(M_House_price_sqft)<span class="sc">$</span>r.squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6226958</code></pre>
</div>
</div>
</section>
<section id="linear-correlation-coefficient" class="level3" data-number="2.2.4">
<h3 data-number="2.2.4" class="anchored" data-anchor-id="linear-correlation-coefficient"><span class="header-section-number">2.2.4</span> Linear Correlation Coefficient</h3>
<p>For models with a single quantiative explanatory varible, the coefficient of determination is equal to the square of the correlation coefficient <span class="math inline">\(r\)</span>, discussed in Chapter 1.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>Houses, <span class="fu">aes</span>(<span class="at">x=</span>sqft_living, <span class="at">y=</span>price)) <span class="sc">+</span> </span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method=</span><span class="st">"lm"</span>, <span class="at">se=</span><span class="cn">FALSE</span>) <span class="sc">+</span> </span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Square Feet"</span>) <span class="sc">+</span> </span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Price (in thousands)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch2_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><p>For linear models with a single quantitative variable, the <strong>linear correlation coefficient</strong> <span class="math inline">\(r=\sqrt{R^2}\)</span>, or <span class="math inline">\(r=-\sqrt{R^2}\)</span> (with sign matching the sign on the slope of the line), provides information about the strength and direction of the linear relationship between the variables.</p></li>
<li><p><span class="math inline">\(-1 \leq r \leq 1\)</span>, and <span class="math inline">\(r\)</span> close to <span class="math inline">\(\pm1\)</span> provides evidence of strong linear relationship, while <span class="math inline">\(r\)</span> close to 0 suggests linear relationship is weak.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(Houses<span class="sc">$</span>price, Houses<span class="sc">$</span>sqft_living)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7891107</code></pre>
</div>
</div>
<p>There is a positive and fairly strong relationship between price and square feet of a house.</p>
<p>While the correlation coefficient, <span class="math inline">\(r\)</span> is equal to the square root of <span class="math inline">\(R^2\)</span> in the simple case of a model with one quantitative explanatory variable and a quantitative response variable, <span class="math inline">\(R^2\)</span> has much broader application, as <span class="math inline">\(r\)</span> is defined only for models with one quantitative explanatory variable and a quantitative response, while <span class="math inline">\(R^2\)</span> is relevant for any linear model with a quantitative response variable.</p>
</section>
<section id="variability-explained-by-waterfront-model" class="level3" data-number="2.2.5">
<h3 data-number="2.2.5" class="anchored" data-anchor-id="variability-explained-by-waterfront-model"><span class="header-section-number">2.2.5</span> Variability Explained by Waterfront Model</h3>
<p>We can similarly calculate the proportion of variability explained by the model using waterfront as an explanatory variable.</p>
<p>Recall that in this model, the predicted price of a house with a waterfront is given by the average price of all waterfront houses, and the predicted price of a non-waterfront house is given by the average price of all non-waterfront houses.</p>
<p>We can calculate residuals using these predicted values, and compare them to the residuals resulting from a model with no explanatory variables, which uses the overall average price for all predictions.</p>
<p>The left two figures show the residuals resulting from a model that accounts for waterfront status. The figure on the right shows the residuals resulting from the model with no explanatory variables.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch2_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
<p>Notice that after accounting for waterfront status, the differences between observed and predicted values are bigger than they were in the model that accounted for square feet, though not as big as for the model that doesn’t use any explanatory variables.</p>
<p>We use R to calculate SSR for the waterfront model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>SSR_M_House_price_wf <span class="ot">&lt;-</span> <span class="fu">sum</span>(M_House_price_wf<span class="sc">$</span>residuals<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>SSR_M_House_price_wf</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 56895095</code></pre>
</div>
</div>
<p><span class="math display">\[
SSM = SST-SSR = 91640004 - 56895095 = 34744909.
\]</span></p>
<p><span class="math display">\[
R^2 = \frac{34744909}{91640004}=0.38.
\]</span></p>
<p>Approximately 37.9145647% of the total variability in sale price is explained by the model using waterfront status as the explanatory variable.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch2_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We calculate <span class="math inline">\(R^2\)</span> directly in R.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(M_House_price_wf)<span class="sc">$</span>r.squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3791456</code></pre>
</div>
</div>
</section>
<section id="variability-explained-by-multiple-regression-model" class="level3" data-number="2.2.6">
<h3 data-number="2.2.6" class="anchored" data-anchor-id="variability-explained-by-multiple-regression-model"><span class="header-section-number">2.2.6</span> Variability Explained by Multiple Regression Model</h3>
<p>We’ve seen at the model using square feet accounts for about 2/3 of the total variability in house prices, while the model using waterfront status accounts for about 1/3 of the total variability. Let’s see if we can do better by using both variables together.</p>
<p>The left figure shows the residuals resulting from a model that accounts for both waterfront status and square feet. The figure on the right shows the residuals resulting from the model with no explanatory variables.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch2_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
<p>We use R to calculate SSR for the waterfront model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>SSR_M_House_price_sqft_wf <span class="ot">&lt;-</span> <span class="fu">sum</span>(M_House_price_sqft_wf<span class="sc">$</span>residuals<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>SSR_M_House_price_sqft_wf</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 23720774</code></pre>
</div>
</div>
<p><span class="math display">\[
SSM = SST-SSR = 91640004 - 23720774 = 67919230.
\]</span></p>
<p><span class="math display">\[
R^2 = \frac{67919230}{91640004}=0.74.
\]</span></p>
<p>Approximately 74.1152631% of the total variability in sale price is explained by the model using square feet and waterfront status as the explanatory variables.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch2_files/figure-html/unnamed-chunk-45-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We calculate <span class="math inline">\(R^2\)</span> directly in R.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(M_House_price_sqft_wf)<span class="sc">$</span>r.squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7411526</code></pre>
</div>
</div>
<p>Including both square feet and waterfront status allows us to explain more variability in sale price than models that include one but not both of these variables.</p>
</section>
<section id="adding-age" class="level3" data-number="2.2.7">
<h3 data-number="2.2.7" class="anchored" data-anchor-id="adding-age"><span class="header-section-number">2.2.7</span> Adding Age</h3>
<p>We’ve seen that a multiple regression model that accounts for both square feet and whether or not the house is on the waterfront explains more variability in price than a model with only one of those variables. We can consider adding additional variables to the model to try to even better explain variability with price.</p>
<p>Let’s consider adding the age of the house to the model.</p>
<p>The model equation is</p>
<p><span class="math display">\[
\widehat{\text{Price}} = b_0 + b_1\times\text{Sq. Ft} + b_2\times\text{Waterfront} + b_3\times\text{Age}
\]</span></p>
<p>Since we now have two quantitative and one categorical explanatory variable, in addition to our response variable, it is difficult to produce a graph that would visualize this model. We can, however, fit the model in R and calculate predicted values as well as model sums of squares, just as we’ve done before.</p>
<p>Estimated model coefficients are shown below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>M_House_price_sqft_wf_age <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>Houses, price <span class="sc">~</span> sqft_living <span class="sc">+</span> waterfront <span class="sc">+</span> age)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>M_House_price_sqft_wf_age</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = price ~ sqft_living + waterfront + age, data = Houses)

Coefficients:
  (Intercept)    sqft_living  waterfrontYes            age  
    -353.1583         0.3942       733.2522         1.4212  </code></pre>
</div>
</div>
<p>The age coefficient estimate <span class="math inline">\(b_3\)</span> tells us that for each additional year in age, the expected price is expected to increase by 1.4 thousand dollars, assuming square feet and waterfront status are held constant. This is not a very large change.</p>
<p>We can calculate predicted prices, residuals, SSR, SSM, and <span class="math inline">\(R^2\)</span> the same way we did for the previous models, but let’s rely on R for these calculations.</p>
<p>SSR:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>SSR_M_House_price_sqft_wf_age <span class="ot">&lt;-</span> <span class="fu">sum</span>((M_House_price_sqft_wf_age<span class="sc">$</span>residuals)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">|&gt;</span><span class="fu">round</span>(<span class="dv">1</span>)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>SSR_M_House_price_sqft_wf_age</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 23436092</code></pre>
</div>
</div>
<p>SSM:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>SSM_M_House_price_sqft_wf_age <span class="ot">&lt;-</span> SST_M_House_price <span class="sc">-</span> SSR_M_House_price_sqft_wf_age <span class="sc">|&gt;</span><span class="fu">round</span>(<span class="dv">1</span>)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>SSM_M_House_price_sqft_wf_age</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 68203912</code></pre>
</div>
</div>
<p><span class="math inline">\(R^2\)</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(M_House_price_sqft_wf_age)<span class="sc">$</span>r.squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7442592</code></pre>
</div>
</div>
<p>Recall that the model with square feet and waterfront, but not age, as explanatory variables had an <span class="math inline">\(R^2\)</span> value of 0.7411526. Adding age to the model only resulted in a tiny increase in <span class="math inline">\(R^2\)</span>, meaning that age only explains a very small percentage of the variability in price that was not explained by size and waterfront status. Thus, it may not be beneficial to add age to a model the model.</p>
<p>When a new variable is added SSR will never increase and <span class="math inline">\(R^2\)</span> will never decrease. Thus, adding even unimportant variables typically lead to small decreases in <span class="math inline">\(R^2\)</span>. This does not necessarily mean we should add these variables. For one, thing this makes the model harder to interpret. It’s also true that making a model more complex by adding additional variables makes it more prone to a phenomenon called “overfitting.” This means that the model starts modeling random noise, rather than true relationships in the data it was built on (in this case, the 200 houses), causing it to perform worse when predicting new houses than a simpler model with fewer variables would. We’ll look more at overfitting later in the course.</p>
<p>Sometimes, it can be good to include a variable in a model even if it only leads to a small increase in <span class="math inline">\(R^2\)</span>. If we were interested in drawing and reporting conclusions on the relationship between the age and expected price of a house, it would be worth including age in the model, so we can report that it does not appear to make much difference. This result might be surprising and interesting in and of itself. There is no single correct model for a given set of data. We should choose models based on relationships we see in the data, as well as the research question(s) we are interested in answering.</p>
</section>
<section id="summary-sst-ssr-ssm-r2" class="level3" data-number="2.2.8">
<h3 data-number="2.2.8" class="anchored" data-anchor-id="summary-sst-ssr-ssm-r2"><span class="header-section-number">2.2.8</span> Summary: SST, SSR, SSM, <span class="math inline">\(R^2\)</span></h3>
<ul>
<li>the total variability in the response variable is the sum of the squared differences between the observed values and the overall average.</li>
</ul>
<p><span class="math display">\[\text{Total Variability in Response Var.}= \text{SST} =\displaystyle\sum_{i=1}^n(y_i-\bar{y})^2\]</span></p>
<ul>
<li>the variability remaining unexplained even after accounting for explanatory variable(s) in a model is given by the sum of squared residuals. We abbreviate this SSR, for sum of squared residuals.</li>
</ul>
<p><span class="math display">\[
\text{SSR} = \text{Variability Remaining}=\displaystyle\sum_{i=1}^n(y_i-\hat{y}_i)^2
\]</span></p>
<ul>
<li>the variability explained by the model, abbreviated SSM, is given by</li>
</ul>
<p><span class="math display">\[ \text{SSM} = \text{SST} - \text{SSR} \]</span></p>
<ul>
<li>The coefficient of determination (abbreviated <span class="math inline">\(R^2\)</span>) is defined as</li>
</ul>
<p><span class="math display">\[R^2=\frac{\text{Variability Explained by Model}}{\text{Total Variability}}=\frac{\text{SSM}}{\text{SST}} =\frac{\displaystyle\sum_{i=1}^n(\hat{y}_i-\bar{y})^2}{\displaystyle\sum_{i=1}^n(y_i-\bar{y})^2}\]</span></p>
<p>Note that some texts use different abbreviations than the ones used here. When working with resources outside this class, be sure to carefully check the notation being used.</p>
<p>For the model with a single quantitative explanatory variable.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Rsq.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>Model with a single categorical explanatory variable with 3 categories:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Rsq2.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><p>Blue Area = Total Variability (SST)</p></li>
<li><p>Red Area = Variability Remaining Unexplained by Model (SSR)</p></li>
<li><p>Blue Area - Red Area = Variability Explained by Model (SSM)</p></li>
<li><p><span class="math inline">\(R^2 = \frac{\text{Area of Blue Squares} - \text{Area of Red Squares}}{\text{Area of Blue Squares}} = \frac{\text{SST}-\text{SSR}}{\text{SST}}= \frac{\text{SSM}}{\text{SST}}\)</span></p></li>
</ul>
</section>
<section id="model-comparison-summary" class="level3" data-number="2.2.9">
<h3 data-number="2.2.9" class="anchored" data-anchor-id="model-comparison-summary"><span class="header-section-number">2.2.9</span> Model Comparison Summary</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th>Model</th>
<th>Variables</th>
<th>Unexplained Variability</th>
<th>Variability Explained</th>
<th><span class="math inline">\(R^2\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>None</td>
<td>91640004</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td>1</td>
<td>Sq. Ft.</td>
<td>34576162</td>
<td>57063842</td>
<td>0.623</td>
</tr>
<tr class="odd">
<td>2</td>
<td>Waterfront</td>
<td>56895095</td>
<td>34744909</td>
<td>0.379</td>
</tr>
<tr class="even">
<td>3</td>
<td>Sq. Ft. and Waterfront</td>
<td>23720774</td>
<td>67919230</td>
<td>0.741</td>
</tr>
<tr class="odd">
<td>4</td>
<td>Sq. Ft., Waterfront, and Age</td>
<td>23436092</td>
<td>68203912</td>
<td>0.744</td>
</tr>
</tbody>
</table>
<p><strong>Comments on</strong> <span class="math inline">\(R^2\)</span>:</p>
<ul>
<li><p><span class="math inline">\(R^2\)</span> will never decrease when a new variable is added to a model.<br>
</p></li>
<li><p>This does not mean that adding more variables to a model always improves its ability to make predictions on new data.<br>
</p></li>
<li><p><span class="math inline">\(R^2\)</span> measures how well a model fits the data on which it was built.<br>
</p></li>
<li><p>It is possible for a model with high <span class="math inline">\(R^2\)</span> to “overfit” the data it was built from, and thus perform poorly on new data. We will discuss this idea extensively later in the course.</p></li>
<li><p>On some datasets, there is a lot of “natural” variability in the response variable, and no model will achieve a high <span class="math inline">\(R^2\)</span>. That’s okay. Even a model with <span class="math inline">\(R^2 = 0.10\)</span> or less can provide useful information.</p></li>
<li><p>The goal is not to achieve a model that makes perfect predictions, but rather to be able to quantify the amount of uncertainty associated with the predictions we make.</p></li>
</ul>
<div style="page-break-after: always;"></div>
</section>
</section>
<section id="analysis-of-variance" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="analysis-of-variance"><span class="header-section-number">2.3</span> ANalysis Of VAriance</h2>
<section id="sub-models" class="level3" data-number="2.3.1">
<h3 data-number="2.3.1" class="anchored" data-anchor-id="sub-models"><span class="header-section-number">2.3.1</span> Sub-Models</h3>
<p>In the preceding sections, we’ve seen 5 different models for predicting house price using some combination of square feet and waterfront status.</p>
<p>A model is defined to be a <strong>submodel</strong> of a larger model, if the larger model contains all of the model’s variables plus more.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th>Model</th>
<th>Variables</th>
<th>Unexplained Variability</th>
<th>Variability Explained</th>
<th><span class="math inline">\(R^2\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>None</td>
<td>91640004</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td>1</td>
<td>Sq. Ft.</td>
<td>34576162</td>
<td>57063842</td>
<td>0.623</td>
</tr>
<tr class="odd">
<td>2</td>
<td>Waterfront</td>
<td>56895095</td>
<td>34744909</td>
<td>0.379</td>
</tr>
<tr class="even">
<td>3</td>
<td>Sq. Ft. and Waterfront</td>
<td>23720774</td>
<td>67919230</td>
<td>0.741</td>
</tr>
<tr class="odd">
<td>4</td>
<td>Sq. Ft., Waterfront, and Age</td>
<td>23436092</td>
<td>68203912</td>
<td>0.744</td>
</tr>
</tbody>
</table>
<ul>
<li><p>Model 1 is a submodel of Model 3, since all variables used in Model 1 are also used in Model 3.</p></li>
<li><p>Model 2 is also a submodel of Model 3.</p></li>
<li><p>Models 1, 2, and 3 are all submodels of Model 4.</p></li>
<li><p>Model 0 is a submodel of Models 1, 2, 3, and 4.</p></li>
<li><p>Models 1 and 2 are not submodels of each other, since Model 1 contains a variable used in Model 2 and Model 2 contains a variable not used in Model 1.</p></li>
</ul>
</section>
<section id="f-statistics" class="level3" data-number="2.3.2">
<h3 data-number="2.3.2" class="anchored" data-anchor-id="f-statistics"><span class="header-section-number">2.3.2</span> F-Statistics</h3>
<p>When one model is a submodel of another, we can compare the amount of variability explained by the models, using a technique known as <strong>ANalysis Of VAriance (ANOVA)</strong>.</p>
<p>Reduced Model: <span class="math inline">\(\hat{y}_i = b_0 + b_1x_{i1} + b_2x_{i2} + \ldots + b_qx_{iq}\)</span></p>
<p>Full Model: <span class="math inline">\(\hat{y}_i = b_0 + b_1x_{i1} + b_2x_{i2} + \ldots + b_qx_{iq} + b_{q+1}x_{i{q+1}} \ldots + b_px_{ip}\)</span></p>
<p>p = # terms in Full Model, not including the intercept<br>
q = # terms in Reduced Model, not including the intercept<br>
n = number of observations</p>
<p>We calculate a statistic called F that measures the amount of variability explained by adding additional variable(s) to the model, relative to the total amount of unexplained variability.</p>
<p><span class="math display">\[
\begin{aligned}
F  
&amp;= \frac{\frac{\text{SSR}_{\text{Reduced}}-\text{SSR}_{\text{Full}}}{p-q}}{\frac{\text{SSR}_{\text{Full}}}{n-(p+1)}}
\end{aligned}
\]</span></p>
<ul>
<li>Large values of F indicate that adding the additional explanatory variables is helpful in explaining variability in the response variable<br>
</li>
<li>Small values of F indicate that adding new explanatory variables variables does not make much of a difference in explaining variability in the response variable<br>
</li>
<li>What counts as “large” is depends on <span class="math inline">\(n, p,\)</span> and <span class="math inline">\(q\)</span>. We will revisit this later in the course.</li>
</ul>
<p><strong>Example 1</strong></p>
<p>Let’s Calculate an ANOVA F-Statistic to compare Models 1 and 3. This will tell us whether adding information about whether or not a house is on the waterfront helps us predict the price, when compared to a model using only square feet of living space.</p>
<p>Reduced Model:</p>
<p><span class="math display">\[
\widehat{\text{Price}}= b_0+ b_1 \times\text{sqft\_living}
\]</span></p>
<p>Full Model:</p>
<p><span class="math display">\[
\widehat{\text{Price}}= b_0+ b_1 \times\text{sqft\_living}+ b_2\times\text{Waterfront}
\]</span></p>
<p><span class="math display">\[
\begin{aligned}
F &amp;= \frac{\frac{\text{SSR}_{\text{Reduced}}-\text{SSR}_{\text{Full}}}{p-q}}{\frac{\text{SSR}_{\text{Full}}}{n-(p+1)}} \\
&amp;=\frac{\frac{23720773.8648291 - 34576162.0524397}{2-1}}{\frac{23720773.8648291}{200-(2+1)}} \\  
&amp; = 90.15
\end{aligned}
\]</span></p>
<p>We can calculate the statistic directly in R, using the <code>anova</code> command.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(M_House_price_sqft_wf, M_House_price_sqft)<span class="sc">$</span>F[<span class="dv">2</span>] <span class="sc">|&gt;</span><span class="fu">round</span>(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 90.15</code></pre>
</div>
</div>
<p>An F-statistic of 90.15 is quite large and provides strong evidence that adding waterfront status to a model already including square feet helps better explain variability in sale price.</p>
<p>We previously saw that the model including both square feet and waterfront status had a <span class="math inline">\(R^2\)</span> value considerably higher than the one including only square feet. This large F-statistic is further evidence of the benefit of using both variables in our model.</p>
<p><strong>Example 2</strong></p>
<p>We’ll calculate an F-statistic to compare Models 3 and 4. This can help us determine whether it is worthwhile to include age in a model that already includes sqaure feet and waterfront status.</p>
<p>Reduced Model: <span class="math display">\[\widehat{\text{Price}}= b_0+ b_1 \times\text{sqft\_living} + b_2\times\text{Waterfront}\]</span></p>
<p>Full Model: <span class="math display">\[\widehat{\text{Price}}= b_0+ b_1 \times\text{sqft\_living}+ b_2\times\text{Waterfront} + b_3\times\text{Age}\]</span></p>
<p><span class="math display">\[
\begin{aligned}
F &amp;= \frac{\frac{\text{SSR}_{\text{Reduced}}-\text{SSR}_{\text{Full}}}{p-q}}{\frac{\text{SSR}_{\text{Full}}}{n-(p+1)}} \\
&amp;=\frac{\frac{23436092 - 23720773.8648291}{3-2}}{\frac{23720773.8648291}{200-(3+1)}} \\  
&amp; = 2.38
\end{aligned}
\]</span></p>
<p>We can calculate the statistic directly in R, using the <code>anova</code> command.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(M_House_price_sqft_wf_age, M_House_price_sqft_wf)<span class="sc">$</span>F[<span class="dv">2</span>] <span class="sc">|&gt;</span><span class="fu">round</span>(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.38</code></pre>
</div>
</div>
<p>Now, the F-statistic is much smaller than we’ve seen before, indicating that adding age to the model does not help very much in explaining variability in price.</p>
<p>You might be wondering how large an F-statistic needs to be in order to merit using the larger model. This is a complicated question, which we’ll explore more in future chapters, but as a general rule, F-statistics larger than 4 typically provide evidence in favor of choosing the larger (full) model over the reduced one.</p>
</section>
<section id="f-statistic-for-comparing-groups" class="level3" data-number="2.3.3">
<h3 data-number="2.3.3" class="anchored" data-anchor-id="f-statistic-for-comparing-groups"><span class="header-section-number">2.3.3</span> F-Statistic for Comparing Groups</h3>
<p>While F-statistics can be used for models with quantitative or categorical variables, they are often used to compare groups for a categorical explanatory variable.</p>
<p>An F-statistic compares the amount of variability between groups to the amount of variability within groups. Larger F-statistics indicate more variability between groups, rather than within groups, indicating stronger evidence of differences between groups.</p>
<p>In scenario 1, we notice considerable differences between the groups, relative to the amount of variability within groups. In this scenario, knowing the group an observation is in will help us predict the response for that group, so we should include account for the groups in our model. We would obtain a large F-statistic when comparing a model that includes group to one that contains only an intercept term.</p>
<p>In scenario 2, there is little difference between the overall averages in each group, and more variability between individual observations within each group. In a scenario like this, knowing the group an observation lies in does little to help us predict the response. In this scenario, predictions from a model that includes group as an explanatory variable would not be much better than those from a model that does not. Hence, we would obtain a small F-statistic.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch2_files/figure-html/unnamed-chunk-56-1.png" class="img-fluid figure-img" width="864"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>M_df1_F  <span class="ot">&lt;-</span> <span class="fu">summary</span>(<span class="fu">lm</span>(<span class="at">data=</span>df1, y<span class="sc">~</span>Group))<span class="sc">$</span>fstatistic[<span class="dv">1</span>]</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>M_df2_F  <span class="ot">&lt;-</span> <span class="fu">summary</span>(<span class="fu">lm</span>(<span class="at">data=</span>df2, y<span class="sc">~</span>Group))<span class="sc">$</span>fstatistic[<span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<table class="caption-top table">
<thead>
<tr class="header">
<th></th>
<th>Scenario 1</th>
<th>Scenario 2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>variation between groups</td>
<td>High</td>
<td>Low</td>
</tr>
<tr class="even">
<td>variation within groups</td>
<td>Low</td>
<td>High</td>
</tr>
<tr class="odd">
<td>F Statistic</td>
<td>Large ($F=<span class="math inline">\(46.5970149) | Small (\)</span>F=$<code>M_df2_F</code>)</td>
<td></td>
</tr>
<tr class="even">
<td>Result</td>
<td>Evidence of Group Differences</td>
<td>No evidence of differences</td>
</tr>
</tbody>
</table>
<p>We’ll use F-statistics to compare the prices of waterfront houses to non-waterfront houses, and also to compare the three different conditions of houses.</p>
<p><strong>Example 1: Price by Waterfront Status</strong></p>
<p>The boxplot shows the distribution of houses in each category, and the table below it provides a numerical summary.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>Houses, <span class="fu">aes</span>(<span class="at">x=</span>waterfront, <span class="at">y=</span>price)) <span class="sc">+</span> </span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outliers=</span><span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>() <span class="sc">+</span> </span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span>  </span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.y=</span><span class="st">"mean"</span>, <span class="at">geom=</span><span class="st">"point"</span>, <span class="at">shape=</span><span class="dv">20</span>, <span class="at">color=</span><span class="st">"red"</span>, <span class="at">fill=</span><span class="st">"red"</span>) <span class="sc">+</span> </span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"Price by Waterfront Status"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch2_files/figure-html/unnamed-chunk-58-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>Cond_Tab <span class="ot">&lt;-</span> Houses <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(waterfront) <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">Mean_Price =</span> <span class="fu">mean</span>(price), </span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>                                             <span class="at">SD_Price=</span> <span class="fu">sd</span> (price), </span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>                                             <span class="at">N=</span> <span class="fu">n</span>())</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(Cond_Tab)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">waterfront</th>
<th style="text-align: right;">Mean_Price</th>
<th style="text-align: right;">SD_Price</th>
<th style="text-align: right;">N</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">No</td>
<td style="text-align: right;">552.6609</td>
<td style="text-align: right;">409.7904</td>
<td style="text-align: right;">175</td>
</tr>
<tr class="even">
<td style="text-align: left;">Yes</td>
<td style="text-align: right;">1812.9540</td>
<td style="text-align: right;">1073.8480</td>
<td style="text-align: right;">25</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>When measuring differences between groups for a categorical variable, we compare a model with the categorical variable to one with only an intercept term. In this case, the models are:</p>
<p>Reduced Model: <span class="math display">\[\widehat{\text{Price}}= b_0\]</span></p>
<p>Full Model: <span class="math display">\[\widehat{\text{Price}}= b_0+ b_1 \times\text{waterfront}\]</span></p>
<p>We’ll fit the model in R. The coefficient estimates for <span class="math inline">\(b_0\)</span>, <span class="math inline">\(b_1\)</span> and <span class="math inline">\(b_2\)</span> are shown below.</p>
<p>We previously calculated <span class="math inline">\(SSR_full\)</span> to be</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>SSR_M_House_price_wf <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 56895095</code></pre>
</div>
</div>
<p>For a model containing only an intercept term, like the reduced model, SSR is equal to SST.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>SST_M_House_price</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 91640004</code></pre>
</div>
</div>
<p>The F-statistic is</p>
<p><span class="math display">\[
\begin{aligned}
F &amp;= \frac{\frac{\text{SSR}_{\text{Reduced}}-\text{SSR}_{\text{Full}}}{p-q}}{\frac{\text{SSR}_{\text{Full}}}{n-(p+1)}} \\
&amp;=\frac{\frac{91640003.8131156 - 56895095.2689966}{1-0}}{\frac{56895095.2689966}{200-(1+1)}} \\  
&amp; = 120.92
\end{aligned}
\]</span></p>
<p>Confirming the calculation in R, we obtain</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(M_House_price_wf, M_House_price_0)<span class="sc">$</span>F[<span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 120.9154</code></pre>
</div>
</div>
<p>The F-statistic is very large, indicating strong efidence that waterfront status is associated with the price of a house, which is consistent with what we’ve observed in our plots as well as <span class="math inline">\(R^2\)</span> calculation.</p>
<p><strong>Example 2: Price by Condition</strong></p>
<p>One variable in the houses dataset, which we haven’t looked at yet, is the condition of the house at the time of sale. The table shows the number of houses in either 1) very good, 2) good, or 3) average or below condition.</p>
<p>The boxplot shows the distribution of houses in each category, and the table below it provides a numerical summary.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>Houses, <span class="fu">aes</span>(<span class="at">x=</span>condition, <span class="at">y=</span>price)) <span class="sc">+</span> </span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outliers=</span><span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>() <span class="sc">+</span> </span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span>  </span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.y=</span><span class="st">"mean"</span>, <span class="at">geom=</span><span class="st">"point"</span>, <span class="at">shape=</span><span class="dv">20</span>, <span class="at">color=</span><span class="st">"red"</span>, <span class="at">fill=</span><span class="st">"red"</span>) <span class="sc">+</span> </span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch2_files/figure-html/unnamed-chunk-63-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>Cond_Tab <span class="ot">&lt;-</span> Houses <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(condition) <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">Mean_Price =</span> <span class="fu">mean</span>(price), </span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>                                             <span class="at">SD_Price=</span> <span class="fu">sd</span> (price), </span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>                                             <span class="at">N=</span> <span class="fu">n</span>())</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(Cond_Tab)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">condition</th>
<th style="text-align: right;">Mean_Price</th>
<th style="text-align: right;">SD_Price</th>
<th style="text-align: right;">N</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">average or below</td>
<td style="text-align: right;">690.1892</td>
<td style="text-align: right;">683.0578</td>
<td style="text-align: right;">142</td>
</tr>
<tr class="even">
<td style="text-align: left;">good</td>
<td style="text-align: right;">729.0987</td>
<td style="text-align: right;">671.5967</td>
<td style="text-align: right;">47</td>
</tr>
<tr class="odd">
<td style="text-align: left;">very_good</td>
<td style="text-align: right;">887.7273</td>
<td style="text-align: right;">684.5189</td>
<td style="text-align: right;">11</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Notice that while houses in very good condition are the most expensive, differences between the three conditions are not that large and there is a lot of variability within each condition group.</p>
<p>We’ll calculate an F-statistic for a model that includes condition, compared to a model with only an intercept term.</p>
<p>Reduced Model: <span class="math display">\[\widehat{\text{Price}}= b_0\]</span></p>
<p>Full Model: <span class="math display">\[\widehat{\text{Price}}= b_0+ b_1 \times\text{good condition}+ b_2\times\text{very good condition}\]</span></p>
<p>Notice that the equation includes separate variables for the “good” and “very” good conditions. These variables take on value 0 if the house is not in that condition, and 1 if the house is in that condition. Here, the “average or below” condition is considered the “baseline” category.</p>
<p>We’ll fit the model in R. The coefficient estimates for <span class="math inline">\(b_0\)</span>, <span class="math inline">\(b_1\)</span> and <span class="math inline">\(b_2\)</span> are shown below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>M_House_price_cond <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>Houses, price<span class="sc">~</span>condition)</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>M_House_price_cond</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = price ~ condition, data = Houses)

Coefficients:
       (Intercept)       conditiongood  conditionvery_good  
            690.19               38.91              197.54  </code></pre>
</div>
</div>
<p><strong>Interpretations</strong></p>
<ul>
<li>On average, houses in average or below condition cost 690.19 thousand dollars.<br>
</li>
<li>On average, houses in good condition cost 38.91 thousand dollars more than those in average or below condition.<br>
</li>
<li>On average, houses in very good condition cost 197.54 thousand dollars more than those in average or below condition.</li>
</ul>
<p>We calculate SSR for the full model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>SSR_M_House_price_cond <span class="ot">&lt;-</span> <span class="fu">sum</span>(M_House_price_cond<span class="sc">$</span>residuals<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>SSR_M_House_price_cond  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 91219681</code></pre>
</div>
</div>
<p>Note that in this case, <span class="math inline">\(p=2\)</span>, since the full model includes terms for both good and very good conditions. For a categorical variable with <span class="math inline">\(g\)</span> groups, there will always be <span class="math inline">\(g-1\)</span> terms in the model equation, one for each category other than the baseline.</p>
<p>The F-statistic is</p>
<p><span class="math display">\[
\begin{aligned}
F &amp;= \frac{\frac{\text{SSR}_{\text{Reduced}}-\text{SSR}_{\text{Full}}}{p-q}}{\frac{\text{SSR}_{\text{Full}}}{n-(p+1)}} \\
&amp;=\frac{\frac{91640003.8131156 - 91219680.6197368}{2-0}}{\frac{91219680.6197368}{200-(2+1)}} \\  
&amp; = 0.45
\end{aligned}
\]</span></p>
<p>We perform the calculation directly in R.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(M_House_price_cond, M_House_price_0)<span class="sc">$</span>F[<span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4538695</code></pre>
</div>
</div>
<p>Notice that the F-statistic of 0.45 is considerably smaller than the F-statistics we’ve seen previously.</p>
<p>This indicates that adding condition to a model with no other explanatory variables doesn’t seem to help improve the model’s ability to account for variation in price. Put another way, there doesn’t appear to be much evidence of difference in price between houses in the different conditions. This is again consistent with our conclusion based on the very small change in <span class="math inline">\(R^2\)</span> that we saw when adding condition to the model in the previous section.</p>
</section>
<section id="relationship-between-f-statistic-and-r2" class="level3" data-number="2.3.4">
<h3 data-number="2.3.4" class="anchored" data-anchor-id="relationship-between-f-statistic-and-r2"><span class="header-section-number">2.3.4</span> Relationship Between F-statistic and <span class="math inline">\(R^2\)</span></h3>
<p>We’ve seen that both <span class="math inline">\(R^2\)</span> and the F-statistic give us ways of comparing models and determining whether explanatory variables help explain variability in the response.</p>
<p>You may be wondering why we need to calculate F-statistics when we already have <span class="math inline">\(R^2\)</span> to answer these questions. Here we’ll look at an example to illustrate the relationship between the two, showing how they’re alike, as well as how they differ.</p>
<p>Shown below are are two different scatterplots displaying relationships between variables <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>.</p>
<p>Which plot do you think displays a stronger relationship between <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>?</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch2_files/figure-html/unnamed-chunk-68-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We calculate <span class="math inline">\(R^2\)</span> values for linear models fit to both sets of data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>M_dfA <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>dfA, y1<span class="sc">~</span>x1)</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(M_dfA)<span class="sc">$</span>r.squared </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6278261</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>M_dfB <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>dfB, y<span class="sc">~</span>x)</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(M_dfB)<span class="sc">$</span>r.squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6441707</code></pre>
</div>
</div>
<p>We see that the <span class="math inline">\(R^2\)</span> values are approximately the same.</p>
<p>You might have thought, however, that Scenario B shows a stronger relationship, and this would seem reasonable. Scenario B has 91 observations, while Scenario A only has 4, hence Scenario B has more information justifying a relationship between the variables.</p>
<p>The <span class="math inline">\(R^2\)</span> value captures only the strength of the relationship in the observed data, without accounting for the number of observations. In this section, we’ll look at a different statistic that can be used to assess the strength of relationships between variables in a model that, unlike <span class="math inline">\(R^2\)</span>, accounts for the sample size.</p>
<p>For each a model with explanatory variable <span class="math inline">\(x\)</span> to one with only an intercept term.</p>
<p>Reduced Model: <span class="math display">\[\widehat{y}= b_0\]</span></p>
<p>Full Model: <span class="math display">\[\widehat{y}= b_0+ b_1 x\]</span></p>
<p>Since, since <span class="math inline">\(p=1\)</span> and <span class="math inline">\(\text{SSR}_{\text{Reduced}}=\text{SST}\)</span>, the F-statistic becomes:</p>
<p><span class="math display">\[
F= \frac{\frac{\text{SSR}_{\text{Reduced}}-\text{SSR}_{\text{Full}}}{p-q}}{\frac{\text{SSR}_{\text{Full}}}{n-(p+1)}} = \frac{\frac{\text{SST}-\text{SSR}_{\text{Full}}}{1-0}}{\frac{\text{SSR}_{\text{Full}}}{n-(1+1)}}=
\frac{\text{SSM}_{\text{Full}}}{\text{SSR}_{\text{Full}}}\times(n-2) =\frac{R^2}{1-R^2}\times(n-2)
\]</span></p>
<p>Thus, we see that the F-statistic is closely related to <span class="math inline">\(R^2\)</span>, but it’s calculation involves one thing that the <span class="math inline">\(R^2\)</span> calculation does not - the sample size!</p>
<p>So, for dataset A in the illustration,</p>
<p><span class="math display">\[F= \frac{0.6278}{`1 - r summary(M_dfA)$r.squared|&gt; round(4)`} \times (4-2)` = 3.3738318\]</span>,</p>
<p>while for dataset B,</p>
<p><span class="math display">\[F= \frac{0.6442}{`1 - r summary(M_dfB)$r.squared|&gt; round(4)`} \times (4-2)` = 161.1199341\]</span>.</p>
<p>While the scenarios had similar <span class="math inline">\(R^2\)</span> values, Scenario B had a much greater F-statistic, due to the larger sample, size which provides more evidence of a relationship.</p>
<p>Both the F-statistic and <span class="math inline">\(R^2\)</span> are useful measures of a model fit. Neither is necessarily better than the other. The F-statistic accounts for sample size, while <span class="math inline">\(R^2\)</span> simply tells us how strongly related the variables are in the data we have. It is good to consider both when building and assessing models.</p>
</section>
<section id="comparing-3-or-more-categories" class="level3" data-number="2.3.5">
<h3 data-number="2.3.5" class="anchored" data-anchor-id="comparing-3-or-more-categories"><span class="header-section-number">2.3.5</span> Comparing 3 or More Categories</h3>
<p>F-statistics are commonly used when making comparisons involving categorical variables with 3 or more categories.</p>
<p>One variable in the houses dataset, which we haven’t looked at yet, is the condition of the house at the time of sale. The table shows the number of houses in each condition listed.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Houses<span class="sc">$</span>condition)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>average or below             good        very_good 
             142               47               11 </code></pre>
</div>
</div>
<p>We notice that there is only one house in poor condition and one house in fair condition. These sample sizes are too small to analyze. We’ll combine these two houses with those in the “average” category, creating a new category called “average or below).</p>
</section>
<section id="alternate-f-stat-formula" class="level3" data-number="2.3.6">
<h3 data-number="2.3.6" class="anchored" data-anchor-id="alternate-f-stat-formula"><span class="header-section-number">2.3.6</span> Alternate F-Stat Formula</h3>
<p>We saw that F-statistics are useful for comparing categorical variables with multiple groups. The “variation between” over “variation within” interpretation of an F-statistic lends itself to another (mathematically equivalent) formula for the F-statistic. We calculate the ratio of variability between different groups, relative to the amount of variability within each group</p>
<p>For a categorical variable with <span class="math inline">\(g\)</span> groups,</p>
<ul>
<li><p>let <span class="math inline">\(\bar{y}_{1\cdot}, \ldots, \bar{y}_{g\cdot}\)</span> represent the mean response for each group.</p></li>
<li><p>let <span class="math inline">\(n_1, \ldots, n_g\)</span> represent the sample size for each group</p></li>
<li><p>Then <span class="math inline">\(\frac{\displaystyle\sum_{i=1}^g\sum_{j=1}^{n_i}n_i(y_{i\cdot}-\bar{y}_{\cdot\cdot})^2}{g-1}\)</span> gives a measure of how much the group means differ, and</p></li>
<li><p><span class="math inline">\(\frac{\displaystyle\sum_{i=1}^g\sum_{j=1}^{n_i}(y_{ij}-\bar{y}_{i\cdot})^2}{n-g}\)</span> gives a measure of how much individual observations differ within groups</p></li>
<li><p>An alternative formula for this F-statistic is:</p></li>
</ul>
<p><span class="math display">\[
F= \frac{\text{Variability between groups}}{\text{Variability within groups}}= \frac{\frac{\displaystyle\sum_{i=1}^g\sum_{j=1}^{n_i}n_i(y_{i\cdot}-\bar{y}_{\cdot\cdot})^2}{g-1}}{\frac{\displaystyle\sum_{i=1}^g\sum_{j=1}^{n_i}(y_{ij}-\bar{y}_{i\cdot})^2}{n-g}}
\]</span></p>
<p>It can be shown that this statistic is equivalent to the one we saw previously.</p>
<p>For models with only one categorical explanatory variable, “variability within vs variability between” interpretation of an F-statistic is frequently in the natural and social sciences. Such studies are often referred to as One-Way ANOVA’s. In fact, these are just a special case of the “full vs reduced” model interpretation of the F-statistic, which can be applied to any two models, as long as one is a submodel of the other. In this class, we’ll use the more general “full vs reduced” model formula, but you should be aware that this other formula is just a special case of the one we’ll use in this class.</p>
</section>
</section>
<section id="least-squares-estimation-lse" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="least-squares-estimation-lse"><span class="header-section-number">2.4</span> Least Squares Estimation (LSE)</h2>
<section id="estimating-regression-coefficients" class="level3" data-number="2.4.1">
<h3 data-number="2.4.1" class="anchored" data-anchor-id="estimating-regression-coefficients"><span class="header-section-number">2.4.1</span> Estimating Regression Coefficients</h3>
<p>We’ve already used R to determine the estimates of <span class="math inline">\(b_0\)</span>, <span class="math inline">\(b_1\)</span>, <span class="math inline">\(b_2\)</span>, and <span class="math inline">\(b_3\)</span> in various kinds of linear models. At this point, it is natural to wonder where these estimates are come from.</p>
<p>Regression coefficients <span class="math inline">\(b_0, b_1, \ldots, b_p\)</span> are chosen in a way that minimizes the sum of the squared differences between the observed and predicted values. That is, we minimize</p>
<p><span class="math display">\[
\text{SSR} = \displaystyle\sum_{i=1}^{n} (y_i-\hat{y}_i)^2
\]</span></p>
<p>Because <span class="math inline">\(\hat{y}_i\)</span> is a function of <span class="math inline">\(b_0, b_1, \ldots, b_p\)</span>, we can choose the values of <span class="math inline">\(b_0, b_1, \ldots, b_p\)</span> in a way that minimizes SSR.</p>
<p><span class="math display">\[\text{SSR} = \displaystyle\sum_{i=1}^n (y_i -\hat{y}_i)^2  = \displaystyle\sum_{i=1}^n (y_i -(b_0 + b_1x_{i1} + b_2x_{i2} + \ldots + b_px_{ip}))^2 \]</span></p>
<p>The process of estimating regression coefficients <span class="math inline">\(b_0, b_1, \ldots, b_p\)</span> in a way that minimizes SSR is called <strong>least-squares estimation</strong>.</p>
<p><strong>Example: Model with one quantitative variable</strong></p>
<p>We start with an example of estimating the regression coefficients for a model with a single explanatory variable. This is easy to illustrate, since we can draw a scatter plot displaying our explanatory and response variable.</p>
<p>The figure below illustrates four possible trend lines that could be fit to a set of 10 points in a scatter plot. The first line is the line of best fit, in that it makes the sum of the squared residuals the smallest of all possible lines that could be drawn. The second through fourth plots all show examples of other trend lines that are not the line of best fit. The sum of squared residuals for each of these models is bigger than for the first one.</p>
<p>In the illustration, SSR is represented by the total area of the squares. The line of best fit is the one that make the intercept the smallest.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="LSE.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>This <a href="http://www.rossmanchance.com/applets/RegShuffle.htm">Rossman-Chance applet</a> provides an illustration of the line of best fit.</li>
</ul>
<p>Returning to the model for predicting price of a house, using only size in square feet as an explanatory variable, the scatter plot, along with the slope and intercept of the regression line are shown below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>Houses, <span class="fu">aes</span>(<span class="at">x=</span>sqft_living, <span class="at">y=</span>price)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method=</span><span class="st">"lm"</span>, <span class="at">se=</span><span class="cn">FALSE</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch2_files/figure-html/unnamed-chunk-73-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>M_House_price_sqft</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = price ~ sqft_living, data = Houses)

Coefficients:
(Intercept)  sqft_living  
  -364.8497       0.4641  </code></pre>
</div>
</div>
<p>The line <span class="math inline">\(\text{Price} = -485 + 0.5328 \times \text{Square Feet}\)</span> is the “line of best fit” in the sense that it minimizes the sum of the squared residuals (SSR). Any other choices for the slope or intercept of the regression line would result in larger SSR than this line.</p>
</section>
<section id="mathematics-of-lse-for-slr" class="level3" data-number="2.4.2">
<h3 data-number="2.4.2" class="anchored" data-anchor-id="mathematics-of-lse-for-slr"><span class="header-section-number">2.4.2</span> Mathematics of LSE for SLR</h3>
<ul>
<li><p>Consider a <strong>simple linear regression(SLR)</strong> model, which is one with a singe quantitative explanatory variable <span class="math inline">\(x\)</span>.</p></li>
<li><p><span class="math inline">\(\hat{y}_i = b_0+b_1x_i\)</span></p></li>
<li><p>we need to choose the values of <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span> that minimize:</p></li>
</ul>
<p><span class="math display">\[
\displaystyle\sum_{i=1}^n(y_i-\hat{y}_i)^2 =\displaystyle\sum_{i=1}^n(y_i-(b_0+b_1x_i))^2
\]</span></p>
<p>We setup the equation by substituting in the values of <span class="math inline">\(y_i\)</span> and <span class="math inline">\(x_i\)</span> seen in the data.</p>
<p>Recall the first 3 houses in the dataset:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(First3Houses)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">ID</th>
<th style="text-align: right;">price</th>
<th style="text-align: left;">waterfront</th>
<th style="text-align: right;">sqft_living</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">90</td>
<td style="text-align: right;">335.0</td>
<td style="text-align: left;">No</td>
<td style="text-align: right;">1030</td>
</tr>
<tr class="even">
<td style="text-align: right;">126</td>
<td style="text-align: right;">1450.0</td>
<td style="text-align: left;">No</td>
<td style="text-align: right;">2750</td>
</tr>
<tr class="odd">
<td style="text-align: right;">300</td>
<td style="text-align: right;">267.5</td>
<td style="text-align: left;">No</td>
<td style="text-align: right;">1590</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><span class="math display">\[
\begin{aligned}
\displaystyle\sum_{i=1}^{100}(y_i-\hat{y}_i)^2 &amp; =\displaystyle\sum_{i=1}^n(y_i-(b_0+b_1x_i))^2 \\
&amp; = (1225-(b_0+b_1(5420)))^2 + (885-(b_0+b_1(2830)))^2 + (385-(b_0+b_1(1620)))^2 + \ldots
\end{aligned}
\]</span></p>
<p>We need to find the values of <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span> that minimize this expression. This is a 2-dimensional optimization problem that can be solved using multivariable calculus or numerical or graphical methods.</p>
<p>Using calculus, it can be shown that this quantity is minimized when</p>
<ul>
<li><p><span class="math inline">\(b_1=\frac{\displaystyle\sum_{i=1}^{n}(x_i-\bar{x})(y_i-\bar{y})}{\displaystyle\sum_{i=1}^{n}(x_i-\bar{x})^2}=\frac{\displaystyle\sum_{i=1}^{n} x_i y_i-\frac{\displaystyle\sum_{i=1}^{n} x_i \displaystyle\sum_{i=1}^{n} y_i }{n}}{\left(\displaystyle\sum_{i=1}^{n} x_i^2 -\frac{\left(\displaystyle\sum_{i=1}^{n} x_i\right)^2}{n}\right)}\)</span></p></li>
<li><p><span class="math inline">\(b_0=\bar{y}-b_1\bar{x}\)</span> (where <span class="math inline">\(\bar{y}=\frac{\displaystyle\sum_{i=1}^{n}{y_i}}{n}\)</span>, and <span class="math inline">\(\bar{x}=\frac{\displaystyle\sum_{i=1}^{n}{x_i}}{n}\)</span>).</p></li>
</ul>
</section>
<section id="lse-for-categorical-variable" class="level3" data-number="2.4.3">
<h3 data-number="2.4.3" class="anchored" data-anchor-id="lse-for-categorical-variable"><span class="header-section-number">2.4.3</span> LSE for Categorical Variable</h3>
<ul>
<li><p>Consider a model with a single categorical variable (such as waterfront), with G+1 categories, numbered <span class="math inline">\(g=0,2, \ldots, G\)</span></p></li>
<li><p>Then <span class="math inline">\(\hat{y}_i = b_0 + b_1x_{i1} + \ldots +b_{G}x_{iG}\)</span>.</p></li>
<li><p>we need to minimize</p></li>
</ul>
<p><span class="math display">\[
\displaystyle\sum_{i=1}^n(y_i-\hat{y}_i)^2 =\displaystyle\sum_{i=1}^n(y_i-(b_0 + b_1x_{i1} + \ldots +b_{G}x_{iG}))^2.   
\]</span></p>
<ul>
<li>It can be shown that this is achieved when
<ul>
<li><span class="math inline">\(b_0 = \bar{y_0}\)</span> (i.e.&nbsp;the average response in the “baseline group”), and<br>
</li>
<li><span class="math inline">\(b_j = \bar{y_j} - \bar{y}_0\)</span></li>
</ul></li>
</ul>
</section>
<section id="lse-more-generally" class="level3" data-number="2.4.4">
<h3 data-number="2.4.4" class="anchored" data-anchor-id="lse-more-generally"><span class="header-section-number">2.4.4</span> LSE More Generally</h3>
<ul>
<li>For multiple regression models, including those involving interaction, the logic is the same. We need to choose <span class="math inline">\(b_0, b_1, \ldots, b_p\)</span> in order to minimize</li>
</ul>
<p><span class="math display">\[ \displaystyle\sum_{i=1}^n (y_i -\hat{y}_i)^2  = \displaystyle\sum_{i=1}^n (y_i -(b_0 + b_1x_{i1} + b_2x_{i2} + \ldots + b_px_{ip}))^2 \]</span></p>
<ul>
<li><p>The mathematics, however, are more complicated and require inverting a matrix. This goes beyond the scope of this class, so we will let R do the estimation and use the results.</p></li>
<li><p>More on least squares estimation in multiple regression can be found <a href="http://www.math.chalmers.se/Stat/Grundutb/GU/MSG500/A10/lecture5.pdf">here</a>.</p></li>
</ul>
<div style="page-break-after: always;"></div>
</section>
</section>
<section id="practice-questions" class="level2" data-number="2.5">
<h2 data-number="2.5" class="anchored" data-anchor-id="practice-questions"><span class="header-section-number">2.5</span> Practice Questions</h2>
<section id="section" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="section">1)</h3>
<p>We’ll work with the data set on 146 roller coasters from around the world. We’ll attempt to predict the speed of a coaster (in mph).</p>
<p>Summary information on the speeds of coasters is shown below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Coasters<span class="sc">$</span>Speed)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  25.00   50.00   57.00   59.11   66.00  120.00 </code></pre>
</div>
</div>
<section id="a" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="a">a)</h4>
<p>Consider a model of the form:</p>
<p>Model 0:</p>
<p><span class="math display">\[
\widehat{\text{Speed}} = b_0
\]</span></p>
<p>What is the value of <span class="math inline">\(b_0\)</span>?</p>
</section>
<section id="b" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="b">b)</h4>
<p>Speeds are broken down by type of coaster (steel or wooden).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>Coasters, <span class="fu">aes</span>(<span class="at">x=</span>Type, <span class="at">y=</span>Speed)) <span class="sc">+</span> </span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span>  </span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.y=</span><span class="st">"mean"</span>, <span class="at">geom=</span><span class="st">"point"</span>, <span class="at">shape=</span><span class="dv">20</span>, <span class="at">color=</span><span class="st">"red"</span>, <span class="at">fill=</span><span class="st">"red"</span>) <span class="sc">+</span> </span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch2_files/figure-html/unnamed-chunk-78-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>Coasters <span class="sc">|&gt;</span> <span class="fu">group_by</span>(Type) <span class="sc">|&gt;</span> <span class="fu">summarize</span>(<span class="at">MeanSpeed =</span> <span class="fu">round</span>(<span class="fu">mean</span>(Speed, <span class="at">na.rm=</span><span class="cn">TRUE</span>),<span class="dv">1</span>), <span class="at">Number=</span><span class="fu">n</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
  Type   MeanSpeed Number
  &lt;fct&gt;      &lt;dbl&gt;  &lt;int&gt;
1 Steel       61.5     83
2 Wooden      53.7     36</code></pre>
</div>
</div>
<p>Model 1:</p>
<p><span class="math display">\[
\widehat{\text{Speed}} = b_0 + b_1\times{\text{TypeWood}}
\]</span></p>
<p>What are the values of <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span>?</p>
</section>
</section>
<section id="section-1" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="section-1">2)</h3>
<p>We’ll fit a model using both type and duration (in seconds) as explanatory variables.</p>
<p><span class="math display">\[
\widehat{\text{Speed}} = b_0  + b_1\times{\text{TypeWooden}} + b_2\times\text{Duration}
\]</span></p>
<p>A scatterplot corresponding to this model is shown again below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>Coasters, <span class="fu">aes</span>(<span class="at">x=</span>Duration, <span class="at">y=</span>Speed, <span class="at">color=</span>Type))<span class="sc">+</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>          <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>          <span class="fu">xlab</span>(<span class="st">"Duration in Seconds"</span>) <span class="sc">+</span> </span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>          <span class="fu">ylab</span>(<span class="st">"Top Speed in MPH"</span>) <span class="sc">+</span></span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>          <span class="fu">geom_parallel_slopes</span>(<span class="at">se=</span><span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>          <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">125</span>)) <span class="sc">+</span></span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a>          <span class="fu">xlim</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">250</span>)) <span class="sc">+</span> </span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a>          <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch2_files/figure-html/unnamed-chunk-80-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>Approximately what are the values of <span class="math inline">\(b_0\)</span>, <span class="math inline">\(b_1\)</span>, and <span class="math inline">\(b_2\)</span>? (Hint: you may need to extend the lines to answer one or more of these.)</p>
</section>
<section id="section-2" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="section-2">3)</h3>
<p>Continuing with the roller coaster dataset, suppose we want to predict speed of the coaster (in mph), using either design or duration (in seconds) as explanatory variables.</p>
<section id="a-1" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="a-1">a)</h4>
<p>Let’s look at the number of coasters with each design type.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Coasters<span class="sc">$</span>Design)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>4th Dimension        Flying      Inverted      Pipeline      Sit Down 
            0             2            15             1            95 
     Stand Up     Suspended          Wing 
            5             1             0 </code></pre>
</div>
</div>
<p>Why might using design in this form in a statistical model be problematic?</p>
</section>
<section id="b-1" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="b-1">b)</h4>
<p>Continuing with the roller coasters data, we’ll modify the <code>design</code> variable to categorize each coaster as either “Sit Down” or “Other”.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>Coasters <span class="ot">&lt;-</span> Coasters <span class="sc">|&gt;</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>              <span class="fu">mutate</span>(<span class="at">Design =</span> <span class="fu">case_when</span>(</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>                              Design <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Sit Down"</span>) <span class="sc">~</span> <span class="st">"Sit Down"</span>,</span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>                              <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Other"</span>)) <span class="co"># Default for remaining categories</span></span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a>Coasters <span class="sc">|&gt;</span> <span class="fu">select</span>(Coaster, Park, Design, Duration, Speed) <span class="sc">|&gt;</span> <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        Coaster                       Park   Design Duration Speed
1 Zippin Pippin                Libertyland Sit Down       90    40
2   Jack Rabbit             Kennywood Park Sit Down       96    45
3   Thunderhawk                Dorney Park Sit Down       78    45
4  Giant Dipper Santa Cruz Beach Boardwalk Sit Down      112    55
5   Thunderbolt             Kennywood Park Sit Down      101    55
6       Wildcat             Lake Compounce Sit Down       75    48</code></pre>
</div>
</div>
<p>Shown below are scatterplots displaying the relationship between duration and speed, colored by design type.</p>
<p>Notice that in Plot A, there are 2 coasters with very fast speeds, of 100 mph or more. These appear to be outliers. In plot B, the outliers are removed from the dataset. Parallel regression lines for each type of coaster are fit in each plot.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>Coasters_filtered <span class="ot">&lt;-</span> Coasters <span class="sc">|&gt;</span> <span class="fu">filter</span>(Speed <span class="sc">&lt;</span> <span class="dv">100</span>)</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>Coasters_filtered <span class="sc">|&gt;</span> <span class="fu">select</span>(Coaster, Park, Max_Height, Design, Speed) <span class="sc">|&gt;</span> <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        Coaster                       Park Max_Height   Design Speed
1 Zippin Pippin                Libertyland         70 Sit Down    40
2   Jack Rabbit             Kennywood Park         40 Sit Down    45
3   Thunderhawk                Dorney Park         80 Sit Down    45
4  Giant Dipper Santa Cruz Beach Boardwalk         70 Sit Down    55
5   Thunderbolt             Kennywood Park         70 Sit Down    55
6       Wildcat             Lake Compounce         85 Sit Down    48</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>PlotA <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>Coasters, <span class="fu">aes</span>(<span class="at">x=</span>Duration, <span class="at">y=</span>Speed, <span class="at">color=</span>Design))<span class="sc">+</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>          <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>          <span class="fu">xlab</span>(<span class="st">"Duration in Seconds"</span>) <span class="sc">+</span> </span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>          <span class="fu">ylab</span>(<span class="st">"Top Speed in MPH"</span>) <span class="sc">+</span> </span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a>          <span class="fu">geom_parallel_slopes</span>(<span class="at">se=</span><span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a>          <span class="fu">ggtitle</span>(<span class="st">"Plot(A) - Including Outliers"</span>) <span class="sc">+</span></span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a>          <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">125</span>)) <span class="sc">+</span> </span>
<span id="cb102-8"><a href="#cb102-8" aria-hidden="true" tabindex="-1"></a>          <span class="fu">xlim</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">250</span>)) <span class="sc">+</span> </span>
<span id="cb102-9"><a href="#cb102-9" aria-hidden="true" tabindex="-1"></a>          <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>PlotB <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>Coasters_filtered, <span class="fu">aes</span>(<span class="at">x=</span>Duration, <span class="at">y=</span>Speed, <span class="at">color=</span>Design))<span class="sc">+</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>          <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>          <span class="fu">xlab</span>(<span class="st">"Duration in Seconds"</span>) <span class="sc">+</span> </span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a>          <span class="fu">ylab</span>(<span class="st">"Top Speed in MPH"</span>) <span class="sc">+</span></span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a>          <span class="fu">geom_parallel_slopes</span>(<span class="at">se=</span><span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a>          <span class="fu">ggtitle</span>(<span class="st">"Plot(B) - Removing Outliers"</span>) <span class="sc">+</span> </span>
<span id="cb103-7"><a href="#cb103-7" aria-hidden="true" tabindex="-1"></a>          <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">125</span>)) <span class="sc">+</span></span>
<span id="cb103-8"><a href="#cb103-8" aria-hidden="true" tabindex="-1"></a>          <span class="fu">xlim</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">250</span>)) <span class="sc">+</span> </span>
<span id="cb103-9"><a href="#cb103-9" aria-hidden="true" tabindex="-1"></a>          <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(PlotA, PlotB, <span class="at">ncol=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch2_files/figure-html/unnamed-chunk-86-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<p>How does removing the outliers affect the slope and intercepts of the regression lines relating speed and duration for each type of coaster? Which plot do you think more accurately captures the relationship between speed and duration? Explain your answer.</p>
</section>
</section>
<section id="section-3" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="section-3">4)</h3>
<p>We’ll continue with the <code>coasters_filtered</code> dataset that excludes the two outliers, and continue to classify each coaster design as either “sit-down” or “other”. In each part, you are asked to interpret model estimates. State the numerical value of each estimate specifically in your interpretation, as is done in Section 2.1 of the class notes.</p>
<section id="a-2" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="a-2">a)</h4>
<p>Consider a model of the form</p>
<p><strong>Model 0:</strong></p>
<p><span class="math display">\[
\widehat{\text{Speed}} = b_0
\]</span> The coefficient estimate <span class="math inline">\(b_0\)</span> for this model is shown below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>M_Coasters_speed_0 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>Coasters_filtered, Speed <span class="sc">~</span> <span class="dv">1</span>)</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>M_Coasters_speed_0</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Speed ~ 1, data = Coasters_filtered)

Coefficients:
(Intercept)  
      58.24  </code></pre>
</div>
</div>
<p>Write a sentence interpreting the estimate <span class="math inline">\(b_0\)</span> in context.</p>
</section>
<section id="b-2" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="b-2">b)</h4>
<p>Now consider a model of the form</p>
<p><strong>Model 1:</strong></p>
<p><span class="math display">\[
\widehat{\text{Speed}} = b_0 + b_1\times\text{Duration}
\]</span> Estimates of <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span> are shown below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>M_Coasters_speed_dur <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>Coasters_filtered, Speed <span class="sc">~</span> Duration)</span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>M_Coasters_speed_dur</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Speed ~ Duration, data = Coasters_filtered)

Coefficients:
(Intercept)     Duration  
    43.8001       0.1129  </code></pre>
</div>
</div>
<p>Write sentences interpreting the estimates <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span> in context.</p>
</section>
<section id="c" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="c">c)</h4>
<p>Now consider a model of the form</p>
<p><strong>Model 2:</strong></p>
<p><span class="math display">\[
\widehat{\text{Speed}} = b_0 + b_1\times\text{DesignSitDown}
\]</span></p>
<p>Estimates of <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span> are shown below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>M_Coasters_speed_des <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>Coasters_filtered, Speed <span class="sc">~</span> Design)</span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>M_Coasters_speed_des</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Speed ~ Design, data = Coasters_filtered)

Coefficients:
   (Intercept)  DesignSit Down  
         55.96            2.87  </code></pre>
</div>
</div>
<p>Write sentences interpreting the estimates <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span> in context.</p>
</section>
<section id="d" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="d">d)</h4>
<p>Finally, consider a model of the form</p>
<p><strong>Model 3:</strong></p>
<p><span class="math display">\[
\widehat{\text{Speed}} = b_0 + b_1\times\text{Duration} +  b_2\times\text{DesignSitDown}
\]</span></p>
<p>Estimates of <span class="math inline">\(b_0\)</span>, <span class="math inline">\(b_1\)</span>, and <span class="math inline">\(b_2\)</span> are shown below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>M_Coasters_speed_dur_des <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>Coasters_filtered, Speed <span class="sc">~</span> Duration <span class="sc">+</span> Design)</span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>M_Coasters_speed_dur_des</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Speed ~ Duration + Design, data = Coasters_filtered)

Coefficients:
   (Intercept)        Duration  DesignSit Down  
       40.4307          0.1159          3.7580  </code></pre>
</div>
</div>
<p>Write sentences interpreting the estimates <span class="math inline">\(b_0\)</span>, <span class="math inline">\(b_1\)</span>, and <span class="math inline">\(b_2\)</span> in context.</p>
</section>
</section>
<section id="section-4" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="section-4">5)</h3>
<p>Continuing with the model in 4(d), we’ll predict the speed of a roller coaster using duration and whether it has a sit down design as explanatory variables. The model is</p>
<p><span class="math display">\[
\widehat{\text{Speed}} = b_0 + b_1\times\text{Duration} +  b_2\times\text{DesignSitDown}
\]</span> A scatterplot displaying the relationship is shown below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>PlotB <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"Speed by Duration and Design"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch2_files/figure-html/unnamed-chunk-91-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>Estimates of <span class="math inline">\(b_0\)</span>, <span class="math inline">\(b_1\)</span>, and <span class="math inline">\(b_2\)</span> are.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>M_Coasters_speed_dur_des <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>Coasters_filtered, Speed <span class="sc">~</span> Duration <span class="sc">+</span> Design)</span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>M_Coasters_speed_dur_des</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Speed ~ Duration + Design, data = Coasters_filtered)

Coefficients:
   (Intercept)        Duration  DesignSit Down  
       40.4307          0.1159          3.7580  </code></pre>
</div>
</div>
<section id="a-3" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="a-3">a)</h4>
<p>Use the model to calculate the predicted speed of a sit down coaster with duration 150 seconds.</p>
</section>
<section id="b-3" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="b-3">b)</h4>
<p>Explain how you could make the prediction in (a) from the scatterplot. Is your calculated speed consistent with the plot?</p>
</section>
<section id="c-1" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="c-1">c)</h4>
<p>Given that not all coasters of the same type and duration have the same speed, we cannot be sure that a sit down coaster with duration 150 seconds will have exactly the predicted speed. Using the scatterplot, give a range of speeds that you can be confident will contain the speed of an individual sit down coaster with duration 150 seconds.</p>
</section>
<section id="d-1" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="d-1">d)</h4>
<p>Suppose that Coasters A and B are both sit down coasters and that Coaster A has a duration 10 seconds longer than B. Which coaster has the faster predicted speed, and by how much?</p>
</section>
<section id="e" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="e">e)</h4>
<p>Suppose that Coasters C and D have the same duration, and that Coaster C is a sit down coaster, and D isn’t. Which coaster has the faster predicted speed, and by how much?</p>
</section>
</section>
<section id="section-5" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="section-5">6)</h3>
<p>Continuing with the model in Question 5, excluding outliers, the <span class="math inline">\(R^2\)</span> value is shown below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(M_Coasters_speed_dur_des)<span class="sc">$</span>r.squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1410659</code></pre>
</div>
</div>
<section id="a-4" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="a-4">a)</h4>
<p>Write a sentence interpreting this value in context.</p>
</section>
<section id="b-4" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="b-4">b)</h4>
<p>We add year built (since 1900) as an explanatory variable. The <span class="math inline">\(R^2\)</span> value is shown below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>M_Coasters_speed_dur_des_yr <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>Coasters_filtered, Speed <span class="sc">~</span>  Duration <span class="sc">+</span> Design <span class="sc">+</span> Year_Since1900)</span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(M_Coasters_speed_dur_des_yr)<span class="sc">$</span>r.squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2480657</code></pre>
</div>
</div>
<p>Does adding year built appear to help predict the speed of a coaster? Explain your answer.</p>
</section>
<section id="c-2" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="c-2">c)</h4>
<p>We now drop design from the model and use only duration as an explanatory variable. The <span class="math inline">\(R^2\)</span> value is shown below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>M_Coasters_speed_dur <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>Coasters_filtered, Speed <span class="sc">~</span> Duration)</span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(M_Coasters_speed_dur)<span class="sc">$</span>r.squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1266004</code></pre>
</div>
</div>
<p>Does dropping design from the model hurt our ability to predict speed? Explain your answer.</p>
</section>
</section>
<section id="section-6" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="section-6">7)</h3>
<p>The scatterplot shows the relationship between top speed of a coaster (in mph) and its maximum height and design type. We again exclude the two outlier coasters.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>Coasters_filtered, <span class="fu">aes</span>(<span class="at">y=</span>Speed, <span class="at">x=</span>Max_Height, <span class="at">color=</span>Design)) <span class="sc">+</span> </span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Top Speed in mph"</span>) <span class="sc">+</span> </span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Max Height in Feet"</span>) <span class="sc">+</span> </span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_parallel_slopes</span>(<span class="at">se=</span><span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb122-6"><a href="#cb122-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Speed by Height and Type"</span>) <span class="sc">+</span> </span>
<span id="cb122-7"><a href="#cb122-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">125</span>)) <span class="sc">+</span></span>
<span id="cb122-8"><a href="#cb122-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">315</span>)) <span class="sc">+</span> </span>
<span id="cb122-9"><a href="#cb122-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch2_files/figure-html/unnamed-chunk-96-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>We’ll use the model</p>
<p><span class="math display">\[
\widehat{\text{Speed}} = b_0 + b_1\times\text{Max Height} + b_2\times{\text{DesignSitDown}}
\]</span></p>
<p>The model estimates are shown below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>M_Coasters_speed_height_des <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>Coasters_filtered, Speed <span class="sc">~</span>  Max_Height <span class="sc">+</span> Design)</span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>M_Coasters_speed_height_des</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Speed ~ Max_Height + Design, data = Coasters_filtered)

Coefficients:
   (Intercept)      Max_Height  DesignSit Down  
       29.5120          0.1979          4.1504  </code></pre>
</div>
</div>
<p>Should we expect the model that predicts speed using height as an explanatory variable to have a higher or lower <span class="math inline">\(R^2\)</span> value than a model that uses duration as an explanatory variable (hint: compare this scatterplot to the one in Question 5)?</p>
</section>
<section id="section-7" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="section-7">8)</h3>
<p>Continuing with the roller coasters data, now consider a model of the form</p>
<p><span class="math display">\[
\widehat{\text{Speed}} = b_0 + b_1\times\text{Duration}
\]</span></p>
<p>R commands and output related to this model are shown below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>Mean_Speed <span class="ot">&lt;-</span> <span class="fu">mean</span>(Coasters_filtered<span class="sc">$</span>Speed)</span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>Mean_Speed</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 58.23932</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>((Coasters<span class="sc">$</span>Speed <span class="sc">-</span> Mean_Speed)<span class="sc">^</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 24069.64</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a>M_Coasters_speed_dur <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>Coasters_filtered, Speed <span class="sc">~</span> Duration)</span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(M_Coasters_speed_dur<span class="sc">$</span>residuals<span class="sc">^</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 16167.76</code></pre>
</div>
</div>
<p>What are the values of SST, SSR, SSM, and <span class="math inline">\(R^2\)</span>?</p>
</section>
<section id="section-8" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="section-8">9)</h3>
<p>The scatterplot shows a response variable (y), plotted against a quantitative explanatory variable (x), with a categorical explanatory variable, (either A or B) indicated by color and shape.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch2_files/figure-html/unnamed-chunk-101-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Consider two models. Model 1 accounts for only the categorical variable, while Model 2 accounts for both the quantitative variable <span class="math inline">\(x\)</span> and the categorical variable.</p>
<p>Model 1:</p>
<p><span class="math display">\[
\hat{y} = b_0 + b_1x
\]</span></p>
<p>Model 2:</p>
<p><span class="math display">\[
\hat{y} = b_0 + b_1\text{CategoryB}
\]</span></p>
<p>Model 3:</p>
<p><span class="math display">\[
\hat{y} = b_0 + b_1\text{CategoryB} + b_2x
\]</span></p>
<section id="a-5" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="a-5">a)</h4>
<p>Without calculating <span class="math inline">\(R^2\)</span>, state approximately what <span class="math inline">\(R^2\)</span> would be for each of Models 1, 2, and 3. Choose from:</p>
<ol type="A">
<li>Between 0 and 0.25<br>
</li>
<li>Between 0.25 and 0.50<br>
</li>
<li>Between 0.50 and 0.75<br>
</li>
<li>Between 0.75 and 1</li>
</ol>
<p>Justify your answers.</p>
</section>
<section id="b-5" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="b-5">b)</h4>
<p>Between Models 2 and 3, which will have a greater estimate of <span class="math inline">\(b_1\)</span>? Justify your answer.</p>
</section>
<section id="c-3" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="c-3">c)</h4>
<p>Between Models 1 and 3, in which model will the coefficient on the variable <span class="math inline">\(x\)</span> be more extreme? (In Model 1, the coefficient on <span class="math inline">\(x\)</span> is <span class="math inline">\(b_1\)</span> and in Model 3, it is <span class="math inline">\(b_2\)</span>.) Justify your answer.</p>
</section>
</section>
<section id="section-9" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="section-9">10)</h3>
<p>The illustrations below show three different scenarios, each with a categorical explanatory variable with three levels. The red dots indicate the mean for each group.</p>
<p>Suppose we calculate F-statistics comparing a model of the form:</p>
<p><span class="math display">\[\hat{y} = b_0\]</span></p>
<p>to one of the form:</p>
<p><span class="math display">\[\hat{y} = b_0 + b_1\text{GroupB}+ b_2\text{GroupC}\]</span></p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch2_files/figure-html/unnamed-chunk-104-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
<p>Which scenario will have the largest F-statistic? Which will have the smallest? Explain your answer.</p>
</section>
<section id="section-10" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="section-10">11)</h3>
<p>The four models for roller coaster speeds in Question 3 are shown again below. SSR’s for each model are also show. There are 117 roller coasters in the dataset.</p>
<p><strong>Model 0:</strong></p>
<p><span class="math display">\[
\widehat{\text{Speed}} = b_0
\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>M_Coasters_speed_0 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>Coasters_filtered, Speed <span class="sc">~</span> <span class="dv">1</span>)</span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(M_Coasters_speed_0<span class="sc">$</span>residuals<span class="sc">^</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 18511.3</code></pre>
</div>
</div>
<p><strong>Model 1:</strong></p>
<p><span class="math display">\[
\widehat{\text{Speed}} = b_0 + b_1\times\text{Duration}
\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a>M_Coasters_speed_dur <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>Coasters_filtered, Speed <span class="sc">~</span> Duration)</span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(M_Coasters_speed_dur<span class="sc">$</span>residuals<span class="sc">^</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 16167.76</code></pre>
</div>
</div>
<p><strong>Model 2:</strong></p>
<p><span class="math display">\[
\widehat{\text{Speed}} = b_0 + b_1\times\text{DesignSitDown}
\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a>M_Coasters_speed_des <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>Coasters_filtered, Speed <span class="sc">~</span> Design)</span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(M_Coasters_speed_des<span class="sc">$</span>residuals<span class="sc">^</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 18354.21</code></pre>
</div>
</div>
<p><strong>Model 3:</strong></p>
<p><span class="math display">\[
\widehat{\text{Speed}} = b_0 + b_1\times\text{Duration} +  b_2\times\text{DesignSitDown}
\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a>M_Coasters_speed_dur_des <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>Coasters_filtered, Speed <span class="sc">~</span> Duration <span class="sc">+</span> Design)</span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(M_Coasters_speed_dur_des<span class="sc">$</span>residuals<span class="sc">^</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 15899.99</code></pre>
</div>
</div>
<p>Calculate F-statistics for comparing each of the following pairs of models, or explain why it would be inappropriate to do so.</p>
<section id="a-6" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="a-6">a)</h4>
<p>Model 0 and Model 1</p>
</section>
<section id="b-6" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="b-6">b)</h4>
<p>Model 0 and Model 2</p>
</section>
<section id="c-4" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="c-4">c)</h4>
<p>Model 1 and Model 2</p>
</section>
<section id="d-2" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="d-2">d)</h4>
<p>Model 1 and Model 3</p>
</section>
<section id="e-1" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="e-1">e)</h4>
<p>Model 2 and Model 3</p>
</section>
</section>
<section id="section-11" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="section-11">12)</h3>
<p>Continue with the models in Question 11.</p>
<section id="a-7" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="a-7">a)</h4>
<p>The F-statistic for comparing Model 2 to Model 3 is shown below. Based on the size of this F-statistic, what can we conclude about the variable(s) in these models?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(M_Coasters_speed_dur, M_Coasters_speed_0)<span class="sc">$</span>F[<span class="dv">2</span>] <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 16.7</code></pre>
</div>
</div>
</section>
<section id="b-7" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="b-7">b)</h4>
<p>The F-statistic for comparing Model 2 to Model 3 is shown below. Based on the size of this F-statistic, what can we conclude about the variable(s) in these models?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(M_Coasters_speed_dur_des, M_Coasters_speed_dur)<span class="sc">$</span>F[<span class="dv">2</span>] <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.9</code></pre>
</div>
</div>
</section>
</section>
<section id="section-12" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="section-12">13)</h3>
<p>The plots show three different lines fit to the same sets of points.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch2_files/figure-html/unnamed-chunk-111-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
<p>Which represents the least squares regression line? Show calculations to justify your answer.</p>
</section>
<section id="section-13" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="section-13">14)</h3>
<p>We saw in Question 5 that for a model of the form</p>
<p><span class="math display">\[
\widehat{\text{Speed}} = b_0 + b_1\times\text{Duration} +  b_2\times\text{DesignSitDown}
\]</span></p>
<p>the estimates of <span class="math inline">\(b_0\)</span>, <span class="math inline">\(b_1\)</span>, and <span class="math inline">\(b_2\)</span> produced by R are</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a>M_Coasters_speed_dur_des</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Speed ~ Duration + Design, data = Coasters_filtered)

Coefficients:
   (Intercept)        Duration  DesignSit Down  
       40.4307          0.1159          3.7580  </code></pre>
</div>
</div>
<p>Suppose that instead of using these, we used the model used the model with the estimates of <span class="math inline">\(b_0\)</span>, <span class="math inline">\(b_1\)</span>, and <span class="math inline">\(b_2\)</span> given below.</p>
<p><span class="math display">\[
\widehat{\text{Speed}} = 25 + 0.25\times\text{MaxHeight} + 3\times{\text{DesignSitDown}}
\]</span></p>
<p>Can we say how SST, SSR, and <span class="math inline">\(R^2\)</span> for this new model would compare to those in the model using the estimates produced by R? Would they increase, decrease, or stay the same? Why?</p>
</section>
<section id="section-14" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="section-14">15)</h3>
<p>A small dataset with 6 observations is shown below. There is a categorical explanatory variable with two groups (A and B), and a quantitative response variable.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: left;">Obs.</th>
<th style="text-align: left;">1</th>
<th style="text-align: left;">2</th>
<th style="text-align: left;">3</th>
<th style="text-align: left;">4</th>
<th style="text-align: left;">5</th>
<th style="text-align: left;">6</th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Group</td>
<td style="text-align: left;">A</td>
<td style="text-align: left;">A</td>
<td style="text-align: left;">A</td>
<td style="text-align: left;">B</td>
<td style="text-align: left;">B</td>
<td style="text-align: left;">B</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Response (y)</td>
<td style="text-align: left;">3</td>
<td style="text-align: left;">4</td>
<td style="text-align: left;">8</td>
<td style="text-align: left;">4</td>
<td style="text-align: left;">6</td>
<td style="text-align: left;">11</td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<p>Consider a model of the form:</p>
<p><span class="math display">\[\hat{y} = b_0 + b_1\text{GroupB}\]</span></p>
<section id="a-8" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="a-8">a)</h4>
<p>Give the values of the estimates <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span> that would be produced by the <code>lm</code> command in R.</p>
</section>
<section id="b-8" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="b-8">b)</h4>
<p>Using the estimates in (a), calculate SSR, SSM, SST, and <span class="math inline">\(R^2\)</span>.</p>
</section>
<section id="c-5" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="c-5">c)</h4>
<p>Suppose instead that we let <span class="math inline">\(b_0 = 4\)</span> and <span class="math inline">\(b_1 = 2\)</span> (so that the predicted value for each group corresponds to the median response value for that group). How would you expect SSR for this model to compare to the SSR you calculated in (b)?</p>
</section>
<section id="d-3" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="d-3">d)</h4>
<p>Calculate SSR for the values of <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span> in (c). Does your answer match what you expected?</p>
</section>
</section>
<section id="section-15" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="section-15">16)</h3>
<p>The table displays a set of fictional data, showing scores that seven students received on an exam. Also shown are whether or not the student attended a study session, and the number of hours the student spent studying on their own.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: left;">Student</th>
<th style="text-align: left;">A</th>
<th style="text-align: left;">B</th>
<th style="text-align: left;">C</th>
<th style="text-align: left;">D</th>
<th style="text-align: left;">E</th>
<th style="text-align: left;">F</th>
<th style="text-align: left;">G</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Hours</td>
<td style="text-align: left;">3</td>
<td style="text-align: left;">4</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">5</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">7</td>
<td style="text-align: left;">6</td>
</tr>
<tr class="even">
<td style="text-align: left;">StudySession</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">Yes</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Exam Score</td>
<td style="text-align: left;">86</td>
<td style="text-align: left;">77</td>
<td style="text-align: left;">80</td>
<td style="text-align: left;">89</td>
<td style="text-align: left;">83</td>
<td style="text-align: left;">88</td>
<td style="text-align: left;">92</td>
</tr>
</tbody>
</table>
<p>We’ll attempt to predict Score, using the other variables as explanatory variables.</p>
<section id="a-9" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="a-9">a)</h4>
<p>We use the model:</p>
<p><span class="math inline">\(\widehat{\text{Score}} = b_0 + b_1\times\text{StudySessionYes}\)</span></p>
<p>Use the data and the plots below to perform the required calculations.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch2_files/figure-html/unnamed-chunk-115-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
<p>Calculate:</p>
<ol type="i">
<li><p>the values of <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span></p></li>
<li><p>the predicted scores for each of the seven students in the dataset</p></li>
<li><p>the total sum of squares (SST)</p></li>
<li><p>the sum of squared residuals (SSR)</p></li>
<li><p>the sum of squares explained by the model (SSM)</p></li>
<li><p>the proportion of variation in exam score explained by the model using study session as the explanatory variable (<span class="math inline">\(R^2\)</span>)</p></li>
</ol>
</section>
<section id="b-9" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="b-9">b)</h4>
<p>Now consider the model</p>
<p><span class="math inline">\(\widehat{\text{Score}} = b_0 + b_1\times\text{Hours}\)</span></p>
<p>Relevant plots are shown below.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch2_files/figure-html/unnamed-chunk-116-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a>M_Hrs<span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>TestScores, Score<span class="sc">~</span>Hours)</span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a>M_Hrs</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Score ~ Hours, data = TestScores)

Coefficients:
(Intercept)        Hours  
       79.0          1.5  </code></pre>
</div>
</div>
<p>Calculate:</p>
<ol type="i">
<li><p>the predicted scores for each of the seven students in the dataset</p></li>
<li><p>the total sum of squares (SST)</p></li>
<li><p>the sum of squared residuals (SSR)</p></li>
<li><p>the sum of squares explained by the model (SSM)</p></li>
<li><p>the proportion of variation in exam score explained by the model using hours studying as the explanatory variable (<span class="math inline">\(R^2\)</span>)</p></li>
</ol>
</section>
</section>
<section id="section-16" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="section-16">17)</h3>
<section id="a-10" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="a-10">a)</h4>
<p>For the fictional test score example in 14(b), write the expression that would need to be minimized to obtain the values of regression coefficients <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span>. Substitute values from the data into your expression. (Hint: The only variables in the expression should be <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span>).</p>
</section>
<section id="b-10" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="b-10">b)</h4>
<p>There are three different ways to do this part of the question. You may complete any of the three ways. To get the most from the question, it is recommended that you complete the part that is consistent with the amount of mathematics you have taken previously.</p>
<p><strong>Option A - suggested for students who have taken multivariable calculus (MATH 155)</strong></p>
<p>Use calculus to show that the quantity in (c) is minimized when <span class="math inline">\(b_0 = 79\)</span>, and <span class="math inline">\(b_1=1.5\)</span>. Note: this question is not asking you to plug into the formulas for <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span> in 2.4.2 of the notes. Rather, you are to perform the derivation to show that these values of <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span> minimize the desired quantity in this context.</p>
<p><strong>Option B - suggested for students who have taken calculus (MATH 140 or equivalent), but not multivariable calculus</strong></p>
<p>Substitute <span class="math inline">\(b_0 = 79\)</span> into the expression from part C, so that <span class="math inline">\(b_1\)</span> is the only variable in the expression. Then use calculus to show that this expression is minimized when <span class="math inline">\(b_1 = 1.5\)</span>.</p>
<p><strong>Option C - suggested for students who have not taken calculus</strong></p>
<p>Substitute <span class="math inline">\(b_0 = 79\)</span> into the expression from part C, so that <span class="math inline">\(b_1\)</span> is the only variable in the expression. Use an online graphing calculator (such as https://www.desmos.com/calculator) to graph SSR as a function of <span class="math inline">\(b_1\)</span> (hint, make <span class="math inline">\(b_1\)</span> the x-variable). Show that SSR is minimized when <span class="math inline">\(b_1=1.5\)</span>. Include a screen shot of your graph.</p>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./Ch1.html" class="pagination-link" aria-label="Visualizing and Summarizing Data">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Visualizing and Summarizing Data</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./Ch3.html" class="pagination-link" aria-label="Simulation-Based Inference">
        <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Simulation-Based Inference</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>