<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>3&nbsp; Simulation-Based Inference – STAT 255 Notes</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./Ch4.html" rel="next">
<link href="./Ch2.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-626149efe8f5d16e1d391ba177679bf0.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./Ch3.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Simulation-Based Inference</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">STAT 255 Notes</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ch1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Visualizing and Summarizing Data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ch2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Introduction to Statistical Models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ch3.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Simulation-Based Inference</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ch4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Inference from Models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ch5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Building and Assessing Models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ch6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Logistic Regression</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ch7.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Predictive Modeling</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#learning-outcomes" id="toc-learning-outcomes" class="nav-link active" data-scroll-target="#learning-outcomes">Learning Outcomes</a></li>
  <li><a href="#sampling-variability" id="toc-sampling-variability" class="nav-link" data-scroll-target="#sampling-variability"><span class="header-section-number">3.1</span> Sampling Variability</a>
  <ul class="collapse">
  <li><a href="#population-and-sample" id="toc-population-and-sample" class="nav-link" data-scroll-target="#population-and-sample"><span class="header-section-number">3.1.1</span> Population and Sample</a></li>
  <li><a href="#sampling-distribution-and-standard-error" id="toc-sampling-distribution-and-standard-error" class="nav-link" data-scroll-target="#sampling-distribution-and-standard-error"><span class="header-section-number">3.1.2</span> Sampling Distribution and Standard Error</a></li>
  <li><a href="#confidence-intervals" id="toc-confidence-intervals" class="nav-link" data-scroll-target="#confidence-intervals"><span class="header-section-number">3.1.3</span> Confidence Intervals</a></li>
  </ul></li>
  <li><a href="#bootstrap-confidence-intervals" id="toc-bootstrap-confidence-intervals" class="nav-link" data-scroll-target="#bootstrap-confidence-intervals"><span class="header-section-number">3.2</span> Bootstrap Confidence Intervals</a>
  <ul class="collapse">
  <li><a href="#mercury-concentration-in-florida-lakes" id="toc-mercury-concentration-in-florida-lakes" class="nav-link" data-scroll-target="#mercury-concentration-in-florida-lakes"><span class="header-section-number">3.2.1</span> Mercury Concentration in Florida Lakes</a></li>
  <li><a href="#bootstrap-sampling" id="toc-bootstrap-sampling" class="nav-link" data-scroll-target="#bootstrap-sampling"><span class="header-section-number">3.2.2</span> Bootstrap Sampling</a></li>
  <li><a href="#bootstrap-distribution-for-mean" id="toc-bootstrap-distribution-for-mean" class="nav-link" data-scroll-target="#bootstrap-distribution-for-mean"><span class="header-section-number">3.2.3</span> Bootstrap Distribution for Mean</a></li>
  </ul></li>
  <li><a href="#bootstrapping-model-coefficients" id="toc-bootstrapping-model-coefficients" class="nav-link" data-scroll-target="#bootstrapping-model-coefficients"><span class="header-section-number">3.3</span> Bootstrapping Model Coefficients</a>
  <ul class="collapse">
  <li><a href="#ci-for-difference-in-means" id="toc-ci-for-difference-in-means" class="nav-link" data-scroll-target="#ci-for-difference-in-means"><span class="header-section-number">3.3.1</span> CI for Difference in Means</a></li>
  <li><a href="#ci-for-regression-slope" id="toc-ci-for-regression-slope" class="nav-link" data-scroll-target="#ci-for-regression-slope"><span class="header-section-number">3.3.2</span> CI for Regression Slope</a></li>
  <li><a href="#ci-for-regression-response" id="toc-ci-for-regression-response" class="nav-link" data-scroll-target="#ci-for-regression-response"><span class="header-section-number">3.3.3</span> CI for Regression Response</a></li>
  <li><a href="#bootstrapping-cautions" id="toc-bootstrapping-cautions" class="nav-link" data-scroll-target="#bootstrapping-cautions"><span class="header-section-number">3.3.4</span> Bootstrapping Cautions</a></li>
  </ul></li>
  <li><a href="#permutation-based-hypothesis-testing" id="toc-permutation-based-hypothesis-testing" class="nav-link" data-scroll-target="#permutation-based-hypothesis-testing"><span class="header-section-number">3.4</span> Permutation-Based Hypothesis Testing</a>
  <ul class="collapse">
  <li><a href="#mercury-in-lakes-n-vs-s" id="toc-mercury-in-lakes-n-vs-s" class="nav-link" data-scroll-target="#mercury-in-lakes-n-vs-s"><span class="header-section-number">3.4.1</span> Mercury in Lakes: N vs S</a></li>
  <li><a href="#chlorophyll-in-lakes-n-vs-s" id="toc-chlorophyll-in-lakes-n-vs-s" class="nav-link" data-scroll-target="#chlorophyll-in-lakes-n-vs-s"><span class="header-section-number">3.4.2</span> Chlorophyll in Lakes: N vs S</a></li>
  <li><a href="#effect-of-ph-on-mercury" id="toc-effect-of-ph-on-mercury" class="nav-link" data-scroll-target="#effect-of-ph-on-mercury"><span class="header-section-number">3.4.3</span> Effect of pH on Mercury</a></li>
  <li><a href="#f-test-for-comparing-three-or-more-groups" id="toc-f-test-for-comparing-three-or-more-groups" class="nav-link" data-scroll-target="#f-test-for-comparing-three-or-more-groups"><span class="header-section-number">3.4.4</span> F-Test for Comparing Three or More Groups</a></li>
  <li><a href="#responsible-hypothesis-testing" id="toc-responsible-hypothesis-testing" class="nav-link" data-scroll-target="#responsible-hypothesis-testing"><span class="header-section-number">3.4.5</span> Responsible Hypothesis Testing</a></li>
  </ul></li>
  <li><a href="#practice-questions" id="toc-practice-questions" class="nav-link" data-scroll-target="#practice-questions"><span class="header-section-number">3.5</span> Practice Questions</a>
  <ul class="collapse">
  <li><a href="#section" id="toc-section" class="nav-link" data-scroll-target="#section">1)</a></li>
  <li><a href="#section-1" id="toc-section-1" class="nav-link" data-scroll-target="#section-1">2)</a></li>
  <li><a href="#section-2" id="toc-section-2" class="nav-link" data-scroll-target="#section-2">3)</a></li>
  <li><a href="#section-3" id="toc-section-3" class="nav-link" data-scroll-target="#section-3">4)</a></li>
  <li><a href="#section-4" id="toc-section-4" class="nav-link" data-scroll-target="#section-4">5)</a></li>
  <li><a href="#a-2" id="toc-a-2" class="nav-link" data-scroll-target="#a-2">a)</a></li>
  <li><a href="#b-2" id="toc-b-2" class="nav-link" data-scroll-target="#b-2">b)</a></li>
  <li><a href="#c-1" id="toc-c-1" class="nav-link" data-scroll-target="#c-1">c)</a></li>
  <li><a href="#section-5" id="toc-section-5" class="nav-link" data-scroll-target="#section-5">6)</a></li>
  <li><a href="#a-3" id="toc-a-3" class="nav-link" data-scroll-target="#a-3">a)</a></li>
  <li><a href="#b-3" id="toc-b-3" class="nav-link" data-scroll-target="#b-3">b)</a></li>
  <li><a href="#c-2" id="toc-c-2" class="nav-link" data-scroll-target="#c-2">c)</a></li>
  <li><a href="#section-6" id="toc-section-6" class="nav-link" data-scroll-target="#section-6">7)</a></li>
  <li><a href="#section-7" id="toc-section-7" class="nav-link" data-scroll-target="#section-7">8)</a></li>
  <li><a href="#section-8" id="toc-section-8" class="nav-link" data-scroll-target="#section-8">9)</a></li>
  <li><a href="#info-for-questions-10-12" id="toc-info-for-questions-10-12" class="nav-link" data-scroll-target="#info-for-questions-10-12">Info for Questions (10-12)</a></li>
  <li><a href="#section-9" id="toc-section-9" class="nav-link" data-scroll-target="#section-9">10)</a></li>
  <li><a href="#section-10" id="toc-section-10" class="nav-link" data-scroll-target="#section-10">11)</a></li>
  <li><a href="#section-11" id="toc-section-11" class="nav-link" data-scroll-target="#section-11">12)</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Simulation-Based Inference</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="learning-outcomes" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="learning-outcomes">Learning Outcomes</h3>
<p><strong>Conceptual Learning Outcomes</strong><br>
10. Interpret and distinguish between sample standard deviation and standard error of a sampling distribution for a statistic.<br>
11. Explain how to use bootstrapping to calculate confidence intervals.<br>
12. Interpret confidence intervals in context.<br>
13. Describe the steps of a permutation-based hypothesis test in context (including writing hypotheses, identifying a test statistic, and explaining how to use permutation to obtain a p-value.)&nbsp;&nbsp;<br>
14. Interpret p-values in context.&nbsp;<br>
15. Compare and contrast the conclusions we can draw from confidence intervals and hypothesis tests.<br>
</p>
<p><strong>Computational Learning Outcomes</strong><br>
F. Perform bootstrapping in R.<br>
G. Perform permutation-based hypothesis tests in R.</p>
</section>
<section id="sampling-variability" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="sampling-variability"><span class="header-section-number">3.1</span> Sampling Variability</h2>
<section id="population-and-sample" class="level3" data-number="3.1.1">
<h3 data-number="3.1.1" class="anchored" data-anchor-id="population-and-sample"><span class="header-section-number">3.1.1</span> Population and Sample</h3>
<p>In statistics, we often do not have the time, money, or means to collect data on all individuals or units on which we want to draw conclusions. Instead, we might collect data on only a subset of the individuals, and then make inferences about all individuals we are interested in, using the information we collected.</p>
<p><strong>Vocabulary:</strong></p>
<ol type="1">
<li>A <strong>population</strong> is the entire set of individuals that we want to draw conclusions about.</li>
<li>A <strong>sample</strong> is a subset of a population.<br>
</li>
<li>A <strong>parameter</strong> is a numerical quantity pertaining to an entire population or process.<br>
</li>
<li>A <strong>statistic</strong> is a numerical quantity calculated from a sample.</li>
</ol>
<p>The purpose of this section is to explore how statistics calculated from a sample compare to the entire population.</p>
<p>We’ll work with data from the American National Health and Nutrition Examination survey (NHANES). This is a survey administered to civilian residents of the United States, which aims to collect data on several health and socioeconomic factors.</p>
<p>The dataset contains information on 12,280 adult U.S. residents. While this is really just a sample of all U.S. residents, let’s pretend for the purposes of this section that this really was our entire population. Perhaps, we can pretend that these are all the adults living in a certain town.</p>
<p>The first 6 rows of the data are shown below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Population)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 9
  Gender   Age Race1   Education HHIncomeMid HomeOwn Height Weight SleepHrsNight
  &lt;fct&gt;  &lt;int&gt; &lt;fct&gt;   &lt;fct&gt;           &lt;int&gt; &lt;fct&gt;    &lt;dbl&gt;  &lt;dbl&gt;         &lt;int&gt;
1 male      34 White   High Sch…       30000 Own       165.   87.4             4
2 female    60 Black   High Sch…       12500 Rent      166   117.              4
3 male      26 Mexican 9 - 11th…       30000 Rent      173    97.6             4
4 female    49 White   Some Col…       40000 Rent      168.   86.7             8
5 male      80 White   Some Col…       17500 Own       174.   79.1             6
6 male      80 White   9 - 11th…       17500 Own       180.   89.6             9</code></pre>
</div>
</div>
<p>One of the variables <code>SleepHrsNight</code> is a self-reported estimate of the number of hours of sleep the participant gets at night or on the weekends.</p>
<p>The histogram shows the distribution of sleep hours among the 12,280 residents in the population.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>Sleep_Plot_Pop <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>Population, <span class="fu">aes</span>(<span class="at">x=</span>SleepHrsNight)) <span class="sc">+</span> </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">fill=</span><span class="st">"blue"</span>, <span class="at">boundary=</span><span class="dv">0</span>, <span class="at">binwidth=</span><span class="dv">1</span>, <span class="at">color=</span><span class="st">"white"</span>) <span class="sc">+</span> </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Distribution of Hours of Sleep"</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>Sleep_Plot_Pop</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch3_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We see that the distribution of sleep hours is roughly symmetric, with most people getting between 5 and 8 hours per night.</p>
<p>We’ll calculate the mean and standard deviation in hours of sleep among the population.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>Population <span class="sc">|&gt;</span> <span class="fu">summarize</span>(<span class="at">Mean_Sleep =</span> <span class="fu">mean</span>(SleepHrsNight),</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">SD_Sleep =</span> <span class="fu">sd</span>(SleepHrsNight), </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">N=</span> <span class="fu">n</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 3
  Mean_Sleep SD_Sleep     N
       &lt;dbl&gt;    &lt;dbl&gt; &lt;int&gt;
1       6.86     1.44 12280</code></pre>
</div>
</div>
<p>Recall that if we fit a statistical model with no explanatory variables, the intercept estimate will be the overall population mean.</p>
<p>In this case, we’ll denote the intercept <span class="math inline">\(\beta_0\)</span>, rather than <span class="math inline">\(b_0\)</span>, as we’ve done before. It is customary to use Greek letters to denote population parameters, and English letters to denote sample statistics. Since we are fitting the model to all 12,280 adult residents of our fictional town, we’ll call the intercept <span class="math inline">\(\beta_0\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>M_Pop_sleep <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>Population, SleepHrsNight <span class="sc">~</span> <span class="dv">1</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>M_Pop_sleep</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = SleepHrsNight ~ 1, data = Population)

Coefficients:
(Intercept)  
      6.856  </code></pre>
</div>
</div>
<p>The mean number of hours of sleep among all adult residents of the city is <span class="math inline">\(\beta_0 =\)</span> 6.86 hours.</p>
</section>
<section id="sampling-distribution-and-standard-error" class="level3" data-number="3.1.2">
<h3 data-number="3.1.2" class="anchored" data-anchor-id="sampling-distribution-and-standard-error"><span class="header-section-number">3.1.2</span> Sampling Distribution and Standard Error</h3>
<p>We typically won’t have data on the full population and won’t know the values of parameters like <span class="math inline">\(\beta_0\)</span>. Instead, we’ll have data on just a sample taken from the population.</p>
<p>To illustrate, we’ll take samples of 75 residents and see how the mean hours of sleep in the samples compare to the population.</p>
<p><strong>First Sample</strong></p>
<p>We use the <code>sample</code> command to take a random sample of 75 residents. The first 6 residents in the sample are shown below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># take sample of 75 residents</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>Sample1 <span class="ot">&lt;-</span> <span class="fu">sample</span>(Population, <span class="at">size =</span> <span class="dv">75</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Sample1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 10
  Gender   Age Race1   Education HHIncomeMid HomeOwn Height Weight SleepHrsNight
  &lt;fct&gt;  &lt;int&gt; &lt;fct&gt;   &lt;fct&gt;           &lt;int&gt; &lt;fct&gt;    &lt;dbl&gt;  &lt;dbl&gt;         &lt;int&gt;
1 female    18 White   &lt;NA&gt;            17500 Own       173.  165               5
2 male      24 White   9 - 11th…       12500 Rent      172.   60.4             6
3 female    27 Mexican Some Col…       30000 Rent      159.   54.2             6
4 male      80 White   8th Grade       22500 Own       168.   84.6             7
5 male      18 White   &lt;NA&gt;             2500 Own       176.   67.5             8
6 female    47 Black   High Sch…          NA Own       170.  103.              6
# ℹ 1 more variable: orig.id &lt;chr&gt;</code></pre>
</div>
</div>
<p>The distribution of sleep hours among the 75 people in the sample is shown below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>Sleep_Plot_Sample1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>Sample1, <span class="fu">aes</span>(<span class="at">x=</span>SleepHrsNight)) <span class="sc">+</span> </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">fill=</span><span class="st">"blue"</span>, <span class="at">boundary=</span><span class="dv">0</span>, <span class="at">binwidth=</span><span class="dv">1</span>, <span class="at">color=</span><span class="st">"white"</span>) <span class="sc">+</span> </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Distribution of Hours of Sleep in Sample"</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>Sleep_Plot_Sample1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch3_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Notice that while the sample is not the same as the population, it has a roughly similar shape, center, and amount of spread.</p>
<p>The mean and standard deviation for the sample are shown below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>Sample1 <span class="sc">|&gt;</span> <span class="fu">summarize</span>(<span class="at">Mean_Sleep =</span> <span class="fu">mean</span>(SleepHrsNight),</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">SD_Sleep =</span> <span class="fu">sd</span>(SleepHrsNight), </span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">N=</span> <span class="fu">n</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 3
  Mean_Sleep SD_Sleep     N
       &lt;dbl&gt;    &lt;dbl&gt; &lt;int&gt;
1       6.71     1.59    75</code></pre>
</div>
</div>
<p>Notice that the mean hours of sleep differs from that of the population. This is not surprising, as we wouldn’t expect a statistic calculated from a sample of 75 to exactly match the parameter calculated from the entire population.</p>
<p>We’ll fit a model to the sample data and record the intercept.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>M_Sample1_sleep <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>Sample1, SleepHrsNight <span class="sc">~</span> <span class="dv">1</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>M_Sample1_sleep</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = SleepHrsNight ~ 1, data = Sample1)

Coefficients:
(Intercept)  
      6.707  </code></pre>
</div>
</div>
<p>In this case, we’ll denote the intercept <span class="math inline">\(b_0\)</span>, since it is a statistic calculated from our sample. <span class="math inline">\(b_0\)</span> = 6.71 is an estimate of our population mean <span class="math inline">\(\beta_0\)</span>, which we happen to know is 6.86</p>
<p>In a real situation, we would typically not know <span class="math inline">\(\beta_0\)</span>, and would need to estimate it using <span class="math inline">\(b_0\)</span>. Since <span class="math inline">\(b_0\)</span> shouldn’t be expected to match <span class="math inline">\(\beta_0\)</span> exactly, we cannot say that <span class="math inline">\(\beta_0\)</span> is exactly <span class="math inline">\(b_0\)</span>, but we can say that <span class="math inline">\(\beta_0\)</span> is likely to be “close: to <span class="math inline">\(b_0\)</span>. In order to know how”close”, we need to know how much the sample statistic <span class="math inline">\(b_0\)</span> could plausibly differ from the population parameter <span class="math inline">\(\beta_0\)</span>.</p>
<p>To investigate that, let’s take some additional samples of size 75, fit a model to estimate the mean hours of sleep <span class="math inline">\(b_0\)</span> and see how much <span class="math inline">\(b_0\)</span> varies between samples.</p>
<p><strong>Second Sample</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>Sample2 <span class="ot">&lt;-</span> <span class="fu">sample</span>(Population, <span class="at">size =</span> <span class="dv">75</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>M_Sample2_sleep <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>Sample2, SleepHrsNight <span class="sc">~</span> <span class="dv">1</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>M_Sample2_sleep</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = SleepHrsNight ~ 1, data = Sample2)

Coefficients:
(Intercept)  
       6.52  </code></pre>
</div>
</div>
<p><strong>Third Sample</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>Sample3 <span class="ot">&lt;-</span> <span class="fu">sample</span>(Population, <span class="at">size =</span> <span class="dv">75</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>M_Sample3_sleep <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>Sample3, SleepHrsNight <span class="sc">~</span> <span class="dv">1</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>M_Sample3_sleep</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = SleepHrsNight ~ 1, data = Sample3)

Coefficients:
(Intercept)  
      6.627  </code></pre>
</div>
</div>
<p><strong>Fourth Sample</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>Sample4 <span class="ot">&lt;-</span> <span class="fu">sample</span>(Population, <span class="at">size =</span> <span class="dv">75</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>M_Sample4_sleep <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>Sample4, SleepHrsNight <span class="sc">~</span> <span class="dv">1</span>)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>M_Sample4_sleep</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = SleepHrsNight ~ 1, data = Sample4)

Coefficients:
(Intercept)  
      6.547  </code></pre>
</div>
</div>
<p><strong>Fifth Sample</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>Sample5 <span class="ot">&lt;-</span> <span class="fu">sample</span>(Population, <span class="at">size =</span> <span class="dv">75</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>M_Sample5_sleep <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>Sample5, SleepHrsNight <span class="sc">~</span> <span class="dv">1</span>)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>M_Sample5_sleep</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = SleepHrsNight ~ 1, data = Sample5)

Coefficients:
(Intercept)  
      6.933  </code></pre>
</div>
</div>
<p>Let’s now take 10,000 more random samples of 75 adult residents and record <span class="math inline">\(b_0\)</span>, the estimated mean hours of sleep for each sample.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>Samples_sleep <span class="ot">&lt;-</span> <span class="fu">do</span>(<span class="dv">10000</span>)<span class="sc">*</span><span class="fu">lm</span>(SleepHrsNight <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> <span class="fu">sample</span>(Population, <span class="at">size=</span><span class="dv">75</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The histogram below shows the distribution of <span class="math inline">\(b_0\)</span>, the mean hours of sleep in the 10,000 different samples.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>Samp_Dist_Mean_sleep <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>Samples_sleep, <span class="fu">aes</span>(<span class="at">x=</span>Intercept)) <span class="sc">+</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">color=</span><span class="st">"white"</span>, <span class="at">fill=</span><span class="st">"lightblue"</span>, <span class="at">binwidth=</span><span class="fl">0.01</span>) <span class="sc">+</span> </span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Sampling Distribution for b0 - Mean Hours of Sleep"</span>) <span class="sc">+</span> </span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Mean Hours in Sample"</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>Samp_Dist_Mean_sleep </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch3_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We notice that most of our 10,000 samples yielded means between 6.5 and 7.25 hours and that the distribution is roughly symmetric and bell-shaped.</p>
<p>The distribution shown in this histogram is called the <strong>sampling distribution for</strong> <span class="math inline">\(b_0\)</span>. The sampling distribution for a statistic shows the distribution of the statistic over many samples.</p>
<p>We’ll calculate the mean and standard deviation of the sampling distribution. How do these compare to the mean and standard deviation of the population that we saw previously?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>Samples_sleep <span class="sc">|&gt;</span> <span class="fu">summarize</span>(<span class="at">Mean_b0 =</span> <span class="fu">mean</span>(Intercept),</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>                              <span class="at">SE_b0 =</span> <span class="fu">sd</span>(Intercept), </span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>                              <span class="at">N=</span> <span class="fu">n</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Mean_b0     SE_b0     N
1 6.85564 0.1664173 10000</code></pre>
</div>
</div>
<p>Notice that the mean of the sampling distribution for <span class="math inline">\(b_0\)</span> is about the same as the population mean <span class="math inline">\(\beta_0\)</span> = 6.86</p>
<p>The standard deviation of the sampling distribution for the mean <span class="math inline">\(b_0\)</span>, however, is much less than the population standard deviation of 1.435. This makes sense, since there is much less variability in the sampling distribution for the mean hours of sleep than there was in the distribution of sleep hours for individuals. We saw that most individuals reported getting between 5 and 8 hours per night, while most samples of size 75 resulted in a mean between 6.5 and 7.25 hours, a much narrower range.</p>
<p>The standard deviation of the sampling distribution for a statistic is also called the <strong>standard error</strong> of the statistic. In this case, it represents the amount of variability in mean hours of sleep between different samples of 75 residents. This is different than the population standard deviation, which represents the amount of variability in hours of sleep between different individual residents.</p>
<p><strong>Vocabulary:</strong></p>
<ul>
<li>The <strong>sampling distribution</strong> of a statistic is the distribution of values the statistic takes on across many different samples of a given size.<br>
</li>
<li>The <strong>standard error</strong> of a statistic is the standard deviation of that statistic’s sampling distribution. It measures how much the statistic varies between different samples of a given size.</li>
</ul>
<section id="effect-of-sample-size" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="effect-of-sample-size">Effect of Sample Size</h4>
<p><strong>Question:</strong></p>
<p>Suppose the sample consisted of 10, or 30, or 200 residents, instead of 75? Would you expect the standard deviation of individual sleep times in the samples to increase, decrease or stay about the same? What about the standard error of the mean sleep time?</p>
<p>The histogram shows the distribution of sample standard deviations in random samples of each size. These represent the variability in sleep hours between individuals in the sample.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch3_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
<p>Notice that the variability in sleep hours between individual people stays roughly the same, regardless of sample size.</p>
<p>The table shows the standard deviation of individual sleep hours in each of the samples.</p>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">Sample_Size</th>
<th style="text-align: right;">SD</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">10</td>
<td style="text-align: right;">1.567021</td>
</tr>
<tr class="even">
<td style="text-align: right;">30</td>
<td style="text-align: right;">1.383399</td>
</tr>
<tr class="odd">
<td style="text-align: right;">75</td>
<td style="text-align: right;">1.245966</td>
</tr>
<tr class="even">
<td style="text-align: right;">200</td>
<td style="text-align: right;">1.419746</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Sample size does not impact the amount of variability between individual people. Standard deviation in sleep hours does not systematically increase or decrease based one sample size (of course it varies a little based on the people randomly chosen in the sample).</p>
<p>Now, we’ll examine what happens to the standard error of the mean <span class="math inline">\(b_0\)</span> as the sample size changes.</p>
<p><strong>Distributions of Mean Between Different Samples</strong></p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch3_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
<p>Notice that as the sample size increases, the sampling distribution of the mean becomes more symmetric and bell-shaped, and also more concentrated around the population mean <span class="math inline">\(\mu\)</span>.</p>
<p>The table shows the standard error of the mean for samples of different size:</p>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">Sample_Size</th>
<th style="text-align: right;">SE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">10</td>
<td style="text-align: right;">0.4547698</td>
</tr>
<tr class="even">
<td style="text-align: right;">30</td>
<td style="text-align: right;">0.2624521</td>
</tr>
<tr class="odd">
<td style="text-align: right;">75</td>
<td style="text-align: right;">0.1637800</td>
</tr>
<tr class="even">
<td style="text-align: right;">200</td>
<td style="text-align: right;">0.0995903</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>As sample size increases, variability between means of different samples decreases. Standard error of the mean decreases. This is also true of standard errors for other statistics (i.e.&nbsp;difference in means, regression slopes, etc.)</p>
<div style="page-break-after: always;"></div>
</section>
</section>
<section id="confidence-intervals" class="level3" data-number="3.1.3">
<h3 data-number="3.1.3" class="anchored" data-anchor-id="confidence-intervals"><span class="header-section-number">3.1.3</span> Confidence Intervals</h3>
<p>We saw that while statistics calculated from individual samples deviate from population parameters, over many samples, they approximately average to the population parameter (assuming the samples are chosen randomly).</p>
<p>Thus, when we have only a single sample, we can use the sample statistic as an estimate of the population parameter, provided we allow for a certain margin of error. The question is how much margin of error do we need?</p>
<p>The sampling distribution for the mean hours of sleep is shown again below. The population mean (<span class="math inline">\(\beta_0=6.856\)</span>) is marked by the purple dotted line. The gold bar at the bottom of the histogram represents the range of sample proportions that lie within <span class="math inline">\(\pm 2\)</span> standard errors of the true population mean:</p>
<p>6.86 - 2(0.17) = 6.53 to </p>
<p>6.86 + 2(0.17) = 7.19.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>Samp_Dist_Mean_sleep <span class="sc">+</span> <span class="fu">geom_vline</span>(<span class="at">xintercept=</span>M_Pop_sleep_b0, <span class="at">color=</span><span class="st">"purple"</span>, <span class="at">linetype=</span><span class="st">"dotted"</span>, <span class="at">linewidth=</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x=</span> M_Pop_sleep_b0 <span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span>SE_b0, <span class="at">xend=</span> M_Pop_sleep_b0 <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>SE_b0, <span class="at">y=</span><span class="dv">20</span>, <span class="at">yend=</span><span class="dv">20</span>), <span class="at">color=</span><span class="st">"gold"</span>, <span class="at">size=</span><span class="dv">20</span>, <span class="at">alpha=</span><span class="fl">0.01</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch3_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We calculate the proportion of samples whose mean hours of sleep lies within <span class="math inline">\(\pm 2\)</span> standard errors of the true proportion.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>Lower <span class="ot">&lt;-</span> M_Pop_sleep_b0 <span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span>SE_b0 </span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>Upper <span class="ot">&lt;-</span> M_Pop_sleep_b0 <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>SE_b0 </span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>((Samples_sleep<span class="sc">$</span>Intercept <span class="sc">&gt;=</span>Lower) <span class="sc">&amp;</span> (Samples_sleep<span class="sc">$</span>Intercept <span class="sc">&lt;=</span> Upper))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 9536</code></pre>
</div>
</div>
<p>Approximately 95% of the 10,000 samples produced proportions within <span class="math inline">\(\pm 2\)</span> standard errors of the true population mean.</p>
<p>In a real situation, we won’t have access to the entire population, but only a single sample. For example, recall our original sample of 75 people, in which we observed a proportion of on-time arrivals of <span class="math inline">\(b_0=\)</span> 6.71.</p>
<p>Since we now know that 95% of all samples produce proportions that lie within two standard errors of the population mean, we can obtain an estimate of the population mean <span class="math inline">\(\beta_0\)</span> by adding and subtracting <span class="math inline">\(2\times \text{SE}(b_0)\)</span> from our observed sample estimate <span class="math inline">\(b_0\)</span>.</p>
<p>Using probability theory, it can be shown generally that if the sampling distribution of a statistic is symmetric and bell shaped, then approximately 95% of all samples will produce sample statistics that lie within two standard errors of the corresponding population parameter. Such an interval is called an approximate 95% <strong>confidence interval</strong> for the population parameter.</p>
<p><strong>Approximate 95% confidence interval:</strong> If the sampling distribution of a statistic is symmetric and bell-shaped, a 95% confidence interval for the population parameter is:</p>
<p><span class="math display">\[
\text{Statistic} \pm 2\times \text{Standard Error},
\]</span></p>
<p>More generally, if we want to use a level of confidence that is different than 95%, we can adjust the value we multiply the standard error by. In general, a standard error confidence interval has the form:</p>
<p><span class="math display">\[
\text{Statistic} \pm m\times \text{Standard Error},
\]</span></p>
<p>where the value of <span class="math inline">\(m\)</span> depends on the desired level of confidence.</p>
<p>Confidence intervals that are calculated by adding and subtracting a certain number of standard errors from the sample statistic are called <strong>standard error confidence intervals</strong>. This approach works as long as the sampling distribution is symmetric and bell-shaped. Probability theory tells us that in a symmetric and bell-shaped distribution, approximately 95% of the area lies within two standard errors of the center of the distribution, given by the true parameter value. We will, however, see that this approach will not work in all cases. Not all statistics produce sampling distributions that are symmetric and bell-shaped, and we will need an alternative way to calculate confidence intervals in these situations.</p>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Emp_Rule.png" class="img-fluid figure-img" width="1800"></p>
<figcaption>Image from https://openintro-ims.netlify.app/foundations-mathematical</figcaption>
</figure>
</div>
</div>
</div>
<section id="example-95-confidence-interval-for-beta_0" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="example-95-confidence-interval-for-beta_0">Example: 95% Confidence Interval for <span class="math inline">\(\beta_0\)</span></h4>
<p>We’ll calculate a 95% confidence interval for the mean hours of sleep in our fictional city, using our original sample where <span class="math inline">\(b_0\)</span> = 6.71. The 95% confidence interval is:</p>
<p><span class="math display">\[
\begin{aligned}
&amp; b_0 \pm 2\times \text{SE}(b_0) \\
&amp; = 6.71 \pm 2(0.17)
\end{aligned}
\]</span></p>
<p>The confidence interval is:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(b0 <span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span>SE_b0, b0 <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>SE_b0) <span class="sc">|&gt;</span> <span class="fu">as.numeric</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6.37 7.04</code></pre>
</div>
</div>
<p>Based on our sample of 75 residents, we can be 95% confident that the mean number of hours of sleep among all residents in the city is between 6.37 and 7.04 hours.</p>
<p>Knowing what we do about the true value of the population parameter <span class="math inline">\(\beta_0\)</span>, we can see that our interval does indeed contain the true population value of <span class="math inline">\(\beta_0=\)</span> 6.86.</p>
</section>
<section id="what-does-95-confidence-mean" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="what-does-95-confidence-mean">What does 95% Confidence Mean?</h4>
<p>Suppose, instead of <span class="math inline">\(\beta_0=\)</span> 6.8560261, our sample of 75 had resulted in a mean of <span class="math inline">\(\beta_0=\)</span> 6.3. We can see from the sampling distribution that some samples did produce means that low.</p>
<p>Then, using the same formula we would obtain an approximate 95% confidence interval of</p>
<p><span class="math display">\[
\begin{aligned}
&amp; 6.3 \pm 2\times \text{SE}(b_0) \\
&amp; = 6.3 \pm 2(0.17)
\end{aligned}
\]</span></p>
<p>which is 5.97 to 6.63.</p>
<p>Notice that this interval does not contain the true value of <span class="math inline">\(\beta_0=6.85\)</span>. Does this mean we did something wrong when we calculated the confidence interval?</p>
<p>The answer is “no”. Notice we claimed to be only “95%” confident that our interval contains the true value of the population parameter <span class="math inline">\(\beta_0\)</span>. This means that we should expect 5% of samples taken randomly to yield a sample mean <span class="math inline">\(b_0\)</span> so different from the population mean <span class="math inline">\(\beta_0\)</span>, that the resulting confidence interval would not contain the true value of <span class="math inline">\(\beta_0\)</span>. This does not mean we did anything wrong, just that we obtained an unusual sample just by chance. Since our procedure, namely adding and subtracting two standard errors, is designed to work 95% of the time, we can expect such samples to be rare.</p>
<p>In a real situation, we won’t know the true value of the population parameter, so we won’t know for sure whether or not our confidence interval contains this true parameter value.</p>
<p>To further understand the meaning of “95% confidence”, let’s explore what happens when we calculate confidence intervals based on estimates <span class="math inline">\(b_0\)</span> obtained from many different samples. For each of our 10,000 different samples taken from our population, we’ll add and subtract two standard errors from the sample mean <span class="math inline">\(b_0\)</span> corresponding to that sample.</p>
<p>The table below displays the value of <span class="math inline">\(b_0\)</span>, for the first 20 samples we took, along with the lower and upper bounds of the confidence interval, and whether or not the confidence interval contains the true parameter value <span class="math inline">\(\beta_0\)</span> (either 1=<code>TRUE</code> or 0=<code>FALSE</code>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>Samples_df_b0 <span class="ot">&lt;-</span> Samples_sleep <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Sample =</span> <span class="fu">row_number</span>(),</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">b_0 =</span> Intercept,</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">Lower =</span> b_0 <span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span>SE_b0, </span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">Upper =</span> b_0 <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>SE_b0,</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">Contains_beta0 =</span> beta0 <span class="sc">&gt;=</span> Lower <span class="sc">&amp;</span> beta0 <span class="sc">&lt;=</span> Upper) <span class="sc">|&gt;</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>                                                    dplyr<span class="sc">::</span><span class="fu">select</span>(Sample, b_0, Lower, Upper, Contains_beta0)  </span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(Samples_df_b0 <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>), <span class="dv">20</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">Sample</th>
<th style="text-align: right;">b_0</th>
<th style="text-align: right;">Lower</th>
<th style="text-align: right;">Upper</th>
<th style="text-align: right;">Contains_beta0</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">7.03</td>
<td style="text-align: right;">6.69</td>
<td style="text-align: right;">7.36</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">6.87</td>
<td style="text-align: right;">6.53</td>
<td style="text-align: right;">7.20</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">6.88</td>
<td style="text-align: right;">6.55</td>
<td style="text-align: right;">7.21</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">7.04</td>
<td style="text-align: right;">6.71</td>
<td style="text-align: right;">7.37</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: right;">7.04</td>
<td style="text-align: right;">6.71</td>
<td style="text-align: right;">7.37</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td style="text-align: right;">6.84</td>
<td style="text-align: right;">6.51</td>
<td style="text-align: right;">7.17</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">7</td>
<td style="text-align: right;">6.96</td>
<td style="text-align: right;">6.63</td>
<td style="text-align: right;">7.29</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">8</td>
<td style="text-align: right;">7.07</td>
<td style="text-align: right;">6.73</td>
<td style="text-align: right;">7.40</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">9</td>
<td style="text-align: right;">6.80</td>
<td style="text-align: right;">6.47</td>
<td style="text-align: right;">7.13</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">10</td>
<td style="text-align: right;">6.67</td>
<td style="text-align: right;">6.33</td>
<td style="text-align: right;">7.00</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">11</td>
<td style="text-align: right;">6.85</td>
<td style="text-align: right;">6.52</td>
<td style="text-align: right;">7.19</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">12</td>
<td style="text-align: right;">6.64</td>
<td style="text-align: right;">6.31</td>
<td style="text-align: right;">6.97</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">13</td>
<td style="text-align: right;">6.81</td>
<td style="text-align: right;">6.48</td>
<td style="text-align: right;">7.15</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">14</td>
<td style="text-align: right;">6.72</td>
<td style="text-align: right;">6.39</td>
<td style="text-align: right;">7.05</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">15</td>
<td style="text-align: right;">6.60</td>
<td style="text-align: right;">6.27</td>
<td style="text-align: right;">6.93</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">16</td>
<td style="text-align: right;">6.65</td>
<td style="text-align: right;">6.32</td>
<td style="text-align: right;">6.99</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">17</td>
<td style="text-align: right;">6.68</td>
<td style="text-align: right;">6.35</td>
<td style="text-align: right;">7.01</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">18</td>
<td style="text-align: right;">6.55</td>
<td style="text-align: right;">6.21</td>
<td style="text-align: right;">6.88</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">19</td>
<td style="text-align: right;">7.15</td>
<td style="text-align: right;">6.81</td>
<td style="text-align: right;">7.48</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">20</td>
<td style="text-align: right;">6.95</td>
<td style="text-align: right;">6.61</td>
<td style="text-align: right;">7.28</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The graphic below visualizes the confidence intervals produced using the estimates from the first 100 samples. The purple dotted line indicates the true value of <span class="math inline">\(\beta_0\)</span>. The black dots indicate the value of <span class="math inline">\(b_0\)</span> for each sample. Intervals that do in fact contain the true value of <span class="math inline">\(p\)</span> are shown in blue, and intervals that do not contain the true value of <span class="math inline">\(p\)</span> are shown in green.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>Samples_df_b0[<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>,], <span class="fu">aes</span>(<span class="at">y=</span>Sample, <span class="at">x=</span>b_0)) <span class="sc">+</span>    </span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> Lower, <span class="at">xmax =</span> Upper, <span class="at">color=</span>Contains_beta0))  <span class="sc">+</span> </span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Confidence Interval"</span>) <span class="sc">+</span> </span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Sample"</span>) <span class="sc">+</span> </span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> beta0, <span class="at">color=</span><span class="st">"purple"</span>, <span class="at">linetype=</span><span class="st">"dotted"</span>, <span class="at">size=</span><span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"100 Different Confidence Intervals for beta_0"</span>) <span class="sc">+</span> </span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch3_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<p>Out of these 100 samples, 91 contain the true value of the population parameter <span class="math inline">\(p\)</span>. This is close to the desired 95% confidence level.</p>
<p>The picture shows confidence intervals produced by the first 100 samples, but we actually took 10,000 different samples of 75 residents. Let’s calculate how many of these samples produced confidence intervals that contain the true value of <span class="math inline">\(p\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">prop</span>(Samples_df_b0<span class="sc">$</span>Contains_beta0 <span class="sc">==</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>prop_TRUE 
   0.9536 </code></pre>
</div>
</div>
<p>Again, notice that close to 95% of the samples produced confidence intervals contain the true population parameter <span class="math inline">\(\beta_0\)</span>. Note that for the red intervals that do not contain <span class="math inline">\(p\)</span> nothing was done incorrectly. The sample was taken at random, and the confidence interval was calculated using the correct formula. It just happened that by chance, we obtained a sample mean <span class="math inline">\(b_0\)</span> that was unusually high or low, leading to an interval that did not capture the true population parameter. This, of course, happens rarely, and approximately 95% of the samples do, in fact, result in intervals that contain the true value of <span class="math inline">\(b_0\)</span>.</p>
<p>This brings us back to the question “what does 95% confidence mean?”. An approximate 95% confidence interval means that if we take a large number of samples and calculate confidence intervals from each of them, then approximately 95% of the samples will produce intervals containing the true population parameter. In reality, we’ll only have on sample, and won’t know whether or not our interval contains the true parameter value. Assuming we have taken the sample and calculated the interval correctly, we can rest assured in the knowledge that that 95% of all intervals taken would contain the true parameter value, and hope that ours is among that 95%.</p>
<p>It might be tempting to say that “there is approximately a 95% chance” that the population parameter lies within the confidence interval, but this is incorrect. In the statistical framework used here (known as classical, or frequentist statistics), the population parameter is assumed to be a fixed, but (typically) unknown number. It either is within the interval, or it isn’t. We just (typically) don’t know which. There’s nothing random about whether or not the parameter value is in our interval, so it doesn’t make sense to speak of it in terms of chance or randomness. Randomness comes into play due to the fact that we selected a random sample, which will produce a statistic likely to differ from the population parameter due to sampling variability. A different statistical framework, known as <em>Bayesian statistics</em> approaches this differently, and would allow us to use randomness and chance to describe our beliefs about any uncertain quantity, including a population proportion. In this class, however, we’ll stick to the classical frequentist interpretation.</p>
<p>Of course, you might ask why we needed to calculate a confidence interval for the mean hours of sleep among all residents in the first place, since we actually have data on all 12,280 residents in our fictional town and already know the mean hours of sleep. The answer is that we don’t. But, in most real situations, we will only have data from a single sample, not the entire population, and we won’t know the true population parameter. We’ll be able to build on the ideas of sampling distributions and standard error that we learned about in this section to calculate confidence intervals in those scenarios.</p>
<div style="page-break-after: always;"></div>
</section>
</section>
</section>
<section id="bootstrap-confidence-intervals" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="bootstrap-confidence-intervals"><span class="header-section-number">3.2</span> Bootstrap Confidence Intervals</h2>
<section id="mercury-concentration-in-florida-lakes" class="level3" data-number="3.2.1">
<h3 data-number="3.2.1" class="anchored" data-anchor-id="mercury-concentration-in-florida-lakes"><span class="header-section-number">3.2.1</span> Mercury Concentration in Florida Lakes</h3>
<p>A 2004 study by Lange, T., Royals, H. and Connor, L. examined Mercury accumulation in large-mouth bass, taken from a sample of 53 Florida Lakes. If Mercury accumulation exceeds 0.5 ppm, then there are environmental concerns. In fact, the legal safety limit in Canada is 0.5 ppm, although it is 1 ppm in the United States.</p>
<p>In our sample, we have data on 53 lakes, out of more than 30,000 lakes in the the state of Florida. We’ll attempt to draw conclusions about the entire population, consisting of all lakes in Florida, using data from our sample of 53. It is not clear how the lakes in this sample of 53 were selected, or how representative they are of all lakes in the state of Florida. Let’s assume for our purposes that the lakes in the sample can be reasonably thought of as being representative of all lakes in Florida.</p>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Bass.png" class="img-fluid figure-img" style="width:50.0%"></p>
<figcaption>https://www.maine.gov/ifw/fish-wildlife/fisheries/species-information/largemouth-bass.html</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>FloridaLakes <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"FloridaLakes.csv"</span>)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>FloridaLakes <span class="ot">&lt;-</span> FloridaLakes <span class="sc">|&gt;</span> <span class="fu">rename</span>(<span class="at">Mercury =</span> AvgMercury) <span class="sc">|&gt;</span> </span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">select</span>(ID, Lake, pH, Mercury, Chlorophyll, Location, Depth)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(FloridaLakes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 53
Columns: 7
$ ID          &lt;dbl&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17,…
$ Lake        &lt;chr&gt; "Alligator", "Annie", "Apopka", "Blue Cypress", "Brick", "…
$ pH          &lt;dbl&gt; 6.1, 5.1, 9.1, 6.9, 4.6, 7.3, 5.4, 8.1, 5.8, 6.4, 5.4, 7.2…
$ Mercury     &lt;dbl&gt; 1.23, 1.33, 0.04, 0.44, 1.20, 0.27, 0.48, 0.19, 0.83, 0.81…
$ Chlorophyll &lt;dbl&gt; 0.7, 3.2, 128.3, 3.5, 1.8, 44.1, 3.4, 33.7, 1.6, 22.5, 14.…
$ Location    &lt;chr&gt; "S", "S", "N", "S", "S", "N", "N", "N", "N", "N", "N", "S"…
$ Depth       &lt;chr&gt; "Medium", "Deep", "Medium", "Shallow", "Medium", "Shallow"…</code></pre>
</div>
</div>
<p>We’ll divide the state along route 50, which runs East-West, passing through Northern Orlando.</p>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Florida.png" class="img-fluid figure-img" style="width:30.0%"></p>
<figcaption>from Google Maps</figcaption>
</figure>
</div>
</div>
</div>
<p>Our data come from a sample of 53 lakes, out of more then 30,000 in the entire state of Florida. The mercury levels of the 53 lakes in the sample are shown in the table below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print.data.frame</span>(FloridaLakes, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> ID              Lake  pH Mercury Chlorophyll Location   Depth
  1         Alligator 6.1    1.23         0.7        S  Medium
  2             Annie 5.1    1.33         3.2        S    Deep
  3            Apopka 9.1    0.04       128.3        N  Medium
  4      Blue Cypress 6.9    0.44         3.5        S Shallow
  5             Brick 4.6    1.20         1.8        S  Medium
  6            Bryant 7.3    0.27        44.1        N Shallow
  7            Cherry 5.4    0.48         3.4        N Shallow
  8          Crescent 8.1    0.19        33.7        N Shallow
  9        Deer Point 5.8    0.83         1.6        N  Medium
 10              Dias 6.4    0.81        22.5        N    Deep
 11              Dorr 5.4    0.71        14.9        N  Medium
 12              Down 7.2    0.50         4.0        S    Deep
 13             Eaton 7.2    0.49        11.6        N Shallow
 14 East Tohopekaliga 5.8    1.16         5.8        S  Medium
 15           Farm-13 7.6    0.05        71.1        N Shallow
 16            George 8.2    0.15        78.6        N Shallow
 17           Griffin 8.7    0.19        80.1        N  Medium
 18            Harney 7.8    0.77        13.9        N Shallow
 19              Hart 5.8    1.08         4.6        S  Medium
 20        Hatchineha 6.7    0.98        17.0        S Shallow
 21           Iamonia 4.4    0.63         9.6        N    Deep
 22         Istokpoga 6.7    0.56         9.5        S Shallow
 23           Jackson 6.1    0.41        21.0        N    Deep
 24         Josephine 6.9    0.73        32.1        S Shallow
 25          Kingsley 5.5    0.34         1.6        N    Deep
 26         Kissimmee 6.9    0.59        21.5        S Shallow
 27         Lochloosa 7.3    0.34        24.7        N Shallow
 28            Louisa 4.5    0.84         7.0        S  Medium
 29        Miccasukee 4.8    0.50        14.8        N  Medium
 30          Minneola 5.8    0.34         0.7        N  Medium
 31            Monroe 7.8    0.28        43.8        N  Medium
 32           Newmans 7.4    0.34        32.7        N Shallow
 33        Ocean Pond 3.6    0.87         3.2        N    Deep
 34      Ocheese Pond 4.4    0.56         3.2        N    Deep
 35        Okeechobee 7.9    0.17        16.1        S Shallow
 36            Orange 7.1    0.18        45.2        N Shallow
 37       Panasoffkee 6.8    0.19        16.5        N Shallow
 38            Parker 8.4    0.04       152.4        S  Medium
 39            Placid 7.0    0.49        12.8        S    Deep
 40            Puzzle 7.5    1.10        20.1        N Shallow
 41            Rodman 7.0    0.16         6.4        N    Deep
 42          Rousseau 6.8    0.10         6.2        N  Medium
 43           Sampson 5.9    0.48         1.6        N    Deep
 44             Shipp 8.3    0.21        68.2        S Shallow
 45           Talquin 6.7    0.86        24.1        N    Deep
 46            Tarpon 6.2    0.52         9.6        S Shallow
 47          Trafford 8.9    0.27         9.6        S Shallow
 48             Trout 4.3    0.94         6.4        S    Deep
 49      Tsala Apopka 7.0    0.40         4.6        N Shallow
 50              Weir 6.9    0.43        16.5        N    Deep
 51      Tohopekaliga 6.2    0.65        27.7        S  Medium
 52           Wildcat 5.2    0.25         2.6        N    Deep
 53              Yale 7.9    0.27         8.8        N  Medium</code></pre>
</div>
</div>
<p>The histogram shows the distribution of mercury levels in the 53 lakes in the sample.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>Lakes_Hist <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>FloridaLakes, <span class="fu">aes</span>(<span class="at">x=</span>Mercury)) <span class="sc">+</span> </span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">fill=</span> <span class="st">"blue"</span>, <span class="at">color=</span><span class="st">"white"</span>, <span class="at">binwidth =</span> <span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Mercury Levels in Sample of 53 Florida Lakes"</span>) <span class="sc">+</span> </span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Mercury Level"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Frequency"</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>Lakes_Hist</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch3_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The table below gives the mean and standard deviation in mercury level among the 53 lakes in our sample.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>FloridaLakes <span class="sc">|&gt;</span> <span class="fu">summarize</span>(<span class="at">Mean_Hg =</span> <span class="fu">mean</span>(Mercury), </span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">SD_Hg =</span> <span class="fu">sd</span>(Mercury),</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">N =</span> <span class="fu">n</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 3
  Mean_Hg SD_Hg     N
    &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt;
1   0.527 0.341    53</code></pre>
</div>
</div>
<p>Thinking in terms of models, we can estimate the mean mercury level by fitting a model with no explanatory variables. The model equation is</p>
<p><span class="math display">\[
\begin{aligned}
\widehat{\text{Mercury}} &amp; = b_0
\end{aligned}
\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>M_Lakes_merc_0 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>FloridaLakes, Mercury<span class="sc">~</span><span class="dv">1</span>)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>M_Lakes_merc_0</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Mercury ~ 1, data = FloridaLakes)

Coefficients:
(Intercept)  
     0.5272  </code></pre>
</div>
</div>
<p>We see that in our sample of 53 lakes, the mean mercury level is 0.527 ppm., which is just above Canada’s legal limit, though below the United States’ limit.</p>
<p>Suppose we want to estimate the mean mercury level among all Florida lakes. As we saw in the previous section, we should not expect the population proportion to exactly match the sample, due to random variability between samples. We can, however, use the sample statistic as an estimates and construct confidence intervals for the unknown population proportions.</p>
<p>In order to construct the confidence interval, we need to know how much each statistic could vary between different samples of size 53. That is, we need to know the standard error. In the previous section, we calculated the standard error by taking 10,000 different samples of the same size as ours from the population, calculating the proportion for each sample, and then calculating the standard deviation of the proportions obtained from these 10,000 different samples. This procedure will not work here, however, because unlike the previous example where we really did have data on the entire population of our city’s residents, we do not have data on all 30,000+ lakes in Florida. We cannot take a lot of different samples of size 53 from the population of all lakes, and thus, cannot obtain the sampling distributions for our statistics or calculate their standard errors. Instead, we’ll use a process that closely mimics what we did in Section 3.1, using only the information from the 53 lakes contained in our sample.</p>
</section>
<section id="bootstrap-sampling" class="level3" data-number="3.2.2">
<h3 data-number="3.2.2" class="anchored" data-anchor-id="bootstrap-sampling"><span class="header-section-number">3.2.2</span> Bootstrap Sampling</h3>
<p>All we have is a single sample of 53 lakes. We need to figure out how much the mean mercury level would vary between different samples of size 53, using only the information contained in our one sample.</p>
<p>To do this, we’ll implement a popular simulation-based strategy, known as <strong>bootstrapping</strong>.</p>
<p>Let’s assume our sample is representative of all Florida lakes. Then, we’ll duplicate the sample many times to create a large set that will look like the population of all Florida Lakes. We can then draw samples of 53 from that large population, and record the mean mercury level for each sample of 53.</p>
<p>An illustration of the bootstrapping procedure is shown below, using a sample of 12 colored dots, instead of the 53 lakes.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Bootstrap_Idea.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>In fact, duplicating the sample many times and selecting new samples of size <span class="math inline">\(n\)</span> has the same effect as drawing samples of size <span class="math inline">\(n\)</span> from the original sample, by putting the item drawn back in each time, a procedure called <strong>sampling with replacement</strong>. Thus, we can skip the step of copying/pasting the sample many times, and instead draw our samples with replacement.</p>
<p>This means that in each new sample, some lakes will be drawn multiple times and others not at all. It also ensures that each sample is different, allowing us to estimate variability in the sample mean between the different samples of size 53.</p>
<p>An illustration of the concept of bootstrapping, using sampling with replacement is shown below.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Bootstrap.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>The variability in a statistic (in this case mean mercury concentration) in our newly drawn samples is used to approximate the variability we would see in our statistic between different samples of 53 lakes if we could draw different samples from the population of all Florida Lakes.</p>
<p>The point of bootstrapping is to observe how much a statistic varies between bootstrap samples. This can act as an estimate of how much that statistic would vary between different samples of size <span class="math inline">\(n\)</span>, drawn from the population.</p>
<p>The steps of bootstrap sampling can be summarized in the following algorithm.</p>
<p><strong>Bootstrap Algorithm</strong></p>
<p>For an original sample of size <span class="math inline">\(n\)</span>:</p>
<ol type="1">
<li><p>Take a sample size <span class="math inline">\(n\)</span> by randomly sampling from the original, with replacement. Thus, some observations will show up multiple times, and others not at all. This sample is called a <strong>bootstrap sample</strong>.</p></li>
<li><p>Calculate the statistic of interest in the bootstrap sample. This statistic could be a single mean, a difference in means, a regression slope, or other statistics like median, standard deviation, or a proportion.</p></li>
<li><p>Repeat steps 1 and 2 many (say 10,000) times, keeping track of the statistic of interest that is calculated in each bootstrap sample.</p></li>
<li><p>Look at the distribution of the statistic across bootstrap samples. The variability in this bootstrap distribution can be used to approximate the variability in the sampling distribution for the statistic of interest.</p></li>
</ol>
<section id="bootstrap-samples-of-lakes" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="bootstrap-samples-of-lakes">Bootstrap Samples of Lakes</h4>
<p><strong>Bootstrap Sample 1</strong></p>
<p>The <code>resample()</code> function samples the specified number rows from a data frame, with replacement.</p>
<p>The lakes in the first sample are shown below. Notice that some lakes occur multiple times, and others not at all.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>Bootstrap1 <span class="ot">&lt;-</span> <span class="fu">resample</span>(FloridaLakes, <span class="at">replace =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> <span class="fu">arrange</span>(ID)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>Bootstrap1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 53 × 8
      ID Lake            pH Mercury Chlorophyll Location Depth   orig.id
   &lt;dbl&gt; &lt;chr&gt;        &lt;dbl&gt;   &lt;dbl&gt;       &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;   &lt;chr&gt;  
 1     2 Annie          5.1    1.33         3.2 S        Deep    2      
 2     2 Annie          5.1    1.33         3.2 S        Deep    2      
 3     3 Apopka         9.1    0.04       128.  N        Medium  3      
 4     4 Blue Cypress   6.9    0.44         3.5 S        Shallow 4      
 5     5 Brick          4.6    1.2          1.8 S        Medium  5      
 6     6 Bryant         7.3    0.27        44.1 N        Shallow 6      
 7     8 Crescent       8.1    0.19        33.7 N        Shallow 8      
 8     8 Crescent       8.1    0.19        33.7 N        Shallow 8      
 9     8 Crescent       8.1    0.19        33.7 N        Shallow 8      
10     9 Deer Point     5.8    0.83         1.6 N        Medium  9      
# ℹ 43 more rows</code></pre>
</div>
</div>
<p>A histogram of the mercury levels in the bootstrap sample is shown below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>Bootstrap1, <span class="fu">aes</span>(<span class="at">x=</span>Mercury)) <span class="sc">+</span> </span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">fill=</span> <span class="st">"blue"</span>,  <span class="at">color=</span><span class="st">"white"</span>, <span class="at">binwidth =</span> <span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Mercury Levels in Bootstrap Sample"</span>) <span class="sc">+</span> </span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Mercury Level"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Frequency"</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch3_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The statistics of interest for the bootstrap sample are shown below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>Bootstrap1 <span class="sc">|&gt;</span> <span class="fu">summarize</span>(<span class="at">Mean_Hg =</span> <span class="fu">mean</span>(Mercury), </span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">SD_Hg =</span> <span class="fu">sd</span>(Mercury), </span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">N =</span> <span class="fu">n</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 3
  Mean_Hg SD_Hg     N
    &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt;
1   0.539 0.327    53</code></pre>
</div>
</div>
<p>We can also obtain the sample mean using a model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>M_Lakes_merc_0_Boot1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>Bootstrap1, Mercury<span class="sc">~</span><span class="dv">1</span>)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>M_Lakes_merc_0_Boot1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Mercury ~ 1, data = Bootstrap1)

Coefficients:
(Intercept)  
     0.5394  </code></pre>
</div>
</div>
<p>Notice that the sample mean of the bootstrap sample differs from that of the original sample. This happens because some lakes in the original sample show up multiple times and others not at all. By taking many bootstrap samples and estimating the variability in <span class="math inline">\(b_0\)</span>, we can estimate the standard error needed to calculate a confidence interval for the mean mercury level among all Florida Lakes.</p>
<p><strong>Bootstrap Sample #2</strong></p>
<p>Since bootstrap samples are taken with replacement, every sample will be different, allowing us to measure the amount of variability in our statistics between samples.</p>
<p>We take a second bootstrap sample and display the statistics below. Notice that the lakes chosen and omitted differ from the first sample.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>Bootstrap2 <span class="ot">&lt;-</span> <span class="fu">resample</span>(FloridaLakes, <span class="at">replace =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> <span class="fu">arrange</span>(ID)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>Bootstrap2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 53 × 8
      ID Lake          pH Mercury Chlorophyll Location Depth   orig.id
   &lt;dbl&gt; &lt;chr&gt;      &lt;dbl&gt;   &lt;dbl&gt;       &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;   &lt;chr&gt;  
 1     1 Alligator    6.1    1.23         0.7 S        Medium  1      
 2     2 Annie        5.1    1.33         3.2 S        Deep    2      
 3     6 Bryant       7.3    0.27        44.1 N        Shallow 6      
 4     6 Bryant       7.3    0.27        44.1 N        Shallow 6      
 5     7 Cherry       5.4    0.48         3.4 N        Shallow 7      
 6     8 Crescent     8.1    0.19        33.7 N        Shallow 8      
 7     9 Deer Point   5.8    0.83         1.6 N        Medium  9      
 8     9 Deer Point   5.8    0.83         1.6 N        Medium  9      
 9    11 Dorr         5.4    0.71        14.9 N        Medium  11     
10    12 Down         7.2    0.5          4   S        Deep    12     
# ℹ 43 more rows</code></pre>
</div>
</div>
<p>A histogram of the mercury levels in the bootstrap sample is shown below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>Bootstrap2, <span class="fu">aes</span>(<span class="at">x=</span>Mercury)) <span class="sc">+</span> </span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">fill =</span> <span class="st">"blue"</span>, <span class="at">color=</span><span class="st">"white"</span>, <span class="at">binwidth =</span> <span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Mercury Levels in Bootstrap Sample"</span>) <span class="sc">+</span> </span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Mercury Level"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Frequency"</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch3_files/figure-html/unnamed-chunk-48-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We again use a model to estimate the mean mercury level in the bootstrap sample. Notice that these differ from the original sample and from the first bootstrap sample.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>M_Lakes_merc_0_Boot2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>Bootstrap2, Mercury<span class="sc">~</span><span class="dv">1</span>)</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>M_Lakes_merc_0_Boot2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Mercury ~ 1, data = Bootstrap2)

Coefficients:
(Intercept)  
     0.5392  </code></pre>
</div>
</div>
<p><strong>Bootstrap Sample #3</strong></p>
<p>We’ll take another bootstrap sample. Notice how the lakes selected differ between bootstrap samples, ensuring our estimates of <span class="math inline">\(b_0\)</span> will differ and we’ll be able to estimate variability.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>Bootstrap3 <span class="ot">&lt;-</span> <span class="fu">resample</span>(FloridaLakes, <span class="at">replace =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> <span class="fu">arrange</span>(ID)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>Bootstrap3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 53 × 8
      ID Lake            pH Mercury Chlorophyll Location Depth   orig.id
   &lt;dbl&gt; &lt;chr&gt;        &lt;dbl&gt;   &lt;dbl&gt;       &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;   &lt;chr&gt;  
 1     2 Annie          5.1    1.33         3.2 S        Deep    2      
 2     3 Apopka         9.1    0.04       128.  N        Medium  3      
 3     3 Apopka         9.1    0.04       128.  N        Medium  3      
 4     3 Apopka         9.1    0.04       128.  N        Medium  3      
 5     4 Blue Cypress   6.9    0.44         3.5 S        Shallow 4      
 6     4 Blue Cypress   6.9    0.44         3.5 S        Shallow 4      
 7     5 Brick          4.6    1.2          1.8 S        Medium  5      
 8     5 Brick          4.6    1.2          1.8 S        Medium  5      
 9     6 Bryant         7.3    0.27        44.1 N        Shallow 6      
10     8 Crescent       8.1    0.19        33.7 N        Shallow 8      
# ℹ 43 more rows</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>Bootstrap3, <span class="fu">aes</span>(<span class="at">x=</span>Mercury)) <span class="sc">+</span> </span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">fill =</span> <span class="st">"blue"</span>, <span class="at">color=</span><span class="st">"white"</span>, <span class="at">binwidth =</span> <span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Mercury Levels in Bootstrap Sample"</span>) <span class="sc">+</span> </span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Mercury Level"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Frequency"</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch3_files/figure-html/unnamed-chunk-51-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>M_Lakes_merc_0_Boot2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>Bootstrap3, Mercury<span class="sc">~</span><span class="dv">1</span>)</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>M_Lakes_merc_0_Boot2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Mercury ~ 1, data = Bootstrap3)

Coefficients:
(Intercept)  
     0.4981  </code></pre>
</div>
</div>
</section>
</section>
<section id="bootstrap-distribution-for-mean" class="level3" data-number="3.2.3">
<h3 data-number="3.2.3" class="anchored" data-anchor-id="bootstrap-distribution-for-mean"><span class="header-section-number">3.2.3</span> Bootstrap Distribution for Mean</h3>
<p>Now that we’ve seen how bootstrap sampling works, we’ll take many different bootstrap samples and calculate our statistics for each of the samples. This will tell how how much our statistics can vary between sample. We’ll take 10,000 different bootstrap samples.</p>
<p>The <code>do(10000)</code> command tells R to do the command following it (in this case, take the bootstrap sample and calculate the statistic of interest) 10,000 times. We’ll store the results in a vector called <code>Lakes_Bootstrap_Mean</code>.</p>
<p>We’ll take 10,000 bootstrap samples, fit a linear model with only an intercept term, <span class="math inline">\(b_0\)</span>, and record the value of <span class="math inline">\(b_0\)</span> in each bootstrap sample.</p>
<p><strong>Bootstrap Distribution for Mean</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>Lakes_Bootstrap_Mean <span class="ot">&lt;-</span> <span class="fu">do</span>(<span class="dv">10000</span>) <span class="sc">*</span> <span class="fu">lm</span>( Mercury <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> <span class="fu">resample</span>(FloridaLakes, <span class="at">replace=</span><span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The means of the first 5 bootstrap samples are:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Lakes_Bootstrap_Mean<span class="sc">$</span>Intercept)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6050943 0.4232075 0.4845283 0.6169811 0.5615094 0.5079245</code></pre>
</div>
</div>
<p>The distribution of means observed in the 10,000 different bootstrap samples is shown below. This distribution is called the <strong>bootstrap distribution.</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>Lakes_Bootstrap_Mean_Plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>Lakes_Bootstrap_Mean, <span class="fu">aes</span>(<span class="at">x=</span>Intercept)) <span class="sc">+</span>  </span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">color=</span><span class="st">"white"</span>, <span class="at">fill=</span><span class="st">"lightblue"</span>, <span class="at">binwidth=</span><span class="fl">0.02</span>) <span class="sc">+</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"b0: Mean Mercury in Sample"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Bootstrap Distribution for b0: Mean Mercury"</span>) <span class="sc">+</span> </span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>Lakes_Bootstrap_Mean_Plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch3_files/figure-html/unnamed-chunk-55-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The bootstrap distribution is meant to approximate the sampling distribution of the statistic of interest (in this case the mean mercury level). Because it is based on the sample, the bootstrap distribution will be centered at the sample statistic (<span class="math inline">\(b_0 = 0.527\)</span> in this case) while the sampling distribution would have been centered at the population parameter (<span class="math inline">\(\beta_0\)</span>), the mean mercury level among all Florida lakes, which is unknown. The important things, however, is that the variability in the bootstrap distribution gives a good approximation of the amount of variability in the sampling distribution, so we can use the standard deviation of the bootstrap distribution (called <strong>bootstrap standard error</strong>) in our confidence interval calculation.</p>
<p><strong>Bootstrap Standard Error</strong></p>
<p>We calculate the standard deviation of this bootstrap distribution, which is an estimate of the standard error of the sample mean, <span class="math inline">\(\bar{x}\)</span>. It measures how much the mean mercury level varies between samples of size 53.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>SE_mean <span class="ot">&lt;-</span> <span class="fu">sd</span>(Lakes_Bootstrap_Mean<span class="sc">$</span>Intercept)</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>SE_mean</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.045823</code></pre>
</div>
</div>
<p>Notice that the standard error of the mean is much less than the sample standard deviation of 0.341.</p>
<p><strong>Interpretations of sample standard deviation and standard error of the mean</strong></p>
<ul>
<li><p>The sample standard deviation (0.341) measures the amount of variability in mercury levels between the 53 individual lakes in our sample.</p></li>
<li><p>The standard error of the mean (0.045823) measures the amount of variability in sample mean mercury levels between different samples of size 53.</p></li>
</ul>
<p>There is more variability between mercury levels in individual lakes than there is between average mercury levels in different samples of size 53.</p>
<p><strong>95% Confidence Interval:</strong></p>
<p>We calculate an approximate 95% confidence interval using the formula:</p>
<p><span class="math display">\[
\text{Statistic} \pm 2\times\text{Standard Error}
\]</span></p>
<p>In this case, the statistic of interest is the sample mean <span class="math inline">\(b_0=0.527\)</span>. The approximate confidence interval is</p>
<p><span class="math display">\[
\begin{aligned}
&amp; \bar{x} \pm 2\times\text{SE}(\bar{x}) \\
&amp; = 0.527 \pm 2\times\text{0.045823}
\end{aligned}
\]</span></p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>       name     lower    upper level method  estimate margin.of.error
1 Intercept 0.4375052 0.617128  0.95 stderr 0.5271698      0.08981142</code></pre>
</div>
</div>
<p>We are 95% confident that the average mercury level among all Florida lakes is between 0.44 and 0.62 parts per million.</p>
<p>The 95% confidence interval is shown by the gold bar on the graph of the bootstrap distribution below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>Lakes_Bootstrap_Mean_Plot <span class="sc">+</span> </span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> CI<span class="sc">$</span>lower, <span class="at">xend =</span> CI<span class="sc">$</span>upper, <span class="at">y=</span><span class="dv">50</span>, <span class="at">yend=</span><span class="dv">50</span>), </span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">color=</span><span class="st">"gold"</span>, <span class="at">size=</span><span class="dv">10</span>, <span class="at">alpha=</span><span class="fl">0.01</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch3_files/figure-html/unnamed-chunk-58-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>It is important to note that we are not saying that we are 95% confident that an individual lake lie in this range, or that 95% of all individual lakes lie in this range. We are only saying that we are confident that the <em>average</em> mercury level among all lakes lies in this range. A confidence interval is a statement about a population parameter (in this case the average mercury level), rather than about individual lakes in the population. Since there is more variability about individual lakes than overall averages, we’ll need to make a wider interval when talking about the mercury level for an individual lake.</p>
<p><strong>Percentile Confidence Intervals</strong></p>
<p>The confidence interval we obtained by taking <span class="math inline">\(\text{Estimate} \pm 2\times\text{Standard Error}\)</span> is called a standard error confidence interval. This method is appropriate when the sampling distribution for our statistic (which we approximate using the bootstrap distribution) is symmetric and bell-shaped. An alternate and more general method for obtaining a confidence interval via bootstrapping is called the bootstrap percentile confidence interval. In this approach, we take the middle 95% of the values in the bootstrap distribution.</p>
<p>The percentile bootstrap confidence interval is implemented by setting <code>method=percentile</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>CI_SE <span class="ot">&lt;-</span> <span class="fu">confint</span>(Lakes_Bootstrap_Mean, <span class="at">level =</span> <span class="fl">0.95</span>, <span class="at">parm=</span><span class="fu">c</span>(<span class="st">"Intercept"</span>), <span class="at">method =</span> <span class="st">"percentile"</span>)</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>CI_SE</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       name    lower     upper level     method  estimate
1 Intercept 0.440566 0.6190566  0.95 percentile 0.5271698</code></pre>
</div>
</div>
<p>Notice that the standard error confidence interval closely matches the percentile interval. This will be true when the bootstrap distribution is symmetric and bell-shaped. When the bootstrap distribution is not symmetric and bell-shaped, then the percentile interval will be more reliable than the standard error interval.</p>
</section>
</section>
<section id="bootstrapping-model-coefficients" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="bootstrapping-model-coefficients"><span class="header-section-number">3.3</span> Bootstrapping Model Coefficients</h2>
<p>We’ve seen how to use bootsrapping to obtain confidence intervals for the mean mercury level among all Florida lakes. We can use the same process to obtain confidence intervals for other statistics, such as coefficients <span class="math inline">\(b_0\)</span>, <span class="math inline">\(b_1\)</span>, representing differences in means, or slopes, like we saw in Chapter 2.</p>
<section id="ci-for-difference-in-means" class="level3" data-number="3.3.1">
<h3 data-number="3.3.1" class="anchored" data-anchor-id="ci-for-difference-in-means"><span class="header-section-number">3.3.1</span> CI for Difference in Means</h3>
<p>Suppose we want to compare mercury levels for lakes in Northern Florida to lakes in Southern Florida.</p>
<p>The boxplot shows and table below describe the distribution of mercury levels for lakes in Northern Florida, compared to Southern Florida.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>LakesBP <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>FloridaLakes, <span class="fu">aes</span>(<span class="at">x=</span>Location, <span class="at">y=</span>Mercury, <span class="at">fill=</span>Location)) <span class="sc">+</span> </span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span>   <span class="fu">geom_jitter</span>() <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"Mercury Levels in Florida Lakes"</span>) <span class="sc">+</span> </span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Location"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Mercury Level"</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>)) <span class="sc">+</span> <span class="fu">coord_flip</span>()</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>LakesBP</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch3_files/figure-html/unnamed-chunk-60-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>LakesTable <span class="ot">&lt;-</span> FloridaLakes <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Location) <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">MeanHg=</span><span class="fu">mean</span>(Mercury), </span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">StDevHg=</span><span class="fu">sd</span>(Mercury), </span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">N=</span><span class="fu">n</span>())</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>LakesTable</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  Location MeanHg StDevHg     N
  &lt;chr&gt;     &lt;dbl&gt;   &lt;dbl&gt; &lt;int&gt;
1 N         0.425   0.270    33
2 S         0.696   0.384    20</code></pre>
</div>
</div>
<p>In our sample of 33 Northern Lakes and 20 Southern Lakes, we saw a difference of 0.27 ppm. We’ll calculate a confidence interval to estimate how big or small this difference could be among all Florida lakes.</p>
<p>We’ll use a statistical model to calculate the average mercury levels in Northern and Southern Florida.</p>
<p><span class="math display">\[
\widehat{\text{Mercury}} = b_0 +b_1\times{\text{South}}
\]</span></p>
<ul>
<li><span class="math inline">\(b_0\)</span> represents the mean mercury level for lakes in North Florida, and<br>
</li>
<li><span class="math inline">\(b_1\)</span> represents the mean difference in mercury level for lakes in South Florida, compared to North Florida</li>
</ul>
<p>The estimates for corresponding to the original sample are shown below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>M_Lakes_merc_loc <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>FloridaLakes, Mercury<span class="sc">~</span>Location)</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>M_Lakes_merc_loc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Mercury ~ Location, data = FloridaLakes)

Coefficients:
(Intercept)    LocationS  
     0.4245       0.2720  </code></pre>
</div>
</div>
<p>A confidence interval for <span class="math inline">\(b_0\)</span> will tell us a range of plausible values for the mean mercury level among all lakes in Northern Florida.</p>
<p>A confidence interval for <span class="math inline">\(b_1\)</span> will tell us a range of plausible values for the mean mercury level among all lakes in Southern Florida.</p>
<p>We can obtain these confidence intervals by fitting a regression model to each of our bootstrap samples and recording the values of the statistics <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span> in the bootstrap samples.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co">#First Bootstrap Sample </span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>Bootstrap1 <span class="ot">&lt;-</span> <span class="fu">resample</span>(FloridaLakes, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>Bootstrap1 <span class="sc">|&gt;</span> <span class="fu">arrange</span>(ID)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 53 × 8
      ID Lake            pH Mercury Chlorophyll Location Depth   orig.id
   &lt;dbl&gt; &lt;chr&gt;        &lt;dbl&gt;   &lt;dbl&gt;       &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;   &lt;chr&gt;  
 1     1 Alligator      6.1    1.23         0.7 S        Medium  1      
 2     1 Alligator      6.1    1.23         0.7 S        Medium  1      
 3     4 Blue Cypress   6.9    0.44         3.5 S        Shallow 4      
 4     4 Blue Cypress   6.9    0.44         3.5 S        Shallow 4      
 5     5 Brick          4.6    1.2          1.8 S        Medium  5      
 6     6 Bryant         7.3    0.27        44.1 N        Shallow 6      
 7     6 Bryant         7.3    0.27        44.1 N        Shallow 6      
 8     7 Cherry         5.4    0.48         3.4 N        Shallow 7      
 9    11 Dorr           5.4    0.71        14.9 N        Medium  11     
10    11 Dorr           5.4    0.71        14.9 N        Medium  11     
# ℹ 43 more rows</code></pre>
</div>
</div>
<p><strong>Bootstrap Sample 1</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>Bootstrap1_BP <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>Bootstrap1, <span class="fu">aes</span>(<span class="at">x=</span>Location, <span class="at">y=</span>Mercury, <span class="at">fill=</span>Location)) <span class="sc">+</span> </span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span>   <span class="fu">geom_jitter</span>() <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"Mercury Levels in Florida Lakes"</span>) <span class="sc">+</span> </span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Location"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Mercury Level"</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>)) <span class="sc">+</span> <span class="fu">coord_flip</span>()</span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>Bootstrap1_BP</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch3_files/figure-html/unnamed-chunk-64-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>Bootstrap1_BP <span class="ot">&lt;-</span> Bootstrap1 <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Location) <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">MeanHg=</span><span class="fu">mean</span>(Mercury), </span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">StDevHg=</span><span class="fu">sd</span>(Mercury), </span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">N=</span><span class="fu">n</span>())</span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>Bootstrap1_BP</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  Location MeanHg StDevHg     N
  &lt;chr&gt;     &lt;dbl&gt;   &lt;dbl&gt; &lt;int&gt;
1 N         0.488   0.231    32
2 S         0.7     0.310    21</code></pre>
</div>
</div>
<p>We fit a regression model to the bootstrap sample and calculate the regression coefficients. We’re interested in the second coefficient, <span class="math inline">\(b_1\)</span>, which represents the mean difference between lakes in Southern and Northern Florida.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit a linear model</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>M_Lakes_merc_loc_Boot1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Mercury <span class="sc">~</span> Location, <span class="at">data =</span> Bootstrap1)</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>M_Lakes_merc_loc_Boot1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Mercury ~ Location, data = Bootstrap1)

Coefficients:
(Intercept)    LocationS  
     0.4878       0.2122  </code></pre>
</div>
</div>
<p>The bootstrap estimates are <span class="math inline">\(b_0\)</span> = 0.4878125 and <span class="math inline">\(b_1\)</span> = 0.2121875.</p>
<p><strong>Bootstrap Sample 2</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Second Bootstrap Sample</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>Bootstrap2 <span class="ot">&lt;-</span> <span class="fu">resample</span>(FloridaLakes, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>Bootstrap2 <span class="sc">|&gt;</span> <span class="fu">arrange</span>(ID)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 53 × 8
      ID Lake        pH Mercury Chlorophyll Location Depth   orig.id
   &lt;dbl&gt; &lt;chr&gt;    &lt;dbl&gt;   &lt;dbl&gt;       &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;   &lt;chr&gt;  
 1     2 Annie      5.1    1.33         3.2 S        Deep    2      
 2     5 Brick      4.6    1.2          1.8 S        Medium  5      
 3     6 Bryant     7.3    0.27        44.1 N        Shallow 6      
 4     6 Bryant     7.3    0.27        44.1 N        Shallow 6      
 5     7 Cherry     5.4    0.48         3.4 N        Shallow 7      
 6     7 Cherry     5.4    0.48         3.4 N        Shallow 7      
 7     8 Crescent   8.1    0.19        33.7 N        Shallow 8      
 8    10 Dias       6.4    0.81        22.5 N        Deep    10     
 9    10 Dias       6.4    0.81        22.5 N        Deep    10     
10    11 Dorr       5.4    0.71        14.9 N        Medium  11     
# ℹ 43 more rows</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>Bootstrap2_BP <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>Bootstrap2, <span class="fu">aes</span>(<span class="at">x=</span>Location, <span class="at">y=</span>Mercury, <span class="at">fill=</span>Location)) <span class="sc">+</span> </span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span>   <span class="fu">geom_jitter</span>() <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"Mercury Levels in Florida Lakes"</span>) <span class="sc">+</span> </span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Location"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Mercury Level"</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>)) <span class="sc">+</span> <span class="fu">coord_flip</span>()</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>Bootstrap2_BP</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch3_files/figure-html/unnamed-chunk-68-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>Bootstrap2_BP <span class="ot">&lt;-</span> Bootstrap2 <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Location) <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">MeanHg=</span><span class="fu">mean</span>(Mercury), </span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">StDevHg=</span><span class="fu">sd</span>(Mercury), </span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">N=</span><span class="fu">n</span>())</span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>Bootstrap2_BP</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  Location MeanHg StDevHg     N
  &lt;chr&gt;     &lt;dbl&gt;   &lt;dbl&gt; &lt;int&gt;
1 N         0.455   0.276    42
2 S         0.807   0.363    11</code></pre>
</div>
</div>
<p>We fit a regression model to the bootstrap sample and calculate the regression coefficients. We’re interested in the second coefficient, <span class="math inline">\(b_1\)</span>, which represents the mean difference between lakes in Southern and Northern Florida.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit a linear model</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>M_Lakes_merc_loc_Boot2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Mercury <span class="sc">~</span> Location, <span class="at">data =</span> Bootstrap2)</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>M_Lakes_merc_loc_Boot2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Mercury ~ Location, data = Bootstrap2)

Coefficients:
(Intercept)    LocationS  
     0.4545       0.3527  </code></pre>
</div>
</div>
<p>The bootstrap estimates are <span class="math inline">\(b_1\)</span> = 0.4545238 and <span class="math inline">\(b_1\)</span> = 0.3527489.</p>
<p>We’ll now take 10,000 different bootstrap samples and look at the bootstrap distribution for <span class="math inline">\(b_1\)</span>, the difference in mean mercury levels between lakes in Southern and Northern Florida</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>M_Lakes_merc_loc_Bootstrap <span class="ot">&lt;-</span> <span class="fu">do</span>(<span class="dv">10000</span>) <span class="sc">*</span> <span class="fu">lm</span>(Mercury <span class="sc">~</span> Location, <span class="at">data =</span> <span class="fu">resample</span>(FloridaLakes))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The bootstrap distribution for the difference in means, <span class="math inline">\(b_0\)</span>, and <span class="math inline">\(b_1\)</span> are shown below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot for b0</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>M_Lakes_merc_loc_Bootstrap_Plot_b0 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>M_Lakes_merc_loc_Bootstrap, <span class="fu">aes</span>(<span class="at">x=</span>Intercept)) <span class="sc">+</span>  </span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">color=</span><span class="st">"white"</span>, <span class="at">fill=</span><span class="st">"lightblue"</span>, <span class="at">binwidth=</span><span class="fl">0.02</span>) <span class="sc">+</span></span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"b0: Mean mercury in Northern Fla."</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Bootstrap Intercept b0"</span>) <span class="sc">+</span> </span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a><span class="co"># plot for b1</span></span>
<span id="cb93-9"><a href="#cb93-9" aria-hidden="true" tabindex="-1"></a>M_Lakes_merc_loc_Bootstrap_Plot_b1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>M_Lakes_merc_loc_Bootstrap, <span class="fu">aes</span>(<span class="at">x=</span>LocationS)) <span class="sc">+</span>  </span>
<span id="cb93-10"><a href="#cb93-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">color=</span><span class="st">"white"</span>, <span class="at">fill=</span><span class="st">"lightblue"</span>, <span class="at">binwidth=</span><span class="fl">0.02</span>) <span class="sc">+</span></span>
<span id="cb93-11"><a href="#cb93-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"b1: Mean difference between southern and northern Fla."</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb93-12"><a href="#cb93-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Bootstrap Intercept b1"</span>) <span class="sc">+</span> </span>
<span id="cb93-13"><a href="#cb93-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span>
<span id="cb93-14"><a href="#cb93-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-15"><a href="#cb93-15" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(M_Lakes_merc_loc_Bootstrap_Plot_b0, M_Lakes_merc_loc_Bootstrap_Plot_b1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch3_files/figure-html/unnamed-chunk-72-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Since both distributions are symmetric and bell-shaped, we can calculate standard error confidence intervals. The <code>confint</code> command gives us standard errors and confidence intervals.</p>
<p>The standard error for <span class="math inline">\(b_0\)</span> is</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>SE_b0 <span class="ot">&lt;-</span> <span class="fu">sd</span>(M_Lakes_merc_loc_Bootstrap<span class="sc">$</span>Intercept)</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>SE_b0</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.04653398</code></pre>
</div>
</div>
<p>This tells us how much the mean mercury level among lakes in Northern Florida would vary between different samples of 20 Northern lakes.</p>
<p>A 95% confidence interval for the mean mercury level among all lakes in Northern Florida is given by</p>
<p><span class="math display">\[
\begin{aligned}
&amp; b_0 \pm 2\times\text{SE}(b_0) \\
&amp; = 0.425 \pm 2\times{0.046}
\end{aligned}
\]</span></p>
<p>The standard error for <span class="math inline">\(b_1\)</span> is</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>SE_b0 <span class="ot">&lt;-</span> <span class="fu">sd</span>(M_Lakes_merc_loc_Bootstrap<span class="sc">$</span>Intercept)</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>SE_b0</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.04653398</code></pre>
</div>
</div>
<p>This tells us how much the difference in mean mercury level between lakes in Northern and Southern Florida would vary between different samples of 53 lakes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>SE_b1 <span class="ot">&lt;-</span> <span class="fu">sd</span>(M_Lakes_merc_loc_Bootstrap<span class="sc">$</span>LocationS)</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>SE_b1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.09593809</code></pre>
</div>
</div>
<p><span class="math display">\[
\begin{aligned}
&amp; b_1 \pm 2\times\text{SE}(b_1) \\
&amp; = 0.271 \pm 2\times{0.097}
\end{aligned}
\]</span></p>
<p>We can calculate these intervals automatically in R using the <code>confint</code> command. When calculating confidence intervals for a regression model we add <code>parm = c("Intercept", "LocationS")</code> to tell it to return intervals for the interval and the estimate associated with LocationS. If we leave out the <code>parm</code> argument, R will return additional confidence intervals that we aren’t interested in here.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>CI <span class="ot">&lt;-</span> <span class="fu">confint</span>(M_Lakes_merc_loc_Bootstrap, <span class="at">parm =</span> <span class="fu">c</span>(<span class="st">"Intercept"</span>, <span class="st">"LocationS"</span>),</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">level =</span> <span class="fl">0.95</span>, <span class="at">method =</span> <span class="st">"se"</span>)</span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>CI</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       name      lower     upper level method  estimate margin.of.error
1 Intercept 0.33333149 0.5157413  0.95 stderr 0.4245455      0.09120492
2 LocationS 0.08256301 0.4586334  0.95 stderr 0.2719545      0.18803521</code></pre>
</div>
</div>
<p>We add the confidence intervals to the plots of the bootstrap distributions below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co"># CI plot for intercept b1</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>CI_Plot_b0 <span class="ot">&lt;-</span> M_Lakes_merc_loc_Bootstrap_Plot_b0 <span class="sc">+</span> </span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>                <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x=</span>CI<span class="sc">$</span>lower[<span class="dv">1</span>], <span class="at">xend=</span>CI<span class="sc">$</span>upper[<span class="dv">1</span>] , <span class="at">y=</span><span class="dv">50</span>, <span class="at">yend=</span><span class="dv">50</span>), </span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">color=</span><span class="st">"gold"</span>, <span class="at">size=</span><span class="dv">10</span>, <span class="at">alpha=</span><span class="fl">0.01</span>) </span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a><span class="co"># CI plot for b1</span></span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a>CI_Plot_b1 <span class="ot">&lt;-</span> M_Lakes_merc_loc_Bootstrap_Plot_b1 <span class="sc">+</span> </span>
<span id="cb102-8"><a href="#cb102-8" aria-hidden="true" tabindex="-1"></a>                <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x=</span>CI<span class="sc">$</span>lower[<span class="dv">2</span>], <span class="at">xend=</span>CI<span class="sc">$</span>upper[<span class="dv">2</span>] , <span class="at">y=</span><span class="dv">50</span>, <span class="at">yend=</span><span class="dv">50</span>), </span>
<span id="cb102-9"><a href="#cb102-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">color=</span><span class="st">"gold"</span>, <span class="at">size=</span><span class="dv">10</span>, <span class="at">alpha=</span><span class="fl">0.01</span>)</span>
<span id="cb102-10"><a href="#cb102-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-11"><a href="#cb102-11" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(CI_Plot_b0, CI_Plot_b1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch3_files/figure-html/unnamed-chunk-77-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We are 95% confident that the mean mercury level among all lakes in Northern Florida is between 0.33 and 0.52 ppm.</p>
<p>We are 95% confident that the mean mercury level among all lakes in Southern Florida is between 0.46 and 0.46 higher than the mean mercury level among all lakes in Northern Florida.</p>
</section>
<section id="ci-for-regression-slope" class="level3" data-number="3.3.2">
<h3 data-number="3.3.2" class="anchored" data-anchor-id="ci-for-regression-slope"><span class="header-section-number">3.3.2</span> CI for Regression Slope</h3>
<p>Now, suppose we also want to investigate whether there is a relationship between a lake’s mercury level and pH. We’ll add pH to the model.</p>
<p>The model equation is:</p>
<p><span class="math display">\[
\widehat{\text{Mercury}} = b_0 + b_1\times{\text{South}} + b_2\times{\text{pH}}
\]</span></p>
<p>In this model:<br>
- <span class="math inline">\(b_0\)</span> represents the mean mercury level among all lakes in Northern Florida with pH level 0. Since lakes will not have pH level 0 in reality, the intercept no longer has a meaningful interpretation.<br>
- <span class="math inline">\(b_1\)</span> represents the difference in mean mercury level among lakes in Southern and Northern Florida, assuming they have the same pH.<br>
- <span class="math inline">\(b_2\)</span> represents the expected change in mercury level for each 1-unit increase in pH, assuming location is the same.</p>
<p>The scatterplot displays the relationship between mercury level and pH, colored by location, with parallel regression lines fit to the data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>FloridaLakes, <span class="fu">aes</span>(<span class="at">y=</span>Mercury, <span class="at">x=</span>pH, <span class="at">color=</span>Location)) <span class="sc">+</span> </span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_parallel_slopes</span>(<span class="at">se=</span><span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch3_files/figure-html/unnamed-chunk-78-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We see that mercury tends to decrease as pH increases.</p>
<p>We fit the model in R and display the estimates <span class="math inline">\(b_0\)</span>, <span class="math inline">\(b_1\)</span>, and <span class="math inline">\(b_2\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>M_Lakes_merc_loc_pH <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>FloridaLakes, Mercury <span class="sc">~</span> Location <span class="sc">+</span> pH)</span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>M_Lakes_merc_loc_pH</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Mercury ~ Location + pH, data = FloridaLakes)

Coefficients:
(Intercept)    LocationS           pH  
     1.4071       0.2552      -0.1481  </code></pre>
</div>
</div>
<ul>
<li>On average, lakes with pH level 0 are expected to have a mercury level of 1.4 ppm. Since no lake has a pH of 0, this is not a meaningful interpretation. &nbsp;</li>
<li>On average, lakes in Southern Florida are expected to have a mercury level 0.255 ppm higher than lakes in Northern Florida with the same pH.<br>
</li>
<li>For each one-unit increase in pH, mercury level is expected to decrease by 0.15 ppm, assuming location is the same.</li>
</ul>
<p>As before, <span class="math inline">\(b_0\)</span>, <span class="math inline">\(b_1\)</span>, and <span class="math inline">\(b_2\)</span> are estimates calculated from a single sample of 53 lakes. We can use them as estimates of the coefficients we would see if we were able to fit a regression model to all Florida lakes.</p>
<p>We’ll use bootstrapping to determine how much these estimates could vary between samples, and to obtain confidence intervals for the quantities of interest.</p>
<p><strong>Bootstrap Sample 1</strong></p>
<p>We select a bootstrap sample and plot the relationship between Mercury, pH, and location.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co">#First Bootstrap Sample </span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>Bootstrap1 <span class="ot">&lt;-</span> <span class="fu">resample</span>(FloridaLakes, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot Bootstrap Sample</span></span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>Bootstrap1, <span class="fu">aes</span>(<span class="at">y=</span>Mercury, <span class="at">x=</span>pH, <span class="at">color=</span>Location)) <span class="sc">+</span> </span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_parallel_slopes</span>(<span class="at">se=</span><span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb106-8"><a href="#cb106-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch3_files/figure-html/unnamed-chunk-80-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Model estimates for the bootstrap sample are shown below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit a linear model</span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>M_Lakes_merc_pH_Boot1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Mercury <span class="sc">~</span> Location <span class="sc">+</span> pH, <span class="at">data =</span> Bootstrap1)</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>M_Lakes_merc_pH_Boot1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Mercury ~ Location + pH, data = Bootstrap1)

Coefficients:
(Intercept)    LocationS           pH  
     1.4862       0.1830      -0.1605  </code></pre>
</div>
</div>
<p><strong>Bootstrap Sample 2</strong></p>
<p>We select a bootstrap sample and plot the relationship between Mercury, pH, and location.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="co">#First Bootstrap Sample </span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>Bootstrap2 <span class="ot">&lt;-</span> <span class="fu">resample</span>(FloridaLakes, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot Bootstrap Sample</span></span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>Bootstrap2, <span class="fu">aes</span>(<span class="at">y=</span>Mercury, <span class="at">x=</span>pH, <span class="at">color=</span>Location)) <span class="sc">+</span> </span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb109-7"><a href="#cb109-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_parallel_slopes</span>(<span class="at">se=</span><span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb109-8"><a href="#cb109-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch3_files/figure-html/unnamed-chunk-82-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Model estimates for the bootstrap sample are shown below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit a linear model</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>M_Lakes_merc_pH_Boot2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Mercury <span class="sc">~</span> Location <span class="sc">+</span> pH, <span class="at">data =</span> Bootstrap2)</span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>M_Lakes_merc_pH_Boot2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Mercury ~ Location + pH, data = Bootstrap2)

Coefficients:
(Intercept)    LocationS           pH  
     1.5792       0.2737      -0.1743  </code></pre>
</div>
</div>
<p>We’ll now take 10,000 different bootstrap samples and look at the bootstrap distribution for <span class="math inline">\(b_1\)</span>, the difference in mean mercury levels between lakes in Southern and Northern Florida</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>M_Lakes_merc_loc_pH_Bootstrap <span class="ot">&lt;-</span> <span class="fu">do</span>(<span class="dv">10000</span>) <span class="sc">*</span> <span class="fu">lm</span>(Mercury <span class="sc">~</span> Location <span class="sc">+</span> pH, <span class="at">data =</span> <span class="fu">resample</span>(FloridaLakes))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We’ll focus on the bootstrap distribution for <span class="math inline">\(b_2\)</span>, pertaining to the effect of pH.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot for b0</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>M_Lakes_merc_loc_pH_Bootstrap_Plot_b2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>M_Lakes_merc_loc_pH_Bootstrap, <span class="fu">aes</span>(<span class="at">x=</span>pH)) <span class="sc">+</span>  </span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">color=</span><span class="st">"white"</span>, <span class="at">fill=</span><span class="st">"lightblue"</span>, <span class="at">binwidth=</span><span class="fl">0.01</span>) <span class="sc">+</span></span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"b2: Effect of pH"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Bootstrap Estimate b2"</span>) <span class="sc">+</span> </span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span>
<span id="cb113-7"><a href="#cb113-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-8"><a href="#cb113-8" aria-hidden="true" tabindex="-1"></a>M_Lakes_merc_loc_pH_Bootstrap_Plot_b2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch3_files/figure-html/unnamed-chunk-85-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Again, notice that the bootstrap distribution is symmetric and bell-shaped, so we can calculate a confidence interval using the standard error method.</p>
<p>The standard error for <span class="math inline">\(b_2\)</span> is</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>SE_b2 <span class="ot">&lt;-</span> <span class="fu">sd</span>(M_Lakes_merc_loc_pH_Bootstrap<span class="sc">$</span>pH)</span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>SE_b2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.02389449</code></pre>
</div>
</div>
<p>This tells us how much the slope associated with pH would vary between different samples of 53 lakes.</p>
<p>A 95% confidence interval is</p>
<p><span class="math display">\[
\begin{aligned}
&amp; b_2 \pm 2\times\text{SE}(b_2) \\
&amp; = -0.15 \pm 2\times{0.024}
\end{aligned}
\]</span></p>
<p>The <code>confint()</code> command displays this confidence interval, as well as those associated with <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>CI <span class="ot">&lt;-</span> <span class="fu">confint</span>(M_Lakes_merc_loc_pH_Bootstrap, <span class="at">parm =</span> <span class="fu">c</span>(<span class="st">"Intercept"</span>, <span class="st">"LocationS"</span>, <span class="st">"pH"</span>),</span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">level =</span> <span class="fl">0.95</span>, <span class="at">method =</span> <span class="st">"se"</span>)</span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>CI</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       name      lower      upper level method   estimate margin.of.error
1 Intercept  1.0913270  1.7178923  0.95 stderr  1.4071357      0.31328265
2 LocationS  0.1133657  0.3984815  0.95 stderr  0.2551666      0.14255789
3        pH -0.1944582 -0.1007935  0.95 stderr -0.1481292      0.04683234</code></pre>
</div>
</div>
<p>The confidence interval associated with <span class="math inline">\(b_2\)</span>, the effect of pH is shown below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="co"># CI plot for intercept b2</span></span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>CI_Plot_b2 <span class="ot">&lt;-</span> M_Lakes_merc_loc_pH_Bootstrap_Plot_b2 <span class="sc">+</span> </span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a>                <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x=</span>CI<span class="sc">$</span>lower[<span class="dv">3</span>], <span class="at">xend=</span>CI<span class="sc">$</span>upper[<span class="dv">3</span>] , <span class="at">y=</span><span class="dv">50</span>, <span class="at">yend=</span><span class="dv">50</span>), </span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">color=</span><span class="st">"gold"</span>, <span class="at">size=</span><span class="dv">10</span>, <span class="at">alpha=</span><span class="fl">0.01</span>) </span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true" tabindex="-1"></a>CI_Plot_b2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch3_files/figure-html/unnamed-chunk-88-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We are 95% confident that for each one-unit increase in pH, mercury level is expected to decrease between about 0.1 and 0.19 ppm.</p>
</section>
<section id="ci-for-regression-response" class="level3" data-number="3.3.3">
<h3 data-number="3.3.3" class="anchored" data-anchor-id="ci-for-regression-response"><span class="header-section-number">3.3.3</span> CI for Regression Response</h3>
<p>In addition to calculating a confidence interval for the quantities associated with our estimates <span class="math inline">\(b_0\)</span>, <span class="math inline">\(b_1\)</span>, and <span class="math inline">\(b_2\)</span>, we can also calculate a confidence interval for the average mercury level among all lakes with a given location and pH.</p>
<p>We’ll calculate a confidence interval for the average mercury level among all lakes in Southern Florida with a neutral pH level of 7.</p>
<p>The regression model equation is</p>
<p><span class="math display">\[
\begin{aligned}
\widehat{\text{Mercury}} &amp; = b_0 + b_1\times\text{LocationS} + b_2\times\text{pH}
\end{aligned}
\]</span></p>
<p>so the expected mercury level among all lakes in Southern Florida with <span class="math inline">\(\text{pH} = 7\)</span> is</p>
<p><span class="math display">\[
b_0 + b_1 + 7b_2
\]</span></p>
<p>Plugging in the model estimates of <span class="math inline">\(b_0\)</span>, <span class="math inline">\(b_1\)</span>, and <span class="math inline">\(b_2\)</span>,</p>
<p><span class="math display">\[
\begin{aligned}
\widehat{\text{Mercury}} &amp; = b_0 + b_1\times\text{LocationS} + b_2\times\text{pH}  \\
\ &amp; = 1.407 + 0.255(1) - 0.148(7) \\
&amp; \approx 0.626
\end{aligned}
\]</span></p>
<p>We can also calculate this using the <code>predict</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(M_Lakes_merc_loc_pH, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">Location =</span> <span class="st">"S"</span>, <span class="at">pH=</span><span class="dv">7</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       1 
0.625398 </code></pre>
</div>
</div>
<p>We estimate that the average mercury level among lakes in Southern Florida with pH of 7 is 0.626 ppm.</p>
<p>This estimate is, however, a sample statistic like all the others we’ve seen. It was calculated from just our sample of 53 lakes, and if we had a different sample, we would have gotten a different estimate. Thus, we need to provide a confidence interval for mean mercury level among all lakes in South Florida with pH 7. We can do that using bootstrapping.</p>
<p><strong>Bootstrap Sample 1</strong></p>
<p>We select a bootstrap sample and plot the relationship between Mercury, pH, and location.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="co">#First Bootstrap Sample </span></span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>Bootstrap1 <span class="ot">&lt;-</span> <span class="fu">resample</span>(FloridaLakes, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Fit regression model to bootstrap sample</span></span>
<span id="cb121-5"><a href="#cb121-5" aria-hidden="true" tabindex="-1"></a>M_Lakes_merc_loc_pH_Boot1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Mercury <span class="sc">~</span> Location <span class="sc">+</span> pH, <span class="at">data=</span>Bootstrap1)</span>
<span id="cb121-6"><a href="#cb121-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-7"><a href="#cb121-7" aria-hidden="true" tabindex="-1"></a><span class="co"># predict mercury level</span></span>
<span id="cb121-8"><a href="#cb121-8" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(M_Lakes_merc_loc_pH_Boot1, <span class="at">newdata=</span><span class="fu">data.frame</span>(<span class="at">Location =</span> <span class="st">"S"</span>, <span class="at">pH=</span><span class="dv">7</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        1 
0.6315449 </code></pre>
</div>
</div>
<p>Based on this bootstrap sample, the mean mercury level among lakes in Southern Florida is estimated to be 0.625398 ppm.</p>
<p><strong>Bootstrap Sample 2</strong></p>
<p>We select a bootstrap sample and plot the relationship between Mercury, pH, and location.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>Bootstrap2 <span class="ot">&lt;-</span> <span class="fu">resample</span>(FloridaLakes, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Fit regression model to bootstrap sample</span></span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a>M_Lakes_merc_loc_pH_Boot2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Mercury <span class="sc">~</span> Location <span class="sc">+</span> pH, <span class="at">data=</span>Bootstrap2)</span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-6"><a href="#cb123-6" aria-hidden="true" tabindex="-1"></a><span class="co"># predict mercury level</span></span>
<span id="cb123-7"><a href="#cb123-7" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(M_Lakes_merc_loc_pH_Boot2, <span class="at">newdata=</span><span class="fu">data.frame</span>(<span class="at">Location =</span> <span class="st">"S"</span>, <span class="at">pH=</span><span class="dv">7</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        1 
0.5106231 </code></pre>
</div>
</div>
<p>Based on the second bootstrap sample, the mean mercury level among lakes in Southern Florida is estimated to be 0.5106231 ppm.</p>
<p>We’ll now take 10,000 different bootstrap samples and look at the bootstrap distribution for <span class="math inline">\(b_0 + b_1 + 7b_2\)</span>, the estimated average mercury level among all lakes in Southern Florida with pH = 7.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>M_Lakes_merc_locS_pH7_Bootstrap <span class="ot">&lt;-</span> <span class="fu">do</span>(<span class="dv">10000</span>) <span class="sc">*</span> <span class="fu">predict</span>(<span class="fu">lm</span>(Mercury <span class="sc">~</span> Location <span class="sc">+</span> pH, <span class="at">data =</span> <span class="fu">resample</span>(FloridaLakes)), <span class="at">newdata=</span><span class="fu">data.frame</span>(<span class="at">Location=</span><span class="st">"S"</span>, <span class="at">pH=</span><span class="dv">7</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The bootstrap distribution for average mercury level among all lakes in Southern Florida with pH = 7 is shown below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot for b0 + b_1 + 7*b_2</span></span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>M_Lakes_merc_locS_pH7_Bootstrap_Plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>M_Lakes_merc_locS_pH7_Bootstrap, <span class="fu">aes</span>(<span class="at">x=</span>X1)) <span class="sc">+</span>  </span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">color=</span><span class="st">"white"</span>, <span class="at">fill=</span><span class="st">"lightblue"</span>, <span class="at">binwidth=</span><span class="fl">0.01</span>) <span class="sc">+</span></span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Estimated Mercury"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb126-5"><a href="#cb126-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Bootstrap Estimate b0 + b1 + 7*b2"</span>) <span class="sc">+</span> </span>
<span id="cb126-6"><a href="#cb126-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span>
<span id="cb126-7"><a href="#cb126-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-8"><a href="#cb126-8" aria-hidden="true" tabindex="-1"></a>M_Lakes_merc_locS_pH7_Bootstrap_Plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch3_files/figure-html/unnamed-chunk-93-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Again, notice that the bootstrap distribution is symmetric and bell-shaped, so we can calculate a confidence interval using the standard error method.</p>
<p>The standard error for <span class="math inline">\(b_0 + b_1 + 7b_2\)</span> is</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a>SE_Est <span class="ot">&lt;-</span> <span class="fu">sd</span>(M_Lakes_merc_locS_pH7_Bootstrap<span class="sc">$</span>X1)</span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>SE_Est</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.05969632</code></pre>
</div>
</div>
<p>This tells us how much the estimated mercury level among lakes in Southern Florida with pH=7 would vary between different samples of 53 lakes. Note, this is <strong>not</strong> the same things as the variability between individual lakes with pH 7.</p>
<p>A 95% confidence interval for mean mercury level among lakes in Southern Florida with pH=7 is</p>
<p><span class="math display">\[
\begin{aligned}
&amp; b_0 + b_1 + 7b_2 \pm 2\times\text{SE}(b_0 + b_1 + 7b_2) \\
&amp; = 0.625 \pm 2\times{0.059}
\end{aligned}
\]</span></p>
<p>We can also calculate the confidence interval using the <code>confint()</code> command below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a>M_Lakes_merc_locS_pH7_Bootstrap_CI <span class="ot">&lt;-</span> <span class="fu">do</span>(<span class="dv">10000</span>) <span class="sc">*</span> <span class="fu">predict</span>(<span class="fu">lm</span>(Mercury <span class="sc">~</span> Location <span class="sc">+</span> pH, <span class="at">data =</span> <span class="fu">resample</span>(FloridaLakes)), <span class="at">newdata=</span><span class="fu">data.frame</span>(<span class="at">Location=</span><span class="st">"S"</span>, <span class="at">pH=</span><span class="dv">7</span>), <span class="at">interval =</span> <span class="st">"confidence"</span>, <span class="at">level=</span><span class="fl">0.95</span>)</span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a>CI <span class="ot">&lt;-</span> <span class="fu">confint</span>(M_Lakes_merc_locS_pH7_Bootstrap_CI, <span class="at">parm =</span> <span class="st">"fit"</span>, <span class="at">method =</span> <span class="st">"stderr"</span>)</span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a>CI</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  name     lower     upper level method estimate margin.of.error
1  fit 0.5118066 0.7411329  0.95 stderr 0.625398       0.1146632</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>M_Lakes_merc_locS_pH7_Bootstrap_Plot  <span class="sc">+</span> </span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>                <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x=</span>CI<span class="sc">$</span>lower, <span class="at">xend=</span>CI<span class="sc">$</span>upper , <span class="at">y=</span><span class="dv">50</span>, <span class="at">yend=</span><span class="dv">50</span>), </span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">color=</span><span class="st">"gold"</span>, <span class="at">size=</span><span class="dv">10</span>, <span class="at">alpha=</span><span class="fl">0.01</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch3_files/figure-html/unnamed-chunk-96-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We are 95% confident that the mean mercury level among lakes in Southern Florida with pH=7 is between 0.51 and 0.74 ppm.</p>
<p>It is important to note that we are <strong>not</strong> saying that we are 95% confident that the mercury level of an individual lake in South Florida with a pH of 7 will lie in this range. Confidence intervals are about population parameters like averages, rather than about individuals. An interval pertaining to mercury levels in individual lakes would need to be wider than this one. We’ll talk about how to obtain these kinds of intervals later in the course.</p>
</section>
<section id="bootstrapping-cautions" class="level3" data-number="3.3.4">
<h3 data-number="3.3.4" class="anchored" data-anchor-id="bootstrapping-cautions"><span class="header-section-number">3.3.4</span> Bootstrapping Cautions</h3>
<p>While bootstrapping is a popular and robust procedure for calculating confidence intervals, it does have cautions and limitations. We should be sure to use the bootstrap procedure appropriate for our context. A standard-error bootstrap interval is appropriate when the sampling distribution for our statistic is roughly symmetric and bell-shaped. When this is not true, a percentile bootstrap interval can be used as long as there are no gaps or breaks in the bootstrap distribution. In situations where there are gaps and breaks in the bootstrap distribution, then the bootstrap distribution may not be a reasonable approximation of the sampling distribution we are interested in.</p>
<div style="page-break-after: always;"></div>
</section>
</section>
<section id="permutation-based-hypothesis-testing" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="permutation-based-hypothesis-testing"><span class="header-section-number">3.4</span> Permutation-Based Hypothesis Testing</h2>
<section id="mercury-in-lakes-n-vs-s" class="level3" data-number="3.4.1">
<h3 data-number="3.4.1" class="anchored" data-anchor-id="mercury-in-lakes-n-vs-s"><span class="header-section-number">3.4.1</span> Mercury in Lakes: N vs S</h3>
<p>Recall the comparison of mercury levels in lakes in Northern Florida, compared to Southern Florida. The boxplot and table below, also seen in the previous section, show the distribution of mercury levels among the 33 northern and 20 southern lakes in the sample.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>Lakes_merc_loc_BP <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>FloridaLakes, <span class="fu">aes</span>(<span class="at">x=</span>Location, <span class="at">y=</span>Mercury, <span class="at">fill=</span>Location)) <span class="sc">+</span> </span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span>   <span class="fu">geom_jitter</span>() <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"Mercury Levels in Florida Lakes"</span>) <span class="sc">+</span> </span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Location"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Mercury Level"</span>) <span class="sc">+</span> </span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>)) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">1.5</span>)) <span class="sc">+</span> </span>
<span id="cb132-5"><a href="#cb132-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span> <span class="fu">theme_bw</span>()  </span>
<span id="cb132-6"><a href="#cb132-6" aria-hidden="true" tabindex="-1"></a>Lakes_merc_loc_BP</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch3_files/figure-html/unnamed-chunk-97-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a>LakesTable <span class="ot">&lt;-</span> FloridaLakes <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Location) <span class="sc">%&gt;%</span> </span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">summarize</span>(<span class="at">MeanHg=</span><span class="fu">mean</span>(Mercury), </span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">StDevHg=</span><span class="fu">sd</span>(Mercury),  </span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">N=</span><span class="fu">n</span>())</span>
<span id="cb133-5"><a href="#cb133-5" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(LakesTable)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Location</th>
<th style="text-align: right;">MeanHg</th>
<th style="text-align: right;">StDevHg</th>
<th style="text-align: right;">N</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">N</td>
<td style="text-align: right;">0.4245455</td>
<td style="text-align: right;">0.2696652</td>
<td style="text-align: right;">33</td>
</tr>
<tr class="even">
<td style="text-align: left;">S</td>
<td style="text-align: right;">0.6965000</td>
<td style="text-align: right;">0.3838760</td>
<td style="text-align: right;">20</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>We see that on average mercury levels were higher among the southern lakes than the northern ones, a difference of <span class="math inline">\(0.697-0.445= 0.272\)</span> ppm.</p>
<p>As we’ve seen, we can use a statistical model to estimate a lake’s mercury level, using its location (N or S) as our explanatory variable.</p>
<p><span class="math inline">\(\widehat{\text{Hg}} = b_0 +b_1\times\text{South}\)</span></p>
<ul>
<li><span class="math inline">\(b_0\)</span> represents the mean mercury level for lakes in North Florida, and<br>
</li>
<li><span class="math inline">\(b_1\)</span> represents the mean difference in mercury level for lakes in South Florida, compared to North Florida</li>
</ul>
<p>Fitting the model in R, we obtain the estimates for <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a>M_Lakes_loc <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>FloridaLakes, Mercury <span class="sc">~</span> Location)</span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>M_Lakes_loc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Mercury ~ Location, data = FloridaLakes)

Coefficients:
(Intercept)    LocationS  
     0.4245       0.2720  </code></pre>
</div>
</div>
<p><span class="math display">\[
\widehat{\text{Hg}} = 0.42+0.27\times\text{South}
\]</span></p>
<ul>
<li><p><span class="math inline">\(b_1 = 0.272= 0.6965 - 0.4245\)</span> is equal to the difference in mean mercury levels between Northern and Southern lakes. (We’ve already seen that for categorical variables, the least-squares estimate is the mean, so this makes sense.)</p></li>
<li><p>We can use <span class="math inline">\(b_1\)</span> to assess the size of the difference in mean mercury concentration levels.</p></li>
</ul>
<section id="hypotheses-and-key-question" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="hypotheses-and-key-question">Hypotheses and Key Question</h4>
<p>Since the lakes we observed are only a sample of 53 lakes out of more than 30,000, we cannot assume the difference in mercury concentration for <strong>all</strong> Northern vs Southern Florida lakes is exactly 0.272. Instead, we need to determine whether a difference of this size in our sample is large enough to provide evidence of a difference in average mercury level between <strong>all</strong> Northern and Southern lakes in Florida.</p>
<p>One possible explanation for us getting the results we did in our sample is that there really is no difference in average mercury levels between all lakes in Northern and Southern Florida, and we just happened, by chance, to select more lakes with higher mercury concentrations in Southern Florida than in Northern Florida. A different possible explanation is that there really is a difference in average mercury level between lakes in Northern and Southern Florida.</p>
<p>In a statistical investigation, the <strong>null hypothesis</strong> is the one that says there is no difference between groups , or no relationship between variables in the larger population, and that any difference/relationship observed in our sample occurred merely by chance. The <strong>alternative hypothesis</strong> contradicts the null hypothesis, stating that there is a difference/relationship.</p>
<p>Stated formally, the hypotheses are:</p>
<p><strong>Null Hypothesis:</strong> There is no difference in average mercury level between all lakes in Northern Florida and all lakes in Southern Florida.</p>
<p><strong>Alternative Hypothesis:</strong> There is a difference in average mercury level between all lakes in Northern Florida and all lakes in Southern Florida.</p>
<p>A statistician’s job is to determine whether the data provide strong enough evidence to rule out the null hypothesis.</p>
<p>The question we need to investigate is:</p>
<p>*“How likely is it that we would have observed a difference in means (i.e.&nbsp;a value of* <span class="math inline">\(b_1\)</span>) as extreme as 0.6965-0.4245 = 0.272 ppm, merely by chance, if there is really no relationship between location and mercury level?”</p>
</section>
<section id="permutation-test-procedure" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="permutation-test-procedure">Permutation Test Procedure</h4>
<p>We can answer the key question using a procedure known as a <strong>permutation test</strong>. In a permutation test, we randomly permute (or shuffle) the values of our explanatory variable to simulate a situation where there is no relationship between our explanatory and response variable. We observe whether it is plausible to observe values of a statistic (in this case the difference in means) as extreme or more extreme than what we saw in the actual data.</p>
<p>We’ll simulate situations where there is no relationship between location and mercury level, and see how often we observe a difference in means (<span class="math inline">\(b_1\)</span>) as extreme as 0.272.</p>
<p><strong>Procedure:</strong></p>
<ol type="1">
<li><p>Randomly shuffle the locations of the lakes, so that any relationship between location and mercury level is due only to chance.</p></li>
<li><p>Calculate the difference in mean mercury levels (i.e.&nbsp;value of <span class="math inline">\(b_1\)</span>) in “Northern” and “Southern” lakes, using the shuffled data. The statistic used to measure the size of the difference or relationship in the sample is called the <strong>test statistic.</strong></p></li>
<li><p>Repeat steps 1 and 2 many (say 10,000) times, recording the test statistic (difference in means, <span class="math inline">\(b_1\)</span>) each time.</p></li>
<li><p>Analyze the distribution of the test statistic (mean difference), simulated under the assumption that there is no relationship between location and mercury level. Look whether the value of the test statistic we observed in the sample (0.272) is consistent with values simulated under the assumption that the null hypothesis is true.</p></li>
</ol>
<p>This simulation can be performed using this <a href="http://www.rossmanchance.com/applets/2021/anovashuffle/AnovaShuffle.htm?hideExtras=2">Rossman-Chance App</a>.</p>
</section>
<section id="three-permutations-in-r" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="three-permutations-in-r">Three Permutations in R</h4>
<p>We’ll use R to perform permutation test.</p>
<p><strong>First Permutation</strong></p>
<p>Recall these groups were randomly assigned, so the only differences in averages are due to random chance.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a>Lakes_shuffle_loc1 <span class="ot">&lt;-</span> FloridaLakes <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">ShuffledLocation =</span> <span class="fu">shuffle</span>(Location))  </span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Lakes_shuffle_loc1)                                        </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 8
     ID Lake            pH Mercury Chlorophyll Location Depth   ShuffledLocation
  &lt;dbl&gt; &lt;chr&gt;        &lt;dbl&gt;   &lt;dbl&gt;       &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;   &lt;chr&gt;           
1     1 Alligator      6.1    1.23         0.7 S        Medium  N               
2     2 Annie          5.1    1.33         3.2 S        Deep    S               
3     3 Apopka         9.1    0.04       128.  N        Medium  S               
4     4 Blue Cypress   6.9    0.44         3.5 S        Shallow N               
5     5 Brick          4.6    1.2          1.8 S        Medium  N               
6     6 Bryant         7.3    0.27        44.1 N        Shallow N               </code></pre>
</div>
</div>
<p>Notice that the locations of the lakes have now been mixed up and assigned randomly. So, any relationship between location and mercury level will have occurred merely by chance.</p>
<p>We create a boxplot and calculate the difference in mean mercury levels for the shuffled data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a>Lakes_shuffle_loc11_BP <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>Lakes_shuffle_loc1, <span class="fu">aes</span>(<span class="at">x=</span><span class="st">`</span><span class="at">ShuffledLocation</span><span class="st">`</span>, </span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">y=</span>Mercury, <span class="at">fill=</span><span class="st">`</span><span class="at">ShuffledLocation</span><span class="st">`</span>)) <span class="sc">+</span> </span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span>   <span class="fu">geom_jitter</span>() <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"Mercury Levels in Florida Lakes"</span>) <span class="sc">+</span> </span>
<span id="cb138-4"><a href="#cb138-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Location"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Mercury Level"</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>)) <span class="sc">+</span> </span>
<span id="cb138-5"><a href="#cb138-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">1.5</span>)) <span class="sc">+</span> <span class="fu">coord_flip</span>() <span class="sc">+</span> <span class="fu">theme_bw</span>()</span>
<span id="cb138-6"><a href="#cb138-6" aria-hidden="true" tabindex="-1"></a>Lakes_shuffle_loc11_BP</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch3_files/figure-html/unnamed-chunk-101-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a>Lakes_shuffle_loc1_Tab <span class="ot">&lt;-</span> Lakes_shuffle_loc1 <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(<span class="st">`</span><span class="at">ShuffledLocation</span><span class="st">`</span>) <span class="sc">|&gt;</span></span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a>                                        <span class="fu">summarize</span>(<span class="at">MeanHg=</span><span class="fu">mean</span>(Mercury), </span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">StDevHg=</span><span class="fu">sd</span>(Mercury),  </span>
<span id="cb139-4"><a href="#cb139-4" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">N=</span><span class="fu">n</span>())</span>
<span id="cb139-5"><a href="#cb139-5" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(Lakes_shuffle_loc1_Tab)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">ShuffledLocation</th>
<th style="text-align: right;">MeanHg</th>
<th style="text-align: right;">StDevHg</th>
<th style="text-align: right;">N</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">N</td>
<td style="text-align: right;">0.4539394</td>
<td style="text-align: right;">0.3205361</td>
<td style="text-align: right;">33</td>
</tr>
<tr class="even">
<td style="text-align: left;">S</td>
<td style="text-align: right;">0.6480000</td>
<td style="text-align: right;">0.3472539</td>
<td style="text-align: right;">20</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>We fit a model to the shuffled data and observe the coefficient <span class="math inline">\(b_1\)</span> representing the difference in means between the lakes randomly assigned to the Northern and Southern groups.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(<span class="at">data=</span>Lakes_shuffle_loc1, Mercury <span class="sc">~</span> ShuffledLocation)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Mercury ~ ShuffledLocation, data = Lakes_shuffle_loc1)

Coefficients:
      (Intercept)  ShuffledLocationS  
           0.4539             0.1941  </code></pre>
</div>
</div>
<p>Notice that the sample means are not identical. We observe a difference of -0.1960606 just by chance associated with the assignment of the lakes to their random location groups.</p>
<p>This difference is considerably smaller than the difference of 0.272 that we saw in the actual data, suggesting that perhaps a difference as big as 0.272 would not be likely to occur by chance. Before we can be sure of this, however, we should repeat our simulation many times to get a better sense for how big of a difference we might reasonable expect to occur just by chance.</p>
<p><strong>Second Permutation</strong></p>
<p>We’ll repeat the procedure, again randomly shuffling the locations of lakes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a>Lakes_shuffle_loc2 <span class="ot">&lt;-</span> FloridaLakes <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">ShuffledLocation =</span> <span class="fu">shuffle</span>(Location))  </span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Lakes_shuffle_loc2)                                        </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 8
     ID Lake            pH Mercury Chlorophyll Location Depth   ShuffledLocation
  &lt;dbl&gt; &lt;chr&gt;        &lt;dbl&gt;   &lt;dbl&gt;       &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;   &lt;chr&gt;           
1     1 Alligator      6.1    1.23         0.7 S        Medium  S               
2     2 Annie          5.1    1.33         3.2 S        Deep    N               
3     3 Apopka         9.1    0.04       128.  N        Medium  N               
4     4 Blue Cypress   6.9    0.44         3.5 S        Shallow N               
5     5 Brick          4.6    1.2          1.8 S        Medium  S               
6     6 Bryant         7.3    0.27        44.1 N        Shallow N               </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a>Lakes_shuffle_loc2_BP <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>Lakes_shuffle_loc2, <span class="fu">aes</span>(<span class="at">x=</span><span class="st">`</span><span class="at">ShuffledLocation</span><span class="st">`</span>, </span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">y=</span>Mercury, <span class="at">fill=</span><span class="st">`</span><span class="at">ShuffledLocation</span><span class="st">`</span>)) <span class="sc">+</span> </span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span>   <span class="fu">geom_jitter</span>() <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"Mercury Levels in Florida Lakes"</span>) <span class="sc">+</span> </span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Location"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Mercury Level"</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>)) <span class="sc">+</span> </span>
<span id="cb144-5"><a href="#cb144-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">1.5</span>)) <span class="sc">+</span> <span class="fu">coord_flip</span>() <span class="sc">+</span> <span class="fu">theme_bw</span>()</span>
<span id="cb144-6"><a href="#cb144-6" aria-hidden="true" tabindex="-1"></a>Lakes_shuffle_loc2_BP</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch3_files/figure-html/unnamed-chunk-105-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a>Lakes_shuffle_loc2_Tab <span class="ot">&lt;-</span> Lakes_shuffle_loc2 <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(<span class="st">`</span><span class="at">ShuffledLocation</span><span class="st">`</span>) <span class="sc">|&gt;</span></span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a>                                        <span class="fu">summarize</span>(<span class="at">MeanHg=</span><span class="fu">mean</span>(Mercury), </span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">StDevHg=</span><span class="fu">sd</span>(Mercury),  </span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">N=</span><span class="fu">n</span>())</span>
<span id="cb145-5"><a href="#cb145-5" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(Lakes_shuffle_loc2_Tab)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">ShuffledLocation</th>
<th style="text-align: right;">MeanHg</th>
<th style="text-align: right;">StDevHg</th>
<th style="text-align: right;">N</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">N</td>
<td style="text-align: right;">0.5130303</td>
<td style="text-align: right;">0.3457735</td>
<td style="text-align: right;">33</td>
</tr>
<tr class="even">
<td style="text-align: left;">S</td>
<td style="text-align: right;">0.5505000</td>
<td style="text-align: right;">0.3406260</td>
<td style="text-align: right;">20</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(<span class="at">data=</span>Lakes_shuffle_loc2, Mercury <span class="sc">~</span> ShuffledLocation)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Mercury ~ ShuffledLocation, data = Lakes_shuffle_loc2)

Coefficients:
      (Intercept)  ShuffledLocationS  
          0.51303            0.03747  </code></pre>
</div>
</div>
<p>Observed Difference in means: -0.0369697.</p>
<p><strong>Third Permutation</strong></p>
<p>We’ll repeat the procedure one more time, randomly shuffling the locations of lakes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a>Lakes_shuffle_loc3 <span class="ot">&lt;-</span> FloridaLakes <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">ShuffledLocation =</span> <span class="fu">shuffle</span>(Location))  </span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Lakes_shuffle_loc3)                                        </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 8
     ID Lake            pH Mercury Chlorophyll Location Depth   ShuffledLocation
  &lt;dbl&gt; &lt;chr&gt;        &lt;dbl&gt;   &lt;dbl&gt;       &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;   &lt;chr&gt;           
1     1 Alligator      6.1    1.23         0.7 S        Medium  S               
2     2 Annie          5.1    1.33         3.2 S        Deep    S               
3     3 Apopka         9.1    0.04       128.  N        Medium  S               
4     4 Blue Cypress   6.9    0.44         3.5 S        Shallow N               
5     5 Brick          4.6    1.2          1.8 S        Medium  N               
6     6 Bryant         7.3    0.27        44.1 N        Shallow S               </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a>Lakes_shuffle_loc3_BP <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>Lakes_shuffle_loc3, <span class="fu">aes</span>(<span class="at">x=</span><span class="st">`</span><span class="at">ShuffledLocation</span><span class="st">`</span>, </span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">y=</span>Mercury, <span class="at">fill=</span><span class="st">`</span><span class="at">ShuffledLocation</span><span class="st">`</span>)) <span class="sc">+</span> </span>
<span id="cb150-3"><a href="#cb150-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span>   <span class="fu">geom_jitter</span>() <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"Mercury Levels in Florida Lakes"</span>) <span class="sc">+</span> </span>
<span id="cb150-4"><a href="#cb150-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Location"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Mercury Level"</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>)) <span class="sc">+</span> </span>
<span id="cb150-5"><a href="#cb150-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">1.5</span>)) <span class="sc">+</span> <span class="fu">coord_flip</span>() <span class="sc">+</span> <span class="fu">theme_bw</span>()</span>
<span id="cb150-6"><a href="#cb150-6" aria-hidden="true" tabindex="-1"></a>Lakes_shuffle_loc3_BP</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch3_files/figure-html/unnamed-chunk-109-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a>Lakes_shuffle_loc3_Tab <span class="ot">&lt;-</span> Lakes_shuffle_loc3 <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(<span class="st">`</span><span class="at">ShuffledLocation</span><span class="st">`</span>) <span class="sc">|&gt;</span></span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a>                                          <span class="fu">summarize</span>(<span class="at">MeanHg=</span><span class="fu">mean</span>(Mercury), </span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a>                                                    <span class="at">StDevHg=</span><span class="fu">sd</span>(Mercury),  </span>
<span id="cb151-4"><a href="#cb151-4" aria-hidden="true" tabindex="-1"></a>                                                    <span class="at">N=</span><span class="fu">n</span>())</span>
<span id="cb151-5"><a href="#cb151-5" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(Lakes_shuffle_loc3_Tab)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">ShuffledLocation</th>
<th style="text-align: right;">MeanHg</th>
<th style="text-align: right;">StDevHg</th>
<th style="text-align: right;">N</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">N</td>
<td style="text-align: right;">0.4957576</td>
<td style="text-align: right;">0.3290804</td>
<td style="text-align: right;">33</td>
</tr>
<tr class="even">
<td style="text-align: left;">S</td>
<td style="text-align: right;">0.5790000</td>
<td style="text-align: right;">0.3624609</td>
<td style="text-align: right;">20</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(<span class="at">data=</span>Lakes_shuffle_loc3, Mercury <span class="sc">~</span> ShuffledLocation)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Mercury ~ ShuffledLocation, data = Lakes_shuffle_loc3)

Coefficients:
      (Intercept)  ShuffledLocationS  
          0.49576            0.08324  </code></pre>
</div>
</div>
<p>Observed Difference in means: -0.0842424.</p>
<p>So far, we haven’t seen a difference anywhere near as big as the 0.272 we saw in the actual sample. But, to be sure, we’ll repeat the shuffling 10,000 times and see how often we get a difference as extreme as the one we saw in the sample.</p>
</section>
<section id="many-permutations" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="many-permutations">Many Permutations</h4>
<p>Now, we’ll perform 10,000 permutations and record the value of <span class="math inline">\(b_1\)</span> (the difference in sample means) for each simulation.</p>
<p>The values of <span class="math inline">\(b_1\)</span>, the estimate pertaining to <code>LocationS</code> obtained for the first 10 permutations are shown below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a>Lakes_merc_loc_perm_test <span class="ot">&lt;-</span> <span class="fu">do</span>(<span class="dv">10000</span>) <span class="sc">*</span> <span class="fu">lm</span>(Mercury <span class="sc">~</span> <span class="fu">shuffle</span>(Location), <span class="at">data =</span> FloridaLakes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Lakes_merc_loc_perm_test<span class="sc">$</span>LocationS, <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] -0.197015152 -0.001878788  0.013378788 -0.074151515  0.055136364
 [6] -0.006696970 -0.053272727  0.130621212 -0.065318182 -0.034000000</code></pre>
</div>
</div>
<p>We again see that none of these differences are as extreme as the 0.272 we saw in the actual data, suggesting that such a difference is unlikely to occur just by chance.</p>
<p>The histogram shows the distribution of differences in the group means observed in our simulation. The red lines indicate the difference we actually observed in the data (0.272), as well as an equally large difference in the opposite direction (-0.272).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a>Estimate <span class="ot">&lt;-</span> <span class="fl">0.272</span></span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a>Extreme <span class="ot">&lt;-</span> <span class="fu">abs</span>(Lakes_merc_loc_perm_test<span class="sc">$</span>LocationS) <span class="sc">&gt;</span> <span class="fl">0.272</span></span>
<span id="cb157-3"><a href="#cb157-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb157-4"><a href="#cb157-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb157-5"><a href="#cb157-5" aria-hidden="true" tabindex="-1"></a>Lakes_merc_loc_perm_test_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>Lakes_merc_loc_perm_test, <span class="fu">aes</span>(<span class="at">x=</span>LocationS)) <span class="sc">+</span> </span>
<span id="cb157-6"><a href="#cb157-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Extreme), <span class="at">color=</span><span class="st">"white"</span>) <span class="sc">+</span> </span>
<span id="cb157-7"><a href="#cb157-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"FALSE"</span> <span class="ot">=</span> <span class="st">"blue"</span>, <span class="st">"TRUE"</span> <span class="ot">=</span> <span class="st">"red"</span>)) <span class="sc">+</span></span>
<span id="cb157-8"><a href="#cb157-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept=</span><span class="fu">c</span>(Estimate, <span class="sc">-</span><span class="dv">1</span><span class="sc">*</span>Estimate), <span class="at">color=</span><span class="st">"red"</span>) <span class="sc">+</span> </span>
<span id="cb157-9"><a href="#cb157-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Lakes: Simulated Value of b1"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Frequency"</span>) <span class="sc">+</span> </span>
<span id="cb157-10"><a href="#cb157-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Distribution of b1 under assumption of no relationship"</span>) <span class="sc">+</span></span>
<span id="cb157-11"><a href="#cb157-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span>
<span id="cb157-12"><a href="#cb157-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-13"><a href="#cb157-13" aria-hidden="true" tabindex="-1"></a>Lakes_merc_loc_perm_test_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch3_files/figure-html/unnamed-chunk-114-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The red lines are quite extreme, relative to the simulated values shown in the histogram. Based on the simulation, it is rare to obtain a difference as extreme as the 0.272 value we saw in the actual data, by chance when there is actually no difference in average mercury levels between Northern and Southern Florida lakes.</p>
<p>We calculate the precise number of simulations (out of 10,000) resulting in difference in means more extreme than 0.272.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="sc">~</span> (<span class="fu">abs</span>(LocationS) <span class="sc">&gt;</span> <span class="fl">0.272</span>), <span class="at">data =</span> Lakes_merc_loc_perm_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 30</code></pre>
</div>
</div>
<p>The proportion of simulations resulting in difference in means more extreme than 0.272 is</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="fu">prop</span>(<span class="sc">~</span> (<span class="fu">abs</span>(LocationS) <span class="sc">&gt;</span> <span class="fl">0.272</span>), <span class="at">data =</span> Lakes_merc_loc_perm_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>prop_TRUE 
    0.003 </code></pre>
</div>
</div>
<p>We only observed a difference between the groups as extreme or more extreme than the 0.272 difference we saw in the sample in a proportion of 30 of our simulations (less than 1%).</p>
<p>The probability of getting a difference in means as extreme or more extreme than 0.272 ppm by chance, when there is no relationship between location and mercury level is about 0.003.</p>
<p>It is very unlikely that we would have observed a result like we did by chance alone. Thus, we have strong evidence that there is a difference in average mercury level between lakes in Northern and Southern Florida. In this case, there is strong evidence that mercury level is higher in Southern Florida lakes than Northern Florida lakes.</p>
<p>Recall that in the previous section, we found that we could be 95% confident that the mean mercury level among all lakes in Southern Florida is between 0.08 and 0.46 higher than the mean mercury level among all lakes in Northern Florida.</p>
</section>
<section id="test-statistic-and-p-value" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="test-statistic-and-p-value">Test-statistic and p-value</h4>
<p>The statistic we use to measure the size of the difference or effect is called the <strong>test statistic</strong>. In this case, the test statistic is the difference in means.</p>
<p>The <strong>p-value</strong> represents the probability of getting a test statistic as extreme or more extreme than we did in our sample when the null hypothesis is true.</p>
<p>In this situation, the p-value represents the probability of observing a difference in sample means as extreme or more extreme than 0.272 if there is actually no difference in average mercury level among all lakes in Northern Florida, compared to Southern Florida.</p>
<p>In our study, the p-value was 0.003, which is very low. This provides strong evidence against the null hypothesis that there is no difference in average mercury levels between all Northern and Southern Florida lakes.</p>
<p>A low p-value tells us that the difference in average Mercury levels that we saw in our sample is unlikely to have occurred by chance, providing evidence that there is indeed a difference in average Mercury levels between Northern and Southern lakes. When a p-value is small enough to suggest that the result was unlikely to have occurred by chance, the result is said to be <strong>statistically discernible.</strong></p>
<p>Note that it is fairly common for people to use the phrase <em>statistically significant</em> instead of statistically discernible. We will avoid this phrase because the word <em>significant</em> can be easily confused with <em>important</em>. Not all statistically discernible results are actually important in a practical sense. The p-value does not tell us anything about the size of the difference! Sometimes, we might get a small p-value even when difference is so small that it is not practically meaningful. This is especially true when we have a large sample size. In addition to a p-value, we should consider whether a difference is big enough to be meaningful in a practical way, before making any policy decisions.</p>
<p>For now, we can use the difference in sample means of 0.272 ppm as an estimate of the size of the difference. Based on our limited knowledge of mercury levels, this does seem big enough to merit further investigation, and possible action.</p>
<p>At this point, a reasonable question is “how small must a p-value be in order to provide evidence against the null hypothesis?” While it is sometimes common to establish strict cutoffs for what counts as a small p-value (such as <span class="math inline">\(&lt;0.05\)</span>), the American Statistical Association does not recommend this. In reality, a p-value of 0.04 is practically no different than a p-value of 0.06. Rather than using strict cutoffs for what counts as small, it is better to interpreting p-values on a sliding scale, as illustrated in the diagram below. A p-value of 0.10 or less provides at least some evidence against a null hypothesis, and the smaller the p-value is, the stronger the evidence gets.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"pvals.png"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="pvals.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<div style="page-break-after: always;"></div>
</section>
</section>
<section id="chlorophyll-in-lakes-n-vs-s" class="level3" data-number="3.4.2">
<h3 data-number="3.4.2" class="anchored" data-anchor-id="chlorophyll-in-lakes-n-vs-s"><span class="header-section-number">3.4.2</span> Chlorophyll in Lakes: N vs S</h3>
<p>Chlorophyll, which comes from plants, is also present in water. Unlike mercury, higher levels of chlorophyll are not dangerous, but the amount of chlorophyll can be an indicator of plant life in the lake. We’ll test whether we have evidence of a difference in mean amount of chlorophyll between lakes in Northern and Southern Florida.</p>
<p>The boxplot and table below show the distribution of chlorophyll levels among the 33 northern and 20 southern lakes in the sample.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a>Lakes_chlor_loc_BP <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>FloridaLakes, <span class="fu">aes</span>(<span class="at">x=</span>Location, <span class="at">y=</span>Chlorophyll, <span class="at">fill=</span>Location)) <span class="sc">+</span> </span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outliers=</span><span class="cn">FALSE</span>) <span class="sc">+</span>   <span class="fu">geom_jitter</span>() <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"Chlorophyll in Florida Lakes"</span>) <span class="sc">+</span> </span>
<span id="cb163-3"><a href="#cb163-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Location"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Chlorophyll Amount in mg/m^3 "</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>)) <span class="sc">+</span> <span class="fu">coord_flip</span>() </span>
<span id="cb163-4"><a href="#cb163-4" aria-hidden="true" tabindex="-1"></a>Lakes_chlor_loc_BP</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch3_files/figure-html/unnamed-chunk-118-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a>Lakes_chlor_loc_tab <span class="ot">&lt;-</span> FloridaLakes <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Location) <span class="sc">%&gt;%</span> </span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">summarize</span>(<span class="at">MeanHg=</span><span class="fu">mean</span>(Chlorophyll), </span>
<span id="cb164-3"><a href="#cb164-3" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">StDevHg=</span><span class="fu">sd</span>(Chlorophyll),  </span>
<span id="cb164-4"><a href="#cb164-4" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">N=</span><span class="fu">n</span>())</span>
<span id="cb164-5"><a href="#cb164-5" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(Lakes_chlor_loc_tab)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Location</th>
<th style="text-align: right;">MeanHg</th>
<th style="text-align: right;">StDevHg</th>
<th style="text-align: right;">N</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">N</td>
<td style="text-align: right;">24.59697</td>
<td style="text-align: right;">28.73836</td>
<td style="text-align: right;">33</td>
</tr>
<tr class="even">
<td style="text-align: left;">S</td>
<td style="text-align: right;">20.67500</td>
<td style="text-align: right;">34.61171</td>
<td style="text-align: right;">20</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>We see that on average mercury levels were higher among the lakes in northern Florida by about 4 mg/<span class="math inline">\(m^3\)</span>. We’ll use a permutation test to investigate whether such a difference could occur by random selection of lakes if there is really no relationship between chlorophyll and location.</p>
<p>The hypotheses are:</p>
<p><strong>Null Hypothesis:</strong> There is no difference in average chlorophyll amount between all lakes in Northern Florida and all lakes in Southern Florida.</p>
<p><strong>Alternative Hypothesis:</strong> There is a difference in average chlorophyll amount between all lakes in Northern Florida and all lakes in Southern Florida.</p>
<p>The model equation is</p>
<p><span class="math inline">\(\widehat{\text{Chlorophyll}} = b_0 +b_1\times\text{South}\)</span></p>
<ul>
<li><span class="math inline">\(b_0\)</span> represents the mean chlorophyll amount for lakes in North Florida, and<br>
</li>
<li><span class="math inline">\(b_1\)</span> represents the mean difference in chlorophyll amount for lakes in South Florida, compared to North Florida</li>
</ul>
<p>Fitting the model in R, we obtain the estimates for <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a>M_Lakes_chlor_loc <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>FloridaLakes, Chlorophyll <span class="sc">~</span> Location)</span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a>M_Lakes_chlor_loc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Chlorophyll ~ Location, data = FloridaLakes)

Coefficients:
(Intercept)    LocationS  
     24.597       -3.922  </code></pre>
</div>
</div>
<p><span class="math inline">\(b_1\)</span> gives the mean difference in chlorophyll between the Northern and Southern lakes in our sample. The question we need to investigate is:</p>
<p>*“How likely is it that we would have observed a difference in means (i.e.&nbsp;a value of* <span class="math inline">\(b_1\)</span>) as extreme as -3.9 mg/<span class="math inline">\(m^3\)</span>, merely by chance, if there is really no relationship between location and chlorophyll amount?”</p>
<p>We’ll perform 10,000 permutations and record the value of <span class="math inline">\(b_1\)</span> (the difference in sample means) for each simulation, just as we did for mercury levels.</p>
<p>The values of <span class="math inline">\(b_1\)</span>, the estimate pertaining to <code>LocationS</code> obtained for the first 10 permutations are shown below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a>Lakes_chlor_loc_perm_test <span class="ot">&lt;-</span> <span class="fu">do</span>(<span class="dv">10000</span>) <span class="sc">*</span> <span class="fu">lm</span>(Chlorophyll <span class="sc">~</span> <span class="fu">shuffle</span>(Location), <span class="at">data =</span> FloridaLakes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The histogram shows the distribution of differences in the group means observed in our simulation. The red lines indicate the difference we actually observed in the data (0.272), as well as an equally large difference in the opposite direction (-0.272).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a>Estimate <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">3.922</span></span>
<span id="cb168-2"><a href="#cb168-2" aria-hidden="true" tabindex="-1"></a>Extreme <span class="ot">&lt;-</span> <span class="fu">abs</span>(Lakes_chlor_loc_perm_test<span class="sc">$</span>LocationS) <span class="sc">&gt;</span> <span class="fl">3.922</span></span>
<span id="cb168-3"><a href="#cb168-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb168-4"><a href="#cb168-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb168-5"><a href="#cb168-5" aria-hidden="true" tabindex="-1"></a>Lakes_chlor_loc_perm_test_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>Lakes_chlor_loc_perm_test, <span class="fu">aes</span>(<span class="at">x=</span>LocationS)) <span class="sc">+</span> </span>
<span id="cb168-6"><a href="#cb168-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Extreme), <span class="at">color=</span><span class="st">"white"</span>) <span class="sc">+</span> </span>
<span id="cb168-7"><a href="#cb168-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"FALSE"</span> <span class="ot">=</span> <span class="st">"blue"</span>, <span class="st">"TRUE"</span> <span class="ot">=</span> <span class="st">"red"</span>)) <span class="sc">+</span></span>
<span id="cb168-8"><a href="#cb168-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept=</span><span class="fu">c</span>(Estimate, <span class="sc">-</span><span class="dv">1</span><span class="sc">*</span>Estimate), <span class="at">color=</span><span class="st">"red"</span>) <span class="sc">+</span> </span>
<span id="cb168-9"><a href="#cb168-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Lakes: Simulated Value of b1"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Frequency"</span>) <span class="sc">+</span> </span>
<span id="cb168-10"><a href="#cb168-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Distribution of b1 under assumption of no relationship"</span>) <span class="sc">+</span></span>
<span id="cb168-11"><a href="#cb168-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb168-12"><a href="#cb168-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-13"><a href="#cb168-13" aria-hidden="true" tabindex="-1"></a>Lakes_chlor_loc_perm_test_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch3_files/figure-html/unnamed-chunk-122-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This time, the red lines are not very extreme. The difference of -3.9 mg/<span class="math inline">\(m^3\)</span> seen in our sample happens quite often, even in a situation where there is really no relationship between location and chlorophyll amount.</p>
<p>Our p-value, represemtomg the proportion of simulations resulting in difference in means more extreme than 3.9 is</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="fu">prop</span>(<span class="sc">~</span> (<span class="fu">abs</span>(LocationS) <span class="sc">&gt;</span> <span class="fl">3.9</span>), <span class="at">data =</span> Lakes_chlor_loc_perm_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>prop_TRUE 
   0.6711 </code></pre>
</div>
</div>
<p>This p-value represents the probability of observing a difference in means as extreme or more extreme than -3.9 <span class="math inline">\(mg/m^3\)</span> if there is really no relationship between location and chlorophyll amount.</p>
<p>Since the p-value is quite large (much bigger than common criteria like 0.05 or 0.10), we cannot rule out the null hypothesis. It would not be unusual to see data like we did in a situation where the null hypothesis is actually true. Thus, we do not have enough evidence to conclude that average chlorophyll amount differs between lakes in Northern and Southern Florida.</p>
<p>Just because we cannot rule out, or reject, the null hypothesis does not mean that we should believe it is true. Afterall, we did observe an average difference of about 4 <span class="math inline">\(mg/m^3\)</span>. It’s just that given the size of our sample and the amount of variability in the data, we cannot be sure that this difference didn’t occur by chance associated with random selection of the lakes. Thus, while we do not reject the null hypothesis, we also shouldn’t accept it, or believe it to be true. We shouldn’t say that we believe that chlorophyll amount is the same in Northern and Southern Florida, only that we don’t have enough evidence to conclude that it differs. “Accepting” the null hypothesis is a common fallacy committed in hypothesis testing that has sometimes had disastrous implications in scientific research.</p>
</section>
<section id="effect-of-ph-on-mercury" class="level3" data-number="3.4.3">
<h3 data-number="3.4.3" class="anchored" data-anchor-id="effect-of-ph-on-mercury"><span class="header-section-number">3.4.3</span> Effect of pH on Mercury</h3>
<p>Next, we’ll investigate whether there is a relationship between a lake’s mercury level and it’s pH, a measure of the acidity of a lake. A pH of 7 is considered neutral, while a lower pH indicates that the water is more acidic and higher pH indicates that the water is more basic.</p>
<p>The plot below shows the relationship between a lake’s mercury level and pH.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>FloridaLakes, <span class="fu">aes</span>(<span class="at">y=</span>Mercury, <span class="at">x=</span>pH)) <span class="sc">+</span> </span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">stat_smooth</span>(<span class="at">method=</span><span class="st">"lm"</span>, <span class="at">se=</span><span class="cn">FALSE</span>) <span class="sc">+</span> </span>
<span id="cb171-3"><a href="#cb171-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">10</span>)) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">1.5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch3_files/figure-html/unnamed-chunk-124-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>There seems to be a strong relationship between the two, but we should investigate whether such relationship could plausible occur in a sample of 53 lakes, in a situation where there is really no such relationship among all lakes.</p>
<p>The regression equation is</p>
<p><span class="math display">\[
\widehat{\text{Mercury}} = b_0 + b_1\times\text{pH}
\]</span></p>
<p>Regression estimates <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span> are shown below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb172"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a>Lakes_M_merc_pH <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>FloridaLakes, Mercury<span class="sc">~</span>pH)</span>
<span id="cb172-2"><a href="#cb172-2" aria-hidden="true" tabindex="-1"></a>Lakes_M_merc_pH</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Mercury ~ pH, data = FloridaLakes)

Coefficients:
(Intercept)           pH  
     1.5309      -0.1523  </code></pre>
</div>
</div>
<p>For quantitative explanatory variables, we can use the slope of the regression line <span class="math inline">\(b_1\)</span> to measure the strength relationship between Mercury and pH. Based on our sample, for each one-unit increase in pH, mercury level is expected to decrease by 0.15 ppm.</p>
<p>If there was really no relationship, then the slope among all lakes would be 0. But, of course, we would not expect the slope in our sample to exactly match the slope for all lakes. Our question of interest is whether it is plausible that we could have randomly selected a sample resulting in a slope as extreme as 0.15 by chance, when there is actually no relationship between mercury and pH levels, among all lakes. In other words, could we plausible have drawn the sample of 53 lakes shown in blue from a population like the one in red, shown below?</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch3_files/figure-html/unnamed-chunk-126-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Key Question:</strong></p>
<ul>
<li>How likely is it that we would have observed a slope (i.e.&nbsp;a value of <span class="math inline">\(b_1\)</span>) as extreme as 0.15 by chance, if there is really no relationship between mercury level and pH?</li>
</ul>
<p><strong>Null Hypothesis:</strong> Among all Florida lakes, there is no relationship between mercury level and pH.</p>
<p><strong>Alternative Hypothesis:</strong> Among all Florida lakes, there is a relationship between mercury level and pH.</p>
<p><strong>Procedure:</strong></p>
<ol type="1">
<li><p>Randomly shuffle the pH values, so that any relationship between acceleration mercury and pH is due only to chance.</p></li>
<li><p>Fit a regression line to the shuffled data and record the slope of the regression line.</p></li>
<li><p>Repeat steps 1 and 2 many (say 10,000) times, recording the slope (i.e.&nbsp;value of <span class="math inline">\(b_1\)</span>) each time.</p></li>
<li><p>Analyze the distribution of slopes, simulated under the assumption that there is no relationship between mercury and pH. Look whether the actual slope we observed is consistent with the simulation results.</p></li>
</ol>
<p>We’ll illustrate the first three permutations.</p>
<p><strong>First Permutation</strong></p>
<p>Recall these groups were randomly assigned, so the only differences in averages are due to random chance.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a>Lakes_shuffle_pH1 <span class="ot">&lt;-</span> FloridaLakes <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">ShuffledpH =</span> <span class="fu">shuffle</span>(pH))  </span>
<span id="cb174-2"><a href="#cb174-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Lakes_shuffle_pH1)                                 </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 8
     ID Lake            pH Mercury Chlorophyll Location Depth   ShuffledpH
  &lt;dbl&gt; &lt;chr&gt;        &lt;dbl&gt;   &lt;dbl&gt;       &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;        &lt;dbl&gt;
1     1 Alligator      6.1    1.23         0.7 S        Medium         7.8
2     2 Annie          5.1    1.33         3.2 S        Deep           6.2
3     3 Apopka         9.1    0.04       128.  N        Medium         7.8
4     4 Blue Cypress   6.9    0.44         3.5 S        Shallow        7.2
5     5 Brick          4.6    1.2          1.8 S        Medium         5.8
6     6 Bryant         7.3    0.27        44.1 N        Shallow        5.8</code></pre>
</div>
</div>
<p>Notice that the pH’s of the lakes have now been mixed up and assigned randomly. So, any relationship between pH and mercury level will have occurred merely by chance.</p>
<p>We create a scatterplot and fit a regression line to the shuffled data.</p>
<p>The red line indicates the slope of the regression line fit to the shuffled data. The blue line indicates the regression line for the actual lakes in the sample, which has a slope of -0.15.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>Lakes_shuffle_pH1, <span class="fu">aes</span>(<span class="at">x=</span>ShuffledpH, <span class="at">y=</span>Mercury)) <span class="sc">+</span> </span>
<span id="cb176-2"><a href="#cb176-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">stat_smooth</span>(<span class="at">method=</span><span class="st">"lm"</span>, <span class="at">se=</span><span class="cn">FALSE</span>, <span class="at">color=</span><span class="st">"red"</span>) <span class="sc">+</span> </span>
<span id="cb176-3"><a href="#cb176-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">10</span>)) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">1.5</span>)) <span class="sc">+</span> </span>
<span id="cb176-4"><a href="#cb176-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope=</span><span class="sc">-</span><span class="fl">0.1523</span>, <span class="at">intercept=</span><span class="fl">1.5309</span>, <span class="at">color=</span><span class="st">"blue"</span>) <span class="sc">+</span> </span>
<span id="cb176-5"><a href="#cb176-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch3_files/figure-html/unnamed-chunk-128-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Slope of regression line from permuted data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a>M_Lakes_shuffle_pH1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>Lakes_shuffle_pH1, Mercury<span class="sc">~</span>ShuffledpH)</span>
<span id="cb177-2"><a href="#cb177-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(M_Lakes_shuffle_pH1)<span class="sc">$</span>coef[<span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.03920538</code></pre>
</div>
</div>
<p>We observed a slight correlation just by chance, but nowhere near as large as the slope of -0.15 that we saw in the actual data.</p>
<p><strong>Second Permutation</strong></p>
<p>We’ll repeat the procedure, again randomly shuffling the pH’s of lakes.</p>
<p>Recall these groups were randomly assigned, so the only differences in averages are due to random chance.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a>Lakes_shuffle_pH2 <span class="ot">&lt;-</span> FloridaLakes <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">ShuffledpH =</span> <span class="fu">shuffle</span>(pH))  </span>
<span id="cb179-2"><a href="#cb179-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Lakes_shuffle_pH2)                                   </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 8
     ID Lake            pH Mercury Chlorophyll Location Depth   ShuffledpH
  &lt;dbl&gt; &lt;chr&gt;        &lt;dbl&gt;   &lt;dbl&gt;       &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;        &lt;dbl&gt;
1     1 Alligator      6.1    1.23         0.7 S        Medium         7.8
2     2 Annie          5.1    1.33         3.2 S        Deep           4.4
3     3 Apopka         9.1    0.04       128.  N        Medium         7.4
4     4 Blue Cypress   6.9    0.44         3.5 S        Shallow        6.1
5     5 Brick          4.6    1.2          1.8 S        Medium         7.8
6     6 Bryant         7.3    0.27        44.1 N        Shallow        5.5</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>Lakes_shuffle_pH2, <span class="fu">aes</span>(<span class="at">x=</span>ShuffledpH, <span class="at">y=</span>Mercury)) <span class="sc">+</span> </span>
<span id="cb181-2"><a href="#cb181-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">stat_smooth</span>(<span class="at">method=</span><span class="st">"lm"</span>, <span class="at">se=</span><span class="cn">FALSE</span>, <span class="at">color=</span><span class="st">"red"</span>) <span class="sc">+</span> </span>
<span id="cb181-3"><a href="#cb181-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">10</span>)) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">1.5</span>)) <span class="sc">+</span> </span>
<span id="cb181-4"><a href="#cb181-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope=</span><span class="sc">-</span><span class="fl">0.1523</span>, <span class="at">intercept=</span><span class="fl">1.5309</span>, <span class="at">color=</span><span class="st">"blue"</span>) <span class="sc">+</span> </span>
<span id="cb181-5"><a href="#cb181-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch3_files/figure-html/unnamed-chunk-131-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Slope of regression line from permuted data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb182"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a>M_Lakes_shuffle_pH2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>Lakes_shuffle_pH2, Mercury<span class="sc">~</span>ShuffledpH)</span>
<span id="cb182-2"><a href="#cb182-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(M_Lakes_shuffle_pH2)<span class="sc">$</span>coef[<span class="dv">2</span>]     </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.05110224</code></pre>
</div>
</div>
<p>The slope on the randomly shuffled data is again not nearly as large as the slope of -0.15 that we saw in the actual data.</p>
<p><strong>Third Permutation</strong></p>
<p>We’ll repeat the procedure one more time, randomly shuffling the pH’s of lakes.</p>
<p>Recall these groups were randomly assigned, so the only differences in averages are due to random chance.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb184"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a>Lakes_shuffle_pH3 <span class="ot">&lt;-</span> FloridaLakes <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">ShuffledpH =</span> <span class="fu">shuffle</span>(pH))  </span>
<span id="cb184-2"><a href="#cb184-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Lakes_shuffle_pH3)                                      </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 8
     ID Lake            pH Mercury Chlorophyll Location Depth   ShuffledpH
  &lt;dbl&gt; &lt;chr&gt;        &lt;dbl&gt;   &lt;dbl&gt;       &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;        &lt;dbl&gt;
1     1 Alligator      6.1    1.23         0.7 S        Medium         7.5
2     2 Annie          5.1    1.33         3.2 S        Deep           8.7
3     3 Apopka         9.1    0.04       128.  N        Medium         8.4
4     4 Blue Cypress   6.9    0.44         3.5 S        Shallow        6.8
5     5 Brick          4.6    1.2          1.8 S        Medium         6.8
6     6 Bryant         7.3    0.27        44.1 N        Shallow        7.1</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb186"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>Lakes_shuffle_pH3, <span class="fu">aes</span>(<span class="at">x=</span>ShuffledpH, <span class="at">y=</span>Mercury)) <span class="sc">+</span> </span>
<span id="cb186-2"><a href="#cb186-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">stat_smooth</span>(<span class="at">method=</span><span class="st">"lm"</span>, <span class="at">se=</span><span class="cn">FALSE</span>, <span class="at">color=</span><span class="st">"red"</span>) <span class="sc">+</span> </span>
<span id="cb186-3"><a href="#cb186-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">10</span>)) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">1.5</span>)) <span class="sc">+</span> </span>
<span id="cb186-4"><a href="#cb186-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope=</span><span class="sc">-</span><span class="fl">0.1523</span>, <span class="at">intercept=</span><span class="fl">1.5309</span>, <span class="at">color=</span><span class="st">"blue"</span>) <span class="sc">+</span> </span>
<span id="cb186-5"><a href="#cb186-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch3_files/figure-html/unnamed-chunk-134-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Slope of regression line from permuted data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a>M_Lakes_shuffle_pH3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>Lakes_shuffle_pH3, Mercury<span class="sc">~</span>ShuffledpH)</span>
<span id="cb187-2"><a href="#cb187-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(M_Lakes_shuffle_pH3)<span class="sc">$</span>coef[<span class="dv">2</span>]     </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.005704182</code></pre>
</div>
</div>
<p>None of our three simulations resulted in a slope near as extreme as the -0.15 that we saw in the actual data. This seems to suggest that it is unlikely that we would have observed a slope as extreme as -0.15 if there is actually no relationship between mercury and pH among all lakes.</p>
<p>To be more sure, we should repeat the simulation many more times to see whether getting a slope as extreme as -0.15 is plausible in a situation where there is no relationship between mercury level and pH of a lake.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb189"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a>Lakes_merc_pH_perm_test <span class="ot">&lt;-</span> <span class="fu">do</span>(<span class="dv">10000</span>) <span class="sc">*</span> <span class="fu">lm</span>(Mercury <span class="sc">~</span> <span class="fu">shuffle</span>(pH), <span class="at">data =</span> FloridaLakes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb190"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a>Estimate <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.1523</span></span>
<span id="cb190-2"><a href="#cb190-2" aria-hidden="true" tabindex="-1"></a>Extreme <span class="ot">&lt;-</span> <span class="fu">abs</span>(Lakes_merc_pH_perm_test<span class="sc">$</span>pH) <span class="sc">&gt;</span> <span class="fl">0.1523</span></span>
<span id="cb190-3"><a href="#cb190-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb190-4"><a href="#cb190-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb190-5"><a href="#cb190-5" aria-hidden="true" tabindex="-1"></a>Lakes_merc_pH_perm_test_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>Lakes_merc_pH_perm_test, <span class="fu">aes</span>(<span class="at">x=</span>pH)) <span class="sc">+</span> </span>
<span id="cb190-6"><a href="#cb190-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Extreme), <span class="at">color=</span><span class="st">"white"</span>) <span class="sc">+</span> </span>
<span id="cb190-7"><a href="#cb190-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"FALSE"</span> <span class="ot">=</span> <span class="st">"blue"</span>, <span class="st">"TRUE"</span> <span class="ot">=</span> <span class="st">"red"</span>)) <span class="sc">+</span></span>
<span id="cb190-8"><a href="#cb190-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept=</span><span class="fu">c</span>(Estimate, <span class="sc">-</span><span class="dv">1</span><span class="sc">*</span>Estimate), <span class="at">color=</span><span class="st">"red"</span>) <span class="sc">+</span> </span>
<span id="cb190-9"><a href="#cb190-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Lakes pH: Simulated Value of b1"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Frequency"</span>) <span class="sc">+</span> </span>
<span id="cb190-10"><a href="#cb190-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Distribution of b1 under assumption of no relationship"</span>) <span class="sc">+</span></span>
<span id="cb190-11"><a href="#cb190-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span>
<span id="cb190-12"><a href="#cb190-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-13"><a href="#cb190-13" aria-hidden="true" tabindex="-1"></a>Lakes_merc_pH_perm_test_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch3_files/figure-html/unnamed-chunk-137-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>p-value:</strong> Proportion of simulations resulting in value of <span class="math inline">\(b_1\)</span> more extreme than -0.15</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb191"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="fu">prop</span>(<span class="sc">~</span> (<span class="fu">abs</span>(pH) <span class="sc">&gt;</span> <span class="fl">0.1523</span>), <span class="at">data =</span> Lakes_merc_pH_perm_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>prop_TRUE 
        0 </code></pre>
</div>
</div>
<p>The p-value represents the probability of observing a slope as extreme or more extreme than -0.15 by chance when there is actually no relationship between mercury level and pH.</p>
<p>It is extremely unlikely that we would observe a value of <span class="math inline">\(b_1\)</span> as extreme as -0.15 by chance, if there is really no relationship between mercury level and pH. In fact, this never happened in any of our 10,000 simulations!</p>
<p>There is very strong evidence of a relationship mercury level and pH.</p>
<p>A low p-value tells us only that there is evidence of a relationship, not that it is practically meaningful. We have seen that for each one-unit increase in pH, mercury level is expected to decrease by 0.15 ppm on average, which seems like a pretty meaningful decrease, especially considering that mercury levels typically stay between 0 and 1.</p>
<p>We used the slope as our test statistic to measure the evidence of the relationship between the explanatory and response variables. In fact, we could have also used the correlation coefficient <span class="math inline">\(r\)</span> as our test statistic, and we would have gotten the same p-value. Either slope or correlation may be used for a hypothesis test involving two quantitative variables, but we will use slope in this class.</p>
</section>
<section id="f-test-for-comparing-three-or-more-groups" class="level3" data-number="3.4.4">
<h3 data-number="3.4.4" class="anchored" data-anchor-id="f-test-for-comparing-three-or-more-groups"><span class="header-section-number">3.4.4</span> F-Test for Comparing Three or More Groups</h3>
<p>Next, we’ll investigate whether mercury levels tend to differ between lakes of different depths. The <code>Depth</code> variable classifies lakes as either shallow (less than 15 feet at deepest point), medium (15-30 feet deep), or deep (deeper than 30 feet).</p>
<p>Comparative boxplots and a table are shown below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb193"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>FloridaLakes, <span class="fu">aes</span>(<span class="at">x=</span>Depth, <span class="at">y=</span>Mercury, <span class="at">fill=</span>Depth)) <span class="sc">+</span> </span>
<span id="cb193-2"><a href="#cb193-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span> <span class="fu">geom_jitter</span>(<span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb193-3"><a href="#cb193-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.y=</span><span class="st">"mean"</span>, <span class="at">geom=</span><span class="st">"point"</span>, <span class="at">shape=</span><span class="dv">20</span>, <span class="at">color=</span><span class="st">"red"</span>, <span class="at">fill=</span><span class="st">"red"</span>)<span class="sc">+</span> </span>
<span id="cb193-4"><a href="#cb193-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"Mercury by Depth"</span>) <span class="sc">+</span> </span>
<span id="cb193-5"><a href="#cb193-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch3_files/figure-html/unnamed-chunk-139-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb194"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a>Lakes_merc_cond_Tab <span class="ot">&lt;-</span> FloridaLakes <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Depth) <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">Mean_Hg =</span> <span class="fu">mean</span>(Mercury) <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">3</span>), </span>
<span id="cb194-2"><a href="#cb194-2" aria-hidden="true" tabindex="-1"></a>                                                                <span class="at">SD_Hg=</span> <span class="fu">sd</span> (Mercury) <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">3</span>), </span>
<span id="cb194-3"><a href="#cb194-3" aria-hidden="true" tabindex="-1"></a>                                                                <span class="at">N=</span> <span class="fu">n</span>())</span>
<span id="cb194-4"><a href="#cb194-4" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(Lakes_merc_cond_Tab)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Depth</th>
<th style="text-align: right;">Mean_Hg</th>
<th style="text-align: right;">SD_Hg</th>
<th style="text-align: right;">N</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Deep</td>
<td style="text-align: right;">0.604</td>
<td style="text-align: right;">0.307</td>
<td style="text-align: right;">15</td>
</tr>
<tr class="even">
<td style="text-align: left;">Medium</td>
<td style="text-align: right;">0.591</td>
<td style="text-align: right;">0.429</td>
<td style="text-align: right;">16</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Shallow</td>
<td style="text-align: right;">0.428</td>
<td style="text-align: right;">0.276</td>
<td style="text-align: right;">22</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>We see that mean mercury level is highest in the deepest lakes, and lowest in the shallowest lakes. We’ll again want to investigate whether the differences we see could be evidence of a relationship between depth and mercury level, or whether differences like these could have plausibly occurred even if there was no relationship.</p>
<p><strong>Null Hypothesis:</strong> There is no difference in average mercury levels between shallow, medium, and deep lakes.</p>
<p><strong>Alternative Hypothesis:</strong> There is no difference in average mercury levels between shallow, medium, and deep lakes.</p>
<p>If we were only comparing two groups, we could use the difference in means as a test statistic, like we did when testing for differences in location. But with three groups, we would have three different differences in means to test (shallow-medium, shallow-deep, medium-deep). We need a single statistic that can measure the size of differences between all three groups. An F-statistic can do this, so we’ll use the F-statistic as our test statistic here.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb195"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a>M_Lakes_merc_depth_test <span class="ot">&lt;-</span>  <span class="fu">do</span>(<span class="dv">1</span>) <span class="sc">*</span> <span class="fu">lm</span>(<span class="at">data=</span>FloridaLakes, Mercury <span class="sc">~</span> Depth)</span>
<span id="cb195-2"><a href="#cb195-2" aria-hidden="true" tabindex="-1"></a>M_Lakes_merc_depth_test<span class="sc">$</span>F</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.628254</code></pre>
</div>
</div>
<p>Our question of interest is “How likely is it to observe an F-statistic as extreme or more extreme than 1.63 if there is actually no difference in average mercury level between the three depths?”</p>
<p>We’ll use a permutation-based hypothesis test to investigate this question.</p>
<p><strong>Procedure:</strong></p>
<ol type="1">
<li><p>Randomly shuffle the depth categories of the lakes, so that any relationship between depth and mercury is due only to chance.</p></li>
<li><p>Using the shuffled data, calculate an F-statistic for a model predicting mercury, comparing a full model that uses depth as an explanatory variable, to a reduced model with no explanatory variables.</p></li>
<li><p>Repeat steps 1 and 2 many (say 10,000) times, recording the F-statistic each time.</p></li>
<li><p>Analyze the distribution of F-statistics, simulated under the assumption that there is no relationship between depth and mercury level. Look whether the actual F-statistic we observed is consistent with the simulation results.</p></li>
</ol>
<p>We’ll illustrate the first three permutations.</p>
<p><strong>First Permutation</strong></p>
<p>Recall these groups were randomly assigned, so the only differences in averages are due to random chance.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb197"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a>Lakes_shuffle_depth1 <span class="ot">&lt;-</span> FloridaLakes <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">ShuffledDepth =</span> <span class="fu">shuffle</span>(Depth))  </span>
<span id="cb197-2"><a href="#cb197-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Lakes_shuffle_depth1)                                 </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 8
     ID Lake            pH Mercury Chlorophyll Location Depth   ShuffledDepth
  &lt;dbl&gt; &lt;chr&gt;        &lt;dbl&gt;   &lt;dbl&gt;       &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;   &lt;chr&gt;        
1     1 Alligator      6.1    1.23         0.7 S        Medium  Shallow      
2     2 Annie          5.1    1.33         3.2 S        Deep    Deep         
3     3 Apopka         9.1    0.04       128.  N        Medium  Shallow      
4     4 Blue Cypress   6.9    0.44         3.5 S        Shallow Medium       
5     5 Brick          4.6    1.2          1.8 S        Medium  Shallow      
6     6 Bryant         7.3    0.27        44.1 N        Shallow Deep         </code></pre>
</div>
</div>
<p>Notice that the depths of the lakes have now been mixed up and assigned randomly. So, any relationship between depth and mercury level will have occurred merely by chance.</p>
<p>We create a boxplot and calculate the mean mercury levels for each depth class in the shuffled data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb199"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>Lakes_shuffle_depth1, <span class="fu">aes</span>(<span class="at">x=</span>ShuffledDepth, <span class="at">y=</span>Mercury, <span class="at">fill=</span>ShuffledDepth)) <span class="sc">+</span> </span>
<span id="cb199-2"><a href="#cb199-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span> <span class="fu">geom_jitter</span>(<span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb199-3"><a href="#cb199-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.y=</span><span class="st">"mean"</span>, <span class="at">geom=</span><span class="st">"point"</span>, <span class="at">shape=</span><span class="dv">20</span>, <span class="at">color=</span><span class="st">"red"</span>, <span class="at">fill=</span><span class="st">"red"</span>)<span class="sc">+</span> </span>
<span id="cb199-4"><a href="#cb199-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"Boxplot for Shuffled Depth Classes"</span>) <span class="sc">+</span> </span>
<span id="cb199-5"><a href="#cb199-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch3_files/figure-html/unnamed-chunk-143-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb200"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a>Cond_Tab <span class="ot">&lt;-</span> Lakes_shuffle_depth1 <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(ShuffledDepth) <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">Mean_Hg =</span> <span class="fu">mean</span>(Mercury) <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">3</span>), </span>
<span id="cb200-2"><a href="#cb200-2" aria-hidden="true" tabindex="-1"></a>                                                                <span class="at">SD_Hg=</span> <span class="fu">sd</span> (Mercury) <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">3</span>), </span>
<span id="cb200-3"><a href="#cb200-3" aria-hidden="true" tabindex="-1"></a>                                                                <span class="at">N=</span> <span class="fu">n</span>())</span>
<span id="cb200-4"><a href="#cb200-4" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(Cond_Tab)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">ShuffledDepth</th>
<th style="text-align: right;">Mean_Hg</th>
<th style="text-align: right;">SD_Hg</th>
<th style="text-align: right;">N</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Deep</td>
<td style="text-align: right;">0.553</td>
<td style="text-align: right;">0.374</td>
<td style="text-align: right;">15</td>
</tr>
<tr class="even">
<td style="text-align: left;">Medium</td>
<td style="text-align: right;">0.517</td>
<td style="text-align: right;">0.271</td>
<td style="text-align: right;">16</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Shallow</td>
<td style="text-align: right;">0.517</td>
<td style="text-align: right;">0.376</td>
<td style="text-align: right;">22</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Notice that the differences between the groups appear as big or bigger than what we saw in the actual data, even though these groups were obtained by randomly assigning lakes to depth classes, meaning there is actually no relationship between depth and mercury level. The differences we see occur just by random assignment.</p>
<p>We fit a model to the shuffled data and record the F-statistic.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb201"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a>Lakes_merc_depth_perm1 <span class="ot">&lt;-</span> <span class="fu">do</span>(<span class="dv">1</span>) <span class="sc">*</span> <span class="fu">lm</span>(Mercury <span class="sc">~</span> ShuffledDepth , <span class="at">data =</span> Lakes_shuffle_depth1)</span>
<span id="cb201-2"><a href="#cb201-2" aria-hidden="true" tabindex="-1"></a>Lakes_merc_depth_perm1<span class="sc">$</span>F</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.05933947</code></pre>
</div>
</div>
<p>The F-statistic observed in the shuffled data is <code>Lakes_merc_depth_perm1$F</code>.</p>
<p><strong>Second Permutation</strong></p>
<p>We’ll repeat the procedure, again randomly shuffling the depths of lakes.</p>
<p>Recall these groups were randomly assigned, so the only differences in averages are due to random chance.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb203"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a>Lakes_shuffle_depth2 <span class="ot">&lt;-</span> FloridaLakes <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">ShuffledDepth =</span> <span class="fu">shuffle</span>(Depth))  </span>
<span id="cb203-2"><a href="#cb203-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Lakes_shuffle_depth2)                                 </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 8
     ID Lake            pH Mercury Chlorophyll Location Depth   ShuffledDepth
  &lt;dbl&gt; &lt;chr&gt;        &lt;dbl&gt;   &lt;dbl&gt;       &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;   &lt;chr&gt;        
1     1 Alligator      6.1    1.23         0.7 S        Medium  Medium       
2     2 Annie          5.1    1.33         3.2 S        Deep    Medium       
3     3 Apopka         9.1    0.04       128.  N        Medium  Medium       
4     4 Blue Cypress   6.9    0.44         3.5 S        Shallow Shallow      
5     5 Brick          4.6    1.2          1.8 S        Medium  Shallow      
6     6 Bryant         7.3    0.27        44.1 N        Shallow Shallow      </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb205"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>Lakes_shuffle_depth2, <span class="fu">aes</span>(<span class="at">x=</span>ShuffledDepth, <span class="at">y=</span>Mercury, <span class="at">fill=</span>ShuffledDepth)) <span class="sc">+</span> </span>
<span id="cb205-2"><a href="#cb205-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span> <span class="fu">geom_jitter</span>(<span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb205-3"><a href="#cb205-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.y=</span><span class="st">"mean"</span>, <span class="at">geom=</span><span class="st">"point"</span>, <span class="at">shape=</span><span class="dv">20</span>, <span class="at">color=</span><span class="st">"red"</span>, <span class="at">fill=</span><span class="st">"red"</span>)<span class="sc">+</span> </span>
<span id="cb205-4"><a href="#cb205-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"Boxplot for Shuffled Depth Classes"</span>) <span class="sc">+</span> </span>
<span id="cb205-5"><a href="#cb205-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch3_files/figure-html/unnamed-chunk-147-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb206"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a>Cond_Tab <span class="ot">&lt;-</span> Lakes_shuffle_depth2 <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(ShuffledDepth) <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">Mean_Hg =</span> <span class="fu">mean</span>(Mercury) <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">3</span>), </span>
<span id="cb206-2"><a href="#cb206-2" aria-hidden="true" tabindex="-1"></a>                                                                <span class="at">SD_Hg=</span> <span class="fu">sd</span> (Mercury) <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">3</span>), </span>
<span id="cb206-3"><a href="#cb206-3" aria-hidden="true" tabindex="-1"></a>                                                                <span class="at">N=</span> <span class="fu">n</span>())</span>
<span id="cb206-4"><a href="#cb206-4" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(Cond_Tab)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">ShuffledDepth</th>
<th style="text-align: right;">Mean_Hg</th>
<th style="text-align: right;">SD_Hg</th>
<th style="text-align: right;">N</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Deep</td>
<td style="text-align: right;">0.460</td>
<td style="text-align: right;">0.260</td>
<td style="text-align: right;">15</td>
</tr>
<tr class="even">
<td style="text-align: left;">Medium</td>
<td style="text-align: right;">0.668</td>
<td style="text-align: right;">0.414</td>
<td style="text-align: right;">16</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Shallow</td>
<td style="text-align: right;">0.470</td>
<td style="text-align: right;">0.315</td>
<td style="text-align: right;">22</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb207"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a>Lakes_merc_depth_perm2 <span class="ot">&lt;-</span> <span class="fu">do</span>(<span class="dv">1</span>) <span class="sc">*</span> <span class="fu">lm</span>(Mercury <span class="sc">~</span> ShuffledDepth , <span class="at">data =</span> Lakes_shuffle_depth2)</span>
<span id="cb207-2"><a href="#cb207-2" aria-hidden="true" tabindex="-1"></a>Lakes_merc_depth_perm2<span class="sc">$</span>F</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.040298</code></pre>
</div>
</div>
<p>The F-statistic observed in the shuffled data is 2.0402981.</p>
<p><strong>Third Permutation</strong></p>
<p>We’ll repeat the procedure, one more time, again randomly shuffling the depths of lakes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb209"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true" tabindex="-1"></a>Lakes_shuffle_depth3 <span class="ot">&lt;-</span> FloridaLakes <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">ShuffledDepth =</span> <span class="fu">shuffle</span>(Depth))  </span>
<span id="cb209-2"><a href="#cb209-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Lakes_shuffle_depth3)                                 </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 8
     ID Lake            pH Mercury Chlorophyll Location Depth   ShuffledDepth
  &lt;dbl&gt; &lt;chr&gt;        &lt;dbl&gt;   &lt;dbl&gt;       &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;   &lt;chr&gt;        
1     1 Alligator      6.1    1.23         0.7 S        Medium  Medium       
2     2 Annie          5.1    1.33         3.2 S        Deep    Medium       
3     3 Apopka         9.1    0.04       128.  N        Medium  Medium       
4     4 Blue Cypress   6.9    0.44         3.5 S        Shallow Shallow      
5     5 Brick          4.6    1.2          1.8 S        Medium  Deep         
6     6 Bryant         7.3    0.27        44.1 N        Shallow Deep         </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb211"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>Lakes_shuffle_depth3, <span class="fu">aes</span>(<span class="at">x=</span>ShuffledDepth, <span class="at">y=</span>Mercury, <span class="at">fill=</span>ShuffledDepth)) <span class="sc">+</span> </span>
<span id="cb211-2"><a href="#cb211-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span> <span class="fu">geom_jitter</span>(<span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb211-3"><a href="#cb211-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.y=</span><span class="st">"mean"</span>, <span class="at">geom=</span><span class="st">"point"</span>, <span class="at">shape=</span><span class="dv">20</span>, <span class="at">color=</span><span class="st">"red"</span>, <span class="at">fill=</span><span class="st">"red"</span>)<span class="sc">+</span> </span>
<span id="cb211-4"><a href="#cb211-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"Boxplot for Shuffled Depth Classes"</span>) <span class="sc">+</span> </span>
<span id="cb211-5"><a href="#cb211-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch3_files/figure-html/unnamed-chunk-151-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb212"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a>Cond_Tab <span class="ot">&lt;-</span> Lakes_shuffle_depth3 <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(ShuffledDepth) <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">Mean_Hg =</span> <span class="fu">mean</span>(Mercury) <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">3</span>), </span>
<span id="cb212-2"><a href="#cb212-2" aria-hidden="true" tabindex="-1"></a>                                                                <span class="at">SD_Hg=</span> <span class="fu">sd</span> (Mercury) <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">3</span>), </span>
<span id="cb212-3"><a href="#cb212-3" aria-hidden="true" tabindex="-1"></a>                                                                <span class="at">N=</span> <span class="fu">n</span>())</span>
<span id="cb212-4"><a href="#cb212-4" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(Cond_Tab)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">ShuffledDepth</th>
<th style="text-align: right;">Mean_Hg</th>
<th style="text-align: right;">SD_Hg</th>
<th style="text-align: right;">N</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Deep</td>
<td style="text-align: right;">0.555</td>
<td style="text-align: right;">0.336</td>
<td style="text-align: right;">15</td>
</tr>
<tr class="even">
<td style="text-align: left;">Medium</td>
<td style="text-align: right;">0.629</td>
<td style="text-align: right;">0.400</td>
<td style="text-align: right;">16</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Shallow</td>
<td style="text-align: right;">0.434</td>
<td style="text-align: right;">0.285</td>
<td style="text-align: right;">22</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb213"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a>Lakes_merc_depth_perm3 <span class="ot">&lt;-</span> <span class="fu">do</span>(<span class="dv">1</span>) <span class="sc">*</span> <span class="fu">lm</span>(Mercury <span class="sc">~</span> ShuffledDepth , <span class="at">data =</span> Lakes_shuffle_depth3)</span>
<span id="cb213-2"><a href="#cb213-2" aria-hidden="true" tabindex="-1"></a>Lakes_merc_depth_perm3<span class="sc">$</span>F</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.617857</code></pre>
</div>
</div>
<p>The F-statistic observed in the shuffled data is 1.6178574.</p>
<p>We’ll repeat the simulation many more times to see whether getting an F-statistic as extreme as 1.62 is plausible in a situation where there is no relationship between depth and average mercury level. The first 6 simulated F-statistics are shown below. Recall that these are simulated under the assumption that there is no difference in average mercury between shallow, medium, and deep lakes, i.e.&nbsp;no relationship between mercury level and depth.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb215"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb215-1"><a href="#cb215-1" aria-hidden="true" tabindex="-1"></a>Lakes_merc_depth_perm_test <span class="ot">&lt;-</span> <span class="fu">do</span>(<span class="dv">10000</span>) <span class="sc">*</span> <span class="fu">lm</span>(Mercury <span class="sc">~</span> <span class="fu">shuffle</span>(Depth) , <span class="at">data =</span> FloridaLakes)</span>
<span id="cb215-2"><a href="#cb215-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Lakes_merc_depth_perm_test<span class="sc">$</span>F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.265481460 0.242068358 0.007345152 1.450498889 1.238486261 0.093325750</code></pre>
</div>
</div>
<p>The distribution of the F-statistics is shown below. As usual, the red line represents the F-statistic observed in our actual data. Since F-statistics cannot be negative, we don’t need to worry about finding an F-statistic as extreme in the opposite direction.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb217"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb217-1"><a href="#cb217-1" aria-hidden="true" tabindex="-1"></a>Fstat <span class="ot">&lt;-</span> <span class="fl">1.628</span></span>
<span id="cb217-2"><a href="#cb217-2" aria-hidden="true" tabindex="-1"></a>Extreme <span class="ot">&lt;-</span> Lakes_merc_depth_perm_test<span class="sc">$</span>F <span class="sc">&gt;</span> <span class="fl">1.628</span></span>
<span id="cb217-3"><a href="#cb217-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb217-4"><a href="#cb217-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb217-5"><a href="#cb217-5" aria-hidden="true" tabindex="-1"></a>Lakes_merc_depth_perm_test_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>Lakes_merc_depth_perm_test, <span class="fu">aes</span>(<span class="at">x=</span>F)) <span class="sc">+</span> </span>
<span id="cb217-6"><a href="#cb217-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Extreme), <span class="at">color=</span><span class="st">"white"</span>) <span class="sc">+</span> </span>
<span id="cb217-7"><a href="#cb217-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"FALSE"</span> <span class="ot">=</span> <span class="st">"blue"</span>, <span class="st">"TRUE"</span> <span class="ot">=</span> <span class="st">"red"</span>)) <span class="sc">+</span></span>
<span id="cb217-8"><a href="#cb217-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept=</span><span class="fu">c</span>(Fstat), <span class="at">color=</span><span class="st">"red"</span>) <span class="sc">+</span> </span>
<span id="cb217-9"><a href="#cb217-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Lakes Depth: Simulated F-statistic"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Frequency"</span>) <span class="sc">+</span> </span>
<span id="cb217-10"><a href="#cb217-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Distribution of F-stat under assumption of no relationship"</span>) <span class="sc">+</span></span>
<span id="cb217-11"><a href="#cb217-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span> </span>
<span id="cb217-12"><a href="#cb217-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb217-13"><a href="#cb217-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb217-14"><a href="#cb217-14" aria-hidden="true" tabindex="-1"></a>Lakes_merc_depth_perm_test_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch3_files/figure-html/unnamed-chunk-155-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Notice that unlike the permutation distributions we’ve seen before, the distribution of the F-statistic is not symmetric. Recall that F-statistics can only take on positive values, which results in this right-skewed shape. Nevertheless, we can still look at where the F-statistic we observed in our data lies relative to those obtained in a simulation that assumed the null hypothesis of no relationship was true.</p>
<p>The result we observed seems pretty consistent with the simulated values in the histogram. The red line is not very extreme.</p>
<p><strong>p-value:</strong> Proportion of simulations resulting in F-statistic more extreme than 1.628:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb218"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb218-1"><a href="#cb218-1" aria-hidden="true" tabindex="-1"></a><span class="fu">prop</span>(<span class="sc">~</span> (F <span class="sc">&gt;</span> <span class="fl">1.628</span>), <span class="at">data =</span> Lakes_merc_depth_perm_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>prop_TRUE 
   0.2089 </code></pre>
</div>
</div>
<p>This p-value represents the probabilty of observing an F-statistic as extreme or more extreme than we 1.628 if there is really no relationship between a lake’s depth and mercury level.</p>
<p>Since the p-value is large, it is plausible that we would see differences like we did in the actual data in a situation where the null hypothesis is true.</p>
<p>We cannot reject the null hypothesis. We do not have enough evidence to say that average mercury levels differ between shallow, medium, and deep lakes.</p>
<p>We are not saying that we think mercury levels are the same between the three different depths (i.e.&nbsp;we’re not accepting the null hypothesis), just that we don’t have enough evidence to say that they differ.</p>
<div style="page-break-after: always;"></div>
</section>
<section id="responsible-hypothesis-testing" class="level3" data-number="3.4.5">
<h3 data-number="3.4.5" class="anchored" data-anchor-id="responsible-hypothesis-testing"><span class="header-section-number">3.4.5</span> Responsible Hypothesis Testing</h3>
<p>While hypothesis tests are a powerful tool in statistics, they are also one that has been widely misused, to the detriment of scientific research. The hard caused by these misuses caused the American Statistical Association to release a <a href="https://www.amstat.org/asa/files/pdfs/p-valuestatement.pdf">2016 statement</a>, intended to provide guidance and clarification to scientists who use hypothesis testing and p-values in their research.</p>
<p>The statement provides the following six principles for responsible use of hypothesis tests and p-values.</p>
<ol type="1">
<li><p>P-values can indicate how incompatible the data are with a specified statistical model.</p></li>
<li><p>P-values do not measure the probability that the studied hypothesis is true, or the probability that the data were produced by random chance alone.</p></li>
<li><p>Scientific conclusions and business or policy decisions should not be based only on whether a p-value passes a specific threshold.</p></li>
<li><p>Proper inference requires full reporting and transparency.</p></li>
<li><p>A p-value, or statistical significance, does not measure the size of an effect or the importance of a result.</p></li>
<li><p>By itself, a p-value does not provide a good measure of evidence regarding a model or hypothesis.</p></li>
</ol>
<p>The statement provides important guidance for us to consider as we work with hypothesis testing in this class, as well as in future classes and potentially in our own research.</p>
<ul>
<li><p>A hypothesis test can only tell us the strength of evidence against the null hypothesis. The absence of evidence against the null hypothesis should not be interpreted as evidence for the null hypothesis.</p></li>
<li><p>We should never say that the data support/prove/confirm the null hypothesis.</p></li>
<li><p>We can only say that the data do not provide evidence against the null hypothesis.</p></li>
</ul>
<p><strong>What to conclude from p-values and what not to:</strong></p>
<ul>
<li><p>A low p-value provides evidence against the null hypothesis. It suggests the test statistic we observed is inconsistent with the null hypothesis.</p></li>
<li><p>A low p-value does <strong>not</strong> tell us that the difference or relationship we observed is meaningful in a practical sense. Researchers should look at the size of the difference or strength of the relationship in the sample before deciding whether it merits being acted upon.</p></li>
<li><p>A high p-value means that the data could have plausibly been obtained when the null hypothesis is true. The test statistic we observed is consistent with what we would have expected to see when the null hypothesis is true, and thus we cannot rule out the null hypothesis.</p></li>
<li><p>A high p-value does <strong>not</strong> mean that the null hypothesis is true or probably true. A p-value can only tell us the strength of evidence against the null hypothesis, and should never be interpreted as support for the null hypothesis.</p></li>
</ul>
<p>Just because our result is consistent with the null hypothesis does not mean that we should believe that null hypothesis is true. Lack of evidence against a claim does not necessarily mean that the claim is true.</p>
<p>In this scenario, we got a small p-value, but we should also be aware of what we should conclude if the p-value is large. Remember that the p-value only measures the strength of evidence <em>against</em> the null hypothesis. A large p-value means we lack evidence against the null hypothesis. This does not mean, however, that we have evidence <em>supporting</em> null hypothesis.</p>
<p>A hypothesis test can be thought of as being analogous to a courtroom trial, where the null hypothesis is that the defendant did not commit the crime. Suppose that after each side presents evidence, the jury remains unsure whether the defendant committed the crime. Since the jury does not have enough evidence to be sure, they must, under the law of the United States find the defendant “not guilty.” This does not mean that the jury thinks the defendant is innocent, only that they do not have enough evidence to be sure they are guilty. Similarly in a hypothesis test, a large p-value indicates a lack of evidence against the null hypothesis, rather than evidence supporting it. As such, we should avoid statements suggesting we “support”, “accept”, or “believe” the null hypothesis, and simply state that we lack evidence against it.</p>
<p><strong>Things to say when the p-value is small:</strong></p>
<ul>
<li>The data are not consistent with the null hypothesis.<br>
</li>
<li>We have evidence against the null hypothesis.<br>
</li>
<li>We detect a difference or effect.<br>
</li>
<li>The difference or effect is statistically discernible.</li>
</ul>
<p><strong>Things NOT to say based on a small p-value alone:</strong></p>
<ul>
<li>The difference is practically meaningful or significant.<br>
</li>
<li>We should take action based on the result.</li>
</ul>
<p>In some cases, a small p-value might merit taking action, but it is important to also consider the size of the difference, the method of in which the data were collected, and how representative it is, as well as the costs and benefits of a potential decision, rather than acting on a p-value alone.</p>
<p><strong>Things to say when the p-value is large:</strong></p>
<ul>
<li>The data are consistent with the null hypothesis.<br>
</li>
<li>We do not have enough evidence against the null hypothesis.<br>
</li>
<li>We cannot reject the null hypothesis.<br>
</li>
<li>The null hypothesis is plausible.</li>
</ul>
<p><strong>Things NOT to say when the p-value is large:</strong></p>
<ul>
<li>The data support the null hypothesis.<br>
</li>
<li>The data provide evidence for the null hypothesis.<br>
</li>
<li>We accept the null hypothesis.<br>
</li>
<li>We conclude that the null hypothesis is true.</li>
</ul>
</section>
</section>
<section id="practice-questions" class="level2" data-number="3.5">
<h2 data-number="3.5" class="anchored" data-anchor-id="practice-questions"><span class="header-section-number">3.5</span> Practice Questions</h2>
<section id="section" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="section">1)</h3>
<p>For each situation identify:</p>
<ol type="i">
<li>a relevant population of interest<br>
</li>
<li>the sample<br>
</li>
<li>the population parameter<br>
</li>
<li>the sample statistic</li>
</ol>
<p>If the size of the sample or population, or the numeric value of the sample/parameter are known, say what they are.</p>
<section id="a" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="a">a)</h4>
<p>Data were collected from a cross-sectional study to investigate the relationship between personal characteristics and dietary factors, and plasma concentrations of retinol, beta-carotene and other carotenoids. 315 study subjects were patients who had an elective surgical procedure during a three-year period to biopsy or remove a lesion of the lung, colon, breast, skin, ovary or uterus that was found to be non-cancerous. Each person’s daily cholesterol consumption (in mg/day) was recorded. Researchers are interested in estimating the average daily cholesterol consumption among all hospital patients with similar conditions.</p>
</section>
<section id="b" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="b">b)</h4>
<p>Data are from samples of ten courses in each of four disciplines at a liberal arts college. The classes were classified as either Arts, Humanities, Natural Sciences, or Sciences. For each course the bookstore’s website lists the required texts(s) and costs. We are interested in comparing average material costs between the four different areas of classes. For this question, assume we’re comparing humanities and natural sciences. It is found that, among the books in the sample, books for natural science courses cost $50.50 more than for books for humanities courses, on average.</p>
</section>
<section id="c" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="c">c)</h4>
<p>A 2012 study in Great Britain examines the relationship between the number of friends an individual has on Facebook and grey matter density in the areas of the brain associated with social perception and associative memory. The study included 40 students at City University London. Researchers then used a linear regression model to study the relationship between number of Facebook friends and grey matter density in the brain. Using data from the 40 students in the sample, they calculated the slope of the regression line to be 82.45.</p>
</section>
</section>
<section id="section-1" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="section-1">2)</h3>
<p>Data were collected from a cross-sectional study to investigate the relationship between personal characteristics and dietary factors, and plasma concentrations of retinol, beta-carotene and other carotenoids. 315 study subjects were patients who had an elective surgical procedure during a three-year period to biopsy or remove a lesion of the lung, colon, breast, skin, ovary or uterus that was found to be non-cancerous. Each person’s daily cholesterol consumption (in mg/day) was recorded. Researchers are interested in estimating the average daily cholesterol consumption among all hospital patients with similar conditions.</p>
<p>The distribution of amount of cholesterol consumed in a day for the 315 people in the nutrition study from 1(a) is shown below along with the sample mean and standard deviation.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb220"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb220-1"><a href="#cb220-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>NutritionStudy, <span class="fu">aes</span>(<span class="at">x=</span>Cholesterol)) <span class="sc">+</span> </span>
<span id="cb220-2"><a href="#cb220-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">color=</span><span class="st">"white"</span>, <span class="at">fill=</span><span class="st">"lightblue"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch3_files/figure-html/unnamed-chunk-158-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb221"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb221-1"><a href="#cb221-1" aria-hidden="true" tabindex="-1"></a>NutritionStudy <span class="sc">|&gt;</span> <span class="fu">summarize</span>(<span class="at">Mean_Chol =</span> <span class="fu">mean</span>(Cholesterol), </span>
<span id="cb221-2"><a href="#cb221-2" aria-hidden="true" tabindex="-1"></a>                            <span class="at">SD_Chol=</span><span class="fu">sd</span>(Cholesterol))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Mean_Chol  SD_Chol
1  242.4606 131.9916</code></pre>
</div>
</div>
<p>We use a model with only an intercept term to estimate the mean cholesterol among all hospital patients with similar conditions. The model is</p>
<p><span class="math display">\[
\begin{aligned}
\widehat{\text{Cholesterol}} &amp; = b_0
\end{aligned}
\]</span> R output for the model is shown below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb223"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb223-1"><a href="#cb223-1" aria-hidden="true" tabindex="-1"></a>M_Nut_chol_0 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>NutritionStudy, Cholesterol<span class="sc">~</span><span class="dv">1</span>)</span>
<span id="cb223-2"><a href="#cb223-2" aria-hidden="true" tabindex="-1"></a>M_Nut_chol_0</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Cholesterol ~ 1, data = NutritionStudy)

Coefficients:
(Intercept)  
      242.5  </code></pre>
</div>
</div>
<p>The bootstrap distribution for <span class="math inline">\(b_0\)</span> is shown below along with its mean and standard deviation.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb225"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb225-1"><a href="#cb225-1" aria-hidden="true" tabindex="-1"></a>Nutrition_Bootstrap_Mean <span class="ot">&lt;-</span> <span class="fu">do</span>(<span class="dv">10000</span>) <span class="sc">*</span> <span class="fu">lm</span>( Cholesterol <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> <span class="fu">resample</span>(NutritionStudy, <span class="at">replace=</span><span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch3_files/figure-html/unnamed-chunk-162-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb226"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb226-1"><a href="#cb226-1" aria-hidden="true" tabindex="-1"></a>Nutrition_Bootstrap_Mean <span class="sc">|&gt;</span> <span class="fu">summarize</span>(<span class="at">Mean_Chol =</span> <span class="fu">mean</span>(Intercept) <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">1</span>), </span>
<span id="cb226-2"><a href="#cb226-2" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">SE_Mean=</span><span class="fu">sd</span>(Intercept) <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Mean_Chol SE_Mean
1     242.6     7.4</code></pre>
</div>
</div>
<section id="a-1" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="a-1">a)</h4>
<p>Explain the difference between the standard deviation of 132 and the standard error of the mean of 7.4. State clearly what each number is measuring the variability between.</p>
</section>
<section id="b-1" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="b-1">b)</h4>
<p>Suppose the sample had included 500 patients instead of 315. Should we expect the standard deviation to be more, less, or about the same as 132? Should we expect the standard error of the mean to be more, less, or about the same as 7.4?</p>
</section>
</section>
<section id="section-2" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="section-2">3)</h3>
<p>For each of the scenarios (a-c) in Question 1, list the steps of the Bootstrap algorithm in Section 3.2.2 that we would need to perform to obtain approximate 95% bootstrap confidence intervals for the parameter of interest. In your steps, be sure to explicitly identify the size of the bootstrap samples and the statistic you would calculate.</p>
</section>
<section id="section-3" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="section-3">4)</h3>
<p>Refer to the information in Question 2. Give an approximate 95% standard error confidence interval for the relevant population parameter. Write a sentence interpreting your confidence interval in context.</p>
</section>
<section id="section-4" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="section-4">5)</h3>
<p>Data are from samples of ten courses in each of four disciplines at a liberal arts college. The classes were classified as either Arts, Humanities, Natural Sciences, or Sciences. For each course the bookstore’s website lists the required texts(s) and costs. We are interested in comparing average material costs between the four different areas of classes. For this question, assume we’re comparing humanities and natural sciences.</p>
<p>We fit a model of the form</p>
<p><span class="math display">\[
\begin{aligned}
\widehat{\text{Cost}} &amp; = b_0 + b_1 \text{Humanities} + b_2 \text{NaturalScience} + b_3 \text{SocialScience},
\end{aligned}
\]</span> where the Humanities, NaturalScience, and SocialScience variables all have value 1 if the course is in that field and 0 otherwise.</p>
<p>Model estimates are shown below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb228"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb228-1"><a href="#cb228-1" aria-hidden="true" tabindex="-1"></a>M_Book_cost_Field <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>TextbookCosts, Cost<span class="sc">~</span>Field) </span>
<span id="cb228-2"><a href="#cb228-2" aria-hidden="true" tabindex="-1"></a>M_Book_cost_Field</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Cost ~ Field, data = TextbookCosts)

Coefficients:
        (Intercept)      FieldHumanities  FieldNaturalScience  
               94.6                 25.7                 76.2  
 FieldSocialScience  
               23.7  </code></pre>
</div>
</div>
<p>We use bootstrapping to produce confidence intervals for parameters associated with the model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb230"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb230-1"><a href="#cb230-1" aria-hidden="true" tabindex="-1"></a>Books_Bootstrap <span class="ot">&lt;-</span> <span class="fu">do</span>(<span class="dv">10000</span>) <span class="sc">*</span> <span class="fu">lm</span>( Cost <span class="sc">~</span> Field, </span>
<span id="cb230-2"><a href="#cb230-2" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">data =</span> <span class="fu">resample</span>(TextbookCosts, <span class="at">replace=</span><span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="a-2" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="a-2">a)</h3>
<p>The bootstrap distribution for <span class="math inline">\(b_0\)</span> is shown below, along with its mean and standard error.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch3_files/figure-html/unnamed-chunk-166-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb231"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb231-1"><a href="#cb231-1" aria-hidden="true" tabindex="-1"></a>Books_Bootstrap <span class="sc">|&gt;</span> <span class="fu">summarize</span>(<span class="at">Mean_b0 =</span> <span class="fu">mean</span>(Intercept) <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">1</span>), </span>
<span id="cb231-2"><a href="#cb231-2" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">SE_b0=</span><span class="fu">sd</span>(Intercept) <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Mean_b0 SE_b0
1    94.6    14</code></pre>
</div>
</div>
<p>Give an approximate 95% standard error confidence interval for the relevant population parameter. Write a sentence interpreting your confidence interval in context.</p>
</section>
<section id="b-2" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="b-2">b)</h3>
<p>The bootstrap distribution for <span class="math inline">\(b_3\)</span> is shown below, along with its mean and standard error.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch3_files/figure-html/unnamed-chunk-168-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb233"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb233-1"><a href="#cb233-1" aria-hidden="true" tabindex="-1"></a>Books_Bootstrap <span class="sc">|&gt;</span> <span class="fu">summarize</span>(<span class="at">Mean_b3 =</span> <span class="fu">mean</span>(FieldSocialScience) <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">1</span>), </span>
<span id="cb233-2"><a href="#cb233-2" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">SE_b3=</span><span class="fu">sd</span>(FieldSocialScience) <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Mean_b3 SE_b3
1    23.7  20.9</code></pre>
</div>
</div>
<p>Give an approximate 95% standard error confidence interval for the relevant population parameter. Write a sentence interpreting your confidence interval in context.</p>
</section>
<section id="c-1" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="c-1">c)</h3>
<p>The bootstrap distribution for <span class="math inline">\(b_0 + b_1\)</span> is shown below, along with its mean and standard error.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch3_files/figure-html/unnamed-chunk-171-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb235"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb235-1"><a href="#cb235-1" aria-hidden="true" tabindex="-1"></a>Books_b0_b1_Bootstrap <span class="sc">|&gt;</span> <span class="fu">summarize</span>(<span class="at">Mean =</span> <span class="fu">mean</span>(X1) <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">1</span>), </span>
<span id="cb235-2"><a href="#cb235-2" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">SE=</span><span class="fu">sd</span>(X1) <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Mean   SE
1 120.3 18.1</code></pre>
</div>
</div>
<p>Give an approximate 95% standard error confidence interval for the relevant population parameter. Write a sentence interpreting your confidence interval in context.</p>
</section>
<section id="section-5" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="section-5">6)</h3>
<p>A 2012 study in Great Britain examines the relationship between the number of friends an individual has on Facebook and grey matter density in the areas of the brain associated with social perception and associative memory. The study included 40 students at City University London. Researchers then used a linear regression model to study the relationship between number of Facebook friends and grey matter density in the brain.</p>
<p>We fit a model of the form</p>
<p><span class="math display">\[
\begin{aligned}
\widehat{\text{Cost}} &amp; = b_0 + b_1 \text{GMdensity}
\end{aligned}
\]</span> where the GMdensity is a measure of grey matter density in the brain. The GM density variable was standardized, so a person who has average grey matter density will have <code>GMdensity =0</code>, and the GMdensity variable can be interpreted as the number of standard deviations a person is above or below the average amount of grey matter density.</p>
<p>Model estimates are shown below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb237"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb237-1"><a href="#cb237-1" aria-hidden="true" tabindex="-1"></a>M_FB_friends_gm <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>FacebookFriends, FBfriends <span class="sc">~</span> GMdensity) </span>
<span id="cb237-2"><a href="#cb237-2" aria-hidden="true" tabindex="-1"></a>M_FB_friends_gm</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = FBfriends ~ GMdensity, data = FacebookFriends)

Coefficients:
(Intercept)    GMdensity  
     366.64        82.45  </code></pre>
</div>
</div>
<p>We use bootstrapping to produce confidence intervals for parameters associated with the model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb239"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb239-1"><a href="#cb239-1" aria-hidden="true" tabindex="-1"></a>FB_Bootstrap <span class="ot">&lt;-</span> <span class="fu">do</span>(<span class="dv">10000</span>) <span class="sc">*</span> <span class="fu">lm</span>( FBfriends <span class="sc">~</span> GMdensity, </span>
<span id="cb239-2"><a href="#cb239-2" aria-hidden="true" tabindex="-1"></a>                                <span class="at">data =</span> <span class="fu">resample</span>(FacebookFriends, <span class="at">replace=</span><span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="a-3" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="a-3">a)</h3>
<p>The bootstrap distribution for <span class="math inline">\(b_0\)</span> is shown below, along with its mean and standard error.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch3_files/figure-html/unnamed-chunk-175-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb240"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb240-1"><a href="#cb240-1" aria-hidden="true" tabindex="-1"></a>FB_Bootstrap <span class="sc">|&gt;</span> <span class="fu">summarize</span>(<span class="at">Mean_b0 =</span> <span class="fu">mean</span>(Intercept) <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">1</span>), </span>
<span id="cb240-2"><a href="#cb240-2" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">SE_b0=</span><span class="fu">sd</span>(Intercept) <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Mean_b0 SE_b0
1   367.5  26.4</code></pre>
</div>
</div>
<p>Give an approximate 95% standard error confidence interval for the relevant population parameter. Write a sentence interpreting your confidence interval in context.</p>
</section>
<section id="b-3" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="b-3">b)</h3>
<p>The bootstrap distribution for <span class="math inline">\(b_1\)</span> is shown below, along with its mean and standard error.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch3_files/figure-html/unnamed-chunk-177-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb242"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb242-1"><a href="#cb242-1" aria-hidden="true" tabindex="-1"></a>FB_Bootstrap <span class="sc">|&gt;</span> <span class="fu">summarize</span>(<span class="at">Mean_b1 =</span> <span class="fu">mean</span>(GMdensity) <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">1</span>), </span>
<span id="cb242-2"><a href="#cb242-2" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">SE_b1=</span><span class="fu">sd</span>(GMdensity) <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Mean_b1 SE_b1
1    81.6  22.8</code></pre>
</div>
</div>
<p>Give an approximate 95% standard error confidence interval for the relevant population parameter. Write a sentence interpreting your confidence interval in context.</p>
</section>
<section id="c-2" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="c-2">c)</h3>
<p>The bootstrap distribution for <span class="math inline">\(b_0 + 0.5b_1\)</span> is shown below, along with its mean and standard error.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch3_files/figure-html/unnamed-chunk-180-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb244"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb244-1"><a href="#cb244-1" aria-hidden="true" tabindex="-1"></a>Books_b0_b1_Bootstrap <span class="sc">|&gt;</span> <span class="fu">summarize</span>(<span class="at">Mean =</span> <span class="fu">mean</span>(X1) <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">1</span>), </span>
<span id="cb244-2"><a href="#cb244-2" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">SE=</span><span class="fu">sd</span>(X1) <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Mean   SE
1 120.3 18.1</code></pre>
</div>
</div>
<p>Give an approximate 95% standard error confidence interval for the relevant population parameter. Write a sentence interpreting your confidence interval in context.</p>
</section>
<section id="section-6" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="section-6">7)</h3>
<p>State whether each of the following statements about bootstrapping are true or false. If the statement is false, explain why.</p>
<section id="a-4" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="a-4">a)</h4>
<p>Bootstrapping helps us measure the amount of variability we would see in a statistic between different samples taken from a population.</p>
</section>
<section id="b-4" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="b-4">b)</h4>
<p>Bootstrapping increases the size of the sample, giving us more accurate estimates of the mean and other regression coefficients.</p>
</section>
<section id="c-3" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="c-3">c)</h4>
<p>Bootstrap samples must be the same size as the original sample.</p>
</section>
<section id="d" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="d">d)</h4>
<p>If we took bootstrap samples without using replacement, then every sample would be the same, and we would not be able to measure variability in our statistic.</p>
</section>
<section id="e" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="e">e)</h4>
<p>When the bootstrap distribution is not symmetric and bell-shaped, it is better to use a standard error bootstrap confidence interval than a percentile bootstrap confidence interval.</p>
</section>
<section id="f" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="f">f)</h4>
<p>The mean and standard deviation of the bootstrap distribution for the mean should both be the same as the mean and standard deviation of the sampling distribution for the mean.</p>
</section>
</section>
<section id="section-7" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="section-7">8)</h3>
<p>For the cholesterol study in Questions 2 and 4, a person suggests that we could reduce the standard error, and thus obtain a more precise confidence interval, by taking bootstrap samples of 500 (instead of the sample size of 315 seen in the actual study). Is this a good idea? Why or why not?</p>
</section>
<section id="section-8" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="section-8">9)</h3>
<p>Each day, United Airlines has a flight from Boston to San Francisco, departing at 6 am (Eastern time). The flight is scheduled to arrive in San Francisco at 9:30 am (Pacific time). This results in an expected total flight duration of 6.5 hours (390 minutes). Due to weather conditions, however, the exact duration of the flight varies from day to day. A random sample of flights from 31 different days was selected. The times of the 28 flights are shown below, listed from smallest to largest.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code> [1] 334 340 344 351 352 354 362 366 367 368 368 368 368 369 371 373 377 377 381
[20] 382 385 386 388 388 388 391 395 398</code></pre>
</div>
</div>
<p>The mean, standard deviation, and sample size in flight times are shown below.</p>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">Mean</th>
<th style="text-align: right;">StDev</th>
<th style="text-align: right;">n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">371.1071</td>
<td style="text-align: right;">16.73395</td>
<td style="text-align: right;">28</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>A 95% bootstrap standard error confidence interval for the mean flight time for a model including only an intercept <span class="math inline">\(b_0\)</span> is shown below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb247"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb247-1"><a href="#cb247-1" aria-hidden="true" tabindex="-1"></a>Flights_Bootstrap <span class="ot">&lt;-</span> <span class="fu">do</span>(<span class="dv">10000</span>) <span class="sc">*</span> <span class="fu">lm</span>( AirTime <span class="sc">~</span> <span class="dv">1</span>, </span>
<span id="cb247-2"><a href="#cb247-2" aria-hidden="true" tabindex="-1"></a>                                <span class="at">data =</span> <span class="fu">resample</span>(Flight433, <span class="at">replace=</span><span class="cn">TRUE</span>))</span>
<span id="cb247-3"><a href="#cb247-3" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(Flights_Bootstrap, <span class="at">parm=</span><span class="st">"Intercept"</span>, <span class="at">level=</span><span class="fl">0.95</span>, <span class="at">method=</span><span class="st">"se"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       name    lower    upper level method estimate margin.of.error
1 Intercept 365.0501 377.1973  0.95 stderr 371.1071        6.073613</code></pre>
</div>
</div>
<p>A manager sees the data and confidence interval and says:</p>
<p><em>“This is supposed to be a 95% confidence interval, but only 11 of the 28 flight times were actually in this range (between 365 and 377). A 95% confidence interval should contain about 95% of the flight times, and 11/28 is much less than 95%. Someone must have made a mistake calculating this interval.”</em></p>
<p>Is the manager’s reasoning correct? If so, identify the mistake in the method used to obtain the confidence interval. If not, identify the mistake in the manager’s reasoning.</p>
</section>
<section id="info-for-questions-10-12" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="info-for-questions-10-12">Info for Questions (10-12)</h3>
<p><strong>For Questions 10-12, refer to the following data and questions.</strong></p>
<p>We’ll work with a dataset pertaining to a sample of 200 high school seniors. Data were collected from student responses to the High School and Beyond Survey. The data are available in the <code>openintro</code> R package.</p>
<p>Variables of interest include:</p>
<p><code>schtyp</code> - school type (public or private)<br>
<code>prog</code> - type of program (general, academic, or vocational)<br>
<code>write</code> - writing score on a standardized test<br>
<code>science</code> - science score on a standardized test</p>
<p>The first 6 rows of the data are shown below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb249"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb249-1"><a href="#cb249-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(openintro)</span>
<span id="cb249-2"><a href="#cb249-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(hsb2)</span>
<span id="cb249-3"><a href="#cb249-3" aria-hidden="true" tabindex="-1"></a>HSSeniors <span class="ot">&lt;-</span> hsb2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb250"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb250-1"><a href="#cb250-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(hsb2) <span class="sc">|&gt;</span> <span class="fu">select</span>(schtyp, prog, write, science)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  schtyp prog       write science
  &lt;fct&gt;  &lt;fct&gt;      &lt;int&gt;   &lt;int&gt;
1 public general       52      47
2 public vocational    59      63
3 public general       33      58
4 public vocational    44      53
5 public academic      52      53
6 public academic      52      63</code></pre>
</div>
</div>
<p><strong>Some graphics summarizing the data are shown below.</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb252"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb252-1"><a href="#cb252-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>HSSeniors, <span class="fu">aes</span>(<span class="at">y=</span>science, <span class="at">x=</span>schtyp)) <span class="sc">+</span> <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb252-2"><a href="#cb252-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Science Scores for Public and Private Schools"</span>) <span class="sc">+</span> </span>
<span id="cb252-3"><a href="#cb252-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Type of School"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Average Score"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Ch3_files/figure-html/unnamed-chunk-187-1.png" class="img-fluid figure-img" width="768"></p>
<figcaption>Science test scores in public and private schools</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb253"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb253-1"><a href="#cb253-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>HSSeniors, <span class="fu">aes</span>(<span class="at">y=</span>science, <span class="at">x=</span>prog)) <span class="sc">+</span> </span>
<span id="cb253-2"><a href="#cb253-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"Science Scores for Program Types"</span>) <span class="sc">+</span> </span>
<span id="cb253-3"><a href="#cb253-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Type of Program"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Average Score"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Ch3_files/figure-html/unnamed-chunk-188-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Science test scores for each academic program</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb254"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb254-1"><a href="#cb254-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>HSSeniors, <span class="fu">aes</span>(<span class="at">y=</span>science, <span class="at">x=</span>write)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb254-2"><a href="#cb254-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Science and Writing Scores"</span>) <span class="sc">+</span> </span>
<span id="cb254-3"><a href="#cb254-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Writing Score"</span>) <span class="sc">+</span> </span>
<span id="cb254-4"><a href="#cb254-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Science Score"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Ch3_files/figure-html/unnamed-chunk-189-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Relationship between science and writing scores</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb255"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb255-1"><a href="#cb255-1" aria-hidden="true" tabindex="-1"></a>T1 <span class="ot">&lt;-</span> HSSeniors <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(schtyp) <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">Mean_Science=</span><span class="fu">mean</span>(science),</span>
<span id="cb255-2"><a href="#cb255-2" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">Med_Science=</span><span class="fu">median</span>(science),</span>
<span id="cb255-3"><a href="#cb255-3" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">StDev_science=</span><span class="fu">sd</span>(science),</span>
<span id="cb255-4"><a href="#cb255-4" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">n=</span><span class="fu">n</span>())</span>
<span id="cb255-5"><a href="#cb255-5" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(T1, <span class="at">caption=</span><span class="st">"Summary of science test scores by school type"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Summary of science test scores by school type</caption>
<thead>
<tr class="header">
<th style="text-align: left;">schtyp</th>
<th style="text-align: right;">Mean_Science</th>
<th style="text-align: right;">Med_Science</th>
<th style="text-align: right;">StDev_science</th>
<th style="text-align: right;">n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">public</td>
<td style="text-align: right;">51.57143</td>
<td style="text-align: right;">53</td>
<td style="text-align: right;">10.192501</td>
<td style="text-align: right;">168</td>
</tr>
<tr class="even">
<td style="text-align: left;">private</td>
<td style="text-align: right;">53.31250</td>
<td style="text-align: right;">55</td>
<td style="text-align: right;">8.185106</td>
<td style="text-align: right;">32</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb256"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb256-1"><a href="#cb256-1" aria-hidden="true" tabindex="-1"></a>T2 <span class="ot">&lt;-</span> HSSeniors <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(prog) <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">Mean_Science=</span><span class="fu">mean</span>(science),</span>
<span id="cb256-2"><a href="#cb256-2" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">Med_Science=</span><span class="fu">median</span>(science),</span>
<span id="cb256-3"><a href="#cb256-3" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">StDev_science=</span><span class="fu">sd</span>(science),</span>
<span id="cb256-4"><a href="#cb256-4" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">n=</span><span class="fu">n</span>())</span>
<span id="cb256-5"><a href="#cb256-5" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(T2, <span class="at">caption=</span><span class="st">"Summary of science test scores by program type"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Summary of science test scores by program type</caption>
<thead>
<tr class="header">
<th style="text-align: left;">prog</th>
<th style="text-align: right;">Mean_Science</th>
<th style="text-align: right;">Med_Science</th>
<th style="text-align: right;">StDev_science</th>
<th style="text-align: right;">n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">general</td>
<td style="text-align: right;">52.44444</td>
<td style="text-align: right;">53</td>
<td style="text-align: right;">9.680241</td>
<td style="text-align: right;">45</td>
</tr>
<tr class="even">
<td style="text-align: left;">academic</td>
<td style="text-align: right;">53.80000</td>
<td style="text-align: right;">55</td>
<td style="text-align: right;">9.127726</td>
<td style="text-align: right;">105</td>
</tr>
<tr class="odd">
<td style="text-align: left;">vocational</td>
<td style="text-align: right;">47.22000</td>
<td style="text-align: right;">47</td>
<td style="text-align: right;">10.333796</td>
<td style="text-align: right;">50</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="section-9" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="section-9">10)</h3>
<p>We want to know whether there is evidence of a difference in average science test scores between public and private schools.</p>
<p>We fit a model of the form</p>
<p><span class="math display">\[
\begin{aligned}
\widehat{\text{Score}} &amp; = b_0 + b_1 \text{Public}
\end{aligned}
\]</span> Model estimates are shown below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb257"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb257-1"><a href="#cb257-1" aria-hidden="true" tabindex="-1"></a>M_Seniors_science_schtyp <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>HSSeniors, science <span class="sc">~</span> schtyp)</span>
<span id="cb257-2"><a href="#cb257-2" aria-hidden="true" tabindex="-1"></a>M_Seniors_science_schtyp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = science ~ schtyp, data = HSSeniors)

Coefficients:
  (Intercept)  schtypprivate  
       51.571          1.741  </code></pre>
</div>
</div>
<p>The following code performs a permutation-based hypothesis test.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb259"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb259-1"><a href="#cb259-1" aria-hidden="true" tabindex="-1"></a>science_schtyp_perm_test <span class="ot">&lt;-</span> <span class="fu">do</span>(<span class="dv">10000</span>) <span class="sc">*</span> <span class="fu">lm</span>(science <span class="sc">~</span> <span class="fu">shuffle</span>(schtyp), <span class="at">data =</span> HSSeniors)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The histogram shows the distribution of <span class="math inline">\(b_1\)</span> in our simulation.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb260"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb260-1"><a href="#cb260-1" aria-hidden="true" tabindex="-1"></a>Estimate <span class="ot">&lt;-</span> M_Seniors_science_schtyp<span class="sc">$</span>coefficients[<span class="dv">2</span>]</span>
<span id="cb260-2"><a href="#cb260-2" aria-hidden="true" tabindex="-1"></a>Extreme <span class="ot">&lt;-</span> <span class="fu">abs</span>(science_schtyp_perm_test<span class="sc">$</span>schtyp) <span class="sc">&gt;</span> <span class="fu">abs</span>(Estimate)</span>
<span id="cb260-3"><a href="#cb260-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb260-4"><a href="#cb260-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb260-5"><a href="#cb260-5" aria-hidden="true" tabindex="-1"></a>science_schtyp_perm_test_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>science_schtyp_perm_test, <span class="fu">aes</span>(<span class="at">x=</span>schtypprivate)) <span class="sc">+</span> </span>
<span id="cb260-6"><a href="#cb260-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Extreme), <span class="at">color=</span><span class="st">"white"</span>) <span class="sc">+</span> </span>
<span id="cb260-7"><a href="#cb260-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"FALSE"</span> <span class="ot">=</span> <span class="st">"blue"</span>, <span class="st">"TRUE"</span> <span class="ot">=</span> <span class="st">"red"</span>)) <span class="sc">+</span></span>
<span id="cb260-8"><a href="#cb260-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept=</span><span class="fu">c</span>(Estimate, <span class="sc">-</span><span class="dv">1</span><span class="sc">*</span>Estimate), <span class="at">color=</span><span class="st">"red"</span>) <span class="sc">+</span> </span>
<span id="cb260-9"><a href="#cb260-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Lakes: Simulated Value of b1"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Frequency"</span>) <span class="sc">+</span> </span>
<span id="cb260-10"><a href="#cb260-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Distribution of b1 under assumption of no relationship"</span>) <span class="sc">+</span></span>
<span id="cb260-11"><a href="#cb260-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span>
<span id="cb260-12"><a href="#cb260-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-13"><a href="#cb260-13" aria-hidden="true" tabindex="-1"></a>science_schtyp_perm_test_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch3_files/figure-html/unnamed-chunk-194-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>p-value:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb261"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb261-1"><a href="#cb261-1" aria-hidden="true" tabindex="-1"></a><span class="fu">prop</span>(<span class="sc">~</span> (<span class="fu">abs</span>(schtypprivate) <span class="sc">&gt;</span> <span class="fl">1.741</span>), <span class="at">data =</span> science_schtyp_perm_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>prop_TRUE 
   0.3638 </code></pre>
</div>
</div>
<section id="a-5" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="a-5">a)</h4>
<p>Write null and alternative hypotheses.</p>
</section>
<section id="b-5" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="b-5">b)</h4>
<p>State the appropriate test statistic words and symbols. Give the numerical value of the test statistic.</p>
</section>
<section id="c-4" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="c-4">c)</h4>
<p>Write out in words the steps in the procedure to perform a permutation-based hypothesis test. (See Section 3.4.1 for an example of how to write the steps.)</p>
</section>
<section id="d-1" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="d-1">d)</h4>
<p>Interpret the p-value in context by completing the sentence “The p-value represents the probability of _____, assuming _____.”</p>
</section>
<section id="e-1" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="e-1">e)</h4>
<p>Explain, in context, what we should conclude from the p-value.</p>
</section>
<section id="f-1" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="f-1">f)</h4>
<p>State whether the difference or effect is statistically discernible. Also state whether you think it is practically meaningful and comment on how the result of the test is or isn’t consistent with the information in the graphs and tables.</p>
</section>
<section id="g" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="g">g)</h4>
<p>Say whether zero would be contained in a 95% confidence interval for the parameter of interest. Explain your answer.</p>
</section>
</section>
<section id="section-10" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="section-10">11)</h3>
<p>We want to know whether there is evidence of differences in average science test scores between two or more of the three programs (general, academic, vocational).</p>
<p>We fit a model of the form</p>
<p><span class="math display">\[
\begin{aligned}
\widehat{\text{Score}} &amp; = b_0 + b_1 \text{general} + b_2 \text{vocational}
\end{aligned}
\]</span> Model estimates are shown below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb263"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb263-1"><a href="#cb263-1" aria-hidden="true" tabindex="-1"></a>M_Seniors_science_prog <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>HSSeniors, science <span class="sc">~</span> prog)</span>
<span id="cb263-2"><a href="#cb263-2" aria-hidden="true" tabindex="-1"></a>M_Seniors_science_prog</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = science ~ prog, data = HSSeniors)

Coefficients:
   (Intercept)    progacademic  progvocational  
        52.444           1.356          -5.224  </code></pre>
</div>
</div>
<p>An F-statistic comparing this model to a model with only an intercept is shown below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb265"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb265-1"><a href="#cb265-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(M_Seniors_science_prog)<span class="sc">$</span>fstat[<span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  value 
8.12799 </code></pre>
</div>
</div>
<p>The following code performs a permutation-based hypothesis test.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb267"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb267-1"><a href="#cb267-1" aria-hidden="true" tabindex="-1"></a>science_prog_perm_test <span class="ot">&lt;-</span>  <span class="fu">do</span>(<span class="dv">10000</span>) <span class="sc">*</span> <span class="fu">lm</span>(<span class="at">data=</span>HSSeniors, science <span class="sc">~</span> <span class="fu">shuffle</span>(prog))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The histogram shows the distribution of <span class="math inline">\(b_1\)</span> in our simulation.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb268"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb268-1"><a href="#cb268-1" aria-hidden="true" tabindex="-1"></a>Estimate <span class="ot">&lt;-</span> science_prog_perm_test<span class="sc">$</span>F</span>
<span id="cb268-2"><a href="#cb268-2" aria-hidden="true" tabindex="-1"></a>Extreme <span class="ot">&lt;-</span> <span class="fu">abs</span>(science_prog_perm_test<span class="sc">$</span>F) <span class="sc">&gt;</span> Estimate</span>
<span id="cb268-3"><a href="#cb268-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb268-4"><a href="#cb268-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb268-5"><a href="#cb268-5" aria-hidden="true" tabindex="-1"></a>science_prog_perm_test_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>science_prog_perm_test, <span class="fu">aes</span>(<span class="at">x=</span>F)) <span class="sc">+</span> </span>
<span id="cb268-6"><a href="#cb268-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Extreme), <span class="at">color=</span><span class="st">"white"</span>) <span class="sc">+</span> </span>
<span id="cb268-7"><a href="#cb268-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"FALSE"</span> <span class="ot">=</span> <span class="st">"blue"</span>, <span class="st">"TRUE"</span> <span class="ot">=</span> <span class="st">"red"</span>)) <span class="sc">+</span></span>
<span id="cb268-8"><a href="#cb268-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept=</span><span class="fl">8.128</span>, <span class="at">color=</span><span class="st">"red"</span>) <span class="sc">+</span> </span>
<span id="cb268-9"><a href="#cb268-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Simulated Value of F"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Frequency"</span>) <span class="sc">+</span> </span>
<span id="cb268-10"><a href="#cb268-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Distribution of F under assumption of no relationship"</span>) <span class="sc">+</span></span>
<span id="cb268-11"><a href="#cb268-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span>
<span id="cb268-12"><a href="#cb268-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb268-13"><a href="#cb268-13" aria-hidden="true" tabindex="-1"></a>science_prog_perm_test_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch3_files/figure-html/unnamed-chunk-199-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>p-value:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb269"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb269-1"><a href="#cb269-1" aria-hidden="true" tabindex="-1"></a><span class="fu">prop</span>(<span class="sc">~</span> (schtypprivate <span class="sc">&gt;</span> <span class="fl">8.128</span>), <span class="at">data =</span> science_schtyp_perm_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>prop_TRUE 
        0 </code></pre>
</div>
</div>
<section id="a-6" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="a-6">a)</h4>
<p>Write null and alternative hypotheses. Be sure to clearly identify the parameter of interest in your hypotheses.</p>
</section>
<section id="b-6" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="b-6">b)</h4>
<p>State the appropriate test statistic words and symbols. Give the numerical value of the test statistic.</p>
</section>
<section id="c-5" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="c-5">c)</h4>
<p>Write out in words the steps to perform a permutation-based hypothesis test.</p>
</section>
<section id="d-2" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="d-2">d)</h4>
<p>Interpret p-value in context by completing the sentence “The p-value represents the probability of _____, assuming _____.”</p>
</section>
<section id="e-2" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="e-2">e)</h4>
<p>Explain, in context, what we should conclude from the p-value.</p>
</section>
<section id="f-2" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="f-2">f)</h4>
<p>State whether the difference or effect is statistically discernible. Also state whether you think it is practically meaningful and comment on how the result of the test is or isn’t consistent with the information in the graphs and tables.</p>
</section>
</section>
<section id="section-11" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="section-11">12)</h3>
<p>We want to know whether there is evidence of a relationship between students’ science scores and writing scores on standardized tests.</p>
<p>We fit a model of the form</p>
<p><span class="math display">\[
\begin{aligned}
\widehat{\text{Score}} &amp; = b_0 + b_1 \text{Writing}
\end{aligned}
\]</span></p>
<p>Model estimates are shown below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb271"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb271-1"><a href="#cb271-1" aria-hidden="true" tabindex="-1"></a>M_Seniors_science_write <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>HSSeniors, science <span class="sc">~</span> write)</span>
<span id="cb271-2"><a href="#cb271-2" aria-hidden="true" tabindex="-1"></a>M_Seniors_science_write</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = science ~ write, data = HSSeniors)

Coefficients:
(Intercept)        write  
    20.4037       0.5959  </code></pre>
</div>
</div>
<p>The following code performs a permutation-based hypothesis test.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb273"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb273-1"><a href="#cb273-1" aria-hidden="true" tabindex="-1"></a>science_write_perm_test <span class="ot">&lt;-</span> <span class="fu">do</span>(<span class="dv">10000</span>) <span class="sc">*</span> <span class="fu">lm</span>(science <span class="sc">~</span> <span class="fu">shuffle</span>(write), <span class="at">data =</span> HSSeniors)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The histogram shows the distribution of <span class="math inline">\(b_1\)</span> in our simulation.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb274"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb274-1"><a href="#cb274-1" aria-hidden="true" tabindex="-1"></a>Estimate <span class="ot">&lt;-</span> M_Seniors_science_write<span class="sc">$</span>coefficients[<span class="dv">2</span>]</span>
<span id="cb274-2"><a href="#cb274-2" aria-hidden="true" tabindex="-1"></a>Extreme <span class="ot">&lt;-</span> <span class="fu">abs</span>(science_write_perm_test<span class="sc">$</span>write) <span class="sc">&gt;</span> <span class="fu">abs</span>(Estimate)</span>
<span id="cb274-3"><a href="#cb274-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb274-4"><a href="#cb274-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb274-5"><a href="#cb274-5" aria-hidden="true" tabindex="-1"></a>science_write_perm_test_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>science_write_perm_test, <span class="fu">aes</span>(<span class="at">x=</span>write)) <span class="sc">+</span> </span>
<span id="cb274-6"><a href="#cb274-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Extreme), <span class="at">color=</span><span class="st">"white"</span>) <span class="sc">+</span> </span>
<span id="cb274-7"><a href="#cb274-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"FALSE"</span> <span class="ot">=</span> <span class="st">"blue"</span>, <span class="st">"TRUE"</span> <span class="ot">=</span> <span class="st">"red"</span>)) <span class="sc">+</span></span>
<span id="cb274-8"><a href="#cb274-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept=</span><span class="fu">c</span>(Estimate, <span class="sc">-</span><span class="dv">1</span><span class="sc">*</span>Estimate), <span class="at">color=</span><span class="st">"red"</span>) <span class="sc">+</span> </span>
<span id="cb274-9"><a href="#cb274-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Lakes: Simulated Value of b1"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Frequency"</span>) <span class="sc">+</span> </span>
<span id="cb274-10"><a href="#cb274-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Distribution of b1 under assumption of no relationship"</span>) <span class="sc">+</span></span>
<span id="cb274-11"><a href="#cb274-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span>
<span id="cb274-12"><a href="#cb274-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb274-13"><a href="#cb274-13" aria-hidden="true" tabindex="-1"></a>science_write_perm_test_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch3_files/figure-html/unnamed-chunk-203-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>p-value:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb275"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb275-1"><a href="#cb275-1" aria-hidden="true" tabindex="-1"></a><span class="fu">prop</span>(<span class="sc">~</span> (<span class="fu">abs</span>(write) <span class="sc">&gt;</span> <span class="fl">0.5959</span>), <span class="at">data =</span> science_write_perm_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>prop_TRUE 
        0 </code></pre>
</div>
</div>
<section id="a-7" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="a-7">a)</h4>
<p>Write null and alternative hypotheses. Be sure to clearly identify the parameter of interest in your hypotheses.</p>
</section>
<section id="b-7" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="b-7">b)</h4>
<p>State the appropriate test statistic words and symbols. Give the numerical value of the test statistic.</p>
</section>
<section id="c-6" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="c-6">c)</h4>
<p>Write out in words the steps to perform a permutation-based hypothesis test.</p>
</section>
<section id="d-3" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="d-3">d)</h4>
<p>Interpret p-values in context by completing the sentence “The p-value represents the probability of _____, assuming _____.”</p>
</section>
<section id="e-3" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="e-3">e)</h4>
<p>Explain, in context, what we should conclude from the p-value.</p>
</section>
<section id="f-3" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="f-3">f)</h4>
<p>State whether the difference or effect is statistically discernible. Also state whether you think it is practically meaningful and comment on how the result of the test is or isn’t consistent with the information in the graphs and tables.</p>
</section>
<section id="g-1" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="g-1">g)</h4>
<p>Say whether zero would be contained in a 95% confidence interval for the parameter of interest.</p>
</section>
<section id="section-12" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="section-12">13)</h4>
<p>The Bootstrap distribution for the difference in average cost of books in natural science classes, compared with humanities classes, was given in Question 6(c). If we perform a permutation-based hypothesis test for the null hypothesis that there is no difference in average books costs among natural science courses, compared to humanities courses, how would the distribution of mean differences compare to the bootstrap distribution from 6(c)? What would be different about it? Would the p-value associated with the hypothesis test be more or less than 0.05? Explain your answer.</p>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./Ch2.html" class="pagination-link" aria-label="Introduction to Statistical Models">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Introduction to Statistical Models</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./Ch4.html" class="pagination-link" aria-label="Inference from Models">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Inference from Models</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>